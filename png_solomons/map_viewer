/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var wcmc = ee.FeatureCollection("projects/coral_atlas/global_datasets/wcmc_reefs_2018v4_dissolved"),
    Artifact_layer = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[133.87823474549796, -0.4089792032861279],
           [133.63653552674796, -1.2987640172814356],
           [134.26275622987296, -2.901638046434227],
           [135.18560779237296, -3.680374916452446],
           [135.93267810487296, -3.384307934312925],
           [136.67974841737296, -2.7370426506771937],
           [141.32696521424796, -3.1759097861941235],
           [143.4279701191011, -4.259070182025207],
           [145.6691810566011, -5.8786331785618025],
           [146.5480873066011, -6.490284053493718],
           [146.8776771503511, -7.798378392835013],
           [147.6906654316011, -8.559593192736711],
           [148.4816810566011, -7.515281003123185],
           [149.31140410379453, -6.323085296945845],
           [148.7783119159761, -5.829452527797415],
           [148.11862548736215, -5.198240891526597],
           [147.2951576191011, -5.003695852147759],
           [146.5920326191011, -3.9084008385224744],
           [142.7687904316011, -2.043326425476854],
           [136.8361732441011, -0.13213848083636925],
           [135.2101966816011, 0.1974508549526587],
           [134.3532630878511, 0.17547831519620935]]],
         [[[151.68811485734636, -4.985234424733032],
           [151.46289513078386, -4.547302031346837],
           [150.85864708390886, -4.667761071909342],
           [150.7075727286196, -4.971498668283573],
           [150.91907188859636, -5.20956328424697],
           [151.22119591203386, -5.2150337336424],
           [151.31457970109636, -5.154856179259612]]],
         [[[148.29333946672136, -5.269735597524267],
           [148.47461388078386, -5.559573881564838],
           [149.94678184953386, -5.625178101912731],
           [149.95227501359636, -5.4556856112092955],
           [149.67761681047136, -5.182210323933331],
           [148.50757286515886, -5.258795608490538]]],
         [[[146.62545668014764, -9.323205761348502],
           [147.1268874846443, -9.964479081696203],
           [147.24636380300367, -9.937426456319757],
           [148.33456133245576, -10.613918906105498],
           [149.76635281667555, -10.691333794802919],
           [149.85911547007052, -10.675462965874859],
           [149.91339687081734, -10.57050003636133],
           [150.06985013112867, -10.275421525503225],
           [147.90966336355055, -9.611268046705264],
           [147.67895047292555, -9.546269125326358],
           [147.3356277190193, -9.482612329450294],
           [147.04723660573805, -9.313255047750458],
           [146.90029446706617, -9.10042611147292],
           [146.82751004323805, -9.147883128872149]]],
         [[[149.55726869828914, -9.337101862913343],
           [149.78932470327902, -9.376472633830232],
           [150.08735903032036, -9.285604413423018],
           [150.7712579561016, -9.15818355275302],
           [150.8097101045391, -9.055128991009664],
           [150.8097101045391, -8.78650678306035],
           [150.7108331514141, -8.631756774276797],
           [150.54329164750789, -8.074682981968278],
           [149.44253804991993, -7.944072510842077],
           [148.27743383982394, -7.930375404846073],
           [148.30757387407039, -8.436192489967747],
           [148.55875819848913, -8.665655297747731],
           [148.59109249722894, -8.850931958224628],
           [148.71139657927307, -9.047048576959925],
           [149.25789125688289, -8.930339227278287],
           [149.43641908891414, -9.098524005753074],
           [149.49409731157039, -9.220544190087072]]],
         [[[150.2948919767333, -2.7862858150120196],
           [150.45694031657706, -2.1963314333767694],
           [150.1740423673583, -2.0920344064818086],
           [149.89663758220206, -2.1606516735138364],
           [149.7950140470458, -2.2649439492415473],
           [149.78677430095206, -2.4488091963068355],
           [149.8554388517333, -2.6573421167179205],
           [150.0037542814208, -2.7917724722694213],
           [150.2289740079833, -2.84663762741956]]],
         [[[156.39644230822557, -6.414516921978265],
           [156.30580510119432, -6.654645725146902],
           [156.34425724963182, -6.98463035740684],
           [156.70405949572557, -7.3280032724124675],
           [156.98421086291307, -7.507760509681789],
           [157.14625920275682, -7.581276246666614],
           [157.44289006213182, -6.990082723849697],
           [157.26161564806932, -6.741936411401399],
           [156.80293644885057, -6.504578712109516],
           [156.48707951525682, -6.387222317613923]]],
         [[[160.00467780021492, -9.244977918484341],
           [160.05960944083992, -9.518671841038799],
           [160.31778815177742, -9.613465472030013],
           [160.5773140827556, -9.717789078205124],
           [160.79844000724617, -9.686573855222663],
           [160.97971442130867, -9.570134520729852],
           [160.49356940177742, -8.957505853583573],
           [160.23813727287117, -8.914093906172516],
           [160.01017096427742, -9.10127076836629]]],
         [[[152.5867729668269, -10.826405340459102],
           [152.5524406914363, -10.796729226715392],
           [152.53458790823316, -10.818312146056291],
           [152.52360158010816, -10.839893511909713],
           [152.48514943167066, -10.872262641448312],
           [152.41236500784254, -10.923506576867792],
           [152.3766594414363, -11.013836158995067],
           [152.45768361135816, -11.009792141799133],
           [152.54420094534254, -10.974741668592298],
           [152.5689201836238, -10.936990354775086],
           [152.58402638479566, -10.910022186516041],
           [152.61698536917066, -10.865519362076688],
           [152.6018791679988, -10.839893511909713]]],
         [[[153.1141167168269, -10.729272623561489],
           [153.05094533010816, -10.872262641448312],
           [152.9163628105769, -10.85742722575276],
           [152.74882130667066, -10.89114301248613],
           [152.79825978323316, -11.030011672052762],
           [152.80237965628004, -11.079880561975394],
           [152.8614311699519, -11.118961050240358],
           [152.96854786917066, -11.137825619144325],
           [153.13334279104566, -11.171509306755395],
           [153.2020073418269, -11.224048047205324],
           [153.3228569512019, -11.268496440389251],
           [153.41212086721754, -11.176898334189444],
           [153.5261040215144, -11.06909881813882],
           [153.5741692070613, -10.895188650614038]]],
         [[[152.41923146292066, -11.093357183031864],
           [152.36292653128004, -11.12165606344333],
           [152.29288868948316, -11.259068566506777],
           [152.27640919729566, -11.389684341259677],
           [152.34782033010816, -11.440837098958864],
           [152.5469475273738, -11.50947495411365],
           [152.90812306448316, -11.619798725123827],
           [152.98502736135816, -11.552533303139224],
           [153.06605153128004, -11.59693029873299],
           [153.10038380667066, -11.529659377178806],
           [153.05094533010816, -11.397761705210451],
           [153.04407887503004, -11.27388365813425],
           [153.03995900198316, -11.229436096232106],
           [152.7790337090144, -11.170162034253947],
           [152.68153004690504, -11.166120179218055],
           [152.58951954885816, -11.127046015084105],
           [152.5030022148738, -11.070446557832925],
           [152.46866993948316, -11.097400048190782]]],
         [[[154.25796585687513, -11.366236524355337],
           [154.27101212152357, -11.395181735629507],
           [154.3712623656642, -11.412008992578516],
           [154.42001419671888, -11.41066284871229],
           [154.46189957269544, -11.360177852037655],
           [154.4591529906642, -11.301604059727552],
           [154.33487015375013, -11.229548620856583],
           [154.2895515502345, -11.253120142759194],
           [154.26071243890638, -11.304297370608236],
           [154.24423294671888, -11.351426209237339],
           [154.24972611078138, -11.360177852037655]]],
         [[[160.29867194522748, -12.251100396584077],
           [160.27120612491498, -12.336975481817502],
           [160.31240485538373, -12.497915273425836],
           [160.31789801944623, -12.564944033483417],
           [160.42226813663373, -12.631955320613867],
           [160.47445319522748, -12.586389550590964],
           [160.53762458194623, -12.505959644319004],
           [160.52663825382123, -12.433551306186807]]],
         [[[160.67495368350873, -12.90250124908476],
           [160.60628913272748, -12.918564141919271],
           [160.55959723819623, -12.939979725505454],
           [160.58706305850873, -12.969423149600967],
           [160.64199469913373, -12.974776125312326],
           [160.72439216007123, -12.921241190341497]]],
         [[[160.16101859182297, -11.85623246602585],
           [160.23517630666672, -11.884454869531236],
           [160.43979666799484, -11.794401773135085],
           [160.4095842656511, -11.713732110542248],
           [160.34091971486984, -11.673388436050052],
           [160.28461478322922, -11.63438397079991],
           [160.22693656057297, -11.658594283643355],
           [160.16513846486984, -11.81322128851953]]],
         [[[161.62734334529722, -10.879040394073847],
           [161.83333699764097, -10.965338907294944],
           [162.00637166560972, -11.016566749206016],
           [162.24807088435972, -10.994998215914597],
           [162.44582479060972, -10.784622789609758],
           [162.48427693904722, -10.665884340896692],
           [162.06669831663342, -9.998386664791544],
           [161.94035554319592, -10.04436617502685],
           [161.86619782835217, -10.274165132777055],
           [161.79753327757092, -10.38765145033208],
           [161.70964265257092, -10.641494737842686],
           [161.55858064085217, -10.827692410386966]]],
         [[[161.14644816589066, -8.560565458628094],
           [160.9898929901094, -8.593155852050975],
           [160.90062907409379, -8.658328225409537],
           [160.86767008971879, -8.768280969367172],
           [160.9569340057344, -8.8968420508194],
           [161.0777836151094, -8.8981988164202],
           [161.16979411315629, -8.808641532775486],
           [161.24669841003129, -8.657973642751688],
           [161.1986332244844, -8.58058012694598]]],
         [[[162.8783444373843, -8.401237791030695],
           [162.8515652625796, -8.409389032203904],
           [162.81448640515774, -8.43384172648629],
           [162.8117398231265, -8.478667644326173],
           [162.85774507214992, -8.528241736772166],
           [162.92572297742336, -8.535032208318714],
           [162.98065461804836, -8.509906861049256],
           [163.01155366589992, -8.4616887435528],
           [162.98546113660305, -8.42297405311963],
           [162.96486177136867, -8.408030503909012],
           [162.91954316785305, -8.408030503909012],
           [162.88521089246242, -8.39852067257153]]],
         [[[159.12769283868514, -5.031088988222289],
           [159.02332272149764, -5.356589831624908],
           [159.18262447931014, -5.5999189407806735],
           [159.68389037852242, -5.703884610159751],
           [159.88300289727889, -5.550714342040766],
           [159.81159176446639, -5.260871812405926],
           [159.57263912774764, -5.102221086775103],
           [159.32544674493514, -4.968157954733102],
           [159.19635738946639, -4.973630458146343]]],
         [[[153.55114863181925, -3.9054729684363525],
           [153.4550182607255, -3.983565120758174],
           [153.40695307517862, -4.082197227793169],
           [153.559388377913, -4.282163722155516],
           [153.867005565413, -4.128769306638603],
           [153.932923534163, -3.9808251698574586],
           [153.84777949119425, -3.8808107721423664],
           [153.73654291892862, -3.765711074408919],
           [153.61294672752237, -3.836965092402823]]],
         [[[144.92907479070624, -1.3534256201414332],
           [144.8439307477375, -1.4028497945746512],
           [144.80410530828436, -1.4742384159397606],
           [144.79174568914374, -1.63073607558392],
           [144.882382896175, -1.7638868286792753],
           [145.11721565984686, -1.776240550226351],
           [145.23806526922186, -1.6623087272531174],
           [145.3177161481281, -1.514050313744027],
           [145.18176033758124, -1.3424423321797951],
           [145.01833870672186, -1.3149838972968817]]],
         [[[145.64294424860844, -0.7563862571808738],
           [145.4863890728272, -0.6327991718126712],
           [145.3600462993897, -0.5943492289282062],
           [145.2996214947022, -0.6410384088003632],
           [145.2117308697022, -0.7316691032554247],
           [145.29687491267094, -0.9046860635489963],
           [145.4039916118897, -1.0419953166615068],
           [145.56603995173344, -1.0996634637497176],
           [145.7061156353272, -1.0200262178583916],
           [145.7225951275147, -0.8991935800909844],
           [145.69238272517094, -0.8003275136288024]]],
         [[[144.35148599263525, -0.949481469891727],
           [143.799423004354, -1.4410111730599109],
           [143.8818204652915, -1.7869426880286041],
           [144.19218423482275, -2.028507762417621],
           [144.4201505434165, -1.7787069305454442],
           [144.733260894979, -1.3421633943466025],
           [144.766219879354, -1.053835623801309],
           [144.54374673482275, -0.9275117613388125],
           [144.45036294576025, -0.92201931276445]]],
         [[[143.11767455475118, -1.3074320527877101],
           [142.97485228912618, -1.3060591189220558],
           [142.8828417910793, -1.3815693458635017],
           [142.9048144473293, -1.4845339437942924],
           [143.04077025787618, -1.631421721290283],
           [143.12042113678243, -1.6094578522462468],
           [143.20419188873555, -1.5408192514010546],
           [143.20419188873555, -1.4145185186625335],
           [143.16024657623555, -1.3486197160745361]]],
         [[[146.51666668688708, -2.082641979013898],
           [146.38345745837145, -2.211640674316241],
           [146.31341961657458, -2.1375363698009777],
           [146.18433026110583, -2.118323553735924],
           [146.13626507555895, -2.144398031661015],
           [146.12390545641833, -2.336511712318543],
           [146.34088543688708, -2.5148795021161154],
           [146.74463299548083, -2.528599113282302],
           [146.97534588610583, -2.5107635905938004],
           [147.1497538450902, -2.4901838389313804],
           [147.27197674548083, -2.306324104933219],
           [147.28296307360583, -2.1869396446174307],
           [147.16760662829333, -2.100161473559883],
           [146.88882855212145, -2.097416734024053],
           [146.64163616930895, -2.0562450666556464],
           [146.5345194700902, -2.063107085557386]]],
         [[[146.09005607070966, -2.5978395661531053],
           [146.08456290664716, -3.0559593691788787],
           [146.59542716445966, -3.2259915753917077],
           [147.03213370742841, -3.220507101347266],
           [147.23812735977216, -2.7679409361366445],
           [147.08981193008466, -2.5868644812768227],
           [146.87832511367841, -2.540219315762449],
           [146.48831046524091, -2.5649140269789243],
           [146.19167960586591, -2.5841206952010483]]],
         [[[151.3173112619978, -4.495063208457773],
           [151.59471604715404, -4.360882424847945],
           [151.59471604715404, -4.254068309251699],
           [151.77049729715404, -4.295152434720749],
           [152.2277330020076, -4.260845806933132],
           [152.2991441348201, -4.030736773695575],
           [152.1068833926326, -3.926618209122255],
           [151.5795396426326, -3.8334484734887675],
           [151.20875106841385, -3.984159043348545],
           [151.1345933535701, -4.217020708766678],
           [151.2389634707576, -4.389567495114925]]],
         [[[153.2463240594829, -4.257140695088385],
           [153.00325154971728, -4.255771191845051],
           [152.67640828799853, -4.265357663350862],
           [152.56654500674853, -4.2941163590447555],
           [152.50612020206103, -4.43378590363591],
           [152.60499715518603, -4.535098315291163],
           [152.81373738956103, -4.551526024548336],
           [153.09938192081103, -4.507717970290143],
           [153.23121785831103, -4.469383755626047],
           [153.26143026065478, -4.335198328122119]]]]),
    image = ee.Image("projects/coral_atlas/workflow/mapping/eastern_png_and_solomons/eastern_png_and_solomons_high_tide_normalized_sr_may2018_may2020_v2_shift_mosaic/20200531T191050Z/eastern_png_and_solomons_high_tide_normalized_sr_may2018_may2020_v2_shift_mosaic_depth"),
    imageVisParam = {"opacity":1,"bands":["b3","b2","b1"],"min":26.14,"max":1280.86,"gamma":0.43900000000000006},
    low_rrs = ee.Image("projects/coral_atlas/png_solomons/image/eastern_png_and_solomons_low_tide_normalized_sr_may2018_may2020_v2_shift_mosaic"),
    noReef_mask = /* color: #ff0000 */ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                136.23460438801584,
                -2.629275602393311
              ],
              [
                136.54427215599102,
                -2.6962787263763
              ],
              [
                137.36482013102457,
                -2.6642552504268946
              ],
              [
                139.9995688809453,
                -2.5488413084834396
              ],
              [
                140.07921983543994,
                -2.3677343285527304
              ],
              [
                140.06823358805778,
                -2.329314547708212
              ],
              [
                140.09020640950374,
                -2.1854847510356965
              ],
              [
                140.1231655546508,
                -2.0345255557659154
              ],
              [
                139.63448174799328,
                -1.9669377329328368
              ],
              [
                139.49441008227905,
                -2.0918267724754664
              ],
              [
                139.5314881643882,
                -2.116529138763426
              ],
              [
                139.52736506429588,
                -2.1590732891643567
              ],
              [
                139.4779267245694,
                -2.149467044103999
              ],
              [
                139.44702752783493,
                -2.1364300548067074
              ],
              [
                139.43123492792634,
                -2.1137861921821144
              ],
              [
                139.45595566720115,
                -2.08359346232172
              ],
              [
                139.48754244073766,
                -2.090454349328754
              ],
              [
                139.54384696346003,
                -1.9923256158176599
              ],
              [
                139.5246187017566,
                -1.9339977952593315
              ],
              [
                139.36257072084962,
                -1.8543904470764119
              ],
              [
                139.27742670959822,
                -2.0177183714923896
              ],
              [
                139.24996091781156,
                -2.052028911291586
              ],
              [
                139.2183752982711,
                -2.032815066888063
              ],
              [
                139.22661505062067,
                -1.9998765582770235
              ],
              [
                139.3158789203569,
                -1.8379195014091445
              ],
              [
                139.15383091818813,
                -1.743208750439816
              ],
              [
                139.1140055109585,
                -1.8022318777858688
              ],
              [
                139.0453410146064,
                -1.9271349034216445
              ],
              [
                139.03160811474413,
                -1.957329886529148
              ],
              [
                139.00276905663648,
                -1.9573298729370465
              ],
              [
                138.9835430281675,
                -1.9339974195429486
              ],
              [
                138.99727592261027,
                -1.91340970740139
              ],
              [
                139.03023484752666,
                -1.913409722828662
              ],
              [
                139.11812540735292,
                -1.748699334409607
              ],
              [
                138.91773994280973,
                -1.5812461623387108
              ],
              [
                138.86504146035546,
                -1.676821768127756
              ],
              [
                138.80204113775144,
                -1.7325886201906302
              ],
              [
                138.71861290024526,
                -1.67047400566644
              ],
              [
                138.68943055312397,
                -1.6172809060505622
              ],
              [
                138.67535436102222,
                -1.4878959602114388
              ],
              [
                138.80169701766204,
                -1.262741578012466
              ],
              [
                138.6314091475644,
                -1.1419187033444245
              ],
              [
                138.12603852128439,
                -0.9332130799140748
              ],
              [
                137.35699635552635,
                -1.0485527089145301
              ],
              [
                136.9944485474737,
                -1.5098621463199164
              ],
              [
                136.86947954194483,
                -1.612818145966949
              ],
              [
                136.98895568769177,
                -1.7157737768162993
              ],
              [
                137.07409974041192,
                -1.824211687443526
              ],
              [
                137.08783288063466,
                -1.8736240112529094
              ],
              [
                137.05487379382166,
                -1.892840019458443
              ],
              [
                137.00268881657726,
                -1.884604837618182
              ],
              [
                136.8969455186693,
                -1.8338247953769289
              ],
              [
                136.7307777778106,
                -1.9436237149937916
              ],
              [
                136.40668192102845,
                -2.058910156772861
              ],
              [
                136.10455880821428,
                -2.2016340367542937
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                140.71373901908086,
                -2.519074775282059
              ],
              [
                140.81673584525274,
                -2.393534125840512
              ],
              [
                140.64782105033086,
                -2.3029730415497327
              ],
              [
                140.511865239784,
                -2.2899372546960612
              ],
              [
                140.41024170462774,
                -2.307775669833533
              ],
              [
                140.35531006400274,
                -2.3516846576705537
              ],
              [
                140.3745361382215,
                -2.41411536419168
              ],
              [
                140.43221436087774,
                -2.4834032269293895
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                141.01554161343432,
                -2.387859721554285
              ],
              [
                140.8754824804241,
                -2.570322586335402
              ],
              [
                140.81778770718432,
                -2.8103972628843534
              ],
              [
                143.70169883999682,
                -3.8358778782129113
              ],
              [
                144.47623497280932,
                -3.9893279430452173
              ],
              [
                144.861104733211,
                -4.114675941761769
              ],
              [
                144.99808555874682,
                -3.872872867174884
              ],
              [
                144.57648521694995,
                -3.6796593376325206
              ],
              [
                144.47552778474923,
                -3.593346729811558
              ],
              [
                144.08072716030932,
                -3.5288961647240895
              ],
              [
                143.73053795132495,
                -3.3493190968681943
              ],
              [
                143.60693752278266,
                -3.490864395121523
              ],
              [
                143.51767784390307,
                -3.431572330714073
              ],
              [
                143.49059614019686,
                -3.412637628239037
              ],
              [
                143.46711920932088,
                -3.403297989914695
              ],
              [
                143.44535929714593,
                -3.397899047607604
              ],
              [
                143.42566025255888,
                -3.3918146080873
              ],
              [
                143.3956183987176,
                -3.3777633645023197
              ],
              [
                143.4136420139484,
                -3.3458902334157075
              ],
              [
                143.30962425503589,
                -3.2876246268176796
              ],
              [
                143.21555382046557,
                -3.2293541220233344
              ],
              [
                142.62228591753225,
                -3.0515008073622583
              ],
              [
                142.5452147010249,
                -3.052256989853185
              ],
              [
                142.52375977021381,
                -3.0948364536741915
              ],
              [
                142.49474882336892,
                -3.1183889132894542
              ],
              [
                142.50530539369186,
                -3.1493624488793324
              ],
              [
                142.4980092648015,
                -3.1721086640064704
              ],
              [
                142.4666499559995,
                -3.161155754741027
              ],
              [
                142.45039778869068,
                -3.131005394371224
              ],
              [
                142.46948817473128,
                -3.111787510014121
              ],
              [
                142.4940711264162,
                -3.102168014898324
              ],
              [
                142.5382918119067,
                -3.049447468494804
              ],
              [
                142.49530847595784,
                -3.0296389838063837
              ],
              [
                142.44401743960728,
                -3.020190317366411
              ],
              [
                142.4159365767008,
                -3.0770604152104624
              ],
              [
                142.4218444790445,
                -3.1137014765581057
              ],
              [
                142.41134446803005,
                -3.125618030331904
              ],
              [
                142.39741101603315,
                -3.1320494428617125
              ],
              [
                142.3884272183513,
                -3.1284569050030293
              ],
              [
                142.38871320960297,
                -3.1159511828595705
              ],
              [
                142.43803684947088,
                -3.0189993360011136
              ],
              [
                141.11991173062182,
                -2.3933481048259027
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                145.21952800346358,
                -4.2738047138002
              ],
              [
                145.20785502983077,
                -4.305301928527081
              ],
              [
                145.24562053276046,
                -4.3981678926099725
              ],
              [
                145.27995280815108,
                -4.395429393667492
              ],
              [
                145.32115153861983,
                -4.405014095909013
              ],
              [
                145.33767395566056,
                -4.411689210082155
              ],
              [
                145.34956149650557,
                -4.40698236769878
              ],
              [
                145.36852999193823,
                -4.434879814516641
              ],
              [
                145.35411052299483,
                -4.441297919007947
              ],
              [
                145.35814454404175,
                -4.44912781605429
              ],
              [
                145.36475352836592,
                -4.447202429309091
              ],
              [
                145.37131974775963,
                -4.43920148412537
              ],
              [
                145.3854388307375,
                -4.440699112586922
              ],
              [
                145.4168527562712,
                -4.458412311356147
              ],
              [
                145.42505499768322,
                -4.479889606114662
              ],
              [
                145.4325038877046,
                -4.487975519783595
              ],
              [
                145.4455840002671,
                -4.486713220665236
              ],
              [
                145.45426985631863,
                -4.490360341485443
              ],
              [
                145.45591770358362,
                -4.498542421633423
              ],
              [
                145.46867141018305,
                -4.527761992604998
              ],
              [
                145.50022366735283,
                -4.557579367043024
              ],
              [
                145.5944364507292,
                -4.678125161332891
              ],
              [
                145.70567302299483,
                -4.5515075843828035
              ],
              [
                145.47529899424939,
                -4.342791359648398
              ],
              [
                145.3880950147572,
                -4.271581916429295
              ],
              [
                145.30913078135876,
                -4.266103991729912
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                145.6133541386202,
                -5.370215193785555
              ],
              [
                145.6298336308077,
                -5.586204004849849
              ],
              [
                145.85779993940145,
                -5.6067051817884765
              ],
              [
                145.98551600385457,
                -5.471384228231634
              ],
              [
                145.96628992963582,
                -5.331930621906449
              ],
              [
                145.9319576542452,
                -5.225268206335136
              ],
              [
                145.82166488984257,
                -5.211602215155205
              ],
              [
                145.80887776375215,
                -5.205110192988256
              ],
              [
                145.66416590619832,
                -5.237576342001267
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                147.6394295424008,
                -6.575348731674722
              ],
              [
                147.53780600724454,
                -6.5535201300551575
              ],
              [
                146.9417977064633,
                -6.509860063645987
              ],
              [
                146.76876303849454,
                -6.613546476096603
              ],
              [
                146.7275643080258,
                -6.913567550664378
              ],
              [
                146.8319344252133,
                -7.235196480466454
              ],
              [
                147.2878670424008,
                -7.6845455744788485
              ],
              [
                147.68200156388517,
                -7.921285558025248
              ],
              [
                147.8914299826872,
                -7.6450335761539545
              ],
              [
                147.7932381361508,
                -7.491245934917704
              ],
              [
                147.6943611830258,
                -7.360515750107844
              ],
              [
                147.8207039564633,
                -6.889027412822765
              ],
              [
                147.70809409318204,
                -6.594447971880935
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                149.81287598377014,
                -9.759604790651878
              ],
              [
                149.60550904041077,
                -9.752837640550407
              ],
              [
                149.61649536853577,
                -9.926033168752364
              ],
              [
                149.61512207752014,
                -10.366723373189567
              ],
              [
                149.61939415201212,
                -10.42549656293051
              ],
              [
                149.69775615974652,
                -10.442722973453531
              ],
              [
                149.73487565213944,
                -10.372312060934986
              ],
              [
                149.79533110499034,
                -10.378887446325564
              ],
              [
                149.84786256143937,
                -10.489024044005982
              ],
              [
                149.85939776293532,
                -10.517380249720935
              ],
              [
                149.89840077160318,
                -10.513328348413188
              ],
              [
                150.0774910875286,
                -10.587905093132598
              ],
              [
                150.30382752185608,
                -10.354565274760462
              ],
              [
                150.39171814685608,
                -10.293092127730384
              ],
              [
                150.4418432689264,
                -10.249175398193326
              ],
              [
                150.51188111072327,
                -10.141046796732594
              ],
              [
                150.40476441150452,
                -10.07615208629753
              ],
              [
                150.14246582752014,
                -9.954439356985928
              ],
              [
                149.9859106517389,
                -9.913858333176595
              ],
              [
                149.86368775134827,
                -9.793438477225978
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                149.28114887630502,
                -10.42136186591352
              ],
              [
                149.2969417229847,
                -10.42136186591352
              ],
              [
                149.3237208977894,
                -10.420011225643288
              ],
              [
                149.34432026302377,
                -10.408530547022572
              ],
              [
                149.34432026302377,
                -10.385567922483963
              ],
              [
                149.33814045345346,
                -10.366656259118976
              ],
              [
                149.3237208977894,
                -10.360577267561561
              ],
              [
                149.2969417229847,
                -10.356524541009197
              ],
              [
                149.29762836849252,
                -10.332207082224455
              ],
              [
                149.3079280511097,
                -10.318696569527377
              ],
              [
                149.32097431575815,
                -10.318696569527377
              ],
              [
                149.33676716243784,
                -10.317345486342376
              ],
              [
                149.3511867181019,
                -10.314643302573465
              ],
              [
                149.3614864007191,
                -10.320047646911785
              ],
              [
                149.37590595638315,
                -10.33761112472372
              ],
              [
                149.39307209407846,
                -10.340313111111644
              ],
              [
                149.39856525814096,
                -10.333558101562875
              ],
              [
                149.39238544857065,
                -10.293700592396638
              ],
              [
                149.35899219229657,
                -10.136860770861745
              ],
              [
                149.04588184073407,
                -10.099006621678834
              ],
              [
                148.43064746573407,
                -9.942135009295349
              ],
              [
                147.76597461417157,
                -9.682320480824014
              ],
              [
                147.27708301260907,
                -9.183784786465402
              ],
              [
                147.15607416810403,
                -9.009588526492545
              ],
              [
                147.0186567126644,
                -8.987241746366323
              ],
              [
                146.68769357789878,
                -9.235591273908257
              ],
              [
                146.76803110231285,
                -9.350788902306903
              ],
              [
                146.8154096423519,
                -9.376533762755251
              ],
              [
                146.87171457399253,
                -9.386695682153789
              ],
              [
                146.9417524157894,
                -9.37450134315114
              ],
              [
                146.98267225755345,
                -9.36833522070071
              ],
              [
                147.02455763353,
                -9.406949842276434
              ],
              [
                147.04447035325657,
                -9.41575608267194
              ],
              [
                147.0788026286472,
                -9.451656122384277
              ],
              [
                147.10420851243626,
                -9.462493135049527
              ],
              [
                147.1607641616591,
                -9.465059003804987
              ],
              [
                147.18719865993657,
                -9.49316654043066
              ],
              [
                147.21775573880754,
                -9.513820962909225
              ],
              [
                147.2338494442562,
                -9.526518532919866
              ],
              [
                147.24651019498583,
                -9.519577327239027
              ],
              [
                147.23337894352963,
                -9.490795990293368
              ],
              [
                147.25655390444595,
                -9.48470107390072
              ],
              [
                147.2980932632216,
                -9.496213278045548
              ],
              [
                147.35165161283098,
                -9.536167872238892
              ],
              [
                147.37808657688706,
                -9.583903949280451
              ],
              [
                147.34478515775285,
                -9.630956621188322
              ],
              [
                147.36675781400285,
                -9.658711158341246
              ],
              [
                147.42031616361223,
                -9.735193508689498
              ],
              [
                147.4786810317763,
                -9.818520622892258
              ],
              [
                147.4738745132216,
                -9.865878396512368
              ],
              [
                147.50752014310441,
                -9.930815125588893
              ],
              [
                147.5617651382216,
                -9.985595473281347
              ],
              [
                147.60914367826066,
                -10.02413908273846
              ],
              [
                147.6434759536513,
                -10.035633658778591
              ],
              [
                147.71282714994035,
                -10.076199485864057
              ],
              [
                147.72724670560441,
                -10.097832508326603
              ],
              [
                147.74252104109493,
                -10.099858532766694
              ],
              [
                147.76329532204454,
                -10.218145903220083
              ],
              [
                147.82252725239798,
                -10.106621598145678
              ],
              [
                147.85702270658098,
                -10.100536533925238
              ],
              [
                147.92706054837785,
                -10.087692209969118
              ],
              [
                147.97237915189348,
                -10.14312193475168
              ],
              [
                148.0069359919168,
                -10.14379784790638
              ],
              [
                148.0495041406555,
                -10.177593504178681
              ],
              [
                147.94856925500062,
                -10.281650246229441
              ],
              [
                148.03439908402393,
                -10.297870178144098
              ],
              [
                148.12092259189106,
                -10.351233697671205
              ],
              [
                148.09619990793243,
                -10.1992178634515
              ],
              [
                148.1435784479715,
                -10.172860762773334
              ],
              [
                148.19507686105743,
                -10.176239999953458
              ],
              [
                148.29395381418243,
                -10.177591684809242
              ],
              [
                148.31798640695587,
                -10.187729138703459
              ],
              [
                148.3633050104715,
                -10.24787139166297
              ],
              [
                148.3962639948465,
                -10.23503299012975
              ],
              [
                148.41686336008087,
                -10.237735854693067
              ],
              [
                148.43265620676056,
                -10.262060598795156
              ],
              [
                148.51368037668243,
                -10.281654172154212
              ],
              [
                148.52466670480743,
                -10.276249169769166
              ],
              [
                148.53702632394806,
                -10.222194069153794
              ],
              [
                148.58989802804962,
                -10.195163066724383
              ],
              [
                148.65581599679962,
                -10.208678855009676
              ],
              [
                148.69083491769806,
                -10.217463809557442
              ],
              [
                148.74576655832306,
                -10.232330102544049
              ],
              [
                148.75537959543243,
                -10.235708708429167
              ],
              [
                148.75812617746368,
                -10.250574146790452
              ],
              [
                148.75606624094024,
                -10.283681024205801
              ],
              [
                148.7869652887918,
                -10.324215330087782
              ],
              [
                148.82816401926056,
                -10.299219790899269
              ],
              [
                148.8748559137918,
                -10.29854420826224
              ],
              [
                148.89133494238902,
                -10.305975694021111
              ],
              [
                148.90850154367462,
                -10.312731139537185
              ],
              [
                148.8993706632922,
                -10.324299927244189
              ],
              [
                148.79547221720003,
                -10.370985350686679
              ],
              [
                148.64144153306066,
                -10.389303610955618
              ],
              [
                148.65299550726508,
                -10.478157161717427
              ],
              [
                148.80601578336717,
                -10.454897159894127
              ],
              [
                148.94661014087245,
                -10.437683638167496
              ],
              [
                148.9297875544168,
                -10.326241908435591
              ],
              [
                148.98334590402618,
                -10.314757791848095
              ],
              [
                149.0066918512918,
                -10.3093533566999
              ],
              [
                149.06848994699493,
                -10.324215330087782
              ],
              [
                149.01836482492462,
                -10.412697053007893
              ],
              [
                149.1275414606668,
                -10.47954827725473
              ],
              [
                149.2078865691016,
                -10.38264983595312
              ],
              [
                149.27448359933868,
                -10.415398391092248
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    });
/***** End of imports. If edited, may not auto-convert in the playground. *****/
//Viewing script for looking at reefs and classifications for each region. In this case png and salomon 
//From this region Hawaii onwards the map_viewer script is going to be used from the very beginning
//in the workflow.

//RB: I set initially this viewer for CR to draw artifact layers and set the mask 1) noReef_mask, 2) mid_mask and 3) refined_mask

// imports
/*
var pkg_vis = require('users/mitchest/global_reefs:Modules/pkg_vis')
var map_palettes = require('users/mitchest/global_reefs:Modules/colour_pals')
*/
// choose where to centre (link this dynamically to map app?)

Map.setCenter(147.86087035000003, -7.199000717379121, 5)

/*
//4. add turbidity for reference
Map.addLayer(turbidity.focal_mode(5), {min:5, max:20, palette: ['#ffffe5','#fff7bc','#fee391','#fec44f','#fe9929','#ec7014','#cc4c02','#993404','#662506']}, "Accumulative turbidity (smooth)", false)
Map.addLayer(turbidity, {min:5, max:20, palette: ['#ffffe5','#fff7bc','#fee391','#fec44f','#fe9929','#ec7014','#cc4c02','#993404','#662506']}, "Accumulative turbidity", false)
*/


// add some background data
//Map.addLayer(any_rrs, {bands: ['b3','b2','b1'], min: 66, max: 1260}, "Any tide mosaic", false)
//Map.addLayer(high_rrs, {bands: ['b3','b2','b1'], min: 66, max: 1260}, "High tide mosaic", false)

var imageVisParam = {"opacity":1,"bands":["b3","b2","b1"],"min":26.14,"max":1280.86,"gamma":1};
Map.addLayer(low_rrs, imageVisParam, 'Dove sr lowtide', true)
//Map.addLayer(Artifact_layer, {color: 'ffff00'}, 'Artifact Layer', false)

//Map.addLayer(any_depth, {min: -1, max: 1200, palette:['#d0d1e6','#a6bddb','#74a9cf','#3690c0','#0570b0','#045a8d','#023858']}, "Any tide depth", false)
//Map.addLayer(high_depth, {min: -1, max: 1200, palette:['#d0d1e6','#a6bddb','#74a9cf','#3690c0','#0570b0','#045a8d','#023858']}, "High tide depth", false)
//Map.addLayer(low_depth, {min: -1, max: 1200, palette:['#d0d1e6','#a6bddb','#74a9cf','#3690c0','#0570b0','#045a8d','#023858']}, "Low tide depth", false)
//Map.addLayer(pixels.select('depth'), {min: -1, max: 2500, palette:['#d0d1e6','#a6bddb','#74a9cf','#3690c0','#0570b0','#045a8d','#023858']}, "Depth covariate (S2/LS8/Dove)", false)

/*
// Hawaii classification


Map.addLayer(ee.ImageCollection([hawaii_geo_west, hawaii_geo_east]).mosaic(), map_palettes.geo, "Geo RAW", false)
Map.addLayer(geo_clean_p2, map_palettes.geo, "Geo Clean Pass 2", false)
Map.addLayer(geo_clean_man, map_palettes.geo, "Geo Clean Manual (FINAL)", true)
Map.addLayer(ee.ImageCollection([hawaii_benthic_west, hawaii_benthic_east]).mosaic(), map_palettes.benthic, "Benthic RAW", false)
Map.addLayer(benthic_clean, map_palettes.benthic, "Benthic Clean (FINAL)", true)

// wave data
//var kd1 = ee.Image('users/danleeharris/reefwave/fiji_v1_kd1')
//var kd2 = ee.Image('users/danleeharris/reefwave/fiji_v1_kd2')

//Map.addLayer(kd1, {}, "waves - kd1", false)
//Map.addLayer(kd2, {}, "waves - kd2", false)

// add training data / sample point distributions
// ----> possibly - points are only intermediate in the mapping script, so will have to pull those out if we want that
//Map.addLayer(ee.Image().byte().paint(fiji_training_geo_oldmaps, 'class_num'), map_palettes.geo, "Training data - geo (old maps) ", false)
//Map.addLayer(ee.Image().byte().paint(fiji_training_geo, 'class_num'), map_palettes.geo, "Training data - geo (new maps)", false)
//Map.addLayer(ee.Image().byte().paint(fiji_training_benthic, 'class_num'), map_palettes.benthic, "Training - benthic (manual curation)", false)
//Map.addLayer(geo_train, {}, "geomorphic training locations", false)

*/

// WCMC

Map.addLayer(Artifact_layer, {color: 'ffff00'}, 'Artifact Layer', false)
//Map.addLayer(any_depth, {min: -1, max: 1200, palette:['#d0d1e6','#a6bddb','#74a9cf','#3690c0','#0570b0','#045a8d','#023858']}, "Any tide depth", false)
//Map.addLayer(high_depth, {min: -1, max: 1200, palette:['#d0d1e6','#a6bddb','#74a9cf','#3690c0','#0570b0','#045a8d','#023858']}, "High tide depth", false)
//Map.addLayer(low_depth, {min: -1, max: 1200, palette:['#d0d1e6','#a6bddb','#74a9cf','#3690c0','#0570b0','#045a8d','#023858']}, "Low tide depth", false)
//Map.addLayer(pixels.select('depth'), {min: -1, max: 2500, palette:['#d0d1e6','#a6bddb','#74a9cf','#3690c0','#0570b0','#045a8d','#023858']}, "Depth covariate (S2/LS8/Dove)", false)

// wave data
//var kd1 = ee.Image('users/danleeharris/reefwave/fiji_v1_kd1')
//var kd2 = ee.Image('users/danleeharris/reefwave/fiji_v1_kd2')

//Map.addLayer(kd1, {}, "waves - kd1", false)
//Map.addLayer(kd2, {}, "waves - kd2", false)

var region_wcmcBound = 
    ee.Geometry.Polygon(
        [[[133.27621531509237, -3.6964607454528933],
          [134.77035594009237, -4.6606761835234165],
          [138.02230906509237, -2.8189834208112403],
          [143.29574656509237, -4.485454607626794],
          [146.81137156509237, -8.32775342522801],
          [145.58090281509237, -9.369872642992746],
          [146.72348094009237, -10.408873647930577],
          [149.36019969009237, -11.960805457501285],
          [153.31527781509237, -12.5620026138334],
          [155.77621531509237, -12.132715510948076],
          [157.79769969009237, -10.235937480088639],
          [157.88559031509237, -11.616658821605727],
          [161.04965281509237, -14.101349060999887],
          [161.40121531509237, -13.24736423000143],
          [161.40121531509237, -12.390372354418293],
          [162.36801219009237, -11.874809336893126],
          [163.77426219009237, -9.369872642992746],
          [163.33480906509237, -7.544319839235769],
          [161.04965281509237, -4.6606761835234165],
          [149.88754344009237, -0.2712922865886533],
          [148.56918406509237, -1.2379938346478028],
          [147.07504344009237, -1.2379938346478028],
          [146.10824656509237, -0.09551200607302315],
          [142.76840281509237, -0.7107281976529471],
          [142.15316844009237, -2.467795559859385],
          [135.12191844009237, 0.6954864947804655],
          [133.45199656509237, -0.44707001364412374]]]);


var wcmc=wcmc.filterBounds(region_wcmcBound)

Map.addLayer(wcmc, {color:'#ffff00'}, "WCMC layer", false)

// #############
// example confidence layers




/*
// depth and nir combos
var depth_nir_flag = fiji_dove_ocean.select('b4').multiply(fiji_high_depth_ocean).gt(250000)
//Map.addLayer(depth_nir_flag, {}, "NIR flag", false)
var conf_flag = fiji_high_depth_ocean.eq(-1)
                        .or(fiji_high_depth_ocean.gt(1000))
                        .add(depth_nir_flag.eq(1))
                        .selfMask()
Map.addLayer(conf_flag, {min:1,max:2,palette:["#f7f7f7","#bababa"]}, "Confidence flag", false)

//straight depth missing/-1
var depth_flag = fiji_high_depth_ocean.gt(0).selfMask()
//Map.addLayer(depth_flag, {min:0,max:1,palette:["#ffff00"]}, "Valid depth retrievals", false)

//Map.addLayer(fiji_geo_clean.gt(0).updateMask(fiji_high_depth_ocean.lte(0)), {min:0,max:1,palette:["#ff0000"]}, "Unmapped area via original algorithm", false)
*/


////////// UI SET UP //////////

/*
//Generate title
var title = ui.Label({
  value: 'Coral Atlas map classes',
  style: {fontWeight: 'bold', fontSize: '18px'}
})

// generate the legend
var geo_legend = pkg_vis.discrete_legend(map_palettes.geo_atlas_names, map_palettes.geo_atlas_cols, 'Geomorphic Zone', false)
var benthic_legend = pkg_vis.discrete_legend(map_palettes.benthic_atlas_names, map_palettes.benthic_atlas_cols, 'Benthic Habitat', false)
//var mask_legend = pkg_vis.discrete_legend(["Low confidence depth","Water conditions"], ["#f7f7f7","#bababa"], 'Confidence Mask reason', false)
pkg_vis.add_lgds([title, geo_legend, benthic_legend])//, mask_legend])
// generate the legend

var conf_str = {"opacity":1,"bands":["constant"],"min":0,"max":9,"palette":["4d004b","810f7c","88419d","8c6bb1","8c96c6","9ebcda","bfd3e6","e0ecf4","f7fcfd"]};
Map.addLayer(benthic_conf_clean,conf_str,'confidence_benthic',true);
Map.addLayer(geo_conf_clean,conf_str,'confidence_geo',true);


//Confidence layer panel

var legend=ui.Panel({
  style: {
    position: 'bottom-right',
    padding: "8px 15px"
  }
});

//var vis = {min: 'low', max: 'high', palette: 'ece2f0,a6bddb,1c9099'};
var vis = {min: 'low', max: 'high', palette: '4d004b,810f7c,88419d,8c6bb1,8c96c6,9ebcda,bfd3e6,e0ecf4,f7fcfd'};

function makeColorBarParams(palette) {
  return {
    bbox: [0, 0, 1, 0.1],
    dimensions: '100x10',
    format: 'png',
    min: 0,
    max: 1,
    palette: palette,
  };
}

var colorBar=ui.Thumbnail({
  image: ee.Image.pixelLonLat().select(0),
  params: makeColorBarParams(vis.palette),
  style:{stretch:'horizontal', margin: '0px 8px',maxHeight: '24px'}
})
// Create a panel with three numbers for the legend.
var legendLabels = ui.Panel({
  widgets: [
    ui.Label(vis.min, {margin: '4px 8px'}),
    ui.Label(
        (' '),
        {margin: '4px 8px', textAlign: 'center', stretch: 'horizontal'}),
    ui.Label(vis.max, {margin: '4px 8px'})
  ],
  layout: ui.Panel.Layout.flow('horizontal')
});

var legendTitle = ui.Label({
  value: 'Confidence Layer',
  style: {fontWeight: 'bold',position: 'bottom-right'}
});

legend.add(legendTitle);
legend.add(colorBar)
legend.add(legendLabels);

Map.add(legend)

*/