/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var outline1 = ee.Image("projects/coral_atlas/reefMask/maskOut/reefMask_gen3_S30_v7_gridID_a"),
    benthic = ee.Image("projects/coral_atlas/east_africa/in_out/east_africa_benthic-clean"),
    geo = ee.Image("projects/coral_atlas/east_africa/in_out/east_africa_geo-clean3-man"),
    pixels = ee.Image("projects/coral_atlas/east_africa/in_out/east_africa_pixels"),
    reef_boundary = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[40.35842048249674, -1.8731644797702776],
          [39.69924079499674, -2.3562322691693933],
          [39.07302009187174, -3.8591024804159404],
          [38.32594977937174, -5.687377519570883],
          [38.33693610749674, -6.626740872916417],
          [38.86427985749674, -6.910394253939107],
          [38.87526618562174, -8.84740435545103],
          [39.29274665437174, -10.277410334541145],
          [40.03981696687174, -10.839024630434508],
          [39.88600837312174, -11.227221359058408],
          [40.03981696687174, -11.744003015894462],
          [40.10573493562174, -14.695513440920823],
          [39.90798102937174, -15.247407444127319],
          [39.27077399812174, -15.988050851840795],
          [35.93093024812174, -17.46102684122401],
          [35.82106696687174, -18.08873569408632],
          [35.44753181062174, -18.130504110950877],
          [34.72243415437174, -19.026081590802168],
          [34.10719977937174, -19.337372528162536],
          [33.99733649812174, -20.555960741622897],
          [34.96413337312174, -22.131748332296137],
          [34.94216071687174, -23.971496248242147],
          [33.93141852937174, -24.071844423828175],
          [33.90944587312174, -24.37241725810691],
          [33.27223884187174, -24.452449924065338],
          [32.04177009187174, -25.666581578853176],
          [31.99782477937174, -26.51511469120565],
          [32.30544196687174, -26.691931633862257],
          [32.34938727937174, -27.240271455094568],
          [32.08571540437174, -27.51343549714823],
          [32.01979743562174, -28.212739468277103],
          [30.74538337312174, -29.29147703885302],
          [30.63552009187174, -29.71219644093404],
          [30.39382087312174, -30.150162070372012],
          [31.86598884187174, -30.13116022077019],
          [32.19557868562174, -29.959979115555466],
          [32.94264899812174, -28.984405375938923],
          [33.29421149812174, -27.532921375136276],
          [33.46999274812174, -26.27893485397652],
          [33.79958259187174, -25.725980597203197],
          [34.92018806062174, -25.587336841326074],
          [35.35964118562174, -25.269833891055377],
          [36.12868415437174, -24.512441091214196],
          [35.97487556062174, -21.21288678253757],
          [35.77712165437174, -20.411877445644876],
          [36.87575446687174, -19.482439395334993],
          [37.73268806062174, -18.276614943367534],
          [39.55641852937174, -17.46102684122401],
          [40.16066657624675, -17.46102684122401],
          [40.89229301322838, -17.063481554970984],
          [41.38014899812175, -16.820631397463128],
          [42.201727631345186, -17.237185269240832],
          [43.26979743562174, -17.754231901073013],
          [43.31374274812174, -19.109149974131626],
          [43.40163337312174, -20.061400554000706],
          [42.74245368562174, -21.397125981256824],
          [40.72096931062174, -21.92806454479081],
          [40.39137946687174, -21.601564213517563],
          [39.86403571687174, -20.905310629278357],
          [39.05104743562174, -21.37666637894461],
          [39.75417243562174, -22.59910156638847],
          [40.61110602937174, -22.801806874624457],
          [40.91872321687174, -22.21313962961825],
          [42.52272712312174, -21.805714016823867],
          [43.05007087312174, -24.172114147484887],
          [43.62135993562174, -25.92376286999194],
          [44.82985602937174, -26.377401833645294],
          [46.65358649812174, -26.1606641080163],
          [47.79616462312174, -25.626965782075235],
          [48.52126227937174, -23.064873411332584],
          [50.87233649812174, -15.734418142662625],
          [50.91628181062174, -15.056528365123471],
          [50.79543220124674, -13.96104281665148],
          [50.50978766999674, -12.538799018045378],
          [49.59792243562174, -11.539557027441735],
          [48.62013923249674, -11.561084720321164],
          [47.74123298249675, -12.179286850645108],
          [47.4341492448213, -12.645919915667747],
          [47.06008063874674, -12.98346860276523],
          [45.93947516999674, -14.605165818738843],
          [43.65431891999674, -15.390453211023946],
          [40.29250251374674, -17.288023478336328],
          [41.39113532624674, -15.49634974788777],
          [41.54494391999674, -10.704115286230923],
          [40.31447516999674, -8.885397016171137],
          [40.28151618562174, -6.042563586602855],
          [40.74294196687174, -3.787850297032323],
          [42.45680915437174, -1.3295556688150814],
          [40.30348884187174, -1.3734887548247627]]]),
    Rivermouth = 
    /* color: #01ffff */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[47.71868486166308, -14.481513594664204],
                  [47.66375322103808, -14.532034888954438],
                  [47.63903398275683, -14.553303561139657],
                  [47.62255449056933, -14.603808438731365],
                  [47.59646196127245, -14.655630333142572],
                  [47.55663652181933, -14.652973097867937],
                  [47.53466386556933, -14.671573067816666],
                  [47.54565019369433, -14.716737838766415],
                  [47.53191728353808, -14.822970962242374],
                  [47.4948384261162, -14.829608806088324],
                  [47.33279008627245, -15.027322752101238],
                  [47.34926957845995, -15.133402528785336],
                  [47.5827290511162, -15.071087071295722],
                  [47.62255449056933, -14.960996082130272],
                  [47.72417802572558, -14.809694664082164],
                  [47.88210649252245, -14.98620263888992],
                  [48.18972368002245, -14.991508904355882],
                  [48.20757646322558, -14.645001198729437],
                  [48.20482988119433, -14.437630501380449],
                  [47.96587724447558, -14.44428001183031]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[47.93630489628834, -14.006285950230149],
                  [47.910212366991466, -14.092879616896072],
                  [47.945917933397716, -14.14348840568382],
                  [47.95553097050709, -14.224705264621116],
                  [47.91982540410084, -14.343149617925258],
                  [47.93630489628834, -14.412324129320726],
                  [48.055781214647716, -14.413654198414925],
                  [48.15053829472584, -14.084887728450047],
                  [48.14229854863209, -14.016945398393709],
                  [47.959650843553966, -14.011615736170912]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[48.93421889381694, -12.752247402126663],
                  [48.883407126238815, -12.758944398314812],
                  [48.842208395770065, -12.728136749578667],
                  [48.76350643174089, -12.744113077781266],
                  [48.76487972275652, -12.81777264552586],
                  [48.81174725710502, -13.081290188041338],
                  [48.89963788210502, -13.110716819047466],
                  [49.019114200464394, -12.900641053562603],
                  [48.95456952273002, -12.772099920719029]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[48.73484296023002, -13.443525677220036],
                  [48.684031192651894, -13.410131797661831],
                  [48.546702091089394, -13.400780679251469],
                  [48.50962323366752, -13.406124220026228],
                  [48.5212313902568, -13.45080866773035],
                  [48.5706698668193, -13.478855078839924],
                  [48.6585604918193, -13.480190540206657],
                  [48.717612005491176, -13.460157836625266]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[49.766806341428676, -13.273105399566585],
                  [49.78740570666305, -13.282461460974925],
                  [49.9000155699443, -13.237014360143167],
                  [49.992026067991176, -13.231667084281398],
                  [50.077170110959926, -13.224982824443904],
                  [50.082663275022426, -13.147432039558907],
                  [50.0263583433818, -13.075207534927332],
                  [49.956320501584926, -13.093934441839446],
                  [49.90276215197555, -13.128709205001414],
                  [49.766806341428676, -13.245035053818956]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[43.74357314947312, -23.55466261757073],
                  [43.74168487432664, -23.55120068675082],
                  [43.73533340337937, -23.542073341203],
                  [43.68434997442429, -23.536879913536456],
                  [43.65707558584242, -23.558792211250605],
                  [43.65432900381117, -23.579089241312136],
                  [43.65759056997328, -23.591203027534654],
                  [43.66926354360609, -23.59214691196601],
                  [43.68282479238539, -23.59057376747452],
                  [43.707887353420546, -23.58412367786371],
                  [43.72642678213148, -23.58947255510733],
                  [43.73775643301039, -23.599540438385716],
                  [43.790372966940474, -23.597319842772077],
                  [43.80341923158891, -23.575294971939815],
                  [43.797582744772505, -23.55515471343786],
                  [43.78144657533891, -23.544296574699043],
                  [43.768400310690474, -23.542880229618607],
                  [43.754667400534224, -23.544296574699043],
                  [43.748659252340865, -23.547129219092316],
                  [43.74608433168657, -23.549647073986318],
                  [43.74556934755571, -23.55153543351024],
                  [43.74453937929399, -23.553581125715134]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[39.009273304067214, -17.009242418388396],
                  [39.02918602379378, -17.03747451807378],
                  [39.07313133629378, -17.059138122742855],
                  [39.13080955895003, -17.061763843495676],
                  [39.18642784508284, -17.023687280584355],
                  [39.209773792348464, -16.958676632567922],
                  [39.20359398277815, -16.909411157128883],
                  [39.2008474007469, -16.88641619170631],
                  [39.226253284535964, -16.854218533743012],
                  [39.29560448082503, -16.82201539336673],
                  [39.34847618492659, -16.802296483130192],
                  [39.46589256676253, -16.828587907642632],
                  [39.6430501414418, -16.6888637684822],
                  [39.73145315057056, -16.60294097880243],
                  [39.81994136196013, -16.53329544348717],
                  [39.89096851361232, -16.484646527877644],
                  [39.96082724095797, -16.393148958439586],
                  [40.05484387187199, -16.27423977849419],
                  [40.12389666591115, -16.138921775806697],
                  [40.091914589067095, -16.069221209583773],
                  [39.6433885477837, -16.441238127768766],
                  [39.4700124398094, -16.549714162420994],
                  [39.40821434410628, -16.589860167131334],
                  [39.341285913555645, -16.62052963312235],
                  [39.07725120934065, -16.675389248843576],
                  [39.01545311363753, -16.750360220638665],
                  [38.98936058434065, -16.83516019388607],
                  [38.98798729332503, -16.907440269963924],
                  [39.00446678551253, -16.998079716303863]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.41267977822199, -10.369510225926186],
                  [40.39345370400324, -10.374238205807174],
                  [40.35980807412043, -10.378290703145156],
                  [40.32135592568293, -10.401253862604488],
                  [40.27672396767512, -10.424215332869677],
                  [40.13664828408137, -10.49308957287559],
                  [40.04120455849543, -10.570048517693518],
                  [40.06523715126887, -10.674654718645547],
                  [40.22728549111262, -10.688824411049115],
                  [40.38534242651724, -10.634911243681051],
                  [40.5315979196813, -10.59104277624572],
                  [40.53091127417349, -10.547168027549535],
                  [40.5041320993688, -10.524215665221618],
                  [40.51237184546255, -10.49315975076307],
                  [40.50619203589224, -10.480331397400544],
                  [40.507565326907866, -10.465476850795334],
                  [40.51443178198599, -10.44859582070925],
                  [40.53640443823599, -10.451296847198801],
                  [40.56936342261099, -10.458049310652937],
                  [40.589962787845366, -10.376334665280897],
                  [40.51717836401724, -10.327025413376907],
                  [40.50069887182974, -10.335807080041093],
                  [40.46156007788443, -10.370931290063249],
                  [40.44576723120474, -10.377010080623537],
                  [40.427914448001616, -10.364176939901428]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[39.0062808026115, -8.090346753712302],
                  [39.15253629577556, -8.099184207436473],
                  [39.30634488952556, -8.101223592295035],
                  [39.39423551452556, -8.095785209717766],
                  [39.43268766296306, -8.027119330283828],
                  [39.44230070007244, -7.997201846416654],
                  [39.438867472533374, -7.988362169419953],
                  [39.45603361022869, -7.964562088329957],
                  [39.48624601257244, -7.9407606239642625],
                  [39.50890531433025, -7.922398551708424],
                  [39.54255094421306, -7.8836314898232445],
                  [39.55491056335369, -7.853023347924988],
                  [39.5665835369865, -7.78771845122165],
                  [39.55285062683025, -7.731248716211082],
                  [39.47311456428426, -7.633855362257479],
                  [39.43397577033895, -7.588936052367912],
                  [39.40994317756551, -7.565793968812877],
                  [39.38041742072957, -7.563751960601428],
                  [39.375610902174884, -7.4759364994297455],
                  [39.38591058479207, -7.45415007669127],
                  [39.38247735725301, -7.431000814922961],
                  [39.36393792854207, -7.424191976182741],
                  [39.345398499831134, -7.427596408738496],
                  [39.31930597053426, -7.437128679561575],
                  [39.3048864148702, -7.438490415643542],
                  [39.0027623914327, -7.481382935385496]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[38.91358718879052, -6.452324446080831],
                  [38.94036636359521, -6.402514389033872],
                  [38.94791946418115, -6.340415599766584],
                  [38.917020416329585, -6.227117274428391],
                  [38.92045364386865, -6.193669099220813],
                  [38.93143997199365, -6.1260836785237185],
                  [38.90397415168115, -6.079656406003751],
                  [38.881314849923335, -5.959473166488374],
                  [38.86552180636137, -5.906540665634381],
                  [38.804410553048335, -5.876148851879652],
                  [38.75016555793115, -5.8570234724951895],
                  [38.72613296515771, -5.848143609318621],
                  [38.70416030890771, -5.83994668742067],
                  [38.67326126105615, -5.831749645578546],
                  [38.66639480597802, -5.781198580439933],
                  [38.639615631173335, -5.776416488521175],
                  [38.61352310187646, -5.77095119117545],
                  [38.58056411750146, -5.766169012776189],
                  [38.466441102747886, -5.775315877750342],
                  [38.45957464766976, -5.978860612997736],
                  [38.460947938685386, -6.355012179210117],
                  [38.661448426966636, -6.47646960576254]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.9325609979023, -2.2909944203033388],
                  [40.89685543149605, -2.262178071660961],
                  [40.9105883416523, -2.200426834590775],
                  [40.837803917824175, -2.160630233362809],
                  [40.250035363136675, -2.533851319053558],
                  [40.09485347837105, -2.7506004911135835],
                  [40.082493859230425, -2.9878818306923205],
                  [40.170384484230425, -3.011195792820958],
                  [40.20471675962105, -2.998853168905174],
                  [40.236302452980425, -2.9906246755415364],
                  [40.25964840024605, -2.96319591939188],
                  [40.2843676385273, -2.950852756993189],
                  [40.329686242042925, -2.732768143361721],
                  [40.4216967400898, -2.6600643099311467],
                  [40.4986010369648, -2.649089771184487],
                  [40.564689785508705, -2.5938676134110783],
                  [40.59902206089933, -2.5861507425712866],
                  [40.61824813511808, -2.58597925601891],
                  [40.63704505589445, -2.5895411662432255],
                  [40.67961707737882, -2.550784721813428],
                  [40.69558158543546, -2.534149959425237],
                  [40.74004188206632, -2.5051672347426277],
                  [40.76176804048657, -2.4657423784739025],
                  [40.7796208236897, -2.4527081293265907],
                  [40.81326645357251, -2.4252671904552927],
                  [40.84416550142407, -2.423895128847498],
                  [40.90871017915845, -2.395767560507544],
                  [40.94853561861157, -2.360097252031308],
                  [40.9389225815022, -2.3127581001629425]]]),
            {
              "system:index": "10"
            })]),
    not_reef = 
    /* color: #09fc27 */
    /* shown: false */
    ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[38.35401789079527, -16.424735032322175],
                  [34.88233820329527, -18.228546805551858],
                  [33.82765070329527, -20.034493928429058],
                  [34.88233820329527, -21.636217850407405],
                  [38.88136164079527, -17.68508818688396]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[33.57899193865784, -24.3090450531787],
                  [32.01893334490784, -25.856247079021113],
                  [32.28260521990784, -27.02193096359606],
                  [32.833444944674454, -27.121112342100222],
                  [33.09010033709534, -27.18818625184454],
                  [33.57264563355209, -27.219313019465638],
                  [33.59272484881409, -26.7218058824699],
                  [35.13905053240784, -25.489882632259945],
                  [35.75977807147034, -24.524125614711263],
                  [35.10059838397034, -24.158772355995787]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[30.771985102720343, -30.17551393390004],
                  [31.343274165220343, -30.431614029491474],
                  [33.06812768084534, -28.8080885695647],
                  [33.51856713397034, -27.197958279069873],
                  [32.28809838397034, -27.051288066473084],
                  [30.585217524595343, -29.55624627195737]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[47.72550953333323, -25.06150046158232],
                  [49.81291187708323, -19.052546736053255],
                  [48.68132008020823, -18.699100261826707],
                  [46.49504078333323, -24.422927003569175],
                  [46.82463062708323, -24.782528311925947]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[44.019582593079306, -22.072454738622977],
                  [47.623052204211184, -15.77865888111144],
                  [47.04627797936351, -15.252382825089557],
                  [47.02430567089811, -15.20600605354598],
                  [47.13416933585809, -15.034325231368603],
                  [47.22927852825613, -14.90794326204374],
                  [47.17605476920325, -14.867811088896437],
                  [46.96016521090364, -14.958764586765245],
                  [46.918008544140726, -14.917125414575708],
                  [46.881348776761754, -14.939171841714204],
                  [46.790161750679495, -15.010449020502294],
                  [46.722910534217725, -15.084039161509306],
                  [46.67274720381737, -15.227207504742122],
                  [46.51619363625021, -15.357023173167581],
                  [46.35964020049622, -15.419252991433952],
                  [46.18523427839844, -15.428519475362728],
                  [46.082238595476035, -15.482787487020566],
                  [46.01357477128247, -15.552917797718344],
                  [45.81444986003387, -15.625669152861825],
                  [45.704587875558225, -15.638893836224344],
                  [45.49173022917167, -15.739374053065173],
                  [45.251092411493936, -15.805452361849836],
                  [44.998409951431434, -15.705004491153629],
                  [44.91464019961971, -15.71690218518185],
                  [44.70727571995741, -15.874150894911367],
                  [44.60016031791184, -15.891321908129996],
                  [44.465579426305496, -15.780344886916966],
                  [44.22662965761002, -15.73805194750035],
                  [43.81739401770325, -16.03391689222961],
                  [44.04159349364812, -16.282918001958432],
                  [44.03747376121431, -16.510831813596525],
                  [43.691406967253116, -17.00919112526558],
                  [43.88508287084567, -17.229542672427417],
                  [43.84526977660668, -17.326309905412078],
                  [43.78533490828829, -17.302989842066538],
                  [43.780347298637366, -17.237705590179278],
                  [43.80695852683128, -17.193396983884302],
                  [43.77314687675463, -17.138592789150522],
                  [43.73040091039783, -17.091626469177154],
                  [43.673943077697956, -17.0472672165729],
                  [43.596705326481455, -17.236780280599753],
                  [43.69686895009573, -17.367608232764855],
                  [43.80264468832103, -17.474793547489835],
                  [43.76009118871005, -17.532423681611434],
                  [43.659150862439745, -17.47479810166831],
                  [43.54996078251879, -17.348997608033795],
                  [43.53821557140482, -17.65129296663684],
                  [43.63647889253022, -17.953578887918944],
                  [43.879548102402175, -18.06067126335666],
                  [43.82599057718601, -18.200315797744675],
                  [43.94821183971117, -18.35809671812983],
                  [43.948211865669464, -18.412830039486504],
                  [43.98391699567337, -18.57041667171542],
                  [44.019622114801784, -18.72395607153677],
                  [44.006629243889755, -18.870902406271078],
                  [44.007953307305385, -18.966343744909743],
                  [43.99322824496872, -19.07267426641331],
                  [43.82653192562884, -19.11812344554728],
                  [43.72531455174489, -19.111042029078813],
                  [43.72831845487481, -19.612215267562732],
                  [43.66702952565739, -20.268275208262388],
                  [43.873020152860555, -20.66197234100242],
                  [43.83868850539531, -20.792979411758306],
                  [43.779637971670866, -20.83148932459001],
                  [43.77414493757712, -20.895650573436225],
                  [43.75217270536636, -20.996969435372222],
                  [43.70960147093463, -21.12768451082062],
                  [43.54206273669835, -21.140493634917718],
                  [43.393064091419255, -21.175712783030587],
                  [43.34156690611228, -21.333135045118805],
                  [43.29487466096948, -21.363192916061315],
                  [43.4370081809342, -21.626729821950697],
                  [43.480266132612066, -21.669808509119218],
                  [43.60248704040799, -21.76676811159124],
                  [43.90323272259465, -21.892972455329264]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[41.80000583235125, -1.5253743123144514],
                  [41.65306924398584, -1.6200932034486581],
                  [41.569292655715, -1.7573638638692843],
                  [41.405888785190996, -1.94334050687446],
                  [41.25068919791847, -2.134798206090043],
                  [40.85792890235107, -2.494304191647207],
                  [40.690387874144676, -2.6424696971159287],
                  [40.62722274696452, -2.6939101984709386],
                  [40.555814489110695, -2.704193470647782],
                  [40.49916261279783, -2.649664696447873],
                  [40.421913886712446, -2.660980132903187],
                  [40.33092447881516, -2.7326528858305066],
                  [40.29092087923231, -2.9166272983604737],
                  [40.268787837148814, -3.01143327286898],
                  [40.24681534508356, -3.121138335659068],
                  [40.21488936604503, -3.2907236874101105],
                  [40.0775765163316, -3.41958403829987],
                  [39.971818061809, -3.5539233296372275],
                  [39.85234252694281, -3.8759663291880364],
                  [39.72738886078212, -4.084881701483663],
                  [39.66557638655313, -4.140361311955505],
                  [39.63811076693376, -4.184190423067543],
                  [39.62437824885247, -4.295115910937345],
                  [39.592792259751704, -4.373174959927739],
                  [39.52963790191488, -4.579880410350448],
                  [39.42045482407128, -4.753030556214946],
                  [39.33873595953369, -4.898787696661642],
                  [39.30580349493109, -4.986375324614203],
                  [39.59698500924893, -5.06095194331916],
                  [39.64642355249541, -4.909415409352309],
                  [39.67387215045333, -4.757876682339201],
                  [39.70543050915504, -4.716117887721857],
                  [39.74522678985036, -4.723627094228783],
                  [39.78367593127602, -4.739366731228586],
                  [39.84410296806988, -4.79889685717824],
                  [39.89079353356151, -4.8317388342726],
                  [39.93473944668573, -4.8495282251774565],
                  [39.89903413070411, -5.109466369010597],
                  [39.8386098262443, -5.378869697247811],
                  [39.788491910858106, -5.4670497122559185],
                  [39.710894919479394, -5.506008854295166],
                  [39.58110692834306, -5.506013731212307],
                  [39.52687554948629, -5.404846612597384],
                  [39.562589213141514, -5.291351585132238],
                  [39.55846087394781, -5.202471550799351],
                  [39.5982859199933, -5.061590830033339],
                  [39.449971709834045, -5.027391890138197],
                  [39.30373584227811, -4.98908168062561],
                  [39.20690131726956, -5.124512540018456],
                  [39.163661902036694, -5.239014892163949],
                  [39.123152035491046, -5.378129968611145],
                  [39.09773746614827, -5.539112141801794],
                  [39.04995587350207, -5.691786361577075],
                  [38.98211082784129, -5.668362746209119],
                  [38.966448293672094, -5.7214610430452035],
                  [38.98454620197832, -5.782571738977489],
                  [38.89826288401263, -5.922922561485292],
                  [38.90429410897058, -6.035523199739257],
                  [38.98285004126539, -6.099990856823974],
                  [38.97021114300806, -6.137943998546022],
                  [38.99465170342856, -6.18135744656903],
                  [39.02678631534237, -6.183940511270805],
                  [39.057548381132115, -6.17833029813933],
                  [39.09901441213584, -6.09700768938633],
                  [39.074560790794635, -6.029340031933524],
                  [39.102848255492795, -5.963428064946387],
                  [39.144859601022375, -5.9630794159391245],
                  [39.16626934620994, -5.902629650944013],
                  [39.18630287247533, -5.836715271662924],
                  [39.19866250846934, -5.716490842171411],
                  [39.29341839881571, -5.676852036185853],
                  [39.3449176742075, -5.683005094318284],
                  [39.37306857657009, -5.739709509146914],
                  [39.42799971623004, -5.7711356429515055],
                  [39.4441221144682, -5.808013021443979],
                  [39.436900282745434, -5.839426008142083],
                  [39.41612801861534, -5.85513668124597],
                  [39.38574118281512, -5.879041886406424],
                  [39.44735970001012, -6.0190524268539765],
                  [39.479558152729034, -6.069932456941471],
                  [39.51763471941183, -6.08307920830603],
                  [39.55571471264758, -6.118071780622345],
                  [39.587286548154204, -6.254581075464072],
                  [39.61339244450554, -6.392456744768216],
                  [39.60240703158798, -6.419068261870955],
                  [39.58318038402151, -6.4497725382814535],
                  [39.55571487049271, -6.481157018744762],
                  [39.51726314943641, -6.5111751348799505],
                  [39.48086752320151, -6.498213131118175],
                  [39.42800013952018, -6.425209501844574],
                  [39.37066819737423, -6.379832707767457],
                  [39.35847908073538, -6.400814428943395],
                  [39.420451387648214, -6.462736886736475],
                  [39.40568873340223, -6.495145182149549],
                  [39.34423033729232, -6.500259780081213],
                  [39.28105243835239, -6.41156766646391],
                  [39.18630342723298, -6.365161544625139],
                  [39.055842118270284, -6.336499863687681],
                  [39.02288346133809, -6.322850854672482],
                  [39.02151027695621, -6.392457231248899],
                  [39.0462293046454, -6.432033073143583],
                  [39.088800906197825, -6.459324930874536],
                  [39.123132207036896, -6.471606463365595],
                  [39.16021129071896, -6.472970252623719],
                  [39.219262241244095, -6.542555991470246],
                  [39.3002855727038, -6.5875768608231535],
                  [39.337356926628495, -6.632591371879867],
                  [39.33598052848369, -6.696702278681063],
                  [39.32362117879356, -6.740344025812753],
                  [39.36344821959584, -6.76489218507269],
                  [39.4540926183351, -6.800347222711779],
                  [39.69029601501841, -6.805801553778645],
                  [39.822130466712906, -6.849434712751152],
                  [39.86607528020005, -6.857615490601472],
                  [39.92924595380982, -6.835799784816465],
                  [39.96220456186555, -6.849434730213202],
                  [39.97593730030791, -6.909423818449167],
                  [39.969070828516344, -6.958499977626258],
                  [39.93748558073808, -6.963952733749107],
                  [39.910020084387675, -6.917603545801244],
                  [39.91002009078125, -6.876703425767802],
                  [39.86332872807148, -6.873976620169105],
                  [39.797411509266446, -6.865796124142294],
                  [39.67930643606807, -6.828996410069549],
                  [39.561208127946536, -6.838526846852729],
                  [39.515885062005395, -6.83034042860939],
                  [39.558451391086386, -6.936683512819285],
                  [39.58317068019832, -6.9966656745913305],
                  [39.58318061836059, -7.051185831364843],
                  [39.58867375878125, -7.157478883212544],
                  [39.53443125887746, -7.179262720398069],
                  [39.54575643571248, -7.26236035715008],
                  [39.520000812680195, -7.327748372948878],
                  [39.492193991290144, -7.364529884356294],
                  [39.5373412034764, -7.385645969643047],
                  [39.56464156748792, -7.433996332361169],
                  [39.56841198760387, -7.497999672166198],
                  [39.610208237167605, -7.5296561632217],
                  [39.65475966655387, -7.584452461693554],
                  [39.679093848946735, -7.571177525803276],
                  [39.6848873781132, -7.542928413426598],
                  [39.718448284999766, -7.5456439641074065],
                  [39.731837457229744, -7.566743935849238],
                  [39.72600129980622, -7.602818218473724],
                  [39.755527453586375, -7.6797232857541555],
                  [39.793464291749196, -7.720381542935167],
                  [39.83620804005029, -7.686868224282472],
                  [39.8756881318245, -7.627999698830885],
                  [39.89869113603172, -7.612006941769445],
                  [39.92443934946989, -7.611665938547918],
                  [39.93765749255779, -7.627997572018954],
                  [39.93027654733783, -7.651815572445627],
                  [39.916886327556746, -7.710339582017786],
                  [39.90590225917807, -7.770209065702401],
                  [39.886674297256356, -7.830078013938816],
                  [39.86882174426261, -7.847763738658549],
                  [39.87156828841814, -7.8708900910850845],
                  [39.84684937065231, -7.911698146817325],
                  [39.83448991279261, -7.94026138304911],
                  [39.82350372893807, -7.972902648085002],
                  [39.80427790975631, -8.013700563754286],
                  [39.67107048549967, -8.152382762771829],
                  [39.63536211587848, -8.144908058927713],
                  [39.60515073560306, -8.10480395118879],
                  [39.565328481456795, -8.091205364300002],
                  [39.48155136894372, -8.114314551738014],
                  [39.45614213567183, -8.162234901816863],
                  [39.48291741830342, -8.210155220901319],
                  [39.53991157216566, -8.246519585304519],
                  [39.60961077590003, -8.223923493763323],
                  [39.65459124206401, -8.247529028180312],
                  [39.66008434347413, -8.295093581461408],
                  [39.62163274964726, -8.372543524168629],
                  [39.59073664919517, -8.435016419566493],
                  [39.59451038655858, -8.502930506152746],
                  [39.603780300092346, -8.611589285763742],
                  [39.57700459036956, -8.656391313696236],
                  [39.533744093585135, -8.668605919107902],
                  [39.52378616128309, -8.691345068322107],
                  [39.5467879093557, -8.70865400251399],
                  [39.587301095931615, -8.747343715291551],
                  [39.62575274873318, -8.942742910718927],
                  [39.65871127387339, -9.05667748546027],
                  [39.63673896635526, -9.116343122725425],
                  [39.65047168522666, -9.175998775273836],
                  [39.655964780239756, -9.23022248002076],
                  [39.666950956969174, -9.297990372251281],
                  [39.650471752192395, -9.414520395077073],
                  [39.70540255087329, -9.509341401251138],
                  [39.73836102161811, -9.566221402301966],
                  [39.74934718174229, -9.625799766782928],
                  [39.760332436611165, -9.655583355089046],
                  [39.76857304247493, -9.6934896477265],
                  [39.779559107346806, -9.736804077096028],
                  [39.793289707807325, -9.765226031256818],
                  [39.81663716288858, -9.801765329658382],
                  [39.82693733772795, -9.869410639798106],
                  [39.80530771855346, -9.911351776685365],
                  [39.81938315039484, -9.953291303190563],
                  [39.91206590816165, -9.990490273012472],
                  [39.97731014896549, -10.06553859448217],
                  [40.1338153337269, -10.136536170031178],
                  [40.18601660994162, -10.18722891020626],
                  [40.22999097388751, -10.150710700282449],
                  [40.47717900005921, -10.310180140907766],
                  [40.576054178601495, -10.369622752787924],
                  [40.5568283138536, -10.466867890326705],
                  [40.64746370722892, -10.631574767747528],
                  [40.73809893501957, -10.869027717824187],
                  [40.760071010503296, -10.98229115446813],
                  [40.73535194542473, -11.160188502591033],
                  [40.696900415515096, -11.22485147654967],
                  [40.70788647208132, -11.267952136551049],
                  [40.716125947029674, -11.343362712421225],
                  [40.70925884904982, -11.451057496959184],
                  [40.67767416489188, -11.588308800816606],
                  [40.68729664132914, -11.738819133381579],
                  [40.64196816303484, -11.88663921361047],
                  [40.67767329304803, -12.176906505126452],
                  [41.38353071146465, -12.099039291983793],
                  [41.45219378263765, -12.131263734233674],
                  [41.46592625400682, -12.187646845385427],
                  [41.45493995260744, -12.257437817975294],
                  [41.416488540544, -12.276224448559603],
                  [41.380783736188384, -12.265489243529284],
                  [41.356065104742854, -12.227912845438956],
                  [41.314867466347955, -12.131263379829223],
                  [40.68316630512874, -12.203752473893804],
                  [40.633728693949095, -12.30574218965776],
                  [40.66943338305352, -12.402327611159409],
                  [40.66256560167721, -12.569925680553528],
                  [40.66040144902197, -12.776017774355166],
                  [40.58123620725999, -13.166891897668558],
                  [40.58947561337905, -13.284533509573942],
                  [40.62518027888112, -13.359366731408924],
                  [40.61282152907651, -13.452874575531299],
                  [40.56818701364311, -13.448863343879216],
                  [40.55547840014619, -13.506955637671325],
                  [40.58826757360039, -13.509296267572521],
                  [40.62105996277108, -13.530326393519383],
                  [40.63479281410538, -13.661135727826288],
                  [40.610738337286165, -13.703730219011216],
                  [40.660501203137336, -13.894410996754575],
                  [40.65539034811398, -14.101074812588221],
                  [40.651254030754, -14.143696990174195],
                  [40.67082192457805, -14.170334993490547],
                  [40.728843331607976, -14.151693350139478],
                  [40.76901623125032, -14.163672327637945],
                  [40.80095615391535, -14.194287150567583],
                  [40.81743084689357, -14.22689215038616],
                  [40.80918758644338, -14.264821737701627],
                  [40.76936209576747, -14.355974926212896],
                  [40.77898221264178, -14.38325769473693],
                  [40.850364670680044, -14.397877114582496],
                  [40.88332527612005, -14.48098584069072],
                  [40.87785710783379, -14.582700232272256],
                  [40.87236410643336, -14.9890005861669],
                  [40.79280968177812, -15.15063850196443],
                  [40.729624015746474, -15.325538575576054],
                  [40.71306557929792, -15.489835793298102],
                  [40.57312771452353, -15.619447973721813],
                  [40.41918858923134, -15.86268794983436],
                  [40.28460832879581, -15.873254848560002],
                  [40.1691544193836, -16.064800355636283],
                  [40.19232769231944, -16.217313300957514],
                  [40.02171422623895, -16.454225974712987],
                  [39.571784108845414, -16.839167923255648],
                  [39.47488443902315, -16.87942226379154],
                  [39.35323909688143, -16.811859858997575],
                  [39.222645153692106, -16.88753861507689],
                  [39.23483857542377, -17.040717028363584],
                  [39.13129970381444, -17.136250746323107],
                  [39.01667476973501, -17.21072820953707],
                  [38.795530094008726, -17.312688226862537],
                  [38.752573103594976, -17.257155395022647],
                  [38.87392302898795, -17.183485558344405],
                  [39.00736106458034, -17.10990172997741],
                  [38.958726244624465, -16.974637137340807],
                  [38.80435174267368, -16.981140325662313],
                  [38.701715597668944, -17.000423610489996],
                  [38.64296501546901, -17.119471150521402],
                  [38.736901765128216, -17.362031159335807],
                  [38.82698487413612, -17.56908511319805],
                  [38.87557379430567, -17.68368972140751],
                  [39.06149951696081, -17.580965300977812],
                  [42.30818262563858, -15.921435925548257]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[35.68485386856369, -20.838122942036133],
                  [35.483257037323064, -21.049744952377225],
                  [35.27835972793869, -21.261066572337043],
                  [35.131990145266194, -21.395200257518248],
                  [35.11735128664969, -21.452566367505646],
                  [35.20899225126483, -21.41390136406537],
                  [35.287944842117824, -21.403043652330076],
                  [35.37998326309494, -21.422235650176543],
                  [35.43491490371994, -21.496364938210295],
                  [35.50357945450119, -21.50658670716974],
                  [35.52829869278244, -21.55513029265893],
                  [35.52280552871994, -21.65727419188275],
                  [35.53379185684494, -21.698111534990634],
                  [35.57224400528244, -22.044759711850975],
                  [35.55851109512619, -22.11093454884705],
                  [35.59970982559494, -22.39310019733248],
                  [35.57224400528244, -22.48195312671535],
                  [35.57773716934494, -22.583429540834945],
                  [35.58048375137619, -22.707636324481935],
                  [35.62442906387619, -22.755767876684402],
                  [35.64090855606369, -22.943065748164603],
                  [35.61618931778244, -22.96835645673816],
                  [35.61893589981369, -23.006283648734968],
                  [35.61893589981369, -23.049254915624857],
                  [35.53379185684494, -23.311838775026576],
                  [35.48984654434494, -23.541175258638408],
                  [35.59421666153244, -23.837961717885065],
                  [35.55576451309494, -24.003665797414598],
                  [35.44864781387619, -24.284372300346956],
                  [35.36350377090744, -24.29688944356968],
                  [35.49808629043869, -24.378533476668125],
                  [35.64082095062715, -24.457200637088224],
                  [35.7730878163176, -24.53010746625782],
                  [36.03641636856369, -24.103988856406062],
                  [35.888774800582546, -20.932411948722276]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[39.625128505929695, -21.428559386569138],
                  [39.677313564523445, -21.411939752264843],
                  [39.72537875007032, -21.420889021126765],
                  [39.79129671882032, -21.43111608550238],
                  [39.792670009835945, -21.53845695041051],
                  [39.729498623117195, -21.570388335785534],
                  [39.680060146554695, -21.565279786565693],
                  [39.63748812507032, -21.547398446818264],
                  [39.608649013742195, -21.48990779271337],
                  [39.28317904303907, -21.609973484466106],
                  [39.29691195319532, -21.905878704775787],
                  [39.92038607428907, -21.94791900656521],
                  [40.262335537179695, -21.65082421275186],
                  [40.18680453132032, -21.271236514241853],
                  [39.32437777350782, -21.248199509754883],
                  [39.257086513742195, -21.609973484466106],
                  [39.375189541085945, -21.57166544495745],
                  [39.410895107492195, -21.561448256507013],
                  [39.61276888678907, -21.47712900458712]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.30720582961698, -22.330090388273106],
                  [40.37724367141386, -22.309763974339596],
                  [40.41157594680448, -22.34152269482265],
                  [40.41706911086698, -22.38216330146559],
                  [40.39097658157011, -22.412635969249553],
                  [40.34977785110136, -22.42279204048779],
                  [40.31681886672636, -22.407557655168326],
                  [40.29621950149198, -22.359304419414624],
                  [40.27424684524198, -22.34914371176578],
                  [40.00645509719511, -22.340252484824],
                  [39.99958864211698, -22.627024721848553],
                  [40.64640871047636, -22.62322190755482],
                  [40.63679567336698, -22.057980363195927],
                  [40.02430788039823, -22.084706048538948],
                  [40.00096193313261, -22.327549748442838],
                  [40.29621950149198, -22.345333255379206]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[42.66777251650283, -16.93280914806448],
                  [42.748796686424704, -16.9367503708304],
                  [42.78038237978408, -16.931495388799526],
                  [42.811968073143454, -16.972217658647303],
                  [42.820207819237204, -17.030001841651636],
                  [42.81883452822158, -17.068077118067848],
                  [42.73918364931533, -17.117957100408805],
                  [42.67875884462783, -17.091706142610317],
                  [42.649919733299704, -17.026062577259033],
                  [42.644426569237204, -16.995858796057767],
                  [42.32170318056533, -16.96433661765999],
                  [42.320329889549704, -17.150765588771865],
                  [42.669145807518454, -17.439229242531137],
                  [43.01384185244033, -17.509964586813883],
                  [43.11821196962783, -17.504725874941062],
                  [43.08799956728408, -16.78824078748151],
                  [42.317583307518454, -16.800073256083184],
                  [42.312090143455954, -16.93543663908054],
                  [42.63481353212783, -16.984038599770173]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[42.74892327385904, -22.240132274025196],
                  [42.83956048089029, -23.013354162584903],
                  [43.13619134026529, -24.55146144595099],
                  [43.62508294182779, -25.4252583404666],
                  [44.03707024651529, -26.053665227213173],
                  [45.27577874260904, -26.51663006535293],
                  [46.31398675042154, -26.1079372695843],
                  [47.56642815667154, -25.861043810848166],
                  [47.72161004143717, -25.060065622187434],
                  [47.11804864006998, -24.8758132982377],
                  [47.15104139741196, -24.904444044296532],
                  [47.15843613649926, -24.923279957074477],
                  [47.15209813220119, -24.943361265206896],
                  [47.13648947558039, -24.950993399055463],
                  [47.121563331859825, -24.985389885707466],
                  [47.11399003333492, -25.01091404965838],
                  [47.084970875609606, -25.021342737757035],
                  [47.06831111480747, -24.985094702909112],
                  [47.01525172605297, -25.014183988576303],
                  [47.012065814700236, -25.043655489052004],
                  [46.98552605706217, -25.07934634072358],
                  [46.899041869079575, -25.10765502802316],
                  [46.809058161554354, -25.155817319103484],
                  [46.740762679157314, -25.19063558879515],
                  [46.64083001214029, -25.23037698940805],
                  [46.51587350026845, -25.21241106027286],
                  [46.45476614026316, -25.158647855346516],
                  [46.32771966057779, -25.154574271382653],
                  [46.11227365133232, -25.21861105042197],
                  [45.89650628167154, -25.31109840091175],
                  [45.71535273944302, -25.43157638952403],
                  [45.55593010979654, -25.509568014792038],
                  [45.436486767956836, -25.54188164897279],
                  [45.28951165276529, -25.556656487302703],
                  [45.16164644906158, -25.54839225519009],
                  [45.042120933765275, -25.584633689609504],
                  [44.86928460198404, -25.456261411899344],
                  [44.74156853753092, -25.360746408336315],
                  [44.55293523172912, -25.34168198978734],
                  [44.37408746150177, -25.30506117436666],
                  [44.318876152409594, -25.299398876654],
                  [44.26640984612467, -25.308615465994333],
                  [44.24958412741423, -25.33031205410924],
                  [44.28495308276741, -25.4339172079938],
                  [44.23757073479654, -25.445101225567],
                  [44.21285149651529, -25.402931189321368],
                  [44.18675896721842, -25.394247292116326],
                  [44.17849802159897, -25.337162172507004],
                  [44.14144036370279, -25.27509086594874],
                  [44.105001932154444, -25.193088455116314],
                  [44.189819931241146, -25.140265934726724],
                  [44.18046789282023, -25.09939146311581],
                  [44.136784432818274, -25.116962394487224],
                  [44.06865593987467, -25.114790060042306],
                  [43.99308497765835, -25.088298612334643],
                  [43.96974155512011, -25.00954861588864],
                  [43.94368645745279, -24.847154751241533],
                  [43.86607577562446, -24.72554177409933],
                  [43.86540886956217, -24.610156790176244],
                  [43.80632362937411, -24.54263670044127],
                  [43.69094652015882, -24.46138773690427],
                  [43.62782952385904, -24.298884101942342],
                  [43.61535213023717, -23.94503163664749],
                  [43.53444573479654, -23.648893141024143],
                  [43.567424934595515, -23.584700077065417],
                  [43.634711197572635, -23.571494586564512],
                  [43.63194939690592, -23.49407234443799],
                  [43.55498263282822, -23.337774025000165],
                  [43.54948914130766, -23.22296828120963],
                  [43.46715447503092, -23.14600834919371],
                  [43.34114924821243, -22.94546281198439],
                  [43.17739007073404, -22.546137549696667],
                  [43.11696526604654, -22.201993307371094],
                  [43.17189690667154, -21.835333960877346],
                  [42.87526604729654, -21.539283403979677]]]),
            {
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[42.92822632449832, -21.566372720235524],
                  [42.94261830567421, -21.616800090364148],
                  [43.03396973270144, -21.716997958261427],
                  [43.13971709449334, -21.81265543600355],
                  [43.173018281175, -21.836876297348038],
                  [43.193958136021756, -21.76738396493256],
                  [43.21181091922488, -21.741236470896066],
                  [43.27566895145144, -21.694669398581237],
                  [43.35257324832644, -21.646810829598106],
                  [43.38553223270144, -21.640428487342326],
                  [43.40613159793582, -21.628939560492825],
                  [43.42810425418582, -21.611066080846264],
                  [43.30588135379519, -21.38618294416309],
                  [43.31686768192019, -21.354211168291194],
                  [43.34021362918582, -21.328628723923284],
                  [43.39926514285769, -21.149426953401548],
                  [43.62134109140012, -20.99005574398356],
                  [43.70923171640012, -20.801459134047757],
                  [43.78613601327512, -20.628050121335125],
                  [43.699618679290744, -20.47502922659045],
                  [43.58563552499387, -20.22652813856482],
                  [42.84405837655637, -21.002876823574674]]]),
            {
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[44.18293630148486, -15.581632954964684],
                  [44.62238942648486, -15.727091575572066],
                  [44.87507497335986, -15.605442349373247],
                  [45.06733571554736, -15.586924170097436],
                  [45.20191823507861, -15.682142693731787],
                  [45.39967214132861, -15.671565046219843],
                  [45.50816213156298, -15.621975025570865],
                  [45.712095847383296, -15.55782080118687],
                  [45.92014943625048, -15.513496403604789],
                  [45.98744069601611, -15.457250261940608],
                  [46.01490651632861, -15.42812860990782],
                  [46.10279714132861, -15.409594521955313],
                  [46.16047536398486, -15.367224689395163],
                  [46.19892751242236, -15.359279386297727],
                  [46.25111257101611, -15.359279386297727],
                  [46.31703053976611, -15.383114387067877],
                  [46.36372243429736, -15.367224689395163],
                  [46.39118825460986, -15.35663088466885],
                  [46.45435964132861, -15.308952110920005],
                  [46.54774343039111, -15.200309955421497],
                  [46.69880544210986, -15.017346918951949],
                  [47.09568654562548, -14.799044867019836],
                  [47.172595129269624, -14.747260107724003],
                  [47.16297780539111, -14.714717288510572],
                  [47.19319020773486, -14.653609218054873],
                  [47.27284108664111, -14.61042475761458],
                  [47.35473128162085, -14.625647017524507],
                  [47.42702005419046, -14.64350150852602],
                  [47.50153117445441, -14.592142534762262],
                  [47.54083112431458, -14.52990766755016],
                  [47.54029472200849, -14.467671208046676],
                  [47.43214284445361, -14.421642644543248],
                  [47.48158132101611, -14.246676957420892],
                  [47.52278005148486, -14.169462542546187],
                  [47.60517751242236, -14.140167434280148],
                  [47.667004708793876, -14.070214798517409],
                  [47.647780917983674, -13.9695973543068],
                  [47.63813649679736, -13.772328671997595],
                  [47.70954762960986, -13.68428079831811],
                  [47.74250661398486, -13.646917186913097],
                  [47.77892277979907, -13.53811850855396],
                  [47.85511647726611, -13.454668338129526],
                  [48.00343190695361, -13.243551000196327],
                  [48.17371999289111, -13.067033886574299],
                  [48.21079885031298, -13.012849830818336],
                  [48.249940793394565, -12.966684911370516],
                  [48.31104909445361, -12.959323087594388],
                  [48.46627469403668, -12.854890385210984],
                  [48.44908760819127, -12.782248406933057],
                  [48.46384237426437, -12.737219920189816],
                  [48.49232350851611, -12.70558446565433],
                  [48.68938635803119, -12.66940109553792],
                  [48.75425388845547, -12.621823741840714],
                  [48.72572954568061, -12.555483367005206],
                  [48.580169844097135, -12.562217085802342],
                  [48.48408376242236, -12.480421903543002],
                  [48.50056325460986, -12.295320154551336],
                  [48.61591969992236, -12.182585550645486],
                  [48.68183766867236, -12.17990080784592],
                  [48.75324880148486, -12.139626410623647],
                  [49.04301320578173, -12.014737158735167],
                  [49.11305876772933, -11.984512879404422],
                  [49.15700169400599, -11.955627445088137],
                  [49.17072927023486, -11.913977772612084],
                  [49.22909395696054, -11.882408287214053],
                  [49.30256520773486, -11.892477586455833],
                  [49.39869557882861, -12.085917743530034],
                  [49.583256627349336, -12.356919014083903],
                  [49.65550099875048, -12.570242561603298],
                  [49.71281504598156, -12.668077156799582],
                  [49.770152515681794, -12.674780852390368],
                  [49.85462819601611, -12.748450074524836],
                  [49.95075856710986, -12.98943329973839],
                  [49.99470387960986, -13.117862436165334],
                  [50.01942311789111, -13.083086140170964],
                  [50.04139577414111, -13.152633813967338],
                  [50.02491628195361, -13.278304495880331],
                  [50.08534108664111, -13.401238382526955],
                  [50.12554478574851, -13.433718458409516],
                  [50.15564148741914, -13.546176724418622],
                  [50.19306366759492, -13.581553924312297],
                  [50.24353211241914, -13.608917573225963],
                  [50.18207733946992, -13.978347982429577],
                  [50.19306366759492, -13.999668976101345],
                  [50.19031708556367, -14.012993592901088],
                  [50.194436958610545, -14.028982112235783],
                  [50.199930122673045, -14.043637275728578],
                  [50.20954315978242, -14.064952203230273],
                  [50.213663032829295, -14.094256984548231],
                  [50.19031708556367, -14.154186855223545],
                  [50.18482392150117, -14.207444585506824],
                  [50.20954315978242, -14.252703805911763],
                  [50.224649360954295, -14.26068978538904],
                  [50.23700898009492, -14.296623190027946],
                  [50.23426239806367, -14.445618817159946],
                  [50.28644745665742, -14.7340131678423],
                  [50.31116669493867, -14.938449241871908],
                  [50.348245552360545, -14.954371191283206],
                  [50.38257782775117, -15.018047160584661],
                  [50.444375923454295, -14.998150455626032],
                  [50.49518769103242, -15.036615746298828],
                  [50.474588325798045, -15.106896448521153],
                  [50.485574653923045, -15.144016490501404],
                  [50.48694794493867, -15.175828490401866],
                  [50.50068085509492, -15.202334831560592],
                  [50.51441376525117, -15.261961909460055],
                  [50.53638642150117, -15.299054663379781],
                  [50.53913300353242, -15.395729852892279],
                  [50.518533638298045, -15.49236014559836],
                  [50.455362251579295, -15.633914665502875],
                  [50.372964790641795, -15.807086486087531],
                  [50.31665985900117, -15.910126198554348],
                  [50.227395942985545, -16.026312734569412],
                  [50.17658417540742, -16.05270934836106],
                  [50.084573677360545, -15.9827506862481],
                  [50.054361275016795, -15.932576575302685],
                  [50.01728241759492, -15.898239689514078],
                  [50.007669380485545, -15.86653889936193],
                  [49.991189888298045, -15.822942173564828],
                  [49.952737739860545, -15.77933604437139],
                  [49.917032173454295, -15.709282337633004],
                  [49.911539009391795, -15.677551971391475],
                  [49.88544648009492, -15.590268057096276],
                  [49.85248749571992, -15.545289119231258],
                  [49.749490669548045, -15.562488109878892],
                  [49.72065155821992, -15.574394261281327],
                  [49.72065155821992, -15.610108576267924],
                  [49.735757759391795, -15.701350209001435],
                  [49.796182564079295, -15.813693173575405],
                  [49.80854218321992, -15.908805510029028],
                  [49.782449653923045, -16.075143719359307],
                  [49.90192597228242, -16.164855861509302],
                  [49.90192597228242, -16.226839009388744],
                  [49.87446015196992, -16.35206445776064],
                  [49.908792427360545, -16.420574962744602],
                  [49.870340278923045, -16.60490611636266],
                  [49.807182117827374, -16.670684582679147],
                  [49.801675728141795, -16.75224391661135],
                  [49.83326142150117, -16.793004816267853],
                  [49.89368622618867, -16.811410097776548],
                  [49.930765083610545, -16.74435370123543],
                  [49.969217232048045, -16.69174391746736],
                  [50.015909126579295, -16.645698469611894],
                  [50.046121528923045, -16.636488051226525],
                  [50.08869355040742, -16.664117978218243],
                  [50.098306587516795, -16.720681094160728],
                  [50.04200165587617, -16.856101198888705],
                  [50.00631718085864, -16.938215254017244],
                  [49.96853058654023, -17.017032870516243],
                  [49.95136444884492, -17.043622578599514],
                  [49.92939179259492, -17.067911104626894],
                  [49.87926667052461, -17.132883768856008],
                  [49.89162628966523, -17.19455397295497],
                  [49.87926667052461, -17.232595561437826],
                  [49.87652008849336, -17.248334618123195],
                  [49.86416046935273, -17.261449473426797],
                  [49.84768097716523, -17.27587473694105],
                  [49.84630768614961, -17.285053862092642],
                  [49.83669464904023, -17.294232529662334],
                  [49.82296173888398, -17.30472187487904],
                  [49.79549591857148, -17.30865522511519],
                  [49.77901642638398, -17.303410739437428],
                  [49.76665680724336, -17.282431301589188],
                  [49.76116364318086, -17.2627609076676],
                  [49.75979035216523, -17.227348911121968],
                  [49.77626984435273, -17.117134901991957],
                  [49.80373566466523, -16.938554823161315],
                  [49.683572700798045, -16.93264301475048],
                  [49.59430878478242, -17.01933089570414],
                  [49.56615631896211, -17.117791131404513],
                  [49.540750435173045, -17.168313838958646],
                  [49.52633087950898, -17.227348911121968],
                  [49.51534455138398, -17.3283207137696],
                  [49.50710480529023, -17.379441124172434],
                  [49.52083771544648, -17.482948952147016],
                  [49.54281037169648, -17.539263935813118],
                  [49.56615631896211, -17.602106514254746],
                  [49.52289765196992, -17.80161724531652],
                  [49.49474518614961, -17.889200815310726],
                  [49.48102956874555, -17.959098377097757],
                  [49.47826569396211, -18.0740299243772],
                  [49.45869629698945, -18.127222121707895],
                  [49.46006958800508, -18.152670341789978],
                  [49.48375885802461, -18.162783349269382],
                  [49.45766632872773, -18.178441044182186],
                  [49.42196076232148, -18.204534079802613],
                  [49.433658277769034, -18.300356485394595],
                  [49.40410797911836, -18.439194989755684],
                  [49.18781464415742, -18.86337497560269],
                  [49.81049804786033, -19.05758085589371],
                  [51.19733477205914, -14.918323796822188],
                  [50.17560625643414, -12.195151300231135],
                  [49.40656328768414, -11.463952826151882],
                  [47.89868975252789, -12.106544664271041],
                  [47.77784014315289, -12.769024502379303],
                  [47.77509356112164, -12.85204918243131],
                  [47.73664141268414, -12.913630416634483],
                  [47.65699053377789, -12.902921724719864],
                  [47.62299909324189, -12.881837184887566],
                  [47.610985284754456, -12.848701942865379],
                  [47.58901237868481, -12.802166530647211],
                  [47.608238702723206, -12.756970261879848],
                  [47.65973711580914, -12.70204924108515],
                  [47.71466875643414, -12.533193492355819],
                  [47.87122393221539, -12.004476370824298],
                  [47.87946367830914, -11.655004762362601],
                  [47.47296953768414, -11.708798591733027],
                  [47.12690020174664, -12.43933682143543],
                  [47.15985918612164, -13.920815691179929],
                  [46.23700762362164, -14.899744958435415],
                  [45.18781328768414, -15.350487725448039],
                  [44.74149370760602, -15.380944360365854],
                  [44.17157793612164, -15.420663712621096]]]),
            {
              "system:index": "12"
            })]),
    slithers = /* color: #d63000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[38.59198216911038, -17.09513040205679],
                  [38.71008519645413, -17.375817499189814],
                  [38.77051000114163, -17.35484633268941],
                  [38.66781521262444, -17.098354346015707],
                  [38.71557836051663, -16.985494762759473],
                  [38.618092820371984, -16.962182007795274]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[47.22062030862082, -24.895706615296657],
                  [47.109727059109105, -24.855526943003586],
                  [47.08981433938254, -24.86051117786147],
                  [47.092217598659886, -24.878265881694755],
                  [47.10183063576926, -24.884806445405335],
                  [47.11831012795676, -24.877954417642812],
                  [47.21238056252707, -24.909719705405795]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[44.76959149149535, -17.052295280452736],
                  [45.89569012430785, -16.50533055511409],
                  [46.92291180399535, -15.719006067676062],
                  [47.26348797587035, -15.24785900444718],
                  [47.34588543680785, -14.988009742100886],
                  [47.41729656962035, -14.865930440074857],
                  [47.41180340555785, -14.786276252541288],
                  [47.12066571024535, -14.950862516001408],
                  [46.95587078837035, -14.998622051801547],
                  [46.62628094462035, -15.369718722052388],
                  [45.91216961649535, -15.650253983002624],
                  [44.58282391337035, -16.036021178372042],
                  [44.18731610087035, -16.16796275829858],
                  [44.17083660868285, -16.515863886019655],
                  [43.97857586649535, -16.915702050506706]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[35.5815811787121, -23.075698216657425],
                  [35.55308539013788, -23.131592526602564],
                  [35.580207887696474, -23.134433988470327],
                  [35.585701051758974, -23.096227078165672]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[35.608440992973556, -22.93499496583643],
                  [35.603205320976485, -22.95475491442548],
                  [35.59754049553703, -22.977040672685533],
                  [35.62234556450676, -22.981149702086398],
                  [35.610672590873946, -22.9524629083189],
                  [35.613419172905196, -22.93515305687135]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[35.51768338783552, -22.806551297758357],
                  [35.516996742327706, -22.809953430133962],
                  [35.51897084816267, -22.813671942759616],
                  [35.519228340228096, -22.819605529258975],
                  [35.51888501747419, -22.82814943959745],
                  [35.520000816424385, -22.830206226816046],
                  [35.52257573707868, -22.8333704541507],
                  [35.52231824501325, -22.83685101923884],
                  [35.52566564186384, -22.840331495290112],
                  [35.52557981117536, -22.84499835750849],
                  [35.53038632973005, -22.85132605049826],
                  [35.539484382708565, -22.851088767325223],
                  [35.54609334572126, -22.84618482237239],
                  [35.53665196998884, -22.815491603435536],
                  [35.51656758888532, -22.80330732498463]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[35.51536595924665, -22.76793510114605],
                  [35.51485097511579, -22.77379153905443],
                  [35.51467931373884, -22.77933118146107],
                  [35.51390683754255, -22.78597845546516],
                  [35.51613843544294, -22.79175499002532],
                  [35.5166534195738, -22.794207964928948],
                  [35.51639592750837, -22.797056525562407],
                  [35.51545178993513, -22.79824340825935],
                  [35.51656758888532, -22.80045889497707],
                  [35.51596677406599, -22.802753468256743],
                  [35.516739250262276, -22.80488976037531],
                  [35.53210294349958, -22.814067523235398],
                  [35.53854024513532, -22.77980599748851],
                  [35.523262382586495, -22.76437363091728],
                  [35.51562345131208, -22.765481653833042]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[35.55004224466967, -22.532883733154236],
                  [35.57716474222826, -22.55317749961616],
                  [35.58128461527514, -22.518295746106155],
                  [35.55896863627123, -22.506243638673638]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[35.525936303522485, -22.770412660275923],
                  [35.535034356501, -22.706609867388995],
                  [35.525852488063606, -22.69968932314909],
                  [35.521389292262825, -22.700481143449995],
                  [35.51658277370814, -22.702856576886724],
                  [35.51572446682337, -22.70602375737714],
                  [35.51606778957728, -22.71758334444537],
                  [35.51417951443079, -22.73658328361717],
                  [35.51349286892298, -22.759063134521416],
                  [35.516411112331184, -22.76666112087267]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[35.52534151055772, -22.70259949313247],
                  [35.52585649468858, -22.673141152189725],
                  [35.515041827940536, -22.627515753387083],
                  [35.510063648008895, -22.626248164838685],
                  [35.50989198663194, -22.63163533543867],
                  [35.511093616270614, -22.63638854590157],
                  [35.51092195489366, -22.63955726152917],
                  [35.512295245909286, -22.64462705450807],
                  [35.51366853692491, -22.64621132643788],
                  [35.513840198301864, -22.652706650262946],
                  [35.51418352105577, -22.66078577055058],
                  [35.51435518243272, -22.664587544950127],
                  [35.51572847344835, -22.672665965780283],
                  [35.516586780333114, -22.682802918730278],
                  [35.517273425840926, -22.69214725825205],
                  [35.517788409971786, -22.70244113188788]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[35.54675634387581, -22.395273012055195],
                  [35.546069698368, -22.407969571546836],
                  [35.55259283069222, -22.409080465319242],
                  [35.551219539676595, -22.395907867571776]]]),
            {
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[35.54647695665108, -22.29810467602206],
                  [35.54506075029121, -22.312914315515393],
                  [35.54566156511055, -22.315574325652225],
                  [35.548236485764846, -22.32053689563217],
                  [35.55257093553291, -22.30822939831317],
                  [35.55321466569649, -22.302472293292706],
                  [35.55141222123848, -22.2993355637987],
                  [35.54948103074776, -22.297707613135643]]]),
            {
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.494264030066574, -15.658881630380387],
                  [40.461305045691574, -15.693259116183883],
                  [40.44551219901189, -15.721682276256923],
                  [40.41598644217595, -15.729613612916078],
                  [40.38508739432439, -15.748779732999212],
                  [40.34251537284001, -15.790410244289706],
                  [40.312989616004074, -15.820141088933784],
                  [40.3045742434889, -15.865643052610448],
                  [40.28466152376234, -15.866303539559963],
                  [40.28191494173109, -15.875550129594057],
                  [40.473489038410776, -15.90394771606419],
                  [40.536660425129526, -15.680621872822144]]]),
            {
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.68576352541095, -15.19907625450391],
                  [40.6720306152547, -15.214316127961235],
                  [40.67340390627032, -15.236842617030154],
                  [40.6830169433797, -15.254729581355134],
                  [40.676837133809386, -15.273277417420168],
                  [40.657611059590636, -15.313017257541164],
                  [40.63769833986407, -15.341492835646097],
                  [40.60885922853595, -15.373274941756089],
                  [40.602679418965636, -15.389826203167633],
                  [40.594439672871886, -15.408362053589796],
                  [40.61503903810626, -15.434177091004662],
                  [40.62533872072345, -15.451385332457566],
                  [40.66928403322345, -15.459988917599182],
                  [40.76060788576251, -15.371288702015365],
                  [40.71872250978595, -15.271290227655761]]]),
            {
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.67139663941401, -14.466076705862076],
                  [40.66281357056636, -14.480371077575109],
                  [40.64805069214839, -14.498653233878622],
                  [40.63672104126948, -14.501977100290391],
                  [40.636377718515575, -14.511616030807328],
                  [40.644617464609325, -14.51361023990209],
                  [40.65526046998042, -14.52457806868583],
                  [40.651140596933544, -14.529563265624903],
                  [40.64152755982417, -14.542524251489057],
                  [40.63672104126948, -14.541527279569465],
                  [40.63612069696296, -14.546429166651969],
                  [40.63200082391609, -14.554072333325877],
                  [40.64607705682624, -14.574009782732467],
                  [40.660496612490306, -14.564373573915214],
                  [40.66736306756843, -14.552743105958658],
                  [40.66358651727546, -14.54077969949065],
                  [40.671482940615306, -14.533136072769969],
                  [40.67354287713874, -14.520839249059767],
                  [40.67045297235359, -14.508874115803781],
                  [40.66839303583015, -14.502226540101262],
                  [40.67182626336921, -14.497240727397402],
                  [40.6766327819239, -14.492587200991554],
                  [40.67937936395515, -14.478293616304818],
                  [40.67834939569343, -14.468985670746934]]]),
            {
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.60818553362327, -14.151309861597081],
                  [40.5879294911428, -14.156303368183323],
                  [40.55085063372093, -14.162295431191323],
                  [40.53128123674827, -14.17128322919827],
                  [40.54123759661155, -14.198244486450507],
                  [40.5549705067678, -14.212223134423592],
                  [40.562866930107646, -14.212223134423592],
                  [40.584839586357646, -14.205233918349567],
                  [40.60269236956077, -14.204901093152351]]]),
            {
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.59170604143577, -13.343178474997146],
                  [40.58827281389671, -13.399293159662278],
                  [40.58140635881858, -13.411316033764011],
                  [40.55531382952171, -13.424674077248879],
                  [40.53952098284202, -13.469418103063296],
                  [40.53883433733421, -13.487446913663774],
                  [40.53059459124046, -13.50347138095223],
                  [40.53677440081077, -13.513486126584683],
                  [40.53334117327171, -13.522165232533531],
                  [40.55256724749046, -13.525503266032194],
                  [40.56080699358421, -13.560883543003646],
                  [40.579346422295146, -13.56755847649678],
                  [40.58621287737327, -13.540190057540011],
                  [40.60269236956077, -13.533514355547567],
                  [40.63084483538108, -13.50213604976601],
                  [40.61917186174827, -13.357876440408017]]]),
            {
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[39.960912296163485, -3.459903703884765],
                  [39.95438916383927, -3.465044144508028],
                  [39.94889599977677, -3.4760103244543616],
                  [39.94202954469864, -3.495200832347828],
                  [39.93584973512833, -3.504795939210459],
                  [39.93275983034317, -3.51027881324921],
                  [39.926236698018954, -3.525356550751139],
                  [39.91902692018692, -3.549343356213097],
                  [39.9176536291713, -3.554825967300584],
                  [39.92280347047989, -3.5764134311702245],
                  [39.9396262854213, -3.6223279298310964],
                  [39.967435428487704, -3.6216426558556365],
                  [39.986661502706454, -3.541804712843998],
                  [39.966405460225985, -3.519873765341635],
                  [39.97910840212052, -3.470527250392384]]]),
            {
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.08778172658589, -3.354735318287983],
                  [40.01911717580464, -3.3842100331722174],
                  [40.0170572392812, -3.378726432942351],
                  [40.00504094289448, -3.3962053004090373],
                  [39.99027806447651, -3.413683851446587],
                  [39.98135167287495, -3.427049587724637],
                  [40.02289372609761, -3.475712993292231],
                  [40.12348729299214, -3.4647468098947662],
                  [40.1434000127187, -3.359190855660744],
                  [40.133786975609326, -3.3550780526534445],
                  [40.11696416066792, -3.3643318350491693],
                  [40.10769444631245, -3.3605617861467834],
                  [40.11215764211323, -3.354735318287983],
                  [40.10941106008198, -3.349937024558272]]]),
            {
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.23214993001244, -3.2121475451584915],
                  [40.21223721028588, -3.2052918549194063],
                  [40.186831326496815, -3.257051173431913],
                  [40.175158352864, -3.303323809326039],
                  [40.17653164387963, -3.3300581289064275],
                  [40.218073697102284, -3.288928107877147],
                  [40.237299771321034, -3.2299721240837367]]]),
            {
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.399963491484016, -2.6586584659001296],
                  [40.312072866484016, -2.7341058419369633],
                  [40.28048717312464, -2.858926474123673],
                  [40.29422008328089, -2.9233889929498296],
                  [40.36013805203089, -2.742336180119018],
                  [40.41781627468714, -2.6833508486614526],
                  [40.504333608671516, -2.6696329195173982],
                  [40.496093862577766, -2.6339655889830604]]]),
            {
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[40.50673686794886, -2.6356803879737982],
                  [40.4978104763473, -2.6514564276413854],
                  [40.5417557888473, -2.7145585627861406],
                  [40.59943401150355, -2.716616186047385],
                  [40.6296464138473, -2.672719466955069],
                  [40.5857011013473, -2.6569436986948114],
                  [40.58638774685511, -2.643225475445336],
                  [40.55411540798792, -2.6336226289015454],
                  [40.52390300564417, -2.6336226289015454],
                  [40.51840984158167, -2.625391558644923]]]),
            {
              "system:index": "21"
            })]),
    east_africa_lt_sr = ee.Image("projects/coral_atlas/workflow/mapping/east_africa/east_africa_low_tide_normalized_sr_jan2018_nov2019_v2_shift_mosaic/20191220T152846Z/east_africa_low_tide_normalized_sr_jan2018_nov2019_v2_shift_mosaic");
/***** End of imports. If edited, may not auto-convert in the playground. *****/
/*
Script to export maps to GCS, ready for smoothing
- note the eventual smoothed output still needs to be QC'd by UQ, 
  to ensure smoothing has not done naything untoward
 
TODO: define output params up front
  - e.g. description, export path, GCS bucket etc.
 
TODO: link this to the reef_params module
  - in that case you'd just choose the region, and the exrpot would all happen automatically
  - let's just see if this process takes off, then i'll invest time to link it up with automation
  
TODO: deal with change in dateline (i.e. WGS-84 projection wrapping)
  - Fiji/south pacific might be the only region where this happens? worth it?
  **A: resonable solution below**
*/

/*
Script to export maps to GCS, ready for smoothing
- note the eventual smoothed output still needs to be QC'd by UQ, 
  to ensure smoothing has not done naything untoward
 
TODO: define output params up front
  - e.g. description, export path, GCS bucket etc.
 
TODO: link this to the reef_params module
  - in that case you'd just choose the region, and the exrpot would all happen automatically
  - let's just see if this process takes off, then i'll invest time to link it up with automation
  
TODO: deal with change in dateline (i.e. WGS-84 projection wrapping)
  - Fiji/south pacific might be the only region where this happens? worth it?
  **A: resonable solution below**
*/

// so we can visualise maps before export
var map_palettes = require('users/mitchest/global_reefs:Modules/colour_pals')

// will need to import depth mosaic from pixels now
var depth = pixels.select('depth')//.multiply(100).uint16()

// addiitonal masking 
var add_zone = function(f) {return(f.set('zone', 1))}
var exclude_fc = not_reef.merge(Rivermouth).merge(slithers).map(add_zone)
Map.addLayer(exclude_fc, {}, "vector mask zone", false)



var exclude_mask = ee.Image().byte().paint(exclude_fc, 'zone').uint8()
Map.addLayer(exclude_mask, {}, "image extra mask zone", false)

geo = geo.where(exclude_mask.eq(1), ee.Image(0))
benthic = benthic.where(geo.eq(0), ee.Image(0)) // may not always need this (only if extra masking is applied here)

// finalise layers (include 'mapped area' as zeros)
geo = geo.where(geo.lte(2), 0)
benthic = benthic.unmask(0).updateMask(geo.gte(0))

// make reef/non-reef layer 
var reef_top = geo.eq([11,13,14,15,16,25,26]).reduce(ee.Reducer.sum())
var reef_all = geo.eq([11,12,13,14,15,16,21,22,23,24,25,26]).reduce(ee.Reducer.sum())
var reef_layer = reef_top.addBands(reef_all).reduce(ee.Reducer.sum())

// check before export
Map.addLayer(reef_layer.selfMask(), {min:0, max:2}, "reef layer", false)
Map.addLayer(geo, map_palettes.geo, "geomorphic map", false)
Map.addLayer(benthic, map_palettes.benthic, "benthic map", false)
Map.addLayer(depth, {min: -3, max: 1200, palette:['#d0d1e6','#a6bddb','#74a9cf','#3690c0','#0570b0','#045a8d','#023858']}, "depth layer", false)
Map.addLayer(east_africa_lt_sr, {"opacity":1,"bands":["b1","b2","b3"],"min":1,"max":1514,"gamma":1}, 'east_africa_lt_sr')
// combine into single stack
var export_stack = depth.updateMask(geo.gte(0)).rename('depth')
                    .addBands(reef_layer.rename('reef'))
                    .addBands(geo.rename('geomorphic'))
                    .addBands(benthic.rename('benthic'))
                    .toInt16()

Map.addLayer(export_stack, {}, "export raster stack", false)

/*// add export region
var export_geom_east = ee.Geometry.Rectangle(-179.99998,-21.4794,-168.13175,-8.4)
var export_geom_west = ee.Geometry.Rectangle(162.7051,-23.052,179.99998,-7.8)
Map.addLayer(export_geom_west, {}, "export footprint west", true)
Map.addLayer(export_geom_east, {}, "export footprint east", true)

// add raster flag for either side of dateline
var latlong = ee.Image.pixelLonLat().select('longitude').clipToCollection(ee.FeatureCollection([export_geom_west,export_geom_east]))
//Map.addLayer(latlong)

var export_stack_east = export_stack.updateMask(latlong.lte(0))
var export_stack_west = export_stack.updateMask(latlong.gt(0))

Map.addLayer(export_stack_east, {}, "export raster stack east", false)
Map.addLayer(export_stack_west, {}, "export raster stack west", false)*/

// make east/west export geometries
/*var export_geom_east = latlong.lt(0).and(latlong.gt(-179.99998)).selfMask()
                            .reduceToVectors({
                              reducer: ee.Reducer.countEvery(),
                              geometry: export_geom,
                              scale: 5,
                              maxPixels: 1e13,
                              crs: 'EPSG:4326'
                            })

var export_geom_west = latlong.gt(0).and(latlong.lt(179.99998)).selfMask()
                            .reduceToVectors({
                              reducer: ee.Reducer.countEvery(),
                              geometry: export_geom,
                              scale: 5,
                              maxPixels: 1e13,
                              crs: 'EPSG:4326'
                            })*/


// run the export
Export.image.toCloudStorage({
  image: export_stack,
  description: 'ea_stack',
  bucket: 'coral-atlas-data-pipeline',
  fileNamePrefix: 'coral-gee-export-bucket/ea/ea_stack',
  region: reef_boundary, 
  scale: 5,
  crs: 'EPSG:4326',
  maxPixels: 1e13, 
  skipEmptyTiles: true
})

/*// run the export
Export.image.toCloudStorage({
  image: export_stack_east,
  description: 'swp_stack_east',
  bucket: 'coral-atlas-data-pipeline',
  fileNamePrefix: 'coral-gee-export-bucket/swp/final/swp_stack_east',
  region: export_geom_east, 
  scale: 5,
  crs: 'EPSG:4326',
  maxPixels: 1e13, 
  skipEmptyTiles: true
})

// run the export
Export.image.toCloudStorage({
  image: export_stack_west,
  description: 'swp_stack_west',
  bucket: 'coral-atlas-data-pipeline',
  fileNamePrefix: 'coral-gee-export-bucket/swp/final/swp_stack_west',
  region: export_geom_west, 
  scale: 5,
  crs: 'EPSG:4326',
  maxPixels: 1e13, 
  skipEmptyTiles: true
})*/


// export the convex hull boundary

// export region convex hull, or manual
/*var export_geom = geo.gte(0).reduceToVectors({scale: 1000, maxPixels: 1e13, bestEffort: true, geometry: geo.geometry().bounds(100), crs: "EPSG:4326"}).geometry().convexHull({maxError: 100})

Export.table.toCloudStorage({
  collection: ee.FeatureCollection(export_geom),
  description: 'swp_convex_hull',
  bucket: 'coral-atlas-data-pipeline',
  fileNamePrefix: 'coral-gee-export-bucket/swp/new_geom/swp_convex_hull',
  fileFormat: "SHP"
})*/