/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var region_extent = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[40.71218675365253, -1.291040994031107],
          [37.81179612865253, -4.801146641926462],
          [38.33913987865253, -14.748571459539246],
          [35.61453050365253, -16.525878339693417],
          [32.88992112865253, -22.64973900024363],
          [29.81374925365253, -29.588011889291487],
          [30.51687425365253, -30.425214327483303],
          [47.65554612865253, -26.091552176113897],
          [51.17117112865253, -15.342712150231542],
          [50.73171800365253, -11.926728956169832],
          [41.75521293276336, -1.2207323500505065]]]),
    centre_map = 
    /* color: #0b4a8b */
    /* shown: false */
    ee.Geometry.Point([40.70782304461784, -15.605803665794955]),
    mid_mask = 
    /* color: #ffc82d */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                38.146583624306686,
                -17.116279021618755
              ],
              [
                36.01529824638364,
                -18.194526602487475
              ],
              [
                34.323464330106965,
                -19.804531881207932
              ],
              [
                34.96066164293281,
                -21.377933571960188
              ],
              [
                35.18107503103253,
                -21.54557370980374
              ],
              [
                35.2104858498592,
                -21.543941328212007
              ],
              [
                35.221065938860136,
                -21.49840865158103
              ],
              [
                35.25223049753175,
                -21.44009562168373
              ],
              [
                35.282336627165385,
                -21.54451086257842
              ],
              [
                35.3303389640113,
                -21.601651492322656
              ],
              [
                35.35361242158444,
                -21.599659689749267
              ],
              [
                35.49897326799129,
                -21.367700269392213
              ],
              [
                38.682029496064445,
                -17.5240996444869
              ],
              [
                38.7883447012383,
                -17.26582265600223
              ],
              [
                38.89851695781031,
                -17.210363032813436
              ],
              [
                38.91923139447483,
                -17.22655132331416
              ],
              [
                38.935768893931,
                -17.213650470872015
              ],
              [
                38.93029918351908,
                -17.18555226215949
              ],
              [
                38.959831595277514,
                -17.172818588567377
              ],
              [
                38.965665659460946,
                -17.20318322410471
              ],
              [
                39.01093214437186,
                -17.205377492071985
              ],
              [
                39.09326318104831,
                -17.161634565694115
              ],
              [
                39.04506980001317,
                -17.15812844961292
              ],
              [
                39.055789095501645,
                -17.119624483704854
              ],
              [
                39.08133667524252,
                -17.10921170418992
              ],
              [
                39.09374125150185,
                -17.117299526427548
              ],
              [
                39.08417451583,
                -17.139823043116554
              ],
              [
                39.124388476243766,
                -17.123630442100783
              ],
              [
                39.11241683262357,
                -17.092343090291084
              ],
              [
                39.11946175065519,
                -17.083348426556885
              ],
              [
                39.146417157943205,
                -17.09469781031484
              ],
              [
                39.18058127332004,
                -17.088979315101408
              ],
              [
                39.49244582429888,
                -16.877811599347723
              ],
              [
                39.54586817817518,
                -16.83974845507886
              ],
              [
                39.501785671806836,
                -16.8292866530394
              ],
              [
                39.50288346056969,
                -16.79390609894455
              ],
              [
                39.548297344442,
                -16.80066868769132
              ],
              [
                39.590965341897785,
                -16.796904377084168
              ],
              [
                39.722879813143656,
                -16.69186693008376
              ],
              [
                39.70094105090062,
                -16.642058798599603
              ],
              [
                39.756583633399586,
                -16.621833241971594
              ],
              [
                39.80225122412518,
                -16.601189253972816
              ],
              [
                39.79298217901505,
                -16.567383593389735
              ],
              [
                39.81356681491963,
                -16.5497785143412
              ],
              [
                39.83346786331641,
                -16.57059230236738
              ],
              [
                39.89234751997175,
                -16.538275781571787
              ],
              [
                39.86882415510703,
                -16.509907185025824
              ],
              [
                39.897298170418175,
                -16.491351426053026
              ],
              [
                39.91816620384508,
                -16.512925085204966
              ],
              [
                39.94864583657426,
                -16.480509175338504
              ],
              [
                39.9299529454529,
                -16.459130546953144
              ],
              [
                39.94886694121925,
                -16.432174544329712
              ],
              [
                39.972958875961346,
                -16.43489430732122
              ],
              [
                40.02386611493466,
                -16.386321221485435
              ],
              [
                40.00894782412086,
                -16.361636067591334
              ],
              [
                40.10946725703304,
                -16.22659688476758
              ],
              [
                40.163927615665806,
                -16.14615266464129
              ],
              [
                40.40390857311065,
                -16.138945955477777
              ],
              [
                40.92742029748063,
                -15.548660590703944
              ],
              [
                40.684118196168285,
                -15.38936758576148
              ],
              [
                40.665710174734635,
                -15.31396960328019
              ],
              [
                40.66852970521121,
                -15.292824322314166
              ],
              [
                40.61161516938597,
                -15.282272965200479
              ],
              [
                40.65297221565413,
                -15.173046251417517
              ],
              [
                40.69083321019734,
                -15.067365676904467
              ],
              [
                40.73306465413219,
                -14.976728684200603
              ],
              [
                40.65036548412237,
                -14.774641492392869
              ],
              [
                40.498647748666805,
                -15.102872515793576
              ],
              [
                38.50075992058814,
                -17.070443831283995
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                44.52795594125225,
                -25.65920811798292
              ],
              [
                44.32997365244227,
                -25.903962974626488
              ],
              [
                44.80810730843975,
                -26.044794340221436
              ],
              [
                45.98677108081794,
                -26.169740496227384
              ],
              [
                48.09851258187725,
                -25.59482179624664
              ],
              [
                49.74615275090008,
                -18.905453457694392
              ],
              [
                48.72991739933758,
                -18.817084005381762
              ],
              [
                48.57610880558758,
                -19.03013086305768
              ],
              [
                45.01820454982484,
                -25.09261364787551
              ],
              [
                44.61984654013705,
                -25.202278938980513
              ],
              [
                44.58497468193399,
                -25.311630229458114
              ],
              [
                44.438403503502805,
                -25.284429135296797
              ],
              [
                44.34028769493227,
                -25.27453552527616
              ],
              [
                44.329391073009056,
                -25.211871772316734
              ],
              [
                44.29925890086035,
                -25.17307618521231
              ],
              [
                44.13864485101321,
                -25.11139236305187
              ],
              [
                44.074169551361315,
                -25.163998085974967
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                48.86312988296415,
                -13.344742504384646
              ],
              [
                48.8603833009329,
                -13.129517255711656
              ],
              [
                49.03479125991728,
                -12.887330727159737
              ],
              [
                48.948814184321606,
                -12.711944251217664
              ],
              [
                48.94469431127473,
                -12.580626705638728
              ],
              [
                48.87291783120838,
                -12.587993621176217
              ],
              [
                48.820563946111214,
                -12.572910243483278
              ],
              [
                48.7489999606953,
                -12.549807275649039
              ],
              [
                48.665916235102856,
                -12.594029545044997
              ],
              [
                48.74694040502473,
                -12.884697465469772
              ],
              [
                48.70093553764233,
                -12.930874518691096
              ],
              [
                48.773032934321606,
                -12.993109654735484
              ],
              [
                48.712608129634106,
                -13.01853283748992
              ],
              [
                48.45774011222501,
                -13.231805263691955
              ],
              [
                48.47447096278842,
                -13.401226595115782
              ],
              [
                48.33103924859917,
                -13.551728638624184
              ],
              [
                48.35377282188383,
                -13.560652471020116
              ],
              [
                48.33732664766192,
                -13.68234497505631
              ],
              [
                48.110772222148256,
                -13.741852460593062
              ],
              [
                48.20624741851957,
                -13.865020991519899
              ],
              [
                48.532436198762184,
                -13.742622823694857
              ],
              [
                48.82276574081573,
                -13.527055820652885
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                47.34912800143173,
                -14.842625772588224
              ],
              [
                47.278396931692846,
                -14.898731300629487
              ],
              [
                47.133519239229514,
                -14.783877438127954
              ],
              [
                46.80865346331411,
                -15.033099685965547
              ],
              [
                46.609260595500906,
                -15.2597124369982
              ],
              [
                46.39235002094847,
                -15.412265285341098
              ],
              [
                46.213749230715365,
                -15.424251126926958
              ],
              [
                46.14233744715544,
                -15.453373648541728
              ],
              [
                45.99127408720503,
                -15.57246845165015
              ],
              [
                45.82647762221656,
                -15.61744195992263
              ],
              [
                45.67816079872125,
                -15.665050188039743
              ],
              [
                45.466671982644506,
                -15.744372537992144
              ],
              [
                45.34582122264839,
                -15.79723690329111
              ],
              [
                44.524585204416894,
                -16.000635416382444
              ],
              [
                44.41485424560481,
                -16.011256930174483
              ],
              [
                44.248622451278216,
                -15.779911625303273
              ],
              [
                44.00016469298891,
                -15.844286926466692
              ],
              [
                43.81606279871811,
                -16.17615100406568
              ],
              [
                44.02470219428571,
                -16.304026419631075
              ],
              [
                43.5224574384365,
                -17.244353069476013
              ],
              [
                43.620570750945014,
                -17.39448721816152
              ],
              [
                43.69266443747023,
                -17.401714257338586
              ],
              [
                43.70022783128711,
                -17.42954794184944
              ],
              [
                43.67843008551533,
                -17.463686505303073
              ],
              [
                43.70607210143901,
                -17.5096147667136
              ],
              [
                43.75037433098921,
                -17.471789802194813
              ],
              [
                43.78063893867077,
                -17.486834302373712
              ],
              [
                43.75727370041942,
                -17.505752871283825
              ],
              [
                43.62125616501375,
                -17.559992706667177
              ],
              [
                43.77767683076548,
                -18.034004518780108
              ],
              [
                43.86784350652856,
                -18.051144071766934
              ],
              [
                43.87574657787095,
                -18.072751072185866
              ],
              [
                43.85549339554695,
                -18.077385173182602
              ],
              [
                43.81584131148163,
                -18.066326949310483
              ],
              [
                43.81051361799776,
                -18.13881362848751
              ],
              [
                43.809444218238966,
                -18.267417029521255
              ],
              [
                43.80548274802596,
                -18.298793489753066
              ],
              [
                43.855086672587646,
                -18.310603994067453
              ],
              [
                43.86847635271245,
                -18.32312303425465
              ],
              [
                43.89440422286221,
                -18.353871659851492
              ],
              [
                43.88253673018467,
                -18.385979471177862
              ],
              [
                43.917364949515566,
                -18.403099456087183
              ],
              [
                43.92384767029952,
                -18.372829415935833
              ],
              [
                43.932004200369875,
                -18.347470165811195
              ],
              [
                43.9404212377458,
                -18.35475634640702
              ],
              [
                43.94197234655589,
                -18.368559529395846
              ],
              [
                43.93760231494031,
                -18.38439931515744
              ],
              [
                43.929065532013354,
                -18.401766862098295
              ],
              [
                43.937695095454174,
                -18.40870958741414
              ],
              [
                43.94440476050342,
                -18.4325713619275
              ],
              [
                43.94148145147296,
                -18.440387943673496
              ],
              [
                43.92585425158426,
                -18.442014174016936
              ],
              [
                43.91022886448253,
                -18.433863296010244
              ],
              [
                43.918554827722,
                -18.408287492322316
              ],
              [
                43.88667538280451,
                -18.403320623287286
              ],
              [
                43.86799449356226,
                -18.39366826697233
              ],
              [
                43.817028168369596,
                -18.389866876752357
              ],
              [
                43.66707300789419,
                -18.420070992268702
              ],
              [
                43.74864446048135,
                -18.50031667926783
              ],
              [
                43.81375144914821,
                -18.45548705698124
              ],
              [
                43.8214626876201,
                -18.505474735339728
              ],
              [
                43.93855382525342,
                -18.5585359144707
              ],
              [
                44.0058600774051,
                -18.671802996944727
              ],
              [
                44.00179670025343,
                -19.139128488035965
              ],
              [
                44.09178857775491,
                -19.59593540856484
              ],
              [
                43.84304023297544,
                -20.783435411886956
              ],
              [
                43.68373604955733,
                -21.19117486659349
              ],
              [
                43.406327491938974,
                -21.285897173108836
              ],
              [
                43.2772588279827,
                -21.379204594532013
              ],
              [
                43.16048565892914,
                -21.80379431812113
              ],
              [
                43.20015350334002,
                -21.841504327912805
              ],
              [
                43.255286113264155,
                -21.838722367847012
              ],
              [
                43.264235295692814,
                -21.750593820041548
              ],
              [
                43.29803991916069,
                -21.708666670707064
              ],
              [
                43.340065214283136,
                -21.6782137015709
              ],
              [
                43.358411569104476,
                -21.68221923379893
              ],
              [
                43.34286679633168,
                -21.711336925784295
              ],
              [
                43.35204042499339,
                -21.720039930325488
              ],
              [
                43.33265040811279,
                -21.71949695647603
              ],
              [
                43.316002150424715,
                -21.758499006733874
              ],
              [
                43.30589960272684,
                -21.867935461604425
              ],
              [
                43.29712790003432,
                -21.90892029310478
              ],
              [
                43.28722486172409,
                -21.940510559733745
              ],
              [
                43.26358251609205,
                -21.96318219819982
              ],
              [
                43.32302070819489,
                -22.009546673437253
              ],
              [
                43.45113083148996,
                -21.97436091505456
              ],
              [
                43.60957682924807,
                -21.74583599737111
              ],
              [
                44.74118409774081,
                -21.34986511675427
              ],
              [
                45.331944637537184,
                -19.780329435647857
              ],
              [
                45.23357132569339,
                -18.517086935715884
              ],
              [
                45.0315598325969,
                -17.541484033333422
              ],
              [
                45.257897899051336,
                -16.465685966438194
              ],
              [
                46.97178179414369,
                -16.01475694600863
              ],
              [
                47.42222478677802,
                -15.459591425763604
              ],
              [
                48.32860330744852,
                -14.477843212705507
              ],
              [
                48.259937201660314,
                -14.019962115670285
              ],
              [
                48.078660905956255,
                -13.846686132916851
              ],
              [
                47.847946182997255,
                -13.905348457995846
              ],
              [
                47.78752091555193,
                -13.932008157030669
              ],
              [
                47.809493952922786,
                -14.041280245974097
              ],
              [
                47.93034474170655,
                -14.12120227361633
              ],
              [
                47.97978373320379,
                -14.16914208090838
              ],
              [
                47.91661203047326,
                -14.291609190820434
              ],
              [
                47.76280243415961,
                -14.480503614462382
              ],
              [
                47.64744518282076,
                -14.548971554447958
              ],
              [
                47.554060765758976,
                -14.727685336986381
              ],
              [
                47.53483468752267,
                -14.83125900889477
              ],
              [
                47.43046367342592,
                -14.860463298295214
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                39.11172050123115,
                -5.379965586203539
              ],
              [
                38.9661516535749,
                -5.351252840319174
              ],
              [
                38.73269218091865,
                -5.828250953675843
              ],
              [
                38.7848772395124,
                -6.55184672439766
              ],
              [
                39.02932304029365,
                -6.858723295100471
              ],
              [
                39.3122209895124,
                -6.9118953859501735
              ],
              [
                39.32509795470146,
                -6.847467206412087
              ],
              [
                39.32694338673173,
                -6.83084876067146
              ],
              [
                39.32604219654342,
                -6.806730799317759
              ],
              [
                39.32973267292894,
                -6.775539614221818
              ],
              [
                39.341746746348335,
                -6.768044397526881
              ],
              [
                39.329730449961616,
                -6.723721432152951
              ],
              [
                39.309387752178694,
                -6.695506775018538
              ],
              [
                39.2784025750748,
                -6.716391422391574
              ],
              [
                39.25488608961005,
                -6.69473884432461
              ],
              [
                39.26072177153486,
                -6.676665827776019
              ],
              [
                39.23960733390647,
                -6.662514252414987
              ],
              [
                39.23977988843818,
                -6.630630077405584
              ],
              [
                39.20890627605079,
                -6.567561449810071
              ],
              [
                39.165292774840516,
                -6.492518712997371
              ],
              [
                39.10831270915626,
                -6.388467899850422
              ],
              [
                39.05398115813758,
                -6.334729518747206
              ],
              [
                39.04140779570761,
                -6.325601113837037
              ],
              [
                38.999306200358205,
                -6.381303420263264
              ],
              [
                38.968580348316415,
                -6.370384466415548
              ],
              [
                38.97707810727284,
                -6.357587390663562
              ],
              [
                39.00432930286814,
                -6.367566986168324
              ],
              [
                39.04233031420924,
                -6.319326283826232
              ],
              [
                39.00102416518068,
                -6.297700262432165
              ],
              [
                38.97063871922462,
                -6.282344534026464
              ],
              [
                38.9184552262461,
                -6.2386633715343445
              ],
              [
                38.918111294486266,
                -6.227399043050184
              ],
              [
                38.93047152263282,
                -6.21374864314068
              ],
              [
                38.93167483157779,
                -6.19616937313718
              ],
              [
                38.946607692066415,
                -6.093595396016328
              ],
              [
                38.94574724157919,
                -5.942330993496216
              ],
              [
                38.8985391498691,
                -5.898623309877234
              ],
              [
                38.86833010417579,
                -5.887702456652248
              ],
              [
                38.87176411985748,
                -5.879421133288005
              ],
              [
                38.88515430245835,
                -5.877969941619143
              ],
              [
                38.919486631116214,
                -5.9120352447389575
              ],
              [
                38.943862287758805,
                -5.901404771996007
              ],
              [
                38.934591395679696,
                -5.844328784880702
              ],
              [
                39.015272242847665,
                -5.690274029042947
              ],
              [
                38.99707846131772,
                -5.647738750960286
              ],
              [
                39.00257199704328,
                -5.625701644571879
              ],
              [
                39.035528285328134,
                -5.596659556636347
              ],
              [
                39.03278376408894,
                -5.563512631302756
              ],
              [
                39.031411723662664,
                -5.54539995739286
              ],
              [
                39.04514545145915,
                -5.507124067454517
              ],
              [
                39.08977328044532,
                -5.434678097360333
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                39.37628876328705,
                -4.632201251287552
              ],
              [
                39.42572723984955,
                -4.644520392157763
              ],
              [
                39.528724066021425,
                -4.5870292362571
              ],
              [
                39.413367620708925,
                -4.526795442750587
              ],
              [
                39.3570626890683,
                -4.577446925381212
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                35.21829261310793,
                -23.802023317368064
              ],
              [
                35.17984046467043,
                -24.030502042852024
              ],
              [
                35.35012855060793,
                -24.18092570789036
              ],
              [
                35.49844398029543,
                -23.89748114095655
              ],
              [
                35.41879310138918,
                -23.761809534844264
              ],
              [
                35.41055335529543,
                -23.65367344782627
              ],
              [
                35.30618323810793,
                -23.64109367193439
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                34.76725609879452,
                -24.507815869273216
              ],
              [
                34.645033198403894,
                -24.596503566703444
              ],
              [
                34.53105004410702,
                -24.782418446713702
              ],
              [
                34.61344750504452,
                -25.05019431727061
              ],
              [
                34.78922875504452,
                -25.042729397498825
              ],
              [
                35.570631342935144,
                -24.41406366490508
              ],
              [
                35.32206566910702,
                -24.25765523438848
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                33.59985460173083,
                -25.03673362449871
              ],
              [
                32.82986393188867,
                -25.346317221707565
              ],
              [
                32.279083264091575,
                -26.100316662753535
              ],
              [
                32.515289318779075,
                -26.568008750380393
              ],
              [
                32.880751676029476,
                -26.64438773237778
              ],
              [
                32.91929650705914,
                -26.525847207461585
              ],
              [
                32.90261229517576,
                -26.34785458500571
              ],
              [
                32.916290295341575,
                -26.314704898854757
              ],
              [
                32.941802480639275,
                -26.170065198392646
              ],
              [
                32.94604772199349,
                -26.092254120934246
              ],
              [
                32.95463079084114,
                -26.085933108999317
              ],
              [
                32.91446202863411,
                -26.068355818072128
              ],
              [
                32.88699620832161,
                -26.05709879863674
              ],
              [
                32.890944419991534,
                -26.021778666424684
              ],
              [
                32.900214134347,
                -26.00635169189883
              ],
              [
                32.89781087506966,
                -25.98197294156479
              ],
              [
                32.8943776475306,
                -25.968701369914786
              ],
              [
                32.896437584054034,
                -25.964380069935316
              ],
              [
                33.00492757428841,
                -25.96191068440029
              ],
              [
                33.847236731683374,
                -25.361002890463652
              ],
              [
                34.6108885999202,
                -25.053210651169756
              ],
              [
                34.55080711798661,
                -24.87143992847103
              ],
              [
                34.54668724493973,
                -24.83904167472373
              ],
              [
                34.5394774671077,
                -24.82969444792924
              ],
              [
                34.54119408087723,
                -24.83904167472373
              ],
              [
                34.54256737189286,
                -24.844338123283805
              ],
              [
                34.53501427130692,
                -24.849945880567358
              ],
              [
                34.51578819708817,
                -24.860849125410393
              ],
              [
                34.474246143865514,
                -24.874554697862777
              ],
              [
                34.45570671515458,
                -24.877046456852092
              ],
              [
                34.435793995428014,
                -24.883898534972232
              ],
              [
                34.36879872386138,
                -24.9094347498325
              ],
              [
                34.35678242747466,
                -24.916285030558864
              ],
              [
                34.34682606761138,
                -24.92282357999765
              ],
              [
                34.321763506576225,
                -24.933720391906093
              ],
              [
                34.28914784495513,
                -24.94274844912002
              ],
              [
                34.26099537913482,
                -24.944304943849012
              ],
              [
                34.111731084052785,
                -24.9995110060908
              ],
              [
                33.986031514141445,
                -25.042132161808446
              ],
              [
                33.92098192534735,
                -25.057696345843915
              ],
              [
                33.855912190410976,
                -25.08007430380207
              ],
              [
                33.81781435017022,
                -25.092265623922035
              ],
              [
                33.779366049109775,
                -25.106001711780713
              ],
              [
                33.70106991917701,
                -25.1359303304133
              ],
              [
                33.669484225817634,
                -25.083081037814342
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                30.75910472131185,
                -30.091993548721344
              ],
              [
                32.62128733849935,
                -30.106250931347127
              ],
              [
                32.9975690767806,
                -28.378436853997446
              ],
              [
                32.438980391144746,
                -28.201928963100343
              ],
              [
                31.87971019006185,
                -28.3421828851955
              ],
              [
                30.86896800256185,
                -29.486552505574004
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                32.746298100020006,
                -27.064125707039288
              ],
              [
                32.95366504337938,
                -27.08735864081675
              ],
              [
                33.004476810957506,
                -26.90625915081869
              ],
              [
                32.74217822697313,
                -26.886663376444226
              ],
              [
                32.71745898869188,
                -27.01152813667206
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                40.51710520586902,
                -12.87457981397654
              ],
              [
                40.51161204180652,
                -12.826379585773378
              ],
              [
                40.43196116290027,
                -12.846464138212495
              ],
              [
                40.36604319415027,
                -12.92678627025921
              ],
              [
                40.4827729304784,
                -13.115441317172634
              ],
              [
                40.54731760821277,
                -13.021800738992807
              ],
              [
                40.50749216875965,
                -12.966937656936645
              ],
              [
                40.50611887774402,
                -12.91072390598611
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                40.60923830519742,
                -13.394791407520827
              ],
              [
                40.55567995558805,
                -13.432194629641895
              ],
              [
                40.54195046354847,
                -13.472596718311037
              ],
              [
                40.5034948969943,
                -13.496968548493278
              ],
              [
                40.500401041838394,
                -13.558388477570446
              ],
              [
                40.54743747584739,
                -13.57507598632937
              ],
              [
                40.59962526808805,
                -13.539028799629305
              ],
              [
                40.7726599360568,
                -13.504312936584325
              ],
              [
                40.77403322707242,
                -13.377423648066967
              ],
              [
                40.67515627394742,
                -13.389447614985432
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                40.508995774736576,
                -10.338641607701497
              ],
              [
                40.432091477861576,
                -10.376467175044526
              ],
              [
                40.311241868486576,
                -10.385922853125624
              ],
              [
                40.206871751299076,
                -10.47101105601486
              ],
              [
                40.33184123372095,
                -10.631669370130407
              ],
              [
                40.4993827376272,
                -10.535824501907031
              ],
              [
                40.50762248372095,
                -10.462908420685476
              ],
              [
                40.60100627278345,
                -10.41969079555411
              ],
              [
                40.54607463215845,
                -10.321078187464217
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                39.70595799869885,
                -9.8984966095286
              ],
              [
                39.66201268619885,
                -9.890379421330515
              ],
              [
                39.54116307682385,
                -10.036457978055585
              ],
              [
                39.65925946319523,
                -10.134494530218289
              ],
              [
                39.72243749088635,
                -10.08378415994503
              ],
              [
                39.817194570964475,
                -10.054037083602871
              ],
              [
                39.802081384065765,
                -9.982356750836068
              ],
              [
                39.762262930339475,
                -9.909319214950383
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                39.5054575104176,
                -9.421954119993693
              ],
              [
                39.528803457683225,
                -9.49510364106481
              ],
              [
                39.633173574870725,
                -9.455821572989812
              ],
              [
                39.6153207916676,
                -9.393502891504635
              ],
              [
                39.517817129558225,
                -9.342013779234497
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                39.67181150350218,
                -4.136494234987167
              ],
              [
                39.650868815513896,
                -4.151218519713961
              ],
              [
                39.63335935506468,
                -4.186144792637216
              ],
              [
                39.74596921834593,
                -4.265579119673206
              ],
              [
                39.88913480672483,
                -4.277562037340849
              ],
              [
                39.89668790731077,
                -4.221754290008491
              ],
              [
                39.89394132527952,
                -4.098483772220108
              ],
              [
                39.73000357462293,
                -4.072120627248906
              ],
              [
                39.7119793927059,
                -4.075030183515339
              ],
              [
                39.707173194135926,
                -4.07143300746291
              ],
              [
                39.69996396932249,
                -4.073484914331559
              ],
              [
                39.6776998902941,
                -4.061772915104739
              ],
              [
                39.75728208193787,
                -3.961322515542387
              ],
              [
                39.764797526805346,
                -3.9611004283169597
              ],
              [
                39.77715220524572,
                -3.9755005159067696
              ],
              [
                39.79568713625713,
                -3.9847628580380516
              ],
              [
                39.78624075044771,
                -3.9640568588699407
              ],
              [
                39.763062042633535,
                -3.954995545290466
              ],
              [
                39.7709395275324,
                -3.942725546916296
              ],
              [
                39.64720207382282,
                -3.9058783077389165
              ],
              [
                39.55325929812857,
                -3.9797092490195323
              ],
              [
                39.5156076661436,
                -4.11038597153565
              ],
              [
                39.65649142915445,
                -4.098598201040752
              ],
              [
                39.67258565013541,
                -4.0838074162844595
              ],
              [
                39.68310014807497,
                -4.080746306806215
              ],
              [
                39.688636590310594,
                -4.091896891993459
              ],
              [
                39.691211647733766,
                -4.098531153885482
              ],
              [
                39.69378675409224,
                -4.104309262622474
              ],
              [
                39.67593137654905,
                -4.129645637159914
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                49.54910515847311,
                -12.568211886751513
              ],
              [
                49.56627129616842,
                -12.540732552518685
              ],
              [
                49.575197687769986,
                -12.500178425395603
              ],
              [
                49.55768822732077,
                -12.446878617685625
              ],
              [
                49.55459832253561,
                -12.433468136038188
              ],
              [
                49.55116509499655,
                -12.41268052203078
              ],
              [
                49.533998957301236,
                -12.3928972187235
              ],
              [
                49.50069665017233,
                -12.397591697800145
              ],
              [
                49.45606469216452,
                -12.419051096410199
              ],
              [
                49.52266930642233,
                -12.559164137410978
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                49.624234362972665,
                -12.79495360056952
              ],
              [
                49.56861607683985,
                -12.886002092657426
              ],
              [
                49.6702396119961,
                -12.907420466695092
              ],
              [
                49.70251195086329,
                -12.776204235297024
              ],
              [
                49.6537601198086,
                -12.772855987886604
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                39.428826336737664,
                -8.013760410223878
              ],
              [
                39.47414494025329,
                -8.006960951933783
              ],
              [
                39.51809025275329,
                -7.8763894521724644
              ],
              [
                39.55654240119079,
                -7.790679485631642
              ],
              [
                39.53182316290954,
                -7.702230179854176
              ],
              [
                39.49611759650329,
                -7.612401217719566
              ],
              [
                39.48787785040954,
                -7.562034307781668
              ],
              [
                39.478264813300164,
                -7.527999281678005
              ],
              [
                39.49474634278076,
                -7.489876319530582
              ],
              [
                39.54006290900329,
                -7.425878218834522
              ],
              [
                39.593621258612664,
                -7.337354092290547
              ],
              [
                39.59774113165954,
                -7.273333353768407
              ],
              [
                39.60934267624703,
                -7.1917070886506504
              ],
              [
                39.64298762088102,
                -7.076562249928061
              ],
              [
                39.59559598132501,
                -6.870724423937425
              ],
              [
                39.481277063465825,
                -6.805961565053253
              ],
              [
                39.44273972781424,
                -6.820448731702683
              ],
              [
                39.49346688570419,
                -6.851298551925418
              ],
              [
                39.511152368629844,
                -6.885727139687484
              ],
              [
                39.52248107666447,
                -6.926968004614906
              ],
              [
                39.54273802988918,
                -6.962071302433533
              ],
              [
                39.55990419968453,
                -7.003646468014881
              ],
              [
                39.51458559616891,
                -7.00637135214731
              ],
              [
                39.45416079148141,
                -7.0540751691375085
              ],
              [
                39.32644472702828,
                -7.090871900479062
              ],
              [
                39.10002837500218,
                -7.805498877406778
              ],
              [
                39.20439849218968,
                -7.971454890154178
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                40.120227890356716,
                -3.218722451321902
              ],
              [
                40.13876713186855,
                -3.2188938690682227
              ],
              [
                40.163829772764196,
                -3.23269066839628
              ],
              [
                40.16417330751343,
                -3.2509434750313817
              ],
              [
                40.16485994659874,
                -3.2704812436966253
              ],
              [
                40.155246871919616,
                -3.2965310053358587
              ],
              [
                40.129154261308386,
                -3.317096117148495
              ],
              [
                40.10992812598669,
                -3.3335478993208065
              ],
              [
                40.09688148570984,
                -3.361651965878104
              ],
              [
                40.1305275207205,
                -3.395239665598043
              ],
              [
                40.44775863458724,
                -3.459669174558237
              ],
              [
                40.93596485861164,
                -2.805590058897794
              ],
              [
                41.708310199219504,
                -1.855819345914573
              ],
              [
                41.85779695298003,
                -1.632210867526935
              ],
              [
                41.6861352742572,
                -1.552590807587116
              ],
              [
                41.63257687726886,
                -1.5800464454078729
              ],
              [
                41.56116574019792,
                -1.7008467237016656
              ],
              [
                41.4993676137803,
                -1.783206260302227
              ],
              [
                41.458169989171836,
                -1.8305613063029804
              ],
              [
                41.410103621653406,
                -1.8751700616998226
              ],
              [
                41.35929180529468,
                -1.92869901927641
              ],
              [
                41.29200047559838,
                -2.0028132462666925
              ],
              [
                41.2501150502248,
                -2.0515346809890556
              ],
              [
                41.234322704618634,
                -2.0494766424034143
              ],
              [
                41.253548836776176,
                -2.032834623272642
              ],
              [
                41.287194158488525,
                -1.99534908646306
              ],
              [
                41.32152529245878,
                -1.950657751374781
              ],
              [
                41.1656584651217,
                -1.8566410520535483
              ],
              [
                41.058586730201775,
                -1.962319444303428
              ],
              [
                41.0854063158401,
                -2.0474095316466827
              ],
              [
                41.15621547651878,
                -2.102992368401074
              ],
              [
                41.18316598552798,
                -2.100249451146213
              ],
              [
                41.20204971846192,
                -2.121526185223239
              ],
              [
                41.1835103656071,
                -2.1469145277889092
              ],
              [
                41.15741779898667,
                -2.1702439617759106
              ],
              [
                41.139564985546826,
                -2.1757331928229275
              ],
              [
                41.12308546182347,
                -2.17161628310321
              ],
              [
                41.11347240980534,
                -2.1784778072459323
              ],
              [
                41.0860065404238,
                -2.1812224165824823
              ],
              [
                41.0722736093777,
                -2.1935730569627214
              ],
              [
                41.066780439793014,
                -2.207295867863355
              ],
              [
                41.068153739281165,
                -2.225135329926637
              ],
              [
                41.072273625530876,
                -2.2416023334428563
              ],
              [
                41.05991398859408,
                -2.2580691573988103
              ],
              [
                41.045837698008626,
                -2.2254784307109783
              ],
              [
                41.01665522734634,
                -2.2182740580594063
              ],
              [
                40.99605581804345,
                -2.1928869363685686
              ],
              [
                40.99004792451743,
                -2.149909368810136
              ],
              [
                41.047598386123774,
                -2.13333390274908
              ],
              [
                41.13844950528431,
                -2.1215603497779068
              ],
              [
                41.079091922898826,
                -2.0524920454038362
              ],
              [
                41.027982249598296,
                -1.8791170398962742
              ],
              [
                40.73908191451159,
                -1.928784528442916
              ],
              [
                40.86215937989257,
                -2.0827573548630323
              ],
              [
                40.91846484923656,
                -2.2203324771913358
              ],
              [
                40.969276613530575,
                -2.2704191761283217
              ],
              [
                40.97339650100855,
                -2.2964910349602867
              ],
              [
                40.96378345049359,
                -2.317073749224986
              ],
              [
                40.94490067059855,
                -2.3242776472033486
              ],
              [
                40.93082437679026,
                -2.3194750627200102
              ],
              [
                40.95605852805141,
                -2.29580343716451
              ],
              [
                40.914001346556226,
                -2.2402282948865744
              ],
              [
                40.88619360345317,
                -2.165441331434814
              ],
              [
                40.71693720127284,
                -2.2090072636212104
              ],
              [
                40.65702227181288,
                -2.3364514420731157
              ],
              [
                40.71796388559533,
                -2.3966574346695553
              ],
              [
                40.767402463793935,
                -2.4282151944580477
              ],
              [
                40.784568637883666,
                -2.444336809959323
              ],
              [
                40.809974572121845,
                -2.4316453376711658
              ],
              [
                40.83057398029954,
                -2.4395346410704417
              ],
              [
                40.82082993539183,
                -2.4546328093214265
              ],
              [
                40.80421916389526,
                -2.4656147443976772
              ],
              [
                40.77168303250355,
                -2.488950282750029
              ],
              [
                40.7614018250371,
                -2.489810473398067
              ],
              [
                40.754553911435174,
                -2.4796946060483704
              ],
              [
                40.759722442958314,
                -2.4646051604140298
              ],
              [
                40.7609334293659,
                -2.4484852316575205
              ],
              [
                40.74360504949655,
                -2.448143669933316
              ],
              [
                40.6334361999458,
                -2.514345446027057
              ],
              [
                40.61722077875342,
                -2.554560761340834
              ],
              [
                40.61542443693353,
                -2.582428647582332
              ],
              [
                40.63495338337254,
                -2.5835016979721455
              ],
              [
                40.64986773669525,
                -2.5843810856823235
              ],
              [
                40.65448246849095,
                -2.5914339149127232
              ],
              [
                40.65249816497548,
                -2.600362354632328
              ],
              [
                40.64158738563087,
                -2.607918884189611
              ],
              [
                40.621825455547324,
                -2.6216599031959014
              ],
              [
                40.60463799612171,
                -2.6328284945801212
              ],
              [
                40.581270475569525,
                -2.637137540707365
              ],
              [
                40.54736469826143,
                -2.627898275559587
              ],
              [
                40.54686945069704,
                -2.6164102422609217
              ],
              [
                40.562414627763026,
                -2.5962617317179295
              ],
              [
                40.589412984626854,
                -2.5813859871721756
              ],
              [
                40.588492298264505,
                -2.5471958170972675
              ],
              [
                40.57109250468905,
                -2.5274108499559995
              ],
              [
                40.452505796644566,
                -2.4661761462275904
              ],
              [
                40.115792422230356,
                -2.694830064166878
              ],
              [
                40.08650972515097,
                -3.048240023441224
              ],
              [
                40.21882067247744,
                -2.9955672219855662
              ],
              [
                40.23330385868346,
                -2.9819135804225243
              ],
              [
                40.2395472544062,
                -2.9816313094011826
              ],
              [
                40.24152163227277,
                -2.995269452264731
              ],
              [
                40.22929092527243,
                -3.017688932348801
              ],
              [
                40.22145767392199,
                -3.0230708336489203
              ],
              [
                40.219165684167756,
                -3.019164351073041
              ],
              [
                40.219736349445434,
                -3.012754110845883
              ],
              [
                40.21212525871375,
                -3.0035490888998657
              ],
              [
                40.20039432456603,
                -3.009086588132608
              ],
              [
                40.18951920956483,
                -3.026436516136957
              ],
              [
                40.20536769020764,
                -3.0275689791981186
              ],
              [
                40.20882879593679,
                -3.0380776195872174
              ],
              [
                40.20611008367748,
                -3.0472148926338907
              ],
              [
                40.19912758815593,
                -3.0515186640903265
              ],
              [
                40.19632294872882,
                -3.0430425208856304
              ],
              [
                40.18959917148313,
                -3.0386329404675188
              ],
              [
                40.18834738625481,
                -3.033159313634662
              ],
              [
                40.18297574472282,
                -3.033171138290736
              ],
              [
                40.16879913116805,
                -3.044851297645801
              ],
              [
                40.163876277423796,
                -3.0638967926338796
              ],
              [
                40.17892441018092,
                -3.0651916187028845
              ],
              [
                40.18610521875231,
                -3.0675531482454574
              ],
              [
                40.18504630398179,
                -3.08225657122071
              ],
              [
                40.17794728719794,
                -3.08606428189488
              ],
              [
                40.16392633996198,
                -3.0792261665920395
              ],
              [
                40.1574585457876,
                -3.0806157866602066
              ],
              [
                40.15463788917242,
                -3.09670393595642
              ],
              [
                40.16490029548466,
                -3.099606161933571
              ],
              [
                40.167628539684664,
                -3.122312170524985
              ],
              [
                40.17345565620024,
                -3.138122250351772
              ],
              [
                40.165382787413094,
                -3.1470561122405076
              ],
              [
                40.15997274545847,
                -3.150494694629312
              ],
              [
                40.152117710178466,
                -3.1484431339553662
              ],
              [
                40.11660424712359,
                -3.1902670462968405
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                40.5819000439199,
                -13.614173464266743
              ],
              [
                40.552374287083964,
                -13.622181561024329
              ],
              [
                40.54550783200584,
                -13.634860492795294
              ],
              [
                40.54276124997459,
                -13.64887325717156
              ],
              [
                40.549627705052714,
                -13.680232141869217
              ],
              [
                40.55374757809959,
                -13.686903706374448
              ],
              [
                40.5599273876699,
                -13.690906554276545
              ],
              [
                40.56954042477928,
                -13.689572279210859
              ],
              [
                40.58052675290428,
                -13.67022444058459
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                39.369758684694865,
                -8.07366693754639
              ],
              [
                39.392761309206584,
                -8.104258563658227
              ],
              [
                39.41164406067143,
                -8.128390316974816
              ],
              [
                39.4373932672144,
                -8.126011194461332
              ],
              [
                39.4538727594019,
                -8.0631292849362
              ],
              [
                39.4428864312769,
                -8.058030322180983
              ],
              [
                39.37490852600346,
                -8.04987184816252
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    mask1 = ee.FeatureCollection("projects/coral_atlas/east_africa/east_africa_mask"),
    mask2 = ee.FeatureCollection("projects/coral_atlas/east_africa/east_africa_mask_final");
/***** End of imports. If edited, may not auto-convert in the playground. *****/
// Viewing script for looking at reefs and classifications for each region. 
// From this region Timor Sea onwards the map_viewer script is going to be used from the very beginning 
// in the workflow 

//Viewer for west East Africa & Madagascar 

// Load and libraries needed
var map_palettes = require('users/mitchest/global_reefs_modules:colour_pals');
var param_module = require('users/mitchest/global_reefs_modules:reef_params');
var pkg_vis = require('users/mitchest/global_reefs_modules:pkg_vis');

// ###########################################
// SENSOR GENERICS
var sensor_params = param_module.dove ;      //<------------ THIS IS WHERE YOU CHOOSE THE SENSOR
// REGION AND SENSOR SPECIFIC LOAD PATHS
var region_params = param_module.east_africa;       //<------------ THIS IS WHERE YOU CHOOSE THE REGION
//  ^^ all the data paths are in this module ^^
// ###########################################



// Choose which layers will be shown in the map viewer
var vars = {
  raw: true, // set to true if you want to view the raw classifications for benthic and geo
  geo_cleanup_stage: 3, // set to 0, 1, 2 or 3 - this controls the display of the geo clean stages (0 = cleanup not ready)
  benthic_cleanup_stage: 2, // set to 0, 1 or 2 - this controls the display of the benthic clean stages (0 = cleanup not ready)
};

// choose where to centre the map (link this dynamically to map app?)
Map.centerObject(centre_map, 10);

// Add low-tide base map to viewer
// var low_tide_image = ee.Image(region_params.pixels);
// Map.addLayer(low_tide_image, {bands: ['b3','b2','b1'], min: 0, max: 3000}, sensor_params.sname + " from stack", false); // image data

//print (region_params.image[0])
var low_tide_image_dove = ee.Image(region_params.pixels);
Map.addLayer(low_tide_image_dove, {bands: ['b3','b2','b1'], min: 0, max: 3000}, sensor_params.sname + ' low tide', false); // image data


// V1 maps
Map.addLayer(ee.Image("ACA/reef_habitat/v1_0").select('geomorphic').selfMask(), map_palettes.geo, 'Geomorphic - V1', false);
Map.addLayer(ee.Image("ACA/reef_habitat/v1_0").select('benthic').selfMask(), map_palettes.benthic, 'Benthic - V1', false);


// Load the raw classifications
if (vars.raw) {
// geo raw (test if more than one map exists for the region)
  if (ee.List(region_params.geo_map).length().getInfo() > 1) {
    var geo_map_raw = ee.Image(region_params.geo_map[0]).unmask(0, false)
                 .add(ee.Image(region_params.geo_map[1]).unmask(0, false))
                 .selfMask();
  } else {
    var geo_map_raw = ee.Image(region_params.geo_map);
  }

  // benthic raw (test if more than one map exists for the region)
  if (ee.List(region_params.benthic_map).length().getInfo() > 1) {
    var benthic_map_raw = ee.Image(region_params.benthic_map[0]).unmask(0, false)
                     .add(ee.Image(region_params.benthic_map[1]).unmask(0, false))
                     .selfMask();
  } else {
      var benthic_map_raw = ee.Image(region_params.benthic_map);
  }

  // Add the raw region classification to the viewer
  Map.addLayer(geo_map_raw, map_palettes.geo, 'Geomorphic RAW', false);
  Map.addLayer(benthic_map_raw.updateMask(geo_map_raw.gt(2)), map_palettes.benthic, 'Benthic RAW', false);
}

// Add geo clean stage 1 to the viewer
if (vars.geo_cleanup_stage >= 1) {
  Map.addLayer(ee.Image(region_params.geo_map_clean1), map_palettes.geo, 'Geomorphic - stage 1 clean', false);
  }

// Add geo clean stage 2 to the viewer
if (vars.geo_cleanup_stage >= 2) {
  Map.addLayer(ee.Image(region_params.geo_map_clean2), map_palettes.geo, 'Geomorphic - stage 2 clean', false);
}

// Add geo clean stage 3 to the viewer
if (vars.geo_cleanup_stage >= 3) {
  var geo_map_clean3 = ee.Image(region_params.geo_map_clean3)
  Map.addLayer(geo_map_clean3.updateMask(geo_map_clean3.gt(2)), map_palettes.geo, 'Geomorphic - stage 3 clean', true);
}

// Add benthic clean stage 1 to the viewer
if (vars.benthic_cleanup_stage >= 1) {
  Map.addLayer(ee.Image(region_params.benthic_map_clean1), map_palettes.benthic, 'Benthic - stage 1 clean', false);
  }

// Add geo clean stage 2 to the viewer
if (vars.benthic_cleanup_stage == 2) {
  Map.addLayer(ee.Image(region_params.benthic_map_clean2), map_palettes.benthic, 'Benthic - stage 2 clean', false);
}

// Geo Training Data - Needs more work + add flag to show
var geo_train = ee.FeatureCollection(region_params.geo_train_library);

var geo_buff = function(feature) {
 return feature.buffer(20);   // substitute in your value of Z herere
};

var geo_train_buff = geo_train.map(geo_buff);

// Create an empty image into which to paint the features, cast to byte.
var empty = ee.Image().byte();

// Paint the interior of the polygons with different colors.
var geo_fill = empty.paint({
  featureCollection: geo_train_buff,
  color: 'class_num',
});

//Map.addLayer(geo_fill, map_palettes.geo, 'Geo Training Data', false);
var wcmc = ee.FeatureCollection("projects/coral_atlas/global_datasets/wcmc_reefs_2018v4_filtered").filterBounds(region_extent);
Map.addLayer(wcmc, {color:'#ffff00'}, "WCMC layer", false);

// add global masks 
Map.addLayer(ee.Image("ACA/reef_habitat/v1_0").select("reef_mask"), {min:0, max:1}, "Global mask", false);
Map.addLayer(ee.FeatureCollection("projects/coral_atlas/global_datasets/global_lagoons_mask"), {}, "Global lagoons mask", false);


////////// UI SET UP //////////

//Generate title
var title = ui.Label({
  value: 'Coral Atlas map classes',
  style: {fontWeight: 'bold', fontSize: '14px'}
});

// generate the legend
var geo_legend = pkg_vis.discrete_legend(map_palettes.geo_atlas_names, map_palettes.geo_atlas_cols, 'Geomorphic Zone', false);
var benthic_legend = pkg_vis.discrete_legend(map_palettes.benthic_atlas_names, map_palettes.benthic_atlas_cols, 'Benthic Habitat', false);
//var mask_legend = pkg_vis.discrete_legend(["Low confidence depth","Water conditions"], ["#f7f7f7","#bababa"], 'Confidence Mask reason', false)
pkg_vis.add_lgds([title, geo_legend, benthic_legend]);//, mask_legend])
// generate the legend



////////// MASK EXPORTS //////////


Export.table.toAsset({
  collection: ee.FeatureCollection(region_extent),
  description: "region_extent_export",
  assetId: region_params.asset + 'in_out/' + region_params.sname + '_extent'
})

/*Export.table.toAsset({
  collection: ee.FeatureCollection(notReef_mask),
  description: "not_reef_mask_export",
  assetId: region_params.asset + 'in_out/' +  region_params.sname + '_notreef'
})*/

Export.table.toAsset({
  collection: ee.FeatureCollection(mid_mask),
  description: "mid_mask_export",
  assetId: region_params.asset + 'in_out/' +  region_params.sname + '_midmask'
})

