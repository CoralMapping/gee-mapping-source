/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var wcmc = ee.FeatureCollection("projects/coral_atlas/global_datasets/wcmc_reefs_2018v4_dissolved"),
    artifact_layer = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                133.87823474549796,
                -0.4089792032861279
              ],
              [
                133.63653552674796,
                -1.2987640172814356
              ],
              [
                134.26275622987296,
                -2.901638046434227
              ],
              [
                135.18560779237296,
                -3.680374916452446
              ],
              [
                135.93267810487296,
                -3.384307934312925
              ],
              [
                136.67974841737296,
                -2.7370426506771937
              ],
              [
                141.32696521424796,
                -3.1759097861941235
              ],
              [
                143.4279701191011,
                -4.259070182025207
              ],
              [
                145.6691810566011,
                -5.8786331785618025
              ],
              [
                146.5480873066011,
                -6.490284053493718
              ],
              [
                146.8776771503511,
                -7.798378392835013
              ],
              [
                147.6906654316011,
                -8.559593192736711
              ],
              [
                148.4816810566011,
                -7.515281003123185
              ],
              [
                149.31140410379453,
                -6.323085296945845
              ],
              [
                148.7783119159761,
                -5.829452527797415
              ],
              [
                148.11862548736215,
                -5.198240891526597
              ],
              [
                147.2951576191011,
                -5.003695852147759
              ],
              [
                146.5920326191011,
                -3.9084008385224744
              ],
              [
                142.7687904316011,
                -2.043326425476854
              ],
              [
                136.8361732441011,
                -0.13213848083636925
              ],
              [
                135.2101966816011,
                0.1974508549526587
              ],
              [
                134.3532630878511,
                0.17547831519620935
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                151.68811485734636,
                -4.985234424733032
              ],
              [
                151.46289513078386,
                -4.547302031346837
              ],
              [
                150.85864708390886,
                -4.667761071909342
              ],
              [
                150.7075727286196,
                -4.971498668283573
              ],
              [
                150.91907188859636,
                -5.20956328424697
              ],
              [
                151.22119591203386,
                -5.2150337336424
              ],
              [
                151.31457970109636,
                -5.154856179259612
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                148.29333946672136,
                -5.269735597524267
              ],
              [
                148.47461388078386,
                -5.559573881564838
              ],
              [
                149.94678184953386,
                -5.625178101912731
              ],
              [
                149.95227501359636,
                -5.4556856112092955
              ],
              [
                149.67761681047136,
                -5.182210323933331
              ],
              [
                148.50757286515886,
                -5.258795608490538
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                146.62545668014764,
                -9.323205761348502
              ],
              [
                147.1268874846443,
                -9.964479081696203
              ],
              [
                147.24636380300367,
                -9.937426456319757
              ],
              [
                148.33456133245576,
                -10.613918906105498
              ],
              [
                149.76635281667555,
                -10.691333794802919
              ],
              [
                149.85911547007052,
                -10.675462965874859
              ],
              [
                149.91339687081734,
                -10.57050003636133
              ],
              [
                150.06985013112867,
                -10.275421525503225
              ],
              [
                147.90966336355055,
                -9.611268046705264
              ],
              [
                147.67895047292555,
                -9.546269125326358
              ],
              [
                147.3356277190193,
                -9.482612329450294
              ],
              [
                147.04723660573805,
                -9.313255047750458
              ],
              [
                146.90029446706617,
                -9.10042611147292
              ],
              [
                146.82751004323805,
                -9.147883128872149
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                149.55726869828914,
                -9.337101862913343
              ],
              [
                149.78932470327902,
                -9.376472633830232
              ],
              [
                150.08735903032036,
                -9.285604413423018
              ],
              [
                150.7712579561016,
                -9.15818355275302
              ],
              [
                150.8097101045391,
                -9.055128991009664
              ],
              [
                150.8097101045391,
                -8.78650678306035
              ],
              [
                150.7108331514141,
                -8.631756774276797
              ],
              [
                150.54329164750789,
                -8.074682981968278
              ],
              [
                149.44253804991993,
                -7.944072510842077
              ],
              [
                148.27743383982394,
                -7.930375404846073
              ],
              [
                148.30757387407039,
                -8.436192489967747
              ],
              [
                148.55875819848913,
                -8.665655297747731
              ],
              [
                148.59109249722894,
                -8.850931958224628
              ],
              [
                148.71139657927307,
                -9.047048576959925
              ],
              [
                149.25789125688289,
                -8.930339227278287
              ],
              [
                149.43641908891414,
                -9.098524005753074
              ],
              [
                149.49409731157039,
                -9.220544190087072
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                150.2948919767333,
                -2.7862858150120196
              ],
              [
                150.45694031657706,
                -2.1963314333767694
              ],
              [
                150.1740423673583,
                -2.0920344064818086
              ],
              [
                149.89663758220206,
                -2.1606516735138364
              ],
              [
                149.7950140470458,
                -2.2649439492415473
              ],
              [
                149.78677430095206,
                -2.4488091963068355
              ],
              [
                149.8554388517333,
                -2.6573421167179205
              ],
              [
                150.0037542814208,
                -2.7917724722694213
              ],
              [
                150.2289740079833,
                -2.84663762741956
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                156.39644230822557,
                -6.414516921978265
              ],
              [
                156.30580510119432,
                -6.654645725146902
              ],
              [
                156.34425724963182,
                -6.98463035740684
              ],
              [
                156.70405949572557,
                -7.3280032724124675
              ],
              [
                156.98421086291307,
                -7.507760509681789
              ],
              [
                157.14625920275682,
                -7.581276246666614
              ],
              [
                157.44289006213182,
                -6.990082723849697
              ],
              [
                157.26161564806932,
                -6.741936411401399
              ],
              [
                156.80293644885057,
                -6.504578712109516
              ],
              [
                156.48707951525682,
                -6.387222317613923
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                160.00467780021492,
                -9.244977918484341
              ],
              [
                160.05960944083992,
                -9.518671841038799
              ],
              [
                160.31778815177742,
                -9.613465472030013
              ],
              [
                160.5773140827556,
                -9.717789078205124
              ],
              [
                160.79844000724617,
                -9.686573855222663
              ],
              [
                160.97971442130867,
                -9.570134520729852
              ],
              [
                160.49356940177742,
                -8.957505853583573
              ],
              [
                160.23813727287117,
                -8.914093906172516
              ],
              [
                160.01017096427742,
                -9.10127076836629
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                152.5867729668269,
                -10.826405340459102
              ],
              [
                152.5524406914363,
                -10.796729226715392
              ],
              [
                152.53458790823316,
                -10.818312146056291
              ],
              [
                152.52360158010816,
                -10.839893511909713
              ],
              [
                152.48514943167066,
                -10.872262641448312
              ],
              [
                152.41236500784254,
                -10.923506576867792
              ],
              [
                152.3766594414363,
                -11.013836158995067
              ],
              [
                152.45768361135816,
                -11.009792141799133
              ],
              [
                152.54420094534254,
                -10.974741668592298
              ],
              [
                152.5689201836238,
                -10.936990354775086
              ],
              [
                152.58402638479566,
                -10.910022186516041
              ],
              [
                152.61698536917066,
                -10.865519362076688
              ],
              [
                152.6018791679988,
                -10.839893511909713
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                153.1141167168269,
                -10.729272623561489
              ],
              [
                153.05094533010816,
                -10.872262641448312
              ],
              [
                152.9163628105769,
                -10.85742722575276
              ],
              [
                152.74882130667066,
                -10.89114301248613
              ],
              [
                152.79825978323316,
                -11.030011672052762
              ],
              [
                152.80237965628004,
                -11.079880561975394
              ],
              [
                152.8614311699519,
                -11.118961050240358
              ],
              [
                152.96854786917066,
                -11.137825619144325
              ],
              [
                153.13334279104566,
                -11.171509306755395
              ],
              [
                153.2020073418269,
                -11.224048047205324
              ],
              [
                153.3228569512019,
                -11.268496440389251
              ],
              [
                153.41212086721754,
                -11.176898334189444
              ],
              [
                153.5261040215144,
                -11.06909881813882
              ],
              [
                153.5741692070613,
                -10.895188650614038
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                152.41923146292066,
                -11.093357183031864
              ],
              [
                152.36292653128004,
                -11.12165606344333
              ],
              [
                152.29288868948316,
                -11.259068566506777
              ],
              [
                152.27640919729566,
                -11.389684341259677
              ],
              [
                152.34782033010816,
                -11.440837098958864
              ],
              [
                152.5469475273738,
                -11.50947495411365
              ],
              [
                152.90812306448316,
                -11.619798725123827
              ],
              [
                152.98502736135816,
                -11.552533303139224
              ],
              [
                153.06605153128004,
                -11.59693029873299
              ],
              [
                153.10038380667066,
                -11.529659377178806
              ],
              [
                153.05094533010816,
                -11.397761705210451
              ],
              [
                153.04407887503004,
                -11.27388365813425
              ],
              [
                153.03995900198316,
                -11.229436096232106
              ],
              [
                152.7790337090144,
                -11.170162034253947
              ],
              [
                152.68153004690504,
                -11.166120179218055
              ],
              [
                152.58951954885816,
                -11.127046015084105
              ],
              [
                152.5030022148738,
                -11.070446557832925
              ],
              [
                152.46866993948316,
                -11.097400048190782
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                154.25796585687513,
                -11.366236524355337
              ],
              [
                154.27101212152357,
                -11.395181735629507
              ],
              [
                154.3712623656642,
                -11.412008992578516
              ],
              [
                154.42001419671888,
                -11.41066284871229
              ],
              [
                154.46189957269544,
                -11.360177852037655
              ],
              [
                154.4591529906642,
                -11.301604059727552
              ],
              [
                154.33487015375013,
                -11.229548620856583
              ],
              [
                154.2895515502345,
                -11.253120142759194
              ],
              [
                154.26071243890638,
                -11.304297370608236
              ],
              [
                154.24423294671888,
                -11.351426209237339
              ],
              [
                154.24972611078138,
                -11.360177852037655
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                160.29867194522748,
                -12.251100396584077
              ],
              [
                160.27120612491498,
                -12.336975481817502
              ],
              [
                160.31240485538373,
                -12.497915273425836
              ],
              [
                160.31789801944623,
                -12.564944033483417
              ],
              [
                160.42226813663373,
                -12.631955320613867
              ],
              [
                160.47445319522748,
                -12.586389550590964
              ],
              [
                160.53762458194623,
                -12.505959644319004
              ],
              [
                160.52663825382123,
                -12.433551306186807
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                160.67495368350873,
                -12.90250124908476
              ],
              [
                160.60628913272748,
                -12.918564141919271
              ],
              [
                160.55959723819623,
                -12.939979725505454
              ],
              [
                160.58706305850873,
                -12.969423149600967
              ],
              [
                160.64199469913373,
                -12.974776125312326
              ],
              [
                160.72439216007123,
                -12.921241190341497
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                160.16101859182297,
                -11.85623246602585
              ],
              [
                160.23517630666672,
                -11.884454869531236
              ],
              [
                160.43979666799484,
                -11.794401773135085
              ],
              [
                160.4095842656511,
                -11.713732110542248
              ],
              [
                160.34091971486984,
                -11.673388436050052
              ],
              [
                160.28461478322922,
                -11.63438397079991
              ],
              [
                160.22693656057297,
                -11.658594283643355
              ],
              [
                160.16513846486984,
                -11.81322128851953
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                161.62734334529722,
                -10.879040394073847
              ],
              [
                161.83333699764097,
                -10.965338907294944
              ],
              [
                162.00637166560972,
                -11.016566749206016
              ],
              [
                162.24807088435972,
                -10.994998215914597
              ],
              [
                162.44582479060972,
                -10.784622789609758
              ],
              [
                162.48427693904722,
                -10.665884340896692
              ],
              [
                162.06669831663342,
                -9.998386664791544
              ],
              [
                161.94035554319592,
                -10.04436617502685
              ],
              [
                161.86619782835217,
                -10.274165132777055
              ],
              [
                161.79753327757092,
                -10.38765145033208
              ],
              [
                161.70964265257092,
                -10.641494737842686
              ],
              [
                161.55858064085217,
                -10.827692410386966
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                161.14644816589066,
                -8.560565458628094
              ],
              [
                160.9898929901094,
                -8.593155852050975
              ],
              [
                160.90062907409379,
                -8.658328225409537
              ],
              [
                160.86767008971879,
                -8.768280969367172
              ],
              [
                160.9569340057344,
                -8.8968420508194
              ],
              [
                161.0777836151094,
                -8.8981988164202
              ],
              [
                161.16979411315629,
                -8.808641532775486
              ],
              [
                161.24669841003129,
                -8.657973642751688
              ],
              [
                161.1986332244844,
                -8.58058012694598
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                162.8783444373843,
                -8.401237791030695
              ],
              [
                162.8515652625796,
                -8.409389032203904
              ],
              [
                162.81448640515774,
                -8.43384172648629
              ],
              [
                162.8117398231265,
                -8.478667644326173
              ],
              [
                162.85774507214992,
                -8.528241736772166
              ],
              [
                162.92572297742336,
                -8.535032208318714
              ],
              [
                162.98065461804836,
                -8.509906861049256
              ],
              [
                163.01155366589992,
                -8.4616887435528
              ],
              [
                162.98546113660305,
                -8.42297405311963
              ],
              [
                162.96486177136867,
                -8.408030503909012
              ],
              [
                162.91954316785305,
                -8.408030503909012
              ],
              [
                162.88521089246242,
                -8.39852067257153
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                159.12769283868514,
                -5.031088988222289
              ],
              [
                159.02332272149764,
                -5.356589831624908
              ],
              [
                159.18262447931014,
                -5.5999189407806735
              ],
              [
                159.68389037852242,
                -5.703884610159751
              ],
              [
                159.88300289727889,
                -5.550714342040766
              ],
              [
                159.81159176446639,
                -5.260871812405926
              ],
              [
                159.57263912774764,
                -5.102221086775103
              ],
              [
                159.32544674493514,
                -4.968157954733102
              ],
              [
                159.19635738946639,
                -4.973630458146343
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                153.55114863181925,
                -3.9054729684363525
              ],
              [
                153.4550182607255,
                -3.983565120758174
              ],
              [
                153.40695307517862,
                -4.082197227793169
              ],
              [
                153.559388377913,
                -4.282163722155516
              ],
              [
                153.867005565413,
                -4.128769306638603
              ],
              [
                153.932923534163,
                -3.9808251698574586
              ],
              [
                153.84777949119425,
                -3.8808107721423664
              ],
              [
                153.73654291892862,
                -3.765711074408919
              ],
              [
                153.61294672752237,
                -3.836965092402823
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                144.92907479070624,
                -1.3534256201414332
              ],
              [
                144.8439307477375,
                -1.4028497945746512
              ],
              [
                144.80410530828436,
                -1.4742384159397606
              ],
              [
                144.79174568914374,
                -1.63073607558392
              ],
              [
                144.882382896175,
                -1.7638868286792753
              ],
              [
                145.11721565984686,
                -1.776240550226351
              ],
              [
                145.23806526922186,
                -1.6623087272531174
              ],
              [
                145.3177161481281,
                -1.514050313744027
              ],
              [
                145.18176033758124,
                -1.3424423321797951
              ],
              [
                145.01833870672186,
                -1.3149838972968817
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                145.64294424860844,
                -0.7563862571808738
              ],
              [
                145.4863890728272,
                -0.6327991718126712
              ],
              [
                145.3600462993897,
                -0.5943492289282062
              ],
              [
                145.2996214947022,
                -0.6410384088003632
              ],
              [
                145.2117308697022,
                -0.7316691032554247
              ],
              [
                145.29687491267094,
                -0.9046860635489963
              ],
              [
                145.4039916118897,
                -1.0419953166615068
              ],
              [
                145.56603995173344,
                -1.0996634637497176
              ],
              [
                145.7061156353272,
                -1.0200262178583916
              ],
              [
                145.7225951275147,
                -0.8991935800909844
              ],
              [
                145.69238272517094,
                -0.8003275136288024
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                144.35148599263525,
                -0.949481469891727
              ],
              [
                143.799423004354,
                -1.4410111730599109
              ],
              [
                143.8818204652915,
                -1.7869426880286041
              ],
              [
                144.19218423482275,
                -2.028507762417621
              ],
              [
                144.4201505434165,
                -1.7787069305454442
              ],
              [
                144.733260894979,
                -1.3421633943466025
              ],
              [
                144.766219879354,
                -1.053835623801309
              ],
              [
                144.54374673482275,
                -0.9275117613388125
              ],
              [
                144.45036294576025,
                -0.92201931276445
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                143.11767455475118,
                -1.3074320527877101
              ],
              [
                142.97485228912618,
                -1.3060591189220558
              ],
              [
                142.8828417910793,
                -1.3815693458635017
              ],
              [
                142.9048144473293,
                -1.4845339437942924
              ],
              [
                143.04077025787618,
                -1.631421721290283
              ],
              [
                143.12042113678243,
                -1.6094578522462468
              ],
              [
                143.20419188873555,
                -1.5408192514010546
              ],
              [
                143.20419188873555,
                -1.4145185186625335
              ],
              [
                143.16024657623555,
                -1.3486197160745361
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                146.51666668688708,
                -2.082641979013898
              ],
              [
                146.38345745837145,
                -2.211640674316241
              ],
              [
                146.31341961657458,
                -2.1375363698009777
              ],
              [
                146.18433026110583,
                -2.118323553735924
              ],
              [
                146.13626507555895,
                -2.144398031661015
              ],
              [
                146.12390545641833,
                -2.336511712318543
              ],
              [
                146.34088543688708,
                -2.5148795021161154
              ],
              [
                146.74463299548083,
                -2.528599113282302
              ],
              [
                146.97534588610583,
                -2.5107635905938004
              ],
              [
                147.1497538450902,
                -2.4901838389313804
              ],
              [
                147.27197674548083,
                -2.306324104933219
              ],
              [
                147.28296307360583,
                -2.1869396446174307
              ],
              [
                147.16760662829333,
                -2.100161473559883
              ],
              [
                146.88882855212145,
                -2.097416734024053
              ],
              [
                146.64163616930895,
                -2.0562450666556464
              ],
              [
                146.5345194700902,
                -2.063107085557386
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                146.09005607070966,
                -2.5978395661531053
              ],
              [
                146.08456290664716,
                -3.0559593691788787
              ],
              [
                146.59542716445966,
                -3.2259915753917077
              ],
              [
                147.03213370742841,
                -3.220507101347266
              ],
              [
                147.23812735977216,
                -2.7679409361366445
              ],
              [
                147.08981193008466,
                -2.5868644812768227
              ],
              [
                146.87832511367841,
                -2.540219315762449
              ],
              [
                146.48831046524091,
                -2.5649140269789243
              ],
              [
                146.19167960586591,
                -2.5841206952010483
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                151.3173112619978,
                -4.495063208457773
              ],
              [
                151.59471604715404,
                -4.360882424847945
              ],
              [
                151.59471604715404,
                -4.254068309251699
              ],
              [
                151.77049729715404,
                -4.295152434720749
              ],
              [
                152.2277330020076,
                -4.260845806933132
              ],
              [
                152.2991441348201,
                -4.030736773695575
              ],
              [
                152.1068833926326,
                -3.926618209122255
              ],
              [
                151.5795396426326,
                -3.8334484734887675
              ],
              [
                151.20875106841385,
                -3.984159043348545
              ],
              [
                151.1345933535701,
                -4.217020708766678
              ],
              [
                151.2389634707576,
                -4.389567495114925
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                153.2463240594829,
                -4.257140695088385
              ],
              [
                153.00325154971728,
                -4.255771191845051
              ],
              [
                152.67640828799853,
                -4.265357663350862
              ],
              [
                152.56654500674853,
                -4.2941163590447555
              ],
              [
                152.50612020206103,
                -4.43378590363591
              ],
              [
                152.60499715518603,
                -4.535098315291163
              ],
              [
                152.81373738956103,
                -4.551526024548336
              ],
              [
                153.09938192081103,
                -4.507717970290143
              ],
              [
                153.23121785831103,
                -4.469383755626047
              ],
              [
                153.26143026065478,
                -4.335198328122119
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                158.0736838745222,
                -8.772281407235576
              ],
              [
                158.00295938721752,
                -8.779746078687726
              ],
              [
                157.9638205932722,
                -8.774995850588773
              ],
              [
                157.91644205323314,
                -8.74377855504135
              ],
              [
                157.86769022217845,
                -8.70848628849085
              ],
              [
                157.84915079346752,
                -8.698983954897606
              ],
              [
                157.79009927979564,
                -8.717988380699598
              ],
              [
                157.67954935303783,
                -8.737670517013822
              ],
              [
                157.68023599854564,
                -8.772960019934548
              ],
              [
                157.78941263428783,
                -8.90594404548562
              ],
              [
                158.03982795643415,
                -8.87426717051447
              ],
              [
                158.08926643299665,
                -8.816596452111776
              ],
              [
                158.08926643299665,
                -8.78470406737434
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    noReef_mask = 
    /* color: #ff0000 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                136.23460438801584,
                -2.629275602393311
              ],
              [
                136.54427215599102,
                -2.6962787263763
              ],
              [
                137.36482013102457,
                -2.6642552504268946
              ],
              [
                139.9995688809453,
                -2.5488413084834396
              ],
              [
                140.07921983543994,
                -2.3677343285527304
              ],
              [
                140.06823358805778,
                -2.329314547708212
              ],
              [
                140.09020640950374,
                -2.1854847510356965
              ],
              [
                140.1231655546508,
                -2.0345255557659154
              ],
              [
                139.63448174799328,
                -1.9669377329328368
              ],
              [
                139.49441008227905,
                -2.0918267724754664
              ],
              [
                139.5314881643882,
                -2.116529138763426
              ],
              [
                139.52736506429588,
                -2.1590732891643567
              ],
              [
                139.4779267245694,
                -2.149467044103999
              ],
              [
                139.44702752783493,
                -2.1364300548067074
              ],
              [
                139.43123492792634,
                -2.1137861921821144
              ],
              [
                139.45595566720115,
                -2.08359346232172
              ],
              [
                139.48754244073766,
                -2.090454349328754
              ],
              [
                139.54384696346003,
                -1.9923256158176599
              ],
              [
                139.5246187017566,
                -1.9339977952593315
              ],
              [
                139.36257072084962,
                -1.8543904470764119
              ],
              [
                139.27742670959822,
                -2.0177183714923896
              ],
              [
                139.24996091781156,
                -2.052028911291586
              ],
              [
                139.2183752982711,
                -2.032815066888063
              ],
              [
                139.22661505062067,
                -1.9998765582770235
              ],
              [
                139.3158789203569,
                -1.8379195014091445
              ],
              [
                139.15383091818813,
                -1.743208750439816
              ],
              [
                139.1140055109585,
                -1.8022318777858688
              ],
              [
                139.0453410146064,
                -1.9271349034216445
              ],
              [
                139.03160811474413,
                -1.957329886529148
              ],
              [
                139.00276905663648,
                -1.9573298729370465
              ],
              [
                138.9835430281675,
                -1.9339974195429486
              ],
              [
                138.99727592261027,
                -1.91340970740139
              ],
              [
                139.03023484752666,
                -1.913409722828662
              ],
              [
                139.11812540735292,
                -1.748699334409607
              ],
              [
                138.91773994280973,
                -1.5812461623387108
              ],
              [
                138.86504146035546,
                -1.676821768127756
              ],
              [
                138.80204113775144,
                -1.7325886201906302
              ],
              [
                138.71861290024526,
                -1.67047400566644
              ],
              [
                138.68943055312397,
                -1.6172809060505622
              ],
              [
                138.67535436102222,
                -1.4878959602114388
              ],
              [
                138.80169701766204,
                -1.262741578012466
              ],
              [
                138.6314091475644,
                -1.1419187033444245
              ],
              [
                138.12603852128439,
                -0.9332130799140748
              ],
              [
                137.35699635552635,
                -1.0485527089145301
              ],
              [
                136.9944485474737,
                -1.5098621463199164
              ],
              [
                136.86947954194483,
                -1.612818145966949
              ],
              [
                136.98895568769177,
                -1.7157737768162993
              ],
              [
                137.07409974041192,
                -1.824211687443526
              ],
              [
                137.08783288063466,
                -1.8736240112529094
              ],
              [
                137.05487379382166,
                -1.892840019458443
              ],
              [
                137.00268881657726,
                -1.884604837618182
              ],
              [
                136.8969455186693,
                -1.8338247953769289
              ],
              [
                136.7307777778106,
                -1.9436237149937916
              ],
              [
                136.40668192102845,
                -2.058910156772861
              ],
              [
                136.10455880821428,
                -2.2016340367542937
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                140.71373901908086,
                -2.519074775282059
              ],
              [
                140.81673584525274,
                -2.393534125840512
              ],
              [
                140.64782105033086,
                -2.3029730415497327
              ],
              [
                140.511865239784,
                -2.2899372546960612
              ],
              [
                140.41024170462774,
                -2.307775669833533
              ],
              [
                140.35531006400274,
                -2.3516846576705537
              ],
              [
                140.3745361382215,
                -2.41411536419168
              ],
              [
                140.43221436087774,
                -2.4834032269293895
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                141.01554161343432,
                -2.387859721554285
              ],
              [
                140.8754824804241,
                -2.570322586335402
              ],
              [
                140.81778770718432,
                -2.8103972628843534
              ],
              [
                143.70169883999682,
                -3.8358778782129113
              ],
              [
                144.47623497280932,
                -3.9893279430452173
              ],
              [
                144.861104733211,
                -4.114675941761769
              ],
              [
                144.99808555874682,
                -3.872872867174884
              ],
              [
                144.57648521694995,
                -3.6796593376325206
              ],
              [
                144.47552778474923,
                -3.593346729811558
              ],
              [
                144.08072716030932,
                -3.5288961647240895
              ],
              [
                143.73053795132495,
                -3.3493190968681943
              ],
              [
                143.60693752278266,
                -3.490864395121523
              ],
              [
                143.51767784390307,
                -3.431572330714073
              ],
              [
                143.49059614019686,
                -3.412637628239037
              ],
              [
                143.46711920932088,
                -3.403297989914695
              ],
              [
                143.44535929714593,
                -3.397899047607604
              ],
              [
                143.42566025255888,
                -3.3918146080873
              ],
              [
                143.3956183987176,
                -3.3777633645023197
              ],
              [
                143.4136420139484,
                -3.3458902334157075
              ],
              [
                143.30962425503589,
                -3.2876246268176796
              ],
              [
                143.21555382046557,
                -3.2293541220233344
              ],
              [
                142.62228591753225,
                -3.0515008073622583
              ],
              [
                142.5452147010249,
                -3.052256989853185
              ],
              [
                142.52375977021381,
                -3.0948364536741915
              ],
              [
                142.49474882336892,
                -3.1183889132894542
              ],
              [
                142.50530539369186,
                -3.1493624488793324
              ],
              [
                142.4980092648015,
                -3.1721086640064704
              ],
              [
                142.4666499559995,
                -3.161155754741027
              ],
              [
                142.45039778869068,
                -3.131005394371224
              ],
              [
                142.46948817473128,
                -3.111787510014121
              ],
              [
                142.4940711264162,
                -3.102168014898324
              ],
              [
                142.5382918119067,
                -3.049447468494804
              ],
              [
                142.49530847595784,
                -3.0296389838063837
              ],
              [
                142.44401743960728,
                -3.020190317366411
              ],
              [
                142.4159365767008,
                -3.0770604152104624
              ],
              [
                142.4218444790445,
                -3.1137014765581057
              ],
              [
                142.41134446803005,
                -3.125618030331904
              ],
              [
                142.39741101603315,
                -3.1320494428617125
              ],
              [
                142.3884272183513,
                -3.1284569050030293
              ],
              [
                142.38871320960297,
                -3.1159511828595705
              ],
              [
                142.43803684947088,
                -3.0189993360011136
              ],
              [
                141.11991173062182,
                -2.3933481048259027
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                145.21952800346358,
                -4.2738047138002
              ],
              [
                145.20785502983077,
                -4.305301928527081
              ],
              [
                145.24562053276046,
                -4.3981678926099725
              ],
              [
                145.27995280815108,
                -4.395429393667492
              ],
              [
                145.32115153861983,
                -4.405014095909013
              ],
              [
                145.33767395566056,
                -4.411689210082155
              ],
              [
                145.34956149650557,
                -4.40698236769878
              ],
              [
                145.36852999193823,
                -4.434879814516641
              ],
              [
                145.35411052299483,
                -4.441297919007947
              ],
              [
                145.35814454404175,
                -4.44912781605429
              ],
              [
                145.36475352836592,
                -4.447202429309091
              ],
              [
                145.37131974775963,
                -4.43920148412537
              ],
              [
                145.3854388307375,
                -4.440699112586922
              ],
              [
                145.4168527562712,
                -4.458412311356147
              ],
              [
                145.42505499768322,
                -4.479889606114662
              ],
              [
                145.4325038877046,
                -4.487975519783595
              ],
              [
                145.4455840002671,
                -4.486713220665236
              ],
              [
                145.45426985631863,
                -4.490360341485443
              ],
              [
                145.45591770358362,
                -4.498542421633423
              ],
              [
                145.46867141018305,
                -4.527761992604998
              ],
              [
                145.50022366735283,
                -4.557579367043024
              ],
              [
                145.5944364507292,
                -4.678125161332891
              ],
              [
                145.70567302299483,
                -4.5515075843828035
              ],
              [
                145.47529899424939,
                -4.342791359648398
              ],
              [
                145.3880950147572,
                -4.271581916429295
              ],
              [
                145.30913078135876,
                -4.266103991729912
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                145.6133541386202,
                -5.370215193785555
              ],
              [
                145.6298336308077,
                -5.586204004849849
              ],
              [
                145.85779993940145,
                -5.6067051817884765
              ],
              [
                145.98551600385457,
                -5.471384228231634
              ],
              [
                145.96628992963582,
                -5.331930621906449
              ],
              [
                145.9319576542452,
                -5.225268206335136
              ],
              [
                145.82166488984257,
                -5.211602215155205
              ],
              [
                145.80887776375215,
                -5.205110192988256
              ],
              [
                145.66416590619832,
                -5.237576342001267
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                147.6394295424008,
                -6.575348731674722
              ],
              [
                147.53780600724454,
                -6.5535201300551575
              ],
              [
                146.9417977064633,
                -6.509860063645987
              ],
              [
                146.76876303849454,
                -6.613546476096603
              ],
              [
                146.7275643080258,
                -6.913567550664378
              ],
              [
                146.8319344252133,
                -7.235196480466454
              ],
              [
                147.2878670424008,
                -7.6845455744788485
              ],
              [
                147.68200156388517,
                -7.921285558025248
              ],
              [
                147.8914299826872,
                -7.6450335761539545
              ],
              [
                147.7932381361508,
                -7.491245934917704
              ],
              [
                147.6943611830258,
                -7.360515750107844
              ],
              [
                147.8207039564633,
                -6.889027412822765
              ],
              [
                147.70809409318204,
                -6.594447971880935
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                149.81287598377014,
                -9.759604790651878
              ],
              [
                149.60550904041077,
                -9.752837640550407
              ],
              [
                149.61649536853577,
                -9.926033168752364
              ],
              [
                149.61512207752014,
                -10.366723373189567
              ],
              [
                149.61939415201212,
                -10.42549656293051
              ],
              [
                149.69775615974652,
                -10.442722973453531
              ],
              [
                149.73487565213944,
                -10.372312060934986
              ],
              [
                149.79533110499034,
                -10.378887446325564
              ],
              [
                149.84786256143937,
                -10.489024044005982
              ],
              [
                149.85939776293532,
                -10.517380249720935
              ],
              [
                149.89840077160318,
                -10.513328348413188
              ],
              [
                150.0774910875286,
                -10.587905093132598
              ],
              [
                150.30382752185608,
                -10.354565274760462
              ],
              [
                150.39171814685608,
                -10.293092127730384
              ],
              [
                150.4418432689264,
                -10.249175398193326
              ],
              [
                150.51188111072327,
                -10.141046796732594
              ],
              [
                150.40476441150452,
                -10.07615208629753
              ],
              [
                150.14246582752014,
                -9.954439356985928
              ],
              [
                149.9859106517389,
                -9.913858333176595
              ],
              [
                149.86368775134827,
                -9.793438477225978
              ]
            ]
          ],
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    centre_map = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.Point([149.9759061226323, -8.440993122283631]),
    region_wcmcBound = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[133.27621531509237, -3.6964607454528933],
          [134.77035594009237, -4.6606761835234165],
          [138.02230906509237, -2.8189834208112403],
          [143.29574656509237, -4.485454607626794],
          [146.81137156509237, -8.32775342522801],
          [145.58090281509237, -9.369872642992746],
          [146.72348094009237, -10.408873647930577],
          [149.36019969009237, -11.960805457501285],
          [153.31527781509237, -12.5620026138334],
          [155.77621531509237, -12.132715510948076],
          [157.79769969009237, -10.235937480088639],
          [157.88559031509237, -11.616658821605727],
          [161.04965281509237, -14.101349060999887],
          [161.40121531509237, -13.24736423000143],
          [161.40121531509237, -12.390372354418293],
          [162.36801219009237, -11.874809336893126],
          [163.77426219009237, -9.369872642992746],
          [163.33480906509237, -7.544319839235769],
          [161.04965281509237, -4.6606761835234165],
          [149.88754344009237, -0.2712922865886533],
          [148.56918406509237, -1.2379938346478028],
          [147.07504344009237, -1.2379938346478028],
          [146.10824656509237, -0.09551200607302315],
          [142.76840281509237, -0.7107281976529471],
          [142.15316844009237, -2.467795559859385],
          [135.12191844009237, 0.6954864947804655],
          [133.45199656509237, -0.44707001364412374]]]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
// Viewing script for looking at reefs and classifications for each region. 
// From this region Timor Sea onwards the map_viewer script is going to be used from the very beginning
// in the workflow 

// Load and libraries needed
var map_palettes = require('users/mitchest/global_reefs_modules:colour_pals');
var param_module = require('users/mitchest/global_reefs_modules:reef_params');
var pkg_vis = require('users/mitchest/global_reefs_modules:pkg_vis');

// ###########################################
// SENSOR GENERICS
var sensor_params = param_module.dove;      //<------------ THIS IS WHERE YOU CHOOSE THE SENSOR
// REGION AND SENSOR SPECIFIC LOAD PATHS
var region_params = param_module.png_solomons;       //<------------ THIS IS WHERE YOU CHOOSE THE REGION
//  ^^ all the data paths are in this module ^^
// ###########################################

// **Choose which layers will be shown in the map viewer**

var vars = {
  raw: true, // set to true if you want to view the raw classifications for benthic and geo
  geo_clean1: true, // set to true if you want to view geo clean 1
  geo_clean2: true, // set to true if you want to view geo clean 2
  geo_clean3: true, // set to true if you want to view geo clean 3
  benthic_clean1: true, // set to true if you want to view benthic clean 1
  benthic_clean2: true, // set to true if you want to view benthic clean 2
  gamma: 1.7 // adjust the gamma value for the image dispaly
};


// choose where to centre the map (link this dynamically to map app?)
Map.centerObject(centre_map, 8);

// Add low-tide base map to viewer
var low_tide_image = ee.Image(region_params.pixels);
Map.addLayer(low_tide_image, {bands: ['b3','b2','b1'], min: 0, max: 3000}, sensor_params.sname + " from stack", false); // image data
//var low_tide_image_dove = ee.Image(region_params.image);
//Map.addLayer(low_tide_image_dove, {bands: ['b3','b2','b1'], min:0, max:4000, gamma: vars.gamma}, sensor_params.sname + ' low tide', false); // image data

// Load the raw classifications
if (vars.raw) {
// geo raw (test if more than one map exists for the region)
  if (ee.List(region_params.geo_map).length().getInfo() > 1) {
    var geo_map_raw = ee.Image(region_params.geo_map[0]).unmask(0, false)
                 .add(ee.Image(region_params.geo_map[1]).unmask(0, false))
                 .selfMask();
  } else {
    var geo_map_raw = ee.Image(region_params.geo_map);
  }

  // benthic raw (test if more than one map exists for the region)
  if (ee.List(region_params.benthic_map).length().getInfo() > 1) {
    var benthic_map_raw = ee.Image(region_params.benthic_map[0]).unmask(0, false)
                     .add(ee.Image(region_params.benthic_map[1]).unmask(0, false))
                     .selfMask();
  } else {
      var benthic_map_raw = ee.Image(region_params.benthic_map);
  }

  // Add the raw region classification to the viewer
  Map.addLayer(geo_map_raw, map_palettes.geo, 'Geomorphic RAW', false);
 // Map.addLayer(pns_benthic_v1.updateMask(geo_map_raw.gt(2)), map_palettes.benthic, 'Benthic v1 RAW', false);
  Map.addLayer(benthic_map_raw.updateMask(geo_map_raw.gt(2)), map_palettes.benthic, 'Benthic RAW', false);
  
}

// Load the clean classifications

var geo_clean1 = ee.Image(region_params.geo_map_clean1);
var geo_clean2 = ee.Image(region_params.geo_map_clean2);
var geo_clean3 = ee.Image(region_params.geo_map_clean3).selfMask();
var benthic_clean1 = ee.Image(region_params.benthic_map_clean1).selfMask();
var benthic_clean2 = ee.Image(region_params.benthic_map_clean2).selfMask();

if (vars.geo_clean1) Map.addLayer(geo_clean1, map_palettes.geo, 'Geomorphic clean - stage 1', false);
if (vars.geo_clean2) Map.addLayer(geo_clean2, map_palettes.geo, 'Geomorphic clean - stage 2', false);
if (vars.geo_clean3) Map.addLayer(geo_clean3.updateMask(geo_clean3.gt(2)), map_palettes.geo, 'Geomorphic clean - stage 3', false);
if (vars.benthic_clean1) Map.addLayer(benthic_clean1, map_palettes.benthic, 'Benthic clean - stage 1', false);
if (vars.benthic_clean2) Map.addLayer(benthic_clean2, map_palettes.benthic, 'Benthic clean - stage 2', false);

var wcmc=wcmc.filterBounds(region_wcmcBound);
Map.addLayer(wcmc, {color:'#ffff00'}, "WCMC layer", false);
Map.addLayer(artifact_layer, {color: 'ffff00'}, 'Artifact Layer', false);


/*// Geo Training Data - Needs more work + add flag to show
var geo_train = ee.FeatureCollection(region_params.geo_train_library);

var geo_buff = function(feature) {
  return feature.buffer(20);   // substitute in your value of Z here
};

var geo_train_buff = geo_train.map(geo_buff)

// Create an empty image into which to paint the features, cast to byte.
var empty = ee.Image().byte();

// Paint the interior of the polygons with different colors.
var geo_fill = empty.paint({
  featureCollection: geo_train_buff,
  color: 'class_num',
});

Map.addLayer(geo_fill, map_palettes.geo, 'Geo Training Data', false);
*/

////////// UI SET UP //////////

//Generate title
var title = ui.Label({
  value: 'Coral Atlas map classes',
  style: {fontWeight: 'bold', fontSize: '14px'}
});

// generate the legend
var geo_legend = pkg_vis.discrete_legend(map_palettes.geo_atlas_names, map_palettes.geo_atlas_cols, 'Geomorphic Zone', false);
var benthic_legend = pkg_vis.discrete_legend(map_palettes.benthic_atlas_names, map_palettes.benthic_atlas_cols, 'Benthic Habitat', false);
//var mask_legend = pkg_vis.discrete_legend(["Low confidence depth","Water conditions"], ["#f7f7f7","#bababa"], 'Confidence Mask reason', false)
pkg_vis.add_lgds([title, geo_legend, benthic_legend]);//, mask_legend])
// generate the legend

