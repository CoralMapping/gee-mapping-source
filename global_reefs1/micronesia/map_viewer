/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var centre_map = /* color: #d63000 */ee.Geometry.Point([151.72552961318496, 7.454410756629496]),
    mid_mask = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                134.64477778864435,
                7.3663530978481555
              ],
              [
                134.58915950251154,
                7.269643665752631
              ],
              [
                134.6530175347381,
                7.2413760486919285
              ],
              [
                134.6801400322967,
                7.3704389492063305
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                139.5095727957781,
                10.161797685593125
              ],
              [
                139.51060276403982,
                10.09994920595151
              ],
              [
                139.51738331279975,
                10.038937467442427
              ],
              [
                139.6065614737566,
                10.100963211542227
              ],
              [
                139.8255157042642,
                10.123860423388674
              ],
              [
                139.81895659477905,
                10.204265420400663
              ],
              [
                139.6036432303484,
                10.164332204606795
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                139.74746870959294,
                9.715535949945615
              ],
              [
                140.0578324791242,
                9.715535949945615
              ],
              [
                140.06607222521794,
                9.85830960192448
              ],
              [
                140.0310533043195,
                9.92189507849359
              ],
              [
                139.76394820178044,
                9.896868221201423
              ],
              [
                139.72343386317905,
                9.85288520678443
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                140.54545208551374,
                9.930239458138441
              ],
              [
                140.38116844332285,
                9.816759375746031
              ],
              [
                140.42040013999667,
                9.743434430020976
              ],
              [
                140.45877063643545,
                9.730776200975606
              ],
              [
                140.50194745166743,
                9.741799544232148
              ],
              [
                140.50384482923297,
                9.750987409578144
              ],
              [
                140.51244967552535,
                9.776128846957498
              ],
              [
                140.53171983149548,
                9.77362622529229
              ],
              [
                140.52966293233231,
                9.752481147531752
              ],
              [
                140.46923822191468,
                9.720252383829234
              ],
              [
                140.49670173063004,
                9.643561766199294
              ],
              [
                140.57359761342687,
                9.665454129377355
              ],
              [
                140.62441585541754,
                9.721855629838705
              ],
              [
                140.63660645614664,
                9.795440176934434
              ],
              [
                140.6000399961996,
                9.864287826137542
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                144.47860128229112,
                7.207016079581096
              ],
              [
                144.4065035039708,
                7.247206306727467
              ],
              [
                144.44907552545519,
                7.3146360816427665
              ],
              [
                144.63034993951769,
                7.226771044744859
              ],
              [
                144.72648031061144,
                7.36639344769209
              ],
              [
                144.4222963506505,
                7.535924364643753
              ],
              [
                144.24308187311144,
                7.2145094437502655
              ],
              [
                144.46349508111925,
                7.10277740281382
              ],
              [
                144.53009969537706,
                7.198841359152212
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                144.4177573337577,
                8.52404627105328
              ],
              [
                144.43767005348425,
                8.494845549381017
              ],
              [
                144.5780890598319,
                8.473113336662719
              ],
              [
                144.6264975681327,
                8.660512967605797
              ],
              [
                144.57980567360144,
                8.681216294717238
              ],
              [
                144.53483039283972,
                8.653045914154239
              ],
              [
                144.54856330299597,
                8.606203751176876
              ],
              [
                144.5396369113944,
                8.572256530912973
              ],
              [
                144.43732673073035,
                8.550189211007513
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                145.3637829056419,
                9.235275548590625
              ],
              [
                145.39811112955957,
                9.247815499599007
              ],
              [
                145.41974043860833,
                9.203591000765828
              ],
              [
                145.45922663122784,
                9.294912047646735
              ],
              [
                145.44412043005596,
                9.356570925676284
              ],
              [
                145.27520563513409,
                9.309141986094383
              ],
              [
                145.36309626013409,
                9.11326042769431
              ],
              [
                145.45373346716534,
                9.149191457398238
              ],
              [
                145.3976030682794,
                9.212740823728097
              ],
              [
                145.37717249304424,
                9.202403386488713
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                146.36665428653367,
                7.4700559925972065
              ],
              [
                146.37815559878953,
                7.466141272097192
              ],
              [
                146.37163246646531,
                7.5047763242871754
              ],
              [
                146.34880150333055,
                7.527581309281199
              ],
              [
                146.33592690005906,
                7.523156555116752
              ],
              [
                146.3343819476665,
                7.51907212660246
              ],
              [
                146.34245003238328,
                7.501883068997179
              ],
              [
                146.34880150333055,
                7.488948280771167
              ],
              [
                146.3570412494243,
                7.477204522133145
              ],
              [
                146.36373604312547,
                7.472268645193664
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                146.33970345035203,
                7.465800859962105
              ],
              [
                146.3427933551372,
                7.4618861013619195
              ],
              [
                146.3486298419536,
                7.460184021477022
              ],
              [
                146.35824287906297,
                7.455758582793239
              ],
              [
                146.36304939761766,
                7.462566931461646
              ],
              [
                146.343480000645,
                7.473800475041547
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                146.31961906924852,
                7.482480742664405
              ],
              [
                146.32288063541063,
                7.473800475041547
              ],
              [
                146.32597054019578,
                7.471587830203672
              ],
              [
                146.3350685931743,
                7.483501939268681
              ],
              [
                146.30949104800828,
                7.512264660351761
              ],
              [
                146.3021096087993,
                7.508350318954503
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                146.29970634952195,
                7.511754096082043
              ],
              [
                146.30863274112352,
                7.517200084021616
              ],
              [
                146.31841743960985,
                7.520773976488433
              ],
              [
                146.3211640216411,
                7.525028572002962
              ],
              [
                146.29713142886766,
                7.535409609865829
              ],
              [
                146.2943848468364,
                7.525709303413054
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                149.0006947192076,
                7.021710799597492
              ],
              [
                149.2204212817076,
                6.705390948093039
              ],
              [
                149.43190809811384,
                6.81858119918456
              ],
              [
                149.4525074633482,
                7.096669254044974
              ],
              [
                149.2973255785826,
                7.209765225096019
              ],
              [
                149.1490101488951,
                7.363693789241601
              ],
              [
                149.2204212817076,
                7.479445614157156
              ],
              [
                149.1709828051451,
                7.6659455189550165
              ],
              [
                148.90456434811384,
                7.5175689291541845
              ],
              [
                148.8688587817076,
                7.164802714019137
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                147.83325493086883,
                7.903905096979439
              ],
              [
                148.06534111250946,
                7.922267993995674
              ],
              [
                148.0674010490329,
                8.061663143780962
              ],
              [
                147.84012138594696,
                8.004550891977896
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                149.61652711866762,
                8.5737052925902
              ],
              [
                149.8074145698395,
                8.747482159804878
              ],
              [
                150.00104860304262,
                8.866906828549062
              ],
              [
                150.03675416944887,
                8.864193060731735
              ],
              [
                150.06284669874574,
                8.884545830331154
              ],
              [
                150.06147340773012,
                8.919821285792986
              ],
              [
                150.05048707960512,
                8.961876027060429
              ],
              [
                150.13243403559258,
                9.005595666619032
              ],
              [
                150.20041194086602,
                9.00830838151443
              ],
              [
                150.24710383539727,
                8.943197617984357
              ],
              [
                150.29173579340508,
                8.986606092736936
              ],
              [
                150.20178523188164,
                9.111376405770397
              ],
              [
                149.56663813715508,
                8.699607948712902
              ],
              [
                149.51170649653008,
                8.569146780864209
              ],
              [
                149.6332427514129,
                8.472040243910461
              ],
              [
                149.7987243187957,
                8.463890324646298
              ],
              [
                149.85159602289727,
                8.5134663269586
              ],
              [
                149.79048457270196,
                8.557603940303833
              ],
              [
                149.66757502680352,
                8.529763886008729
              ],
              [
                149.64010920649102,
                8.54470270440819
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                150.21689143305352,
                8.53994950743823
              ],
              [
                150.1496001732879,
                8.515503559817505
              ],
              [
                150.2045318139129,
                8.462531987992714
              ],
              [
                150.26701655512383,
                8.508033652997126
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                150.40445802695774,
                8.704938969748593
              ],
              [
                150.48136232383274,
                8.57256217248389
              ],
              [
                150.54934022910618,
                8.601078018779534
              ],
              [
                150.4521798897507,
                8.755162051719108
              ],
              [
                150.3862619210007,
                8.729372664819401
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                151.87442735776807,
                8.582648273604748
              ],
              [
                151.97330431089307,
                8.573821740539204
              ],
              [
                152.04334215268995,
                8.619310135064053
              ],
              [
                152.11612657651807,
                8.65936254818153
              ],
              [
                152.17655138120557,
                8.793744458428915
              ],
              [
                152.10582689390088,
                8.862952527176763
              ],
              [
                151.85520128354932,
                8.607089908915396
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                152.64210752112012,
                6.934076490391379
              ],
              [
                152.77669004065137,
                6.910900732635922
              ],
              [
                152.70321897131544,
                6.813413826001633
              ],
              [
                152.6633935318623,
                6.698176492970459
              ],
              [
                152.75197080237012,
                6.685219105444005
              ],
              [
                152.94560483557325,
                6.90749243703821
              ],
              [
                152.62562802893262,
                7.179396194219454
              ],
              [
                152.40658811194044,
                7.012456611655118
              ],
              [
                152.57618955237012,
                6.742501791273028
              ],
              [
                152.668200050417,
                6.799095891094523
              ],
              [
                152.58786252600294,
                6.943619118320958
              ],
              [
                152.57824948889356,
                6.973608973385138
              ],
              [
                152.5576501236592,
                7.007004506577892
              ],
              [
                152.57618955237012,
                7.0329014369433205
              ],
              [
                152.6400475845967,
                6.9517983596461805
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                153.06939840252096,
                5.898032856211052
              ],
              [
                153.0007338517397,
                5.794205578011701
              ],
              [
                153.47589254314596,
                5.533187687037742
              ],
              [
                153.51571798259909,
                5.604261791647044
              ],
              [
                153.3059185771145,
                5.802059548975334
              ],
              [
                153.09855163375514,
                5.906568369630712
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                154.91576140685336,
                3.8818160264749677
              ],
              [
                154.95764678282993,
                3.8804458849320307
              ],
              [
                154.99266570372836,
                3.850987305492073
              ],
              [
                154.9665731744315,
                3.7338280577612837
              ],
              [
                154.98717253966586,
                3.707105320232801
              ],
              [
                155.169820244744,
                3.8441363266534068
              ],
              [
                155.00845855040805,
                4.020873692219618
              ],
              [
                154.8848623590018,
                3.916753882492982
              ],
              [
                154.90546172423618,
                3.88798163589441
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                158.04941305939005,
                6.762432702716621
              ],
              [
                157.9872691970189,
                6.746405245838298
              ],
              [
                158.02400717560099,
                6.622970616641561
              ],
              [
                158.15309653106974,
                6.5602168201297655
              ],
              [
                158.27531943146036,
                6.6979918495435955
              ],
              [
                158.07619223419474,
                6.775728954745063
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                157.69853720489786,
                6.988418650310181
              ],
              [
                157.68205771271036,
                6.9270756539754
              ],
              [
                157.80290732208536,
                6.871178418929044
              ],
              [
                157.87569174591349,
                6.969335021904548
              ],
              [
                157.73698935333536,
                7.032035443386041
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                162.79396005552778,
                5.332723340295067
              ],
              [
                162.7982515899516,
                5.298025928857004
              ],
              [
                162.82752201499983,
                5.225892834018174
              ],
              [
                162.92270608824262,
                5.254950570662815
              ],
              [
                162.83515878599653,
                5.350669508472552
              ],
              [
                162.80460306089887,
                5.34947311361991
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                155.12043567319458,
                7.572333061654162
              ],
              [
                155.1218089642102,
                7.589349162254122
              ],
              [
                155.15751453061645,
                7.639032317141603
              ],
              [
                155.17742725034302,
                7.6261016397457615
              ],
              [
                155.18566699643677,
                7.633587869062337
              ],
              [
                155.1705607952649,
                7.657406816854332
              ],
              [
                155.1327952923352,
                7.637671211624946
              ],
              [
                155.0497111858899,
                7.536937422094734
              ],
              [
                155.1657542767102,
                7.346296115758818
              ],
              [
                155.22480579038208,
                7.408944528241872
              ],
              [
                155.11768909116333,
                7.548509392466933
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                154.32812316926075,
                8.147727257090706
              ],
              [
                154.319883423167,
                8.059354655038554
              ],
              [
                154.26083190949512,
                7.99544242799165
              ],
              [
                154.3191967776592,
                7.941721211816329
              ],
              [
                154.4015942385967,
                8.046437037530994
              ],
              [
                154.37756164582325,
                8.180352219940946
              ],
              [
                154.35009582551075,
                8.16471975780968
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                132.30456113158274,
                4.332690076587462
              ],
              [
                132.31623410521556,
                4.338167522397546
              ],
              [
                132.3244738513093,
                4.320365678534387
              ],
              [
                132.3794054919343,
                4.294346847846234
              ],
              [
                132.4233508044343,
                4.4353855290891895
              ],
              [
                132.22834348021556,
                4.482620663282865
              ],
              [
                132.17272519408274,
                4.340906230409462
              ],
              [
                132.28945493041087,
                4.329951338801763
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                132.24418190215826,
                5.401316182873925
              ],
              [
                132.23388404227344,
                5.288165448902277
              ],
              [
                132.1597261295383,
                5.284920121581758
              ],
              [
                132.24143807453203,
                5.218000258171042
              ],
              [
                132.27233436797857,
                5.24201743034306
              ],
              [
                132.3008301565528,
                5.255350875559454
              ],
              [
                132.34958410963273,
                5.402166023927335
              ],
              [
                132.26718452666998,
                5.4102028743357335
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                131.17786161795195,
                3.0234786559198024
              ],
              [
                131.18335478201445,
                2.986450782720946
              ],
              [
                131.20979063406523,
                2.991936472715895
              ],
              [
                131.2080740202957,
                3.030335531236781
              ],
              [
                131.19056455984648,
                3.0310212163808257
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                134.1969388653358,
                6.941737954723254
              ],
              [
                134.12964760557017,
                6.866754672324752
              ],
              [
                134.08570229307017,
                6.898112762816723
              ],
              [
                134.05823647275767,
                6.834030983080868
              ],
              [
                134.16260658994517,
                6.746756889129249
              ],
              [
                134.26593706256648,
                6.8306167277888745
              ],
              [
                134.26697670713267,
                6.924015706807135
              ],
              [
                134.2189115215858,
                6.9458276095266145
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                134.49417960293889,
                8.400076060029948
              ],
              [
                134.52233115421882,
                8.269989365873583
              ],
              [
                134.58994843119964,
                8.210356876833577
              ],
              [
                134.70066211948927,
                8.286536344288923
              ],
              [
                134.7262657845795,
                8.406189525287683
              ],
              [
                134.73313223965764,
                8.50297316773774
              ],
              [
                134.47426688321232,
                8.481920550988432
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                137.37021197242046,
                8.26932059593678
              ],
              [
                137.35167254370953,
                8.219033920660943
              ],
              [
                137.49724139136578,
                8.174178262475893
              ],
              [
                137.51784075660015,
                8.259807391377846
              ],
              [
                137.40385760230328,
                8.290384731586581
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                137.48570003072047,
                8.662879671285294
              ],
              [
                137.48535670796656,
                8.651424543822998
              ],
              [
                137.50123538533472,
                8.651594251959192
              ],
              [
                137.4998620943191,
                8.66491610187321
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                138.0376312855609,
                9.451999408550328
              ],
              [
                138.04398275650817,
                9.476890138302974
              ],
              [
                138.04295278824645,
                9.482985552266367
              ],
              [
                138.0460426930316,
                9.490773979140652
              ],
              [
                138.05273748673278,
                9.502964204968084
              ],
              [
                138.05805898941833,
                9.511598685624199
              ],
              [
                138.06286550797302,
                9.518709270708856
              ],
              [
                138.0695603016742,
                9.530221332803256
              ],
              [
                138.07917333878356,
                9.549520094903796
              ],
              [
                138.08363653458434,
                9.55764556245437
              ],
              [
                138.09685446060973,
                9.576265693547535
              ],
              [
                138.1086990956195,
                9.588622126218796
              ],
              [
                138.1222603443988,
                9.607240557929597
              ],
              [
                138.12861181534606,
                9.617057136996124
              ],
              [
                137.9596746002601,
                9.616857915761857
              ],
              [
                137.93426871647102,
                9.47059530933423
              ],
              [
                137.9383885895179,
                9.395408284546605
              ],
              [
                137.98370719303352,
                9.345274521740677
              ],
              [
                138.06885123600227,
                9.35475984258465
              ],
              [
                138.20480704654915,
                9.406924476542127
              ],
              [
                138.13751578678352,
                9.447566791891608
              ],
              [
                138.07434440006477,
                9.422504596434994
              ],
              [
                138.03520560611946,
                9.411666326519088
              ],
              [
                138.02421927799446,
                9.440116059242575
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                134.22096338858492,
                6.971703193183574
              ],
              [
                134.2147835790146,
                6.997942848640983
              ],
              [
                134.2183669896808,
                7.006504459851405
              ],
              [
                134.21800222983248,
                7.00986947748941
              ],
              [
                134.21860303837275,
                7.012723297390947
              ],
              [
                134.2201479970444,
                7.015321549039148
              ],
              [
                134.2300828246012,
                7.020092017793693
              ],
              [
                134.23226082063502,
                7.022051311278992
              ],
              [
                134.23355634110015,
                7.024330054982216
              ],
              [
                134.2330494203937,
                7.025927306345833
              ],
              [
                134.23143473257906,
                7.029803303954764
              ],
              [
                134.23235740537345,
                7.031294051520849
              ],
              [
                134.2336234049349,
                7.031507017763983
              ],
              [
                134.23643436298497,
                7.03240145673055
              ],
              [
                134.24027529349215,
                7.0361921700430905
              ],
              [
                134.24025381848773,
                7.038023610174914
              ],
              [
                134.24383726706392,
                7.045221617475968
              ],
              [
                134.2440733103424,
                7.049438126070443
              ],
              [
                134.24439516653902,
                7.051652861961883
              ],
              [
                134.2449315961702,
                7.053090273441954
              ],
              [
                134.2441805642947,
                7.056742393205359
              ],
              [
                134.25040331473238,
                7.0642595456341315
              ],
              [
                134.24911585440523,
                7.069838745272689
              ],
              [
                134.24864372401092,
                7.074778967494791
              ],
              [
                134.25529566397555,
                7.088236849547162
              ],
              [
                134.26143250509722,
                7.093602794746379
              ],
              [
                134.2675694524277,
                7.099352015022356
              ],
              [
                134.26010218253023,
                7.107996958082079
              ],
              [
                134.2520769055706,
                7.102929281358757
              ],
              [
                134.24396601309664,
                7.095732163013819
              ],
              [
                134.2364129125107,
                7.095732163013819
              ],
              [
                134.2370995580185,
                7.102886666557181
              ],
              [
                134.23958864162105,
                7.105825071898979
              ],
              [
                134.24001780142672,
                7.111872224597884
              ],
              [
                134.2373141347397,
                7.116812077357151
              ],
              [
                134.23038351190823,
                7.123263584709348
              ],
              [
                134.2228572596298,
                7.133265420018834
              ],
              [
                134.22159655460885,
                7.132962026348563
              ],
              [
                134.21984758963472,
                7.134058559922357
              ],
              [
                134.22268000235445,
                7.143256418390202
              ],
              [
                134.22370996293435,
                7.1498139873070325
              ],
              [
                134.2241820394028,
                7.155221873950356
              ],
              [
                134.2221650182236,
                7.1671018557850275
              ],
              [
                134.21255198111422,
                7.19111635647916
              ],
              [
                134.21169367422945,
                7.1967365883053205
              ],
              [
                134.2092904149521,
                7.209339279248608
              ],
              [
                134.20705881705172,
                7.218876217726618
              ],
              [
                134.20242395987398,
                7.231818884007741
              ],
              [
                134.1970595418442,
                7.2400781548023145
              ],
              [
                134.19208136191256,
                7.245016615608554
              ],
              [
                134.19118013968355,
                7.247145245820978
              ],
              [
                134.1898926793564,
                7.252083629179514
              ],
              [
                134.18577280630953,
                7.258384246546322
              ],
              [
                134.1834553927537,
                7.26102366214246
              ],
              [
                134.1814812718857,
                7.264684775668782
              ],
              [
                134.1847428380478,
                7.274050263824876
              ],
              [
                134.18800440420992,
                7.274731382616973
              ],
              [
                134.19251051535494,
                7.274135403730395
              ],
              [
                134.1996344624985,
                7.271112927196078
              ],
              [
                134.20871132762585,
                7.262747870378867
              ],
              [
                134.22491160025484,
                7.251913340999647
              ],
              [
                134.2396744786728,
                7.250167883442909
              ],
              [
                134.24405181965383,
                7.252956340710995
              ],
              [
                134.24624052634127,
                7.258171389291319
              ],
              [
                134.2460903267537,
                7.262279497977854
              ],
              [
                134.24568262686617,
                7.2668558834903445
              ],
              [
                134.24392310706966,
                7.273432973378063
              ],
              [
                134.24396601309664,
                7.276604453965378
              ],
              [
                134.24430933585055,
                7.2835858328207195
              ],
              [
                134.23761454214937,
                7.295334737096475
              ],
              [
                134.2376574605804,
                7.297803665026205
              ],
              [
                134.23576918234713,
                7.302188122192856
              ],
              [
                134.23275721602033,
                7.303649973312484
              ],
              [
                134.22983104003416,
                7.308261768132794
              ],
              [
                134.22622615111814,
                7.310475231293802
              ],
              [
                134.21970301879392,
                7.314391331549404
              ],
              [
                134.2160981298779,
                7.325458385598727
              ],
              [
                134.21455317748533,
                7.331928228397863
              ],
              [
                134.21438151610838,
                7.336014396474935
              ],
              [
                134.21850138915522,
                7.3379723387177735
              ],
              [
                134.22394090912408,
                7.338472500002321
              ],
              [
                134.22783549255215,
                7.339483378822362
              ],
              [
                134.23244887603266,
                7.337589263739467
              ],
              [
                134.2385428628615,
                7.334907744436369
              ],
              [
                134.2427914739941,
                7.334567216237243
              ],
              [
                134.2476838050578,
                7.335631337642319
              ],
              [
                134.2516320349072,
                7.3382277218534115
              ],
              [
                134.25772597198673,
                7.341420002793474
              ],
              [
                134.26073008788572,
                7.346399904765392
              ],
              [
                134.27429133666502,
                7.368532145048595
              ],
              [
                134.2779391070666,
                7.374916227783602
              ],
              [
                134.2808144689892,
                7.377725212367288
              ],
              [
                134.28308896035114,
                7.378959470124229
              ],
              [
                134.28750926269038,
                7.381300242537472
              ],
              [
                134.30192881835447,
                7.386577615208458
              ],
              [
                134.3128722311352,
                7.3897695439047615
              ],
              [
                134.31782884939855,
                7.394685009566191
              ],
              [
                134.32085448516352,
                7.401898662537805
              ],
              [
                134.3246952382533,
                7.408495138875091
              ],
              [
                134.3383316008487,
                7.412772141440887
              ],
              [
                134.34261256469233,
                7.414367899920746
              ],
              [
                134.34527329851988,
                7.4188575704732
              ],
              [
                134.34604579223142,
                7.423347234440377
              ],
              [
                134.34570246947752,
                7.428624103802592
              ],
              [
                134.35171061767088,
                7.442922398955723
              ],
              [
                134.35703212035642,
                7.449050097094438
              ],
              [
                134.36235362304197,
                7.459943571064291
              ],
              [
                134.37711650145994,
                7.471857997685382
              ],
              [
                134.3853562475537,
                7.482580703843803
              ],
              [
                134.3844121339091,
                7.491345860105754
              ],
              [
                134.38175135863764,
                7.496494298645734
              ],
              [
                134.37625825122615,
                7.5008980539072265
              ],
              [
                134.37145167602048,
                7.506067614895987
              ],
              [
                134.36132365478025,
                7.516449106308547
              ],
              [
                134.3808930517529,
                7.537211344239554
              ],
              [
                134.39209395659907,
                7.535467014154311
              ],
              [
                134.41076213134275,
                7.528021623851554
              ],
              [
                134.4193452001904,
                7.548783307286248
              ],
              [
                134.4977115573443,
                7.6478916970983155
              ],
              [
                134.38930461796508,
                7.711610882804918
              ],
              [
                134.32973796142088,
                7.551846422152259
              ],
              [
                134.12649089110838,
                7.298215912926677
              ],
              [
                134.11859446776853,
                7.107559613364443
              ],
              [
                134.1662848528431,
                6.9757896332023455
              ],
              [
                134.1947806414173,
                6.948867135421273
              ],
              [
                134.25898199639778,
                6.951934333356101
              ],
              [
                134.33794622979622,
                6.957727874823747
              ],
              [
                134.38395147881965,
                6.995554532672491
              ],
              [
                134.37914496026497,
                7.038148451354347
              ],
              [
                134.31357031426887,
                7.036104032384417
              ],
              [
                134.3039572771595,
                7.033718865540034
              ],
              [
                134.29194098077278,
                7.03133368644474
              ],
              [
                134.2878211077259,
                7.028267009613113
              ],
              [
                134.22602301202278,
                6.964884503811603
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                134.40322934389343,
                7.988381464355865
              ],
              [
                134.43653165102234,
                7.909835957544396
              ],
              [
                134.48150693178405,
                7.9360194628548495
              ],
              [
                134.44271146059265,
                8.011500213659396
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                134.74929867983093,
                7.994161274559922
              ],
              [
                134.70569669008484,
                8.003000825886533
              ],
              [
                134.70535336733093,
                7.9887214554569494
              ],
              [
                134.697800266745,
                7.961521273664349
              ],
              [
                134.69608365297546,
                7.947580480129474
              ],
              [
                134.6984869122528,
                7.9390797638003585
              ],
              [
                134.70054684877624,
                7.9302388322383806
              ],
              [
                134.6984869122528,
                7.9193574248468215
              ],
              [
                134.6984869122528,
                7.9115362356937675
              ],
              [
                134.6871572613739,
                7.908475729977443
              ],
              [
                134.67926083803405,
                7.903034774858847
              ],
              [
                134.68578397035827,
                7.892832790727757
              ],
              [
                134.6878439068817,
                7.876509092419979
              ],
              [
                134.675827610495,
                7.8646059900385925
              ],
              [
                134.66346799135437,
                7.873108240910714
              ],
              [
                134.6380621075653,
                7.869027182253876
              ],
              [
                134.63119565248718,
                7.84624053361372
              ],
              [
                134.6263891339325,
                7.833656326467616
              ],
              [
                134.64767514467468,
                7.828894635375389
              ],
              [
                134.67050610780944,
                7.812568424453762
              ],
              [
                134.75187360048523,
                7.792499915825691
              ],
              [
                134.77624951601257,
                7.917997228701699
              ],
              [
                134.767323124411,
                7.967641472247128
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                144.92962532977702,
                13.62659224510819
              ],
              [
                145.03399544696452,
                13.685308893032886
              ],
              [
                144.83074837665202,
                13.830702828330526
              ],
              [
                144.12487679462077,
                12.998493095164806
              ],
              [
                144.43249398212077,
                12.833852221437512
              ],
              [
                144.75935333346203,
                13.168373609413397
              ],
              [
                145.11915557955578,
                13.488417252389393
              ],
              [
                145.01821868990734,
                13.563188578880396
              ],
              [
                144.95092743014172,
                13.533816929052067
              ],
              [
                144.91453521822766,
                13.509115235830622
              ],
              [
                144.8898159799464,
                13.489752660313876
              ],
              [
                144.8341976938136,
                13.442341111821417
              ],
              [
                144.8074185190089,
                13.425644670381534
              ],
              [
                144.78407257174328,
                13.386236465864734
              ],
              [
                144.77789276217297,
                13.358179235746388
              ],
              [
                144.77789276217297,
                13.302054992968806
              ],
              [
                144.7627865610011,
                13.263963277983594
              ],
              [
                144.7634732065089,
                13.236560281451215
              ],
              [
                144.62889068697766,
                13.225865592454262
              ],
              [
                144.63850372408703,
                13.245249370543165
              ],
              [
                144.6481167611964,
                13.261289950798487
              ],
              [
                144.65566986178234,
                13.277329472761705
              ],
              [
                144.65223663424328,
                13.293367935245762
              ],
              [
                144.64468353365734,
                13.326777990725903
              ],
              [
                144.63919036959484,
                13.331455030516544
              ],
              [
                144.62339752291516,
                13.339472602517596
              ],
              [
                144.63507049654797,
                13.34748990849984
              ],
              [
                144.63781707857922,
                13.354170793502666
              ],
              [
                144.63575714205578,
                13.37020416285683
              ],
              [
                144.64056366061047,
                13.380224477274409
              ],
              [
                144.65017669771984,
                13.390244374861323
              ],
              [
                144.65635650729016,
                13.40360358940765
              ],
              [
                144.6419369516261,
                13.412286680884087
              ],
              [
                144.61584442232922,
                13.44100543928097
              ],
              [
                144.63919036959484,
                13.46103974564835
              ],
              [
                144.62751739596203,
                13.473059524827779
              ],
              [
                144.67901580904797,
                13.467717475297443
              ],
              [
                144.6975552377589,
                13.483743265865268
              ],
              [
                144.71609466646984,
                13.481072375372463
              ],
              [
                144.72776764010266,
                13.487081836999145
              ],
              [
                144.75866668795422,
                13.489084957284891
              ],
              [
                144.7634732065089,
                13.500435654860029
              ],
              [
                144.78269928072766,
                13.514456359436252
              ],
              [
                144.79299896334484,
                13.519797363376322
              ],
              [
                144.79711883639172,
                13.543830399073192
              ],
              [
                144.83145111178234,
                13.592556596761547
              ],
              [
                144.83076446627453,
                13.625257606047892
              ],
              [
                144.82458465670422,
                13.633932625207974
              ],
              [
                144.85960357760266,
                13.66996390803206
              ],
              [
                144.91384857271984,
                13.617249613459414
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                145.38093840175358,
                14.15952596896615
              ],
              [
                145.4530361800739,
                14.313935181185602
              ],
              [
                145.06782805019108,
                14.32790665600882
              ],
              [
                145.02662931972233,
                14.09360379032458
              ],
              [
                145.1124600081989,
                14.102927276876748
              ],
              [
                145.13237272792546,
                14.166183712509113
              ],
              [
                145.19073759608952,
                14.185490064252063
              ],
              [
                145.2333096175739,
                14.208788643694419
              ],
              [
                145.35141264491764,
                14.18083006084818
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                145.53315187301902,
                14.86260220760904
              ],
              [
                145.5812170585659,
                14.870566135437551
              ],
              [
                145.59083009567527,
                14.857292759171964
              ],
              [
                145.5262854179409,
                14.825433329008334
              ],
              [
                145.48508668747215,
                14.76966804704774
              ],
              [
                145.51941896286277,
                14.712560192253827
              ],
              [
                145.62790895309715,
                14.701933824060559
              ],
              [
                145.7185461601284,
                14.798880221042412
              ],
              [
                145.72129274215965,
                14.873220712738629
              ],
              [
                145.6526281913784,
                14.907727243389246
              ],
              [
                145.6086828788784,
                14.942228242356988
              ],
              [
                145.58259034958152,
                14.9886631390336
              ],
              [
                145.57709718551902,
                15.035087962203216
              ],
              [
                145.60730958786277,
                15.081502683578451
              ],
              [
                145.66636110153465,
                15.143815083448805
              ],
              [
                145.69039369430809,
                15.14845463584412
              ],
              [
                145.69039369430809,
                15.165686368342888
              ],
              [
                145.6972601493862,
                15.186892726142476
              ],
              [
                145.7027533134487,
                15.194844561228253
              ],
              [
                145.69451356735496,
                15.218698267575217
              ],
              [
                145.6855871757534,
                15.241224287678943
              ],
              [
                145.73493715361022,
                15.26233766639723
              ],
              [
                145.7994818313446,
                15.312676151276822
              ],
              [
                145.84548708036803,
                15.296118773585473
              ],
              [
                145.83106752470397,
                15.243126376693779
              ],
              [
                145.85647340849303,
                15.220600560209482
              ],
              [
                145.81184145048522,
                15.10130616510047
              ],
              [
                145.89149232939147,
                15.087384108126852
              ],
              [
                146.01852174833678,
                15.296781093829031
              ],
              [
                145.76583620146178,
                15.396767372551283
              ],
              [
                145.35384889677428,
                15.085395168375957
              ],
              [
                145.37532311845533,
                14.90131108712652
              ],
              [
                145.42750817704908,
                14.814368029814382
              ],
              [
                145.5215786116194,
                14.863485203729216
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                145.6841612355902,
                17.310967077095437
              ],
              [
                145.6731749074652,
                16.780531987829153
              ],
              [
                146.1126280324652,
                16.7174104914706
              ],
              [
                146.1126280324652,
                17.379130904699856
              ],
              [
                145.7445860402777,
                17.400099289881844
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                151.8802163301127,
                7.686589838322096
              ],
              [
                151.98698970657753,
                7.606286140391217
              ],
              [
                152.0508477388041,
                7.657328377061501
              ],
              [
                151.89566585403847,
                7.771640745666347
              ],
              [
                151.88845607620644,
                7.705642729347139
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                158.02750372858205,
                6.9097457529498465
              ],
              [
                157.9478528496758,
                6.849074280578722
              ],
              [
                157.9588391778008,
                6.818735646073661
              ],
              [
                157.97806525201955,
                6.82350814308603
              ],
              [
                157.99832129450002,
                6.828962367138169
              ],
              [
                158.00621771783986,
                6.822826360710077
              ],
              [
                158.0141141411797,
                6.813622203669368
              ],
              [
                158.01548743219533,
                6.804076965320171
              ],
              [
                158.01823401422658,
                6.7948724486431145
              ],
              [
                158.02922034235158,
                6.77987211812285
              ],
              [
                158.05565619440236,
                6.782599485702615
              ],
              [
                158.11436438532033,
                6.805781486091493
              ],
              [
                158.11367773981252,
                6.818053856905024
              ],
              [
                158.11161780328908,
                6.831348570611924
              ],
              [
                158.11058783502736,
                6.841234143844518
              ],
              [
                158.1074979302422,
                6.847029039934487
              ],
              [
                158.10440802545705,
                6.8582777549245755
              ],
              [
                158.09925818414845,
                6.880433537515877
              ],
              [
                158.09273505182423,
                6.897816581805974
              ],
              [
                158.0796887871758,
                6.928831800527788
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                160.70070771917148,
                6.321520006027896
              ],
              [
                160.6995060895328,
                6.291831689580581
              ],
              [
                160.7731488202457,
                6.294902973523359
              ],
              [
                160.7738354657535,
                6.325956045095319
              ],
              [
                160.7192471478824,
                6.324249880727698
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                153.3939737037044,
                5.33410942789721
              ],
              [
                153.39534699472003,
                5.1214510814482805
              ],
              [
                153.59516083749347,
                5.264370937604384
              ],
              [
                153.46126496347003,
                5.338211446250065
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                153.85608613046222,
                5.542593507787868
              ],
              [
                153.87805878671222,
                5.497485065258092
              ],
              [
                153.9426034644466,
                5.535075672586507
              ],
              [
                153.90140473397784,
                5.589065268368665
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                149.48407301011449,
                6.324357015450005
              ],
              [
                149.49299940171605,
                6.262931372334972
              ],
              [
                149.56647047105199,
                6.262931372334972
              ],
              [
                149.5788300901926,
                6.335276367772841
              ],
              [
                149.52527174058324,
                6.335276367772841
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                131.81140217082114,
                3.065682861815997
              ],
              [
                131.69467243449301,
                3.0677398483482974
              ],
              [
                131.5841225077352,
                2.681645633223453
              ],
              [
                131.72763141886801,
                2.573955665939535
              ],
              [
                132.00915607707114,
                2.8380191779026522
              ],
              [
                131.87594684855551,
                2.9491139095747214
              ],
              [
                131.82788166300864,
                2.873680399055884
              ],
              [
                131.83337482707114,
                2.8373333743602327
              ],
              [
                131.7708900858602,
                2.775609401455778
              ],
              [
                131.7097786356649,
                2.781781945001597
              ],
              [
                131.71939167277426,
                2.896996749818911
              ],
              [
                131.8141487528524,
                3.0423700720002866
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                131.024794003098,
                3.0795773185176976
              ],
              [
                130.9853118863988,
                2.9791243346489327
              ],
              [
                131.06633605632067,
                2.944152187252728
              ],
              [
                131.11062469157457,
                3.052836481227891
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                131.9747710635339,
                4.673562869939569
              ],
              [
                131.9153762271081,
                4.575007793788624
              ],
              [
                131.97133783599483,
                4.553104813099116
              ],
              [
                132.0523620059167,
                4.672194143658849
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    notReef_mask = 
    /* color: #00ff49 */
    /* shown: false */
    ee.Geometry.MultiPoint(),
    region_extent = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[131.35974185737638, 1.7944113553701195],
          [132.41442935737638, 2.23359193856174],
          [136.72106998237638, 7.050282688863173],
          [140.14880435737638, 6.0898466203563935],
          [150.34411685737638, 4.427012035038513],
          [154.83075680576678, 0.6938588322719602],
          [163.40009274326678, 4.950400383100129],
          [163.35614743076678, 5.781694731510697],
          [154.87781485826304, 9.089975885436523],
          [148.28601798326304, 10.129848046486977],
          [146.16135851771367, 19.87611308798013],
          [144.47343529849502, 19.88044496968265],
          [136.21171654849502, 11.512377845112747],
          [132.25663842349502, 6.653751544824428],
          [130.82989775320527, 3.512109058412099],
          [130.82989775320527, 2.8320043460866122]]]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
// Viewing script for looking at reefs and classifications for each region. 
// From this region Timor Sea onwards the map_viewer script is going to be used from the very beginning 
// in the workflow 

//Viewer for west Micronesia

// Load and libraries needed
var map_palettes = require('users/mitchest/global_reefs_modules:colour_pals');
var param_module = require('users/mitchest/global_reefs_modules:reef_params');
var pkg_vis = require('users/mitchest/global_reefs_modules:pkg_vis');

// ###########################################
// SENSOR GENERICS
var sensor_params = param_module.dove ;      //<------------ THIS IS WHERE YOU CHOOSE THE SENSOR
// REGION AND SENSOR SPECIFIC LOAD PATHS
var region_params = param_module.wmic;       //<------------ THIS IS WHERE YOU CHOOSE THE REGION
//  ^^ all the data paths are in this module ^^
// ###########################################



// Choose which layers will be shown in the map viewer
var vars = {
  raw: true, // set to true if you want to view the raw classifications for benthic and geo
  geo_cleanup_stage: 3, // set to 0, 1, 2 or 3 - this controls the display of the geo clean stages (0 = cleanup not ready)
  benthic_cleanup_stage: 2, // set to 0, 1 or 2 - this controls the display of the benthic clean stages (0 = cleanup not ready)
};

// choose where to centre the map (link this dynamically to map app?)
Map.centerObject(centre_map, 10);

// Add low-tide base map to viewer
// var low_tide_image = ee.Image(region_params.pixels);
// Map.addLayer(low_tide_image, {bands: ['b3','b2','b1'], min: 0, max: 3000}, sensor_params.sname + " from stack", false); // image data

//print (region_params.image[0])
var low_tide_image_dove = ee.Image(region_params.pixels);
Map.addLayer(low_tide_image_dove, {bands: ['b3','b2','b1'], min: 0, max: 3000}, sensor_params.sname + ' low tide', false); // image data


// V1 maps
Map.addLayer(ee.Image("ACA/reef_habitat/v1_0").select('geomorphic').selfMask(), map_palettes.geo, 'Geomorphic - V1', false);
Map.addLayer(ee.Image("ACA/reef_habitat/v1_0").select('benthic').selfMask(), map_palettes.benthic, 'Benthic - V1', false);


// Load the raw classifications
if (vars.raw) {
// geo raw (test if more than one map exists for the region)
  if (ee.List(region_params.geo_map).length().getInfo() > 1) {
    var geo_map_raw = ee.Image(region_params.geo_map[0]).unmask(0, false)
                 .add(ee.Image(region_params.geo_map[1]).unmask(0, false))
                 .selfMask();
  } else {
    var geo_map_raw = ee.Image(region_params.geo_map);
  }

  // benthic raw (test if more than one map exists for the region)
  if (ee.List(region_params.benthic_map).length().getInfo() > 1) {
    var benthic_map_raw = ee.Image(region_params.benthic_map[0]).unmask(0, false)
                     .add(ee.Image(region_params.benthic_map[1]).unmask(0, false))
                     .selfMask();
  } else {
      var benthic_map_raw = ee.Image(region_params.benthic_map);
  }

  // Add the raw region classification to the viewer
  Map.addLayer(geo_map_raw, map_palettes.geo, 'Geomorphic RAW', false);
  Map.addLayer(benthic_map_raw.updateMask(geo_map_raw.gt(2)), map_palettes.benthic, 'Benthic RAW', false);
}

// Add geo clean stage 1 to the viewer
if (vars.geo_cleanup_stage >= 1) {
  Map.addLayer(ee.Image(region_params.geo_map_clean1), map_palettes.geo, 'Geomorphic - stage 1 clean', false);
  }

// Add geo clean stage 2 to the viewer
if (vars.geo_cleanup_stage >= 2) {
  Map.addLayer(ee.Image(region_params.geo_map_clean2), map_palettes.geo, 'Geomorphic - stage 2 clean', false);
}

// Add geo clean stage 3 to the viewer
if (vars.geo_cleanup_stage >= 3) {
  var geo_map_clean3 = ee.Image(region_params.geo_map_clean3)
  Map.addLayer(geo_map_clean3.updateMask(geo_map_clean3.gt(2)), map_palettes.geo, 'Geomorphic - stage 3 clean', true);
}

// Add benthic clean stage 1 to the viewer
if (vars.benthic_cleanup_stage >= 1) {
  Map.addLayer(ee.Image(region_params.benthic_map_clean1), map_palettes.benthic, 'Benthic - stage 1 clean', false);
  }

// Add geo clean stage 2 to the viewer
if (vars.benthic_cleanup_stage == 2) {
  Map.addLayer(ee.Image(region_params.benthic_map_clean2), map_palettes.benthic, 'Benthic - stage 2 clean', false);
}

// Geo Training Data - Needs more work + add flag to show
var geo_train = ee.FeatureCollection(region_params.geo_train_library);

var geo_buff = function(feature) {
 return feature.buffer(20);   // substitute in your value of Z herere
};

var geo_train_buff = geo_train.map(geo_buff);

// Create an empty image into which to paint the features, cast to byte.
var empty = ee.Image().byte();

// Paint the interior of the polygons with different colors.
var geo_fill = empty.paint({
  featureCollection: geo_train_buff,
  color: 'class_num',
});

//Map.addLayer(geo_fill, map_palettes.geo, 'Geo Training Data', false);
var wcmc = ee.FeatureCollection("projects/coral_atlas/global_datasets/wcmc_reefs_2018v4_filtered").filterBounds(region_extent);
Map.addLayer(wcmc, {color:'#ffff00'}, "WCMC layer", false);

// add global masks 
Map.addLayer(ee.Image("ACA/reef_habitat/v1_0").select("reef_mask"), {min:0, max:1}, "Global mask", false);
Map.addLayer(ee.FeatureCollection("projects/coral_atlas/global_datasets/global_lagoons_mask"), {}, "Global lagoons mask", false);


////////// UI SET UP //////////

//Generate title
var title = ui.Label({
  value: 'Coral Atlas map classes',
  style: {fontWeight: 'bold', fontSize: '14px'}
});

// generate the legend
var geo_legend = pkg_vis.discrete_legend(map_palettes.geo_atlas_names, map_palettes.geo_atlas_cols, 'Geomorphic Zone', false);
var benthic_legend = pkg_vis.discrete_legend(map_palettes.benthic_atlas_names, map_palettes.benthic_atlas_cols, 'Benthic Habitat', false);
//var mask_legend = pkg_vis.discrete_legend(["Low confidence depth","Water conditions"], ["#f7f7f7","#bababa"], 'Confidence Mask reason', false)
pkg_vis.add_lgds([title, geo_legend, benthic_legend]);//, mask_legend])
// generate the legend



////////// MASK EXPORTS //////////


Export.table.toAsset({
  collection: ee.FeatureCollection(region_extent),
  description: "region_extent_export",
  assetId: region_params.asset + 'in_out/' + region_params.sname + '_extent'
})

/*Export.table.toAsset({
  collection: ee.FeatureCollection(notReef_mask),
  description: "not_reef_mask_export",
  assetId: region_params.asset + 'in_out/' +  region_params.sname + '_notreef'
})*/

Export.table.toAsset({
  collection: ee.FeatureCollection(mid_mask),
  description: "mid_mask_export",
  assetId: region_params.asset + 'in_out/' +  region_params.sname + '_midmask'
})

