/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var land_dist = ee.Image("projects/coral_atlas/global_datasets/mod44w6_global_distToLand"),
    imageVisParam = {"opacity":1,"bands":["depth"],"min":1500,"max":2500,"gamma":1},
    depth_pal = {"opacity":1,"bands":["depth"],"max":5,"palette":["e4e1ff","7f89ff","3a52ff","0007ff","000258"]},
    benthic = ee.Image("projects/coral_atlas/Andaman_sea/in_out/andm_benthic"),
    geo = ee.Image("projects/coral_atlas/Andaman_sea/in_out/andm_geo"),
    pixels = ee.Image("projects/coral_atlas/Andaman_sea/in_out/andm_pixels"),
    southasia_dove = ee.Image("projects/coral_atlas/workflow/mapping/south_asia/south_asia_low_tide_normalized_sr_may2018_may2020_v2_shift_mosaic/20200526T213437Z/south_asia_low_tide_normalized_sr_may2018_may2020_v2_shift_mosaic"),
    wcmc = ee.FeatureCollection("projects/coral_atlas/global_datasets/wcmc_reefs_2018v4_filtered"),
    reef_boundary = 
    /* color: #d69d40 */
    /* shown: false */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[90.2347830552545, 21.971185910352975],
          [90.2347830552545, 1.5243019898904366],
          [103.94572055525448, 1.5243019898904366],
          [103.94572055525448, 21.971185910352975]]], null, false),
    not_reef = /* color: #d63000 */ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                94.09109703919786,
                15.733448346326067
              ],
              [
                94.13263909242052,
                15.686187125648821
              ],
              [
                94.15598503968614,
                15.68023738426514
              ],
              [
                94.1813909234752,
                15.699077636699126
              ],
              [
                94.20027367494005,
                15.72188192837816
              ],
              [
                94.21503655335802,
                15.725847631459953
              ],
              [
                94.26275841615099,
                15.835204413268006
              ],
              [
                94.26584832093614,
                15.84214046463901
              ],
              [
                94.2631017389049,
                15.855681592454987
              ],
              [
                94.26756493470567,
                15.869882286608888
              ],
              [
                94.28404442689317,
                15.876486919780298
              ],
              [
                94.2857610406627,
                15.871533465196691
              ],
              [
                94.28644768617052,
                15.859974931040837
              ],
              [
                94.26413170716661,
                15.831901447948411
              ],
              [
                94.21743981263536,
                15.723534314053536
              ],
              [
                94.2143499078502,
                15.694119844260944
              ],
              [
                94.15046645654691,
                15.45894224981689
              ],
              [
                94.27131606592191,
                15.225856920532353
              ],
              [
                94.88105727685941,
                14.944752323700595
              ],
              [
                95.69953872217191,
                14.92882966094028
              ],
              [
                97.01240493310941,
                14.711102172322283
              ],
              [
                97.58369399560941,
                14.541017286257746
              ],
              [
                97.70610393230112,
                14.436741286978643
              ],
              [
                97.75760234538706,
                14.467992382108076
              ],
              [
                97.7768284196058,
                14.471316708056587
              ],
              [
                97.7884950258869,
                14.429634464481294
              ],
              [
                97.78780838037909,
                14.410681589596535
              ],
              [
                97.78695007349432,
                14.395551383935008
              ],
              [
                97.80153005597514,
                14.34993644379455
              ],
              [
                97.79672353742045,
                14.315342218457458
              ],
              [
                97.79191701886576,
                14.288727647729356
              ],
              [
                97.80290334699076,
                14.288062243092005
              ],
              [
                97.81114309308451,
                14.298043105959746
              ],
              [
                97.82281606671732,
                14.286731427913253
              ],
              [
                97.81938283917826,
                14.26410636607746
              ],
              [
                97.81114309308451,
                14.242810115101893
              ],
              [
                97.80221670148295,
                14.217518207377598
              ],
              [
                97.79741018292826,
                14.19355484303154
              ],
              [
                97.79989397398157,
                14.190651468753622
              ],
              [
                97.8045288311593,
                14.185242650460248
              ],
              [
                97.80907785764856,
                14.18682370300518
              ],
              [
                97.81903421751184,
                14.192981381464485
              ],
              [
                97.82341158262415,
                14.192814959922588
              ],
              [
                97.82590067258997,
                14.188487956926991
              ],
              [
                97.82555734983606,
                14.184909795887657
              ],
              [
                97.82281076780481,
                14.181081933176012
              ],
              [
                97.82015001646204,
                14.180499426663074
              ],
              [
                97.81877672544641,
                14.178169385647923
              ],
              [
                97.8177467571847,
                14.173925320862123
              ],
              [
                97.8155151592843,
                14.165686615526958
              ],
              [
                97.81457102171106,
                14.16169198408123
              ],
              [
                97.81328356138391,
                14.158612741043955
              ],
              [
                97.81130945554895,
                14.154534760336812
              ],
              [
                97.81473148449508,
                14.143850856789035
              ],
              [
                97.81764404677544,
                14.135330620882536
              ],
              [
                97.8236521949688,
                14.128339036112129
              ],
              [
                97.82227890395318,
                14.123011970234284
              ],
              [
                97.81798736952935,
                14.119016589041069
              ],
              [
                97.81163589858208,
                14.110526171337073
              ],
              [
                97.80150787734185,
                14.103533825144469
              ],
              [
                97.78039359114425,
                14.070900740705866
              ],
              [
                97.7941265013005,
                14.04825415306905
              ],
              [
                97.8270854856755,
                13.97896834688147
              ],
              [
                97.86828421614425,
                13.94565043081375
              ],
              [
                97.90124320051925,
                13.953647169905832
              ],
              [
                97.92184256575362,
                13.953647169905832
              ],
              [
                97.92057240786679,
                13.896178855264285
              ],
              [
                97.92022908511288,
                13.885680468877123
              ],
              [
                97.92263234439022,
                13.875181606927278
              ],
              [
                97.92812550845272,
                13.864848929601594
              ],
              [
                97.9293271380914,
                13.854015790152655
              ],
              [
                97.92881215396054,
                13.847348991684113
              ],
              [
                97.93293202700741,
                13.841515386158168
              ],
              [
                97.92915547671444,
                13.83151457908892
              ],
              [
                97.92812550845272,
                13.822180104710235
              ],
              [
                97.92555058779843,
                13.813178650049416
              ],
              [
                97.91765416445858,
                13.7941744374813
              ],
              [
                97.91748250308163,
                13.784505033424445
              ],
              [
                97.9216023761285,
                13.780170343005373
              ],
              [
                97.9216023761285,
                13.76866635161251
              ],
              [
                97.87752689585007,
                13.773050467950945
              ],
              [
                97.86379398569382,
                13.887729386473401
              ],
              [
                97.81160892710007,
                13.954377127777196
              ],
              [
                97.72371830210007,
                13.975700341686306
              ],
              [
                97.67977298960007,
                14.132897874547607
              ],
              [
                97.72921146616257,
                14.3245850199133
              ],
              [
                97.62209476694382,
                14.4629240942178
              ],
              [
                97.46279300913132,
                14.521426289039512
              ],
              [
                97.11672367319382,
                14.51344962657249
              ],
              [
                97.19088138803757,
                13.722360430280009
              ],
              [
                97.38863529428757,
                13.244274398213838
              ],
              [
                97.81160892710007,
                13.18812382599196
              ],
              [
                98.15218509897507,
                13.217537642273655
              ],
              [
                98.22908939585007,
                13.23892728174591
              ],
              [
                98.2534538404951,
                13.229559018826176
              ],
              [
                98.26718675065135,
                13.206497348719815
              ],
              [
                98.27508317399119,
                13.184436321413514
              ],
              [
                98.27748643326854,
                13.163041909529328
              ],
              [
                98.29362260270213,
                13.107207074328466
              ],
              [
                98.30220567154979,
                13.097844303277313
              ],
              [
                98.33447801041697,
                13.086140338879149
              ],
              [
                98.3361946241865,
                13.074770241278094
              ],
              [
                98.32692490983104,
                13.047680545236473
              ],
              [
                98.32314835953807,
                13.030622546631585
              ],
              [
                98.31490861344432,
                12.97040846026203
              ],
              [
                98.3083854811201,
                12.929588397611177
              ],
              [
                98.32095500562252,
                12.86827122238279
              ],
              [
                98.32747813794674,
                12.837142183783047
              ],
              [
                98.31649180982174,
                12.843502193418585
              ],
              [
                98.31305858228268,
                12.858899444780612
              ],
              [
                98.30722209546627,
                12.876973273749554
              ],
              [
                98.29177257154049,
                12.923156022701077
              ],
              [
                98.2485139045483,
                12.943902015381486
              ],
              [
                98.2155549201733,
                12.950259312833673
              ],
              [
                98.20353862378659,
                12.92984846687055
              ],
              [
                98.19804545972409,
                12.904081573023861
              ],
              [
                98.13250750171925,
                12.908428221690327
              ],
              [
                98.05560320484425,
                12.901735203729237
              ],
              [
                97.96084612476612,
                12.864250995898296
              ],
              [
                97.8935548650005,
                12.838812092511178
              ],
              [
                97.89630144703175,
                12.787926567301593
              ],
              [
                97.88531511890675,
                12.720956304119994
              ],
              [
                97.88119524585987,
                12.6579881386003
              ],
              [
                97.89492815601612,
                12.60840651518299
              ],
              [
                97.87570208179737,
                12.601705558786287
              ],
              [
                97.89218157398487,
                12.564176967603174
              ],
              [
                97.87982195484425,
                12.540048550384842
              ],
              [
                97.89492815601612,
                12.498488757918915
              ],
              [
                97.866089044688,
                12.464967927062046
              ],
              [
                97.855102716563,
                12.43278385026841
              ],
              [
                97.88119524585987,
                12.41266677745308
              ],
              [
                97.92514055835987,
                12.40998438355831
              ],
              [
                98.05148333179737,
                12.463627003572391
              ],
              [
                98.162719904063,
                12.664687619819802
              ],
              [
                98.2231447087505,
                12.68612477640401
              ],
              [
                98.32888811695362,
                12.785248097233724
              ],
              [
                98.35910051929737,
                12.777212516567156
              ],
              [
                98.371460138438,
                12.707560127640638
              ],
              [
                98.38519304859425,
                12.664687619819802
              ],
              [
                98.36871355640675,
                12.637888639660103
              ],
              [
                98.30142229664112,
                12.624488095168571
              ],
              [
                98.27670305835987,
                12.624488095168571
              ],
              [
                98.25335711109425,
                12.671386925014062
              ],
              [
                98.23687761890675,
                12.65530829684492
              ],
              [
                98.22589129078175,
                12.623148002097215
              ],
              [
                98.18677525796166,
                12.60438596237472
              ],
              [
                98.14420323647728,
                12.58428225240241
              ],
              [
                98.1290970353054,
                12.544070110329441
              ],
              [
                98.15244298257103,
                12.517258525294158
              ],
              [
                98.18677525796166,
                12.478376780300954
              ],
              [
                98.18128209389916,
                12.442171284857855
              ],
              [
                98.1675491837429,
                12.400595787346315
              ],
              [
                98.12772374428978,
                12.392548149915845
              ],
              [
                98.09476475991478,
                12.354989226909348
              ],
              [
                98.05367277756345,
                12.302874620986497
              ],
              [
                98.03032683029782,
                12.241146733763994
              ],
              [
                98.06465910568845,
                12.202223905180713
              ],
              [
                98.08113859787595,
                12.159267941009452
              ],
              [
                98.0289535392822,
                12.108248721373151
              ],
              [
                98.03856657639157,
                12.051847717859397
              ],
              [
                98.0399398674072,
                11.944384479081597
              ],
              [
                98.02758024826657,
                11.869134810904002
              ],
              [
                98.02620695725095,
                11.831502177766188
              ],
              [
                98.04268644943845,
                11.830158059282732
              ],
              [
                98.06877897873532,
                11.850319142639902
              ],
              [
                98.09349821701657,
                11.846287044968504
              ],
              [
                98.09899138107907,
                11.781765400612795
              ],
              [
                98.0948715080322,
                11.723951886223734
              ],
              [
                98.09075163498532,
                11.676885432798862
              ],
              [
                98.1003646720947,
                11.648641722684738
              ],
              [
                98.11959074631345,
                11.615014516073298
              ],
              [
                98.13161142777176,
                11.554137264060657
              ],
              [
                98.17795561447751,
                11.530928774028336
              ],
              [
                98.21160124436032,
                11.641916606462717
              ],
              [
                98.23082731857907,
                11.654021698502742
              ],
              [
                98.2706527580322,
                11.625775664132235
              ],
              [
                98.2651595939697,
                11.46296909162726
              ],
              [
                98.29125212326657,
                11.405089540084111
              ],
              [
                98.3036117424072,
                11.304108634484903
              ],
              [
                98.2981185783447,
                11.19635644950406
              ],
              [
                98.27889250412595,
                11.174801185694541
              ],
              [
                98.23906706467282,
                11.150549599044474
              ],
              [
                98.30086516037595,
                11.065653138264423
              ],
              [
                98.32833098068845,
                11.031957236355929
              ],
              [
                98.32833098068845,
                11.003649692274218
              ],
              [
                98.30635832443845,
                10.999605535232755
              ],
              [
                98.26378630295407,
                11.057566474793298
              ],
              [
                98.21160124436032,
                11.073739578529603
              ],
              [
                98.1827621330322,
                11.023869644527936
              ],
              [
                98.17589567795407,
                10.979383918138094
              ],
              [
                98.26241301193845,
                10.835096358085597
              ],
              [
                98.3200912345947,
                10.756855273673601
              ],
              [
                98.35717009201657,
                10.685341353449582
              ],
              [
                98.37090300217282,
                10.652952143567546
              ],
              [
                98.3640365470947,
                10.607061535755538
              ],
              [
                98.34069059982907,
                10.578713895797238
              ],
              [
                98.2918228652383,
                10.523781354704576
              ],
              [
                98.30967564844143,
                10.442759273114936
              ],
              [
                98.3137955214883,
                10.364417848222867
              ],
              [
                98.35499425195705,
                10.297415181908914
              ],
              [
                98.3797134902383,
                10.25282337261239
              ],
              [
                98.37284703516018,
                10.094674729053008
              ],
              [
                98.29456944726955,
                9.998666201925039
              ],
              [
                98.28619695568449,
                9.880852518237386
              ],
              [
                98.34112859630949,
                9.815905931813456
              ],
              [
                98.43451238537199,
                9.875440791265538
              ],
              [
                98.49631048107511,
                9.880852518237386
              ],
              [
                98.72565008068449,
                9.909262623059979
              ],
              [
                98.92340398693449,
                9.891675705036358
              ],
              [
                99.06585265140608,
                12.751756662347935
              ],
              [
                98.31878233890608,
                15.796437009383085
              ],
              [
                98.16497374515608,
                16.913843182084616
              ],
              [
                96.8465310497674,
                17.998706208070473
              ],
              [
                95.17669249515608,
                16.892819817687297
              ],
              [
                94.36370421390608,
                16.282133563690067
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                98.28875334151691,
                9.88263671605484
              ],
              [
                98.25716764815753,
                9.818367069890545
              ],
              [
                98.20635588057941,
                9.768972437991064
              ],
              [
                98.14661772139972,
                9.691144116065262
              ],
              [
                98.04871086811562,
                9.491390401430104
              ],
              [
                97.98965935444375,
                9.271893100778485
              ],
              [
                97.99103264545937,
                9.152602224369545
              ],
              [
                98.01712517475625,
                9.080737236519171
              ],
              [
                98.13934807514687,
                9.016995849072925
              ],
              [
                98.20251946186562,
                8.973591012817511
              ],
              [
                98.22174553608437,
                8.955956313355287
              ],
              [
                98.234105155225,
                8.934250893725997
              ],
              [
                98.22998528217812,
                8.896263300518692
              ],
              [
                98.19153313374062,
                8.875911181256285
              ],
              [
                98.1077623817875,
                8.86098557609556
              ],
              [
                97.98965935444375,
                8.837917539792628
              ],
              [
                97.95670037006875,
                8.721198358457286
              ],
              [
                97.95120720600625,
                8.631598403099487
              ],
              [
                98.16406731342812,
                8.656036873477472
              ],
              [
                98.22586540913125,
                8.685903959733382
              ],
              [
                98.23547844624062,
                8.664182677867782
              ],
              [
                98.24097161030312,
                8.626167416853235
              ],
              [
                98.26019768452187,
                8.590864104765672
              ],
              [
                98.22723870014687,
                8.56098950395976
              ],
              [
                98.18878655170937,
                8.555557506170537
              ],
              [
                98.15994744038125,
                8.384410165715863
              ],
              [
                98.23685173725625,
                8.188720986564299
              ],
              [
                98.25338683598491,
                8.1464127273116
              ],
              [
                98.26608977787944,
                8.12194217878376
              ],
              [
                98.29218230717632,
                8.111065900394246
              ],
              [
                98.32891784184429,
                8.113105225017607
              ],
              [
                98.37728658365077,
                8.07378287436696
              ],
              [
                98.4171120231039,
                8.079221553710479
              ],
              [
                98.44320455240077,
                8.08058121209791
              ],
              [
                98.47616353677577,
                8.06698442220795
              ],
              [
                98.50088277505702,
                8.03163063002967
              ],
              [
                98.5379616324789,
                7.936432079444191
              ],
              [
                98.56268087076015,
                7.937792214645813
              ],
              [
                98.56268087076015,
                7.956833634413586
              ],
              [
                98.56680074380702,
                8.001713477837239
              ],
              [
                98.6038796012289,
                8.018032197238576
              ],
              [
                98.76730123208827,
                8.035710071100935
              ],
              [
                98.8290993277914,
                7.982674146164554
              ],
              [
                98.81399312661952,
                7.922830479981754
              ],
              [
                98.80026021646327,
                7.838490562331474
              ],
              [
                98.82772603677577,
                7.731000438878468
              ],
              [
                98.8785378043539,
                7.649344054078905
              ],
              [
                98.96047772085721,
                7.549520484153332
              ],
              [
                98.91103924429471,
                7.383399608212374
              ],
              [
                98.96185101187284,
                7.290780457867688
              ],
              [
                99.07171429312284,
                7.327558015376026
              ],
              [
                99.14175213491971,
                7.448766167542537
              ],
              [
                99.19668377554471,
                7.462382976476771
              ],
              [
                99.24474896109159,
                7.42425484571609
              ],
              [
                99.28457440054471,
                7.40246585678119
              ],
              [
                99.31066692984159,
                7.38476151040134
              ],
              [
                99.30242718374784,
                7.342540595334171
              ],
              [
                99.26534832632596,
                7.2839694671545026
              ],
              [
                99.26946819937284,
                7.241739018498298
              ],
              [
                99.30105389273221,
                7.213129046436801
              ],
              [
                99.33675945913846,
                7.237651990603825
              ],
              [
                99.37246502554471,
                7.247188331395104
              ],
              [
                99.41091717398221,
                7.233564925684745
              ],
              [
                99.41091717398221,
                7.21585388369498
              ],
              [
                99.33126629507596,
                7.1545410884665985
              ],
              [
                99.38482464468534,
                7.125925627645656
              ],
              [
                99.43978230210722,
                7.141847911639146
              ],
              [
                99.46999470445097,
                7.080525183083854
              ],
              [
                99.4878474876541,
                7.043727627883744
              ],
              [
                99.49059406968534,
                6.990570452050379
              ],
              [
                99.50020710679472,
                6.9278644745530364
              ],
              [
                99.5482722923416,
                6.926501208240948
              ],
              [
                99.5867244407791,
                6.900598400478361
              ],
              [
                99.60457722398222,
                6.8665136001803075
              ],
              [
                99.60732380601347,
                6.835153426930449
              ],
              [
                99.72268025132597,
                6.746515756713307
              ],
              [
                99.69933430406034,
                6.679685853314214
              ],
              [
                99.69933430406034,
                6.6292164019034
              ],
              [
                99.73229328843534,
                6.445027573728057
              ],
              [
                99.7954646751541,
                6.488693268399135
              ],
              [
                99.84902302476347,
                6.498244635490301
              ],
              [
                99.91219441148222,
                6.464131779222771
              ],
              [
                99.93416706773222,
                6.431381271966836
              ],
              [
                99.92455403062284,
                6.353590378799301
              ],
              [
                99.94240681382597,
                6.320832791504552
              ],
              [
                99.9437801048416,
                6.30035824523497
              ],
              [
                99.8833553001541,
                6.2457555127976265
              ],
              [
                99.8558894798416,
                6.158379314459688
              ],
              [
                99.88428678411502,
                6.071891194625445
              ],
              [
                99.98591031927127,
                6.052772640574602
              ],
              [
                100.0641879071619,
                6.1005677526995665
              ],
              [
                100.1026400555994,
                6.040481784187257
              ],
              [
                100.06556119817752,
                5.961267374674438
              ],
              [
                100.16993131536502,
                5.813734318202781
              ],
              [
                100.28116788763064,
                5.827396426553401
              ],
              [
                100.30863370794314,
                5.819199201390491
              ],
              [
                100.28666105169314,
                5.703059082703872
              ],
              [
                100.39103116888064,
                5.659329625601617
              ],
              [
                100.7782992352869,
                5.590995736638626
              ],
              [
                100.87626103442342,
                5.904010631562902
              ],
              [
                99.34896432285977,
                8.279944124543295
              ],
              [
                98.77218209629727,
                9.955821478000098
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                100.29991446446982,
                5.704829222817308
              ],
              [
                100.25596915196982,
                5.59003270528241
              ],
              [
                99.74510489415732,
                5.442404161809887
              ],
              [
                99.75059805821982,
                4.70921180466154
              ],
              [
                99.87694083165732,
                4.013604492411981
              ],
              [
                100.19005118321982,
                3.268047269229756
              ],
              [
                100.60203848790732,
                2.7030216183687044
              ],
              [
                101.38756094884482,
                2.615225640178804
              ],
              [
                101.87095938634482,
                3.4983579108027
              ],
              [
                100.90965567540732,
                5.2509800190266365
              ],
              [
                100.71739493321982,
                5.682964976637016
              ]
            ]
          ],
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    mid_mask = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                91.7229667394585,
                21.133848007785446
              ],
              [
                91.95854511501604,
                20.4828980531498
              ],
              [
                92.21535053493791,
                20.58192398288816
              ],
              [
                92.30873432400041,
                20.651332438371067
              ],
              [
                92.33345356228166,
                20.641051700864672
              ],
              [
                92.36229267360979,
                20.590923159116908
              ],
              [
                92.46803608181291,
                20.39796775770922
              ],
              [
                92.57327049589479,
                20.206816239163867
              ],
              [
                92.54992454862916,
                20.168148411940592
              ],
              [
                92.4805486531403,
                20.174030036676196
              ],
              [
                92.48156871316255,
                20.259415349160225
              ],
              [
                92.2870243057241,
                20.541456716520816
              ],
              [
                91.93708244626947,
                20.388894274993667
              ],
              [
                92.14480369901979,
                20.0972325056751
              ],
              [
                92.29861229276979,
                20.010800636778214
              ],
              [
                92.27801292753541,
                19.8429616400519
              ],
              [
                92.54443138456666,
                19.75380563153829
              ],
              [
                92.73943870878541,
                19.677531241204164
              ],
              [
                92.83968895292604,
                19.886875195611587
              ],
              [
                92.91247337675416,
                19.982409653397305
              ],
              [
                92.93574523749443,
                20.02315670685104
              ],
              [
                93.00422630482358,
                19.94238112882892
              ],
              [
                93.05847129994076,
                19.953676477087974
              ],
              [
                93.07083091908139,
                19.955290032286175
              ],
              [
                93.12576255970639,
                19.861353693775467
              ],
              [
                93.14361534290951,
                19.832935856344708
              ],
              [
                93.16043815785092,
                19.810973135545275
              ],
              [
                93.17725053389222,
                19.790304479823575
              ],
              [
                93.20814958174378,
                19.78287426110273
              ],
              [
                93.21879258711488,
                19.79256578192715
              ],
              [
                93.21638932783753,
                19.81517703599837
              ],
              [
                93.21295610029847,
                19.821959785471666
              ],
              [
                93.21055284102113,
                19.827127400342437
              ],
              [
                93.20402970869691,
                19.85586918995363
              ],
              [
                93.20402970869691,
                19.863295997217794
              ],
              [
                93.21089616377503,
                19.867816492246
              ],
              [
                93.24831834395081,
                19.82131382179919
              ],
              [
                93.25449815352113,
                19.821959785471666
              ],
              [
                93.26342454512269,
                19.813562052999075
              ],
              [
                93.2750975187555,
                19.803225773476413
              ],
              [
                93.28333726484925,
                19.79159665638676
              ],
              [
                93.35028520186097,
                19.74701050875696
              ],
              [
                93.39526048262269,
                19.764458747193576
              ],
              [
                93.39732041914613,
                19.781258950296397
              ],
              [
                93.39491715986878,
                19.802902753919877
              ],
              [
                93.39629045088441,
                19.814531044766834
              ],
              [
                93.40899339277894,
                19.809363020447215
              ],
              [
                93.41688981611878,
                19.781258950296397
              ],
              [
                93.42881814279207,
                19.785281597352615
              ],
              [
                93.42195168771394,
                19.83179481148398
              ],
              [
                93.41371194162019,
                19.88604301943512
              ],
              [
                93.42881814279207,
                19.895082582904266
              ],
              [
                93.45216409005769,
                19.857629605086903
              ],
              [
                93.47001687326082,
                19.777528073280298
              ],
              [
                93.47139016427644,
                19.74004739022154
              ],
              [
                93.48924294747957,
                19.724535567103473
              ],
              [
                93.49885598458894,
                19.68962846089595
              ],
              [
                93.49610940255769,
                19.671525482423274
              ],
              [
                93.38761941232332,
                19.693507404359487
              ],
              [
                93.36564675607332,
                19.632726501516927
              ],
              [
                93.38899270333894,
                19.442476275414098
              ],
              [
                93.46864358224519,
                19.456720437661975
              ],
              [
                93.50022927560457,
                19.42952595217457
              ],
              [
                93.50709573068269,
                19.3660544533197
              ],
              [
                93.64167825021394,
                19.16641196043337
              ],
              [
                93.65129128732332,
                19.14565596438718
              ],
              [
                93.61146584787019,
                19.14046655735173
              ],
              [
                93.50572243966707,
                19.130087253914184
              ],
              [
                93.45078570804392,
                19.138522639255015
              ],
              [
                93.43156472482332,
                19.084670136434486
              ],
              [
                93.43740121163972,
                18.93782984886395
              ],
              [
                93.448558149269,
                18.952444786060056
              ],
              [
                93.49748269357332,
                18.949520048400093
              ],
              [
                93.546234524628,
                18.924190248342615
              ],
              [
                93.56202737130769,
                18.874818584135664
              ],
              [
                93.601166165253,
                18.884564144974835
              ],
              [
                93.62588540353426,
                18.841679439428766
              ],
              [
                93.71926919259676,
                18.750675639958978
              ],
              [
                93.80578652658113,
                18.77278108407353
              ],
              [
                93.87787677780193,
                18.787365041607828
              ],
              [
                93.91977815639797,
                18.84223308166713
              ],
              [
                93.90845780090588,
                18.86269028913803
              ],
              [
                93.88889393204532,
                18.883146223325017
              ],
              [
                93.86349459086175,
                18.89156902795708
              ],
              [
                93.81335758456648,
                18.93373932315585
              ],
              [
                93.7975720912658,
                18.945336512014354
              ],
              [
                93.79483248199972,
                18.954336024605574
              ],
              [
                93.81269619176234,
                18.95759153969
              ],
              [
                93.95070101227316,
                18.85884488619213
              ],
              [
                93.93833761667139,
                18.836434782972205
              ],
              [
                93.93627496122866,
                18.821732997727807
              ],
              [
                93.9520638884717,
                18.80703096143742
              ],
              [
                93.97745863133818,
                18.82281291326274
              ],
              [
                93.98603202528255,
                18.81877019826701
              ],
              [
                93.99563375126118,
                18.801726166705194
              ],
              [
                94.00214361993478,
                18.781757070427687
              ],
              [
                94.02268099248525,
                18.75613961830842
              ],
              [
                94.02998381766646,
                18.70581196188652
              ],
              [
                94.04350621007517,
                18.681298523535865
              ],
              [
                94.06511575980343,
                18.662374355249938
              ],
              [
                94.0788275860095,
                18.668818729187393
              ],
              [
                94.08813568820068,
                18.65917502603259
              ],
              [
                94.07527979444329,
                18.651099937818497
              ],
              [
                94.09967408129685,
                18.624480470317987
              ],
              [
                94.14245529583091,
                18.664929852610946
              ],
              [
                94.13543729559645,
                18.678402013279772
              ],
              [
                94.14352614245632,
                18.684230685179966
              ],
              [
                94.15180781525937,
                18.67165469638159
              ],
              [
                94.14152568080492,
                18.665121670997756
              ],
              [
                94.1240257539377,
                18.651526796880407
              ],
              [
                94.09725594224153,
                18.625732110847782
              ],
              [
                94.11933116652105,
                18.601273092345988
              ],
              [
                94.1311041721619,
                18.600239693518873
              ],
              [
                94.1274251546738,
                18.590747257403272
              ],
              [
                94.11013621523799,
                18.58209639375157
              ],
              [
                94.12237191387256,
                18.547409508554946
              ],
              [
                94.13955220619374,
                18.513533768842333
              ],
              [
                94.16083843039969,
                18.4894361036954
              ],
              [
                94.18143790899803,
                18.44058320514153
              ],
              [
                94.223323931975,
                18.469884477465055
              ],
              [
                94.24392621606123,
                18.498205128718112
              ],
              [
                94.24942156686295,
                18.533029252356744
              ],
              [
                94.2857660780435,
                18.71820119833153
              ],
              [
                94.16905428375753,
                18.89133098097366
              ],
              [
                94.14021517242941,
                19.32149723501314
              ],
              [
                94.08528353180441,
                20.16424091620052
              ],
              [
                93.22159892392749,
                20.979478435594864
              ],
              [
                92.80961161923999,
                21.21906690689283
              ],
              [
                92.49924784970874,
                21.217786714775077
              ],
              [
                92.11884623838061,
                21.135831344366135
              ],
              [
                91.83869487119311,
                21.134550431547314
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                94.41362509333919,
                17.181956509213276
              ],
              [
                94.41722524796323,
                17.194580894606897
              ],
              [
                94.42631913968847,
                17.1986775449391
              ],
              [
                94.44125698358324,
                17.19671243607706
              ],
              [
                94.45138942242757,
                17.20015858205989
              ],
              [
                94.46716916697756,
                17.201556177065697
              ],
              [
                94.47206006163367,
                17.195581391082143
              ],
              [
                94.47935388708085,
                17.19157427666429
              ],
              [
                94.48514677735368,
                17.192235648133785
              ],
              [
                94.49008120463573,
                17.195356693443394
              ],
              [
                94.49411379801275,
                17.2019267400539
              ],
              [
                94.49196494278712,
                17.212524624466422
              ],
              [
                94.48861470480165,
                17.21935089021723
              ],
              [
                94.49065086938643,
                17.235917846492487
              ],
              [
                94.49180613035192,
                17.249212339794965
              ],
              [
                94.48175862880694,
                17.251702853840612
              ],
              [
                94.48089473341693,
                17.316033032840913
              ],
              [
                94.52279811947764,
                17.412062087078617
              ],
              [
                94.38684654191253,
                17.93020559281431
              ],
              [
                94.41019946291964,
                18.054893107697072
              ],
              [
                94.33328992712457,
                18.17957997529052
              ],
              [
                94.11563428616942,
                18.139140478099865
              ],
              [
                94.09417881893935,
                18.107164579187096
              ],
              [
                94.1276513088406,
                18.08563022533461
              ],
              [
                94.13004754105583,
                18.054308529529447
              ],
              [
                94.09982876170334,
                18.030478297620057
              ],
              [
                94.06961369150149,
                18.032758556307453
              ],
              [
                94.00645763470087,
                17.985072194565717
              ],
              [
                93.88561198760186,
                17.870094194970708
              ],
              [
                93.89110483502238,
                17.671320564385702
              ],
              [
                94.01469686682582,
                17.43040562357396
              ],
              [
                94.10258458915695,
                17.194419706654138
              ],
              [
                94.2337297008569,
                17.10912833790316
              ],
              [
                94.33671701315956,
                17.022490154815692
              ],
              [
                94.37104827276555,
                17.078274612255235
              ],
              [
                94.42117645561518,
                17.15439600688678
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                94.15481946215573,
                16.06954869332222
              ],
              [
                94.16237256274167,
                16.103196450766703
              ],
              [
                94.17061230883542,
                16.138157684373542
              ],
              [
                94.17095558633412,
                16.168164933949086
              ],
              [
                94.18983838305417,
                16.19421469614198
              ],
              [
                94.20528764109939,
                16.2456346895993
              ],
              [
                94.199280480144,
                16.278595134083265
              ],
              [
                94.1918983195776,
                16.29573621875953
              ],
              [
                94.16615153189274,
                16.320447837252345
              ],
              [
                94.15962598071042,
                16.354383801533142
              ],
              [
                94.13422009692135,
                16.403792250686898
              ],
              [
                94.22760388598385,
                16.63880398805442
              ],
              [
                94.2852821086401,
                16.77888425914572
              ],
              [
                94.23406041057926,
                16.931110402074797
              ],
              [
                94.33035921623778,
                17.02949432988607
              ],
              [
                94.22537291775461,
                17.115457910168356
              ],
              [
                94.10249622266417,
                17.18884299026242
              ],
              [
                94.03238767845217,
                16.84229905517685
              ],
              [
                93.97333616478029,
                16.67529877936597
              ],
              [
                93.93763059837404,
                16.508810911398967
              ],
              [
                93.86026525185494,
                16.24347880079392
              ],
              [
                93.86438512490182,
                16.029770866417703
              ],
              [
                93.85408544228463,
                15.870660260684069
              ],
              [
                93.88292455361275,
                15.769582820388202
              ],
              [
                93.88773107216744,
                15.694898493158254
              ],
              [
                93.90283727333932,
                15.6433305090853
              ],
              [
                93.90558385537057,
                15.552063023488397
              ],
              [
                93.93304967568307,
                15.507737387736789
              ],
              [
                94.02368688271432,
                15.438252704402627
              ],
              [
                94.13492345497994,
                15.374041403737623
              ],
              [
                94.22487401650338,
                15.35748888850075
              ],
              [
                94.237233635644,
                15.480608049600919
              ],
              [
                94.22762059853463,
                15.648620132025723
              ],
              [
                94.24066686318307,
                15.669116128503818
              ],
              [
                94.25096654580025,
                15.696881617027186
              ],
              [
                94.25886345620049,
                15.712417924680302
              ],
              [
                94.26263951943307,
                15.732574546025656
              ],
              [
                94.31688451455025,
                15.880567090994301
              ],
              [
                94.27156591103463,
                15.901226436436138
              ],
              [
                94.22178577231553,
                15.906181017846555
              ],
              [
                94.21869420693307,
                15.963291750163831
              ],
              [
                94.24025592478876,
                16.00699306843157
              ],
              [
                94.21965655955438,
                16.002372854555617
              ],
              [
                94.19631061228876,
                16.002372854555617
              ],
              [
                94.18532428416376,
                16.007653090261194
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                93.44287447821586,
                19.337829398610936
              ],
              [
                93.36439406284275,
                19.35335357822942
              ],
              [
                93.34702040428344,
                19.397712628010808
              ],
              [
                93.2906341865821,
                19.37885668012331
              ],
              [
                93.2631317230244,
                19.369098000599216
              ],
              [
                93.24766491558664,
                19.3826785528943
              ],
              [
                93.23391412202626,
                19.376824708100585
              ],
              [
                93.2258539436151,
                19.380889100207657
              ],
              [
                93.23376701715655,
                19.402627069165348
              ],
              [
                93.25265005305857,
                19.408708100868424
              ],
              [
                93.32784210064386,
                19.438063420878805
              ],
              [
                93.30866136959942,
                19.519431481942515
              ],
              [
                93.2978136689337,
                19.64072206708444
              ],
              [
                93.27474941861577,
                19.696356646184988
              ],
              [
                93.23270817902493,
                19.70612924123326
              ],
              [
                93.2110915083539,
                19.7043436315616
              ],
              [
                93.1956385898775,
                19.715814528776765
              ],
              [
                93.1822452132455,
                19.743493306057108
              ],
              [
                93.1595648977358,
                19.75231806546051
              ],
              [
                93.14128694571676,
                19.79139006763389
              ],
              [
                93.14463526042746,
                19.80850693924692
              ],
              [
                93.1128670320327,
                19.825945555381168
              ],
              [
                93.06098891796384,
                19.807190023567312
              ],
              [
                93.0224547263209,
                19.79873282740806
              ],
              [
                93.01729418279199,
                19.833665841069674
              ],
              [
                93.00147981368411,
                19.897360963586024
              ],
              [
                92.9753253120449,
                19.938868188210282
              ],
              [
                92.94908609848304,
                19.967016959424573
              ],
              [
                92.9123631028807,
                20.000088040574088
              ],
              [
                92.82792942583052,
                19.89316028632586
              ],
              [
                92.75417935846588,
                19.745287076053064
              ],
              [
                92.67821400362341,
                19.59779876316617
              ],
              [
                92.99624582288916,
                19.170592243050724
              ],
              [
                93.16653354709366,
                18.89797018257911
              ],
              [
                93.3395678581442,
                18.601477070576163
              ],
              [
                93.50161587444225,
                18.282300623240506
              ],
              [
                93.68426322712263,
                18.018699871190364
              ],
              [
                93.79000643156425,
                18.013476051149034
              ],
              [
                93.88750990415649,
                18.048733849190782
              ],
              [
                94.06878396574047,
                18.083984584006163
              ],
              [
                94.12403049409768,
                18.12120331932029
              ],
              [
                94.33723783352333,
                18.18183167655737
              ],
              [
                94.26211120892785,
                18.269211078485334
              ],
              [
                94.29892709603524,
                18.300181696682117
              ],
              [
                94.29729765542136,
                18.336366009405804
              ],
              [
                94.3095266356531,
                18.360323711327716
              ],
              [
                94.29978347385989,
                18.40774149773772
              ],
              [
                94.25707114990443,
                18.462964635475256
              ],
              [
                94.2335786048728,
                18.49080975145541
              ],
              [
                94.18773357221961,
                18.46382405172151
              ],
              [
                94.15561853984362,
                18.509769007357814
              ],
              [
                94.12432065854337,
                18.59512047803109
              ],
              [
                94.03106147597752,
                18.706108076471985
              ],
              [
                93.97804733983425,
                18.713854217453555
              ],
              [
                93.96949902633467,
                18.737814665493467
              ],
              [
                93.9437504340742,
                18.759821204849676
              ],
              [
                93.94065614974181,
                18.780198026263363
              ],
              [
                93.93584962410878,
                18.784363939847868
              ],
              [
                93.9334502840103,
                18.790480400959467
              ],
              [
                93.92966836526632,
                18.799015276936544
              ],
              [
                93.92897640759855,
                18.811397796536852
              ],
              [
                93.91833487493986,
                18.84329447467356
              ],
              [
                93.89687949515333,
                18.813967167468757
              ],
              [
                93.87018096707934,
                18.794755234367937
              ],
              [
                93.83799395083082,
                18.787239070994033
              ],
              [
                93.82290724371632,
                18.78110143073531
              ],
              [
                93.80507604821092,
                18.773662943053747
              ],
              [
                93.82380833037483,
                18.736803040165373
              ],
              [
                93.83052350975049,
                18.707416253824213
              ],
              [
                93.8010857154852,
                18.70595087186286
              ],
              [
                93.79940749315536,
                18.657267962553316
              ],
              [
                93.81764023850627,
                18.61443796542173
              ],
              [
                93.81149774205026,
                18.585159327286682
              ],
              [
                93.78542665523396,
                18.578004370461446
              ],
              [
                93.76210567289644,
                18.572473417211302
              ],
              [
                93.68185996083379,
                18.59757238208562
              ],
              [
                93.6154539193304,
                18.657906600017697
              ],
              [
                93.52324516470385,
                18.735808743315186
              ],
              [
                93.4622807176901,
                18.86928287045375
              ],
              [
                93.43254486790045,
                18.90626835414808
              ],
              [
                93.4417417602785,
                18.93217524232817
              ],
              [
                93.44090557916442,
                19.00545856073071
              ],
              [
                93.44668684582062,
                19.11676017012269
              ],
              [
                93.49130358148744,
                19.15477108872137
              ],
              [
                93.49542655847215,
                19.21871829755695
              ],
              [
                93.46865695915545,
                19.315482906346524
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                93.9869455082983,
                14.791624623361804
              ],
              [
                93.8551095707983,
                14.868622241538205
              ],
              [
                93.62149565523403,
                14.733311503347512
              ],
              [
                93.54043787902192,
                14.754579955726227
              ],
              [
                93.46559082116966,
                14.806117730108168
              ],
              [
                93.5322002651182,
                14.897499032159223
              ],
              [
                93.6270256675138,
                14.968754849146366
              ],
              [
                93.7466431531618,
                14.896655487114387
              ],
              [
                93.89918537025478,
                14.914711410542846
              ],
              [
                93.97934904869818,
                15.197656967533362
              ],
              [
                93.92771506242062,
                15.480601626061848
              ],
              [
                93.5336302721079,
                15.605414889161572
              ],
              [
                93.2728341801733,
                14.587050385764284
              ],
              [
                93.3497384770483,
                14.27051683575861
              ],
              [
                93.4760812504858,
                14.116077969782669
              ],
              [
                93.6518625004858,
                14.113414309028979
              ],
              [
                94.02814423876706,
                14.387606829758113
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                92.84583448725604,
                14.096159544670583
              ],
              [
                92.73597105264173,
                13.90961192920246
              ],
              [
                92.7689300886756,
                13.79494364067713
              ],
              [
                92.90900597362611,
                13.746926202033503
              ],
              [
                93.00650977491759,
                13.725581955449291
              ],
              [
                93.03878215973512,
                13.721246167916682
              ],
              [
                93.03672289301838,
                13.708238036043621
              ],
              [
                93.0477093265317,
                13.697064291989753
              ],
              [
                93.05938155440894,
                13.690559843124417
              ],
              [
                93.06988318868397,
                13.651794690918903
              ],
              [
                93.06482960992923,
                13.63708836932237
              ],
              [
                93.06882598733937,
                13.619060651422293
              ],
              [
                93.06498591131286,
                13.609047983470335
              ],
              [
                93.05207949305871,
                13.589026646480356
              ],
              [
                93.05695632830917,
                13.488561910911496
              ],
              [
                93.12498646229092,
                13.47088019101847
              ],
              [
                93.14246579996468,
                13.358426456148033
              ],
              [
                93.06898616846249,
                13.186685074679973
              ],
              [
                93.20248875045594,
                13.157597378816565
              ],
              [
                93.31138080700343,
                13.407858471013284
              ],
              [
                93.40198476234534,
                13.526738793942432
              ],
              [
                93.56269343495023,
                13.872284278972506
              ],
              [
                93.32511374667851,
                14.053533270208673
              ],
              [
                93.27155532170323,
                13.922941778192966
              ],
              [
                93.19465091360071,
                13.920275852725558
              ],
              [
                93.19877073143496,
                14.048204499433126
              ],
              [
                93.22211667136649,
                14.110810359011658
              ],
              [
                93.36357416282996,
                14.306497661096005
              ],
              [
                93.28735968148366,
                14.537297062014986
              ],
              [
                93.09852040375759,
                14.331790496267956
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                93.20820298577354,
                13.164755692434456
              ],
              [
                93.06812730217979,
                13.188824105759396
              ],
              [
                93.05576768303916,
                13.150046053084283
              ],
              [
                93.04512258872494,
                13.103733841005171
              ],
              [
                93.0432348152297,
                13.078571264760198
              ],
              [
                93.03448167229698,
                13.05340857961691
              ],
              [
                93.02692857171104,
                12.993534559773474
              ],
              [
                93.02006211663291,
                12.972123581083212
              ],
              [
                93.02967515374229,
                12.931973030100298
              ],
              [
                92.99259629632041,
                12.81148268267866
              ],
              [
                92.97611680413291,
                12.780681436161375
              ],
              [
                92.97886338616416,
                12.75389468973094
              ],
              [
                92.98160996819541,
                12.729784193929776
              ],
              [
                92.98435655022666,
                12.65073929776742
              ],
              [
                92.98435655022666,
                12.611877737726843
              ],
              [
                92.99122300530479,
                12.579711985286842
              ],
              [
                93.00495591546104,
                12.546201707731123
              ],
              [
                92.98023667717979,
                12.471122873023072
              ],
              [
                92.96375718499229,
                12.381267822975461
              ],
              [
                92.95551743889854,
                12.334316299515685
              ],
              [
                92.95689072991416,
                12.277963366840838
              ],
              [
                92.97199693108604,
                12.259176372275197
              ],
              [
                92.99534287835166,
                12.259176372275197
              ],
              [
                93.03516831780479,
                12.320900031689781
              ],
              [
                93.06538072014854,
                12.34236573054417
              ],
              [
                93.17661729241416,
                12.393339708153162
              ],
              [
                93.29609361077354,
                12.705671405895652
              ],
              [
                93.21918931389854,
                13.145879116480883
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                92.31181351724592,
                12.841894214762092
              ],
              [
                92.1621157488416,
                12.45855465278817
              ],
              [
                92.29258744302717,
                12.359418638731364
              ],
              [
                92.35850541177717,
                12.335271176188849
              ],
              [
                92.39146439615217,
                12.343320577873243
              ],
              [
                92.39421097818342,
                12.313804896410076
              ],
              [
                92.38597123208967,
                12.289653233165916
              ],
              [
                92.33653275552717,
                12.311121487929698
              ],
              [
                92.24040238443342,
                12.343320577873243
              ],
              [
                92.13603226724592,
                12.300387579788772
              ],
              [
                91.95750443521467,
                11.959359942297876
              ],
              [
                92.09208695474592,
                11.741628557576014
              ],
              [
                92.25688187662092,
                11.636733358373753
              ],
              [
                92.32829300943342,
                11.679772091472511
              ],
              [
                92.38047806802717,
                11.784650962270568
              ],
              [
                92.46562211099592,
                11.929801691840384
              ],
              [
                92.54527298990217,
                12.045329189644841
              ],
              [
                92.60295121255842,
                12.163491938590383
              ],
              [
                92.63316361490217,
                12.295020461265162
              ],
              [
                92.62492386880842,
                12.458668069168747
              ],
              [
                92.57273881021467,
                12.769581017931488
              ],
              [
                92.56313980675182,
                12.899434014768206
              ],
              [
                92.67436234537092,
                13.118901164759047
              ],
              [
                92.74610112739246,
                13.111042955990081
              ],
              [
                92.79518191423355,
                13.124237429200495
              ],
              [
                92.79554559074667,
                13.147310715188071
              ],
              [
                92.79950302768681,
                13.159518479682655
              ],
              [
                92.78534551509532,
                13.167295324957232
              ],
              [
                92.78822116879539,
                13.176198319984575
              ],
              [
                92.80476519382732,
                13.17730793632635
              ],
              [
                92.80754567671977,
                13.20894981552302
              ],
              [
                92.82163736442054,
                13.218756055203347
              ],
              [
                92.82113027591487,
                13.23201545588607
              ],
              [
                92.78690309223921,
                13.243533119470888
              ],
              [
                92.77562710325671,
                13.208181359262811
              ],
              [
                92.75336854282479,
                13.188871791714812
              ],
              [
                92.74294001033651,
                13.203884197136409
              ],
              [
                92.79520940450458,
                13.288046170336703
              ],
              [
                92.81793896345705,
                13.327209195560698
              ],
              [
                92.83102371811115,
                13.378193777101501
              ],
              [
                92.79911399508188,
                13.394337199168833
              ],
              [
                92.79311240423316,
                13.4334667356906
              ],
              [
                92.79534997176282,
                13.469256950998826
              ],
              [
                92.84906411868188,
                13.591888815080841
              ],
              [
                92.92065440339405,
                13.627740186373392
              ],
              [
                92.95028173912912,
                13.657351086850744
              ],
              [
                92.97475161298463,
                13.676618106486293
              ],
              [
                93.00279221251363,
                13.726122200121946
              ],
              [
                93.00839779626692,
                13.73503114172953
              ],
              [
                92.93022976782913,
                13.744601794191182
              ],
              [
                92.89770678280435,
                13.76218903375856
              ],
              [
                92.73696362522386,
                13.947881497610416
              ],
              [
                92.31868244270234,
                13.582558018547731
              ],
              [
                92.41343705240217,
                13.037303222671168
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                93.94933908112971,
                7.342516007241437
              ],
              [
                93.82299630769221,
                7.310507154966418
              ],
              [
                93.81818978913752,
                7.28326377103352
              ],
              [
                93.83947579987971,
                7.258062166684972
              ],
              [
                93.84565560945002,
                7.253975286870091
              ],
              [
                93.86144845612971,
                7.2417144248694525
              ],
              [
                93.87792794831721,
                7.221960112824183
              ],
              [
                93.8992139590594,
                7.185855176147739
              ],
              [
                93.89784066804377,
                7.157922973424297
              ],
              [
                93.8937207949969,
                7.1361210412156195
              ],
              [
                93.89440744050471,
                7.122494305933679
              ],
              [
                93.89715402253596,
                7.107504429406249
              ],
              [
                93.90058725007502,
                7.097283778612671
              ],
              [
                93.91706674226252,
                7.088425697621729
              ],
              [
                93.92393319734065,
                7.0604875584199185
              ],
              [
                93.93936978454785,
                7.034100317664614
              ],
              [
                93.9421163665791,
                7.023196550804529
              ],
              [
                93.95035611267285,
                7.014337051974929
              ],
              [
                93.94692288513379,
                6.986394452553163
              ],
              [
                93.94417630310254,
                6.9768526943215186
              ],
              [
                93.94966946716504,
                6.961858110023063
              ],
              [
                93.95790921325879,
                6.951634255016109
              ],
              [
                93.9421163665791,
                6.933230755662618
              ],
              [
                93.92975674743847,
                6.923687917322033
              ],
              [
                93.91533719177441,
                6.90051164975053
              ],
              [
                93.90847073669629,
                6.888923090247928
              ],
              [
                93.90709744568066,
                6.871198863409286
              ],
              [
                93.91259060974316,
                6.847338284191138
              ],
              [
                93.92040714787524,
                6.828343414416957
              ],
              [
                93.9018677191643,
                6.786071500881787
              ],
              [
                93.85654911564868,
                6.765616015328243
              ],
              [
                93.8304565863518,
                6.742432084441461
              ],
              [
                93.7974976019768,
                6.736976880554619
              ],
              [
                93.73432621525805,
                6.73288543737218
              ],
              [
                93.58463749455493,
                6.7792531021241205
              ],
              [
                93.53657230900805,
                6.743795875820635
              ],
              [
                93.52421268986743,
                6.601941156050136
              ],
              [
                93.67802128361743,
                6.3372195417975625
              ],
              [
                94.03095707463305,
                6.308555857905875
              ],
              [
                94.1435669379143,
                6.462774911785317
              ],
              [
                94.17927250432055,
                6.698788738119398
              ],
              [
                94.1161011176018,
                7.076444395499127
              ],
              [
                94.00898441838305,
                7.309428893671103
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                93.48301395939868,
                6.806949420952118
              ],
              [
                93.64231571721118,
                6.904523939862369
              ],
              [
                93.58738407658618,
                7.006762716208694
              ],
              [
                93.65055546330493,
                7.152584486979907
              ],
              [
                93.65879520939868,
                7.213897546111034
              ],
              [
                93.62308964299243,
                7.220709596921758
              ],
              [
                93.59562382267993,
                7.243869801585173
              ],
              [
                93.5612915472893,
                7.39642476271455
              ],
              [
                93.56266483830493,
                7.475405789849488
              ],
              [
                93.52146610783618,
                7.505360382033638
              ],
              [
                93.5393188910393,
                7.5530111598717635
              ],
              [
                93.59562382267993,
                7.546204226815358
              ],
              [
                93.72196659611743,
                7.4985527010439865
              ],
              [
                93.8285844959714,
                7.542242057570457
              ],
              [
                93.8615434803464,
                7.666112520276039
              ],
              [
                93.77639943737765,
                7.784504440073426
              ],
              [
                93.60748464245577,
                7.904223171749544
              ],
              [
                93.47976632386732,
                7.868184987020926
              ],
              [
                93.42071539159095,
                7.85083938178323
              ],
              [
                93.35891896862765,
                7.860693077739754
              ],
              [
                93.29986057508586,
                7.8885796369180445
              ],
              [
                93.25454885144015,
                7.750487175048003
              ],
              [
                93.24768239636202,
                7.659307381323369
              ],
              [
                93.27240163464327,
                7.4836974866904935
              ],
              [
                93.31909352917452,
                7.126816430437768
              ],
              [
                93.3506792225339,
                6.9755340556818926
              ],
              [
                93.42621022839327,
                6.8225994090428985
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                94.4370278110695,
                13.488166476314056
              ],
              [
                94.4699867954445,
                13.557597845844546
              ],
              [
                94.46861350442887,
                13.668378928614567
              ],
              [
                94.431534647007,
                13.749763179198878
              ],
              [
                94.33677756692887,
                13.767103713740012
              ],
              [
                94.20768821146012,
                13.748429238712646
              ],
              [
                94.07173240091325,
                13.532231038141228
              ],
              [
                94.12666404153825,
                13.327863353651544
              ],
              [
                94.35051047708512,
                13.298462879902068
              ],
              [
                94.3930824985695,
                13.420050716338366
              ],
              [
                94.31892478372575,
                13.433408273861923
              ],
              [
                94.27360618021012,
                13.422722287310934
              ],
              [
                94.24751365091325,
                13.422722287310934
              ],
              [
                94.24339377786637,
                13.434743988718811
              ],
              [
                94.24064719583512,
                13.464127832474805
              ],
              [
                94.266739725132,
                13.47481197255144
              ],
              [
                94.30931174661637,
                13.469469962161645
              ],
              [
                94.40269553567887,
                13.440086773756805
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                93.7098338713789,
                12.308101360107738
              ],
              [
                93.84853626395703,
                12.315480752317884
              ],
              [
                93.88698841239453,
                12.287974691326589
              ],
              [
                93.88492847587109,
                12.257110808836886
              ],
              [
                93.85746265555859,
                12.253755821184527
              ],
              [
                93.71120716239453,
                12.249729779680612
              ],
              [
                93.79360462333203,
                12.112136586635788
              ],
              [
                93.94878650809765,
                12.109451133276899
              ],
              [
                94.01607776786328,
                12.238993368763358
              ],
              [
                94.02157093192578,
                12.357069806289461
              ],
              [
                93.95633960868359,
                12.43821647621109
              ],
              [
                93.8306834807539,
                12.450285720179023
              ],
              [
                93.69816089774609,
                12.410723327915772
              ],
              [
                93.67893482352734,
                12.344325475364645
              ],
              [
                93.69404102469922,
                12.318834952919682
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                93.36811009526278,
                12.182871408335778
              ],
              [
                93.25000614266641,
                12.115744321115647
              ],
              [
                93.10992936472088,
                12.005619353324448
              ],
              [
                93.0879565244248,
                11.943822173232574
              ],
              [
                93.08795651415677,
                11.911574561015378
              ],
              [
                93.1071827194796,
                11.876635321885667
              ],
              [
                93.14563512277115,
                11.793300617937716
              ],
              [
                93.09894286784645,
                11.739522873647955
              ],
              [
                93.03577100864877,
                11.701872216478492
              ],
              [
                92.95337295361969,
                11.728766100399417
              ],
              [
                92.86548169383327,
                11.769101998359293
              ],
              [
                92.82702925912223,
                11.73952293566653
              ],
              [
                92.7748437972768,
                11.553909436299515
              ],
              [
                92.74737775907045,
                11.349323316495068
              ],
              [
                92.7473777499566,
                11.257750300437806
              ],
              [
                92.71167193003026,
                11.211952855146906
              ],
              [
                92.64026030096478,
                11.265831454469657
              ],
              [
                92.52764964531937,
                11.346630416683816
              ],
              [
                92.4232787836022,
                11.41932993998533
              ],
              [
                92.3244011210532,
                11.459710514736463
              ],
              [
                92.10467300596675,
                11.413945362793067
              ],
              [
                91.98656958606418,
                11.061039264655367
              ],
              [
                91.99480937263303,
                10.926229635531547
              ],
              [
                92.03807174096885,
                10.850039219717615
              ],
              [
                92.11153898508908,
                10.870944940271023
              ],
              [
                92.13763236405417,
                10.931623240743686
              ],
              [
                92.19531096971907,
                10.966679080890694
              ],
              [
                92.20904396296889,
                11.009819009882415
              ],
              [
                92.25573617646818,
                11.012515056020296
              ],
              [
                92.38482641419321,
                11.023298973998203
              ],
              [
                92.5221564544055,
                11.077212531204966
              ],
              [
                92.54790810724617,
                11.020937467288624
              ],
              [
                92.55030839590258,
                10.967357693895158
              ],
              [
                92.60695696140982,
                11.001398252677664
              ],
              [
                92.60936027729252,
                11.011170636178722
              ],
              [
                92.6333937911316,
                11.017233093420451
              ],
              [
                92.69656561174583,
                11.036104347339359
              ],
              [
                92.7209427249225,
                11.023636333639717
              ],
              [
                92.73845127236561,
                11.007122987641106
              ],
              [
                92.74220917436276,
                10.971164889264884
              ],
              [
                92.65345279289261,
                10.893185998855873
              ],
              [
                92.63202048478601,
                10.787552427170771
              ],
              [
                92.63613711637369,
                10.583751809952245
              ],
              [
                92.61691417811751,
                10.524377199899753
              ],
              [
                92.53382953054908,
                10.47441585770752
              ],
              [
                92.48713733210035,
                10.47846707548847
              ],
              [
                92.46344353384815,
                10.500414332175517
              ],
              [
                92.39512623772448,
                10.46023615968564
              ],
              [
                92.3388209364198,
                10.4852189750208
              ],
              [
                92.33813344526456,
                10.50006762648315
              ],
              [
                92.33401249035074,
                10.515591406916823
              ],
              [
                92.36388140999465,
                10.532466229533277
              ],
              [
                92.37263647311808,
                10.553222865165882
              ],
              [
                92.38482592407964,
                10.566553770053279
              ],
              [
                92.360109585582,
                10.637930770714933
              ],
              [
                92.35152386345487,
                10.694454682790742
              ],
              [
                92.35461383926736,
                10.794971990347822
              ],
              [
                92.39855691972598,
                10.81621825211146
              ],
              [
                92.40310636853269,
                10.820180654721367
              ],
              [
                92.40422267744033,
                10.82549190552198
              ],
              [
                92.40980229000118,
                10.827768204266256
              ],
              [
                92.41332208641415,
                10.83341653031005
              ],
              [
                92.44868122118582,
                10.883324074427433
              ],
              [
                92.47614701378018,
                10.891413377488712
              ],
              [
                92.5008703431166,
                10.903209679895356
              ],
              [
                92.51700298956982,
                10.90978020747074
              ],
              [
                92.52507084112588,
                10.957561213507816
              ],
              [
                92.5434426139622,
                11.004667523205374
              ],
              [
                92.52215645615262,
                11.037692837642712
              ],
              [
                92.45349143612125,
                11.016125700352028
              ],
              [
                92.36285361038794,
                11.002645429433612
              ],
              [
                92.28594878860055,
                10.99725313985934
              ],
              [
                92.24749638499785,
                10.962200930551209
              ],
              [
                92.21728378259144,
                10.937931581280152
              ],
              [
                92.16509837657456,
                10.91096330260002
              ],
              [
                92.05798098951583,
                10.797669903840289
              ],
              [
                91.94262388837488,
                10.511549929385628
              ],
              [
                91.97009001257946,
                10.195430562950374
              ],
              [
                92.19805780103401,
                10.04401397414301
              ],
              [
                92.6787126505061,
                10.033195818740877
              ],
              [
                93.13190162267625,
                10.373793535778601
              ],
              [
                93.40106870745464,
                10.981075545006872
              ],
              [
                93.43344027953344,
                11.571164795414143
              ],
              [
                93.39498799393908,
                11.842800753938633
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                92.65079479143567,
                9.151000146945087
              ],
              [
                92.68650035784192,
                9.24589432750157
              ],
              [
                92.78812389299817,
                9.297397616152505
              ],
              [
                92.86777477190442,
                9.259448556956068
              ],
              [
                92.95017223284192,
                9.20522851014723
              ],
              [
                92.90348033831067,
                9.430186816182667
              ],
              [
                92.83481578752942,
                9.454571135467374
              ],
              [
                92.62058238909192,
                9.457280397686091
              ],
              [
                92.52445201799817,
                9.357023533031844
              ],
              [
                92.52994518206067,
                9.202517289108354
              ],
              [
                92.52445201799817,
                9.012680503571369
              ],
              [
                92.54093151018567,
                8.882448895037863
              ],
              [
                92.64530162737317,
                8.741312449779373
              ],
              [
                92.77164440081067,
                8.649001962035392
              ],
              [
                92.82932262346692,
                8.803744830331873
              ],
              [
                92.85678844377942,
                8.852597609779734
              ],
              [
                92.88082103655286,
                8.844116688808567
              ],
              [
                92.87258100912165,
                8.814593780416283
              ],
              [
                92.84460114362008,
                8.814763654555637
              ],
              [
                92.81842522030928,
                8.747158430686161
              ],
              [
                92.7840040199513,
                8.653414377105223
              ],
              [
                92.89249401018567,
                8.515926515233437
              ],
              [
                93.04355602190442,
                8.49419549674191
              ],
              [
                93.05832228304766,
                8.474331053147674
              ],
              [
                93.05952416259002,
                8.463379847492964
              ],
              [
                93.07935072329039,
                8.457904401760661
              ],
              [
                93.06587200090833,
                8.414051750667097
              ],
              [
                93.06570561407091,
                8.362767980981637
              ],
              [
                93.15694220785922,
                8.363280514276513
              ],
              [
                93.18912486956067,
                8.3474790767536
              ],
              [
                93.41434459612317,
                8.27410012791328
              ],
              [
                93.54273523449874,
                8.266637423719478
              ],
              [
                93.58587879663396,
                8.258784799962104
              ],
              [
                93.58507388005717,
                8.207440298237957
              ],
              [
                93.64468149724492,
                8.161527253012242
              ],
              [
                93.6847744951153,
                8.027754877504142
              ],
              [
                93.79762949619126,
                8.04353613339564
              ],
              [
                93.7985114786002,
                8.40896260256988
              ],
              [
                93.62857799456067,
                8.362424953998834
              ],
              [
                93.54618053362317,
                8.578396308653259
              ],
              [
                93.60868783020268,
                8.587575047195683
              ],
              [
                93.79199962542005,
                8.437824937821285
              ],
              [
                93.82633190081067,
                8.920437923837337
              ],
              [
                93.76041393206067,
                9.06150529180221
              ],
              [
                93.47476940081067,
                9.191672197161195
              ],
              [
                93.21933727190442,
                9.164558014820912
              ],
              [
                92.96939830706067,
                9.121171019460483
              ],
              [
                92.91172008440442,
                9.11574727360604
              ],
              [
                92.84580211565442,
                9.104899534795031
              ],
              [
                92.78812389299817,
                9.083203070090494
              ],
              [
                92.67002086565442,
                9.1021875486472
              ],
              [
                92.65354137346692,
                9.129306483670126
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                92.92206312042393,
                8.086423507595978
              ],
              [
                93.05115247589268,
                7.77086605686318
              ],
              [
                93.1623890481583,
                7.736847688245663
              ],
              [
                93.19946790558018,
                7.817126612975257
              ],
              [
                93.2667591653458,
                7.883787211104322
              ],
              [
                93.30795789581455,
                7.906911853003231
              ],
              [
                93.28805080997746,
                8.012307284811875
              ],
              [
                93.25714612823643,
                8.087783141710357
              ],
              [
                93.10333753448643,
                8.208772127478555
              ],
              [
                93.04565931183018,
                8.327006651166853
              ],
              [
                92.96051526886143,
                8.313418282637253
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                97.10479808033074,
                12.833527818897206
              ],
              [
                97.01690572505733,
                11.889101585236533
              ],
              [
                97.41866738240122,
                9.591449698332053
              ],
              [
                97.37280813987287,
                8.717467724857581
              ],
              [
                97.43257234476731,
                8.415983589522314
              ],
              [
                97.51425665395917,
                8.435027612321422
              ],
              [
                97.55408976475303,
                8.752760827143797
              ],
              [
                97.69417098363307,
                8.950881327278168
              ],
              [
                97.74086476883178,
                9.067532158737889
              ],
              [
                97.80403878893831,
                9.129911289072622
              ],
              [
                97.86171942236871,
                9.108215423286143
              ],
              [
                97.85897270668208,
                9.04854505180829
              ],
              [
                97.77382513625751,
                8.934601509579506
              ],
              [
                97.83012925563838,
                8.845023205804344
              ],
              [
                97.75734501290128,
                8.655018814426318
              ],
              [
                97.7285047964568,
                8.519223854980874
              ],
              [
                97.6694510095912,
                8.459458755413038
              ],
              [
                97.54310334447531,
                8.4513081472343
              ],
              [
                97.47443629714367,
                8.339900704798765
              ],
              [
                97.62290727414664,
                8.020401796515925
              ],
              [
                97.89193246081928,
                7.766068187658562
              ],
              [
                97.98257444439243,
                7.595943527483417
              ],
              [
                98.17621463126852,
                7.521750731405432
              ],
              [
                98.25723902164165,
                7.851088723120274
              ],
              [
                98.24350633205904,
                7.974888434964734
              ],
              [
                98.24831424102152,
                8.047629745744844
              ],
              [
                98.28093081980818,
                8.13091357397863
              ],
              [
                98.23114275097433,
                8.31951170038324
              ],
              [
                98.16934394735561,
                8.425494549816449
              ],
              [
                98.20795929082283,
                8.552100467294979
              ],
              [
                98.19362482142695,
                8.570587523336846
              ],
              [
                98.19439555335863,
                8.608085600108925
              ],
              [
                98.21533813159142,
                8.663022094063287
              ],
              [
                98.23935318038947,
                8.68364493032423
              ],
              [
                98.22252235848701,
                8.695084968285874
              ],
              [
                98.15762666876093,
                8.680727569440322
              ],
              [
                98.0814048047583,
                8.660147152490719
              ],
              [
                97.99351439693945,
                8.676444611200582
              ],
              [
                98.01548839399412,
                8.804041504500969
              ],
              [
                98.06355693268478,
                8.84389051719716
              ],
              [
                98.117092773438,
                8.851728483026655
              ],
              [
                98.18436384979191,
                8.854138363691922
              ],
              [
                98.2104406456844,
                9.003070465024233
              ],
              [
                98.09642745030679,
                9.086869064172074
              ],
              [
                98.04286463472513,
                9.26582878190273
              ],
              [
                98.01196327965656,
                9.390523097784419
              ],
              [
                97.92921472512946,
                9.402716490478452
              ],
              [
                97.84922545584512,
                9.336305846401727
              ],
              [
                97.81352249618689,
                9.375601648754392
              ],
              [
                97.81626678808477,
                9.439285288960015
              ],
              [
                97.97733300899553,
                10.028030706096105
              ],
              [
                97.96497296749166,
                10.103080016478744
              ],
              [
                97.94437311601345,
                10.119980344045006
              ],
              [
                97.92789232640801,
                10.144313917741231
              ],
              [
                97.85785063934787,
                10.169321822350533
              ],
              [
                97.83999764403275,
                10.341628167545064
              ],
              [
                97.86196902269786,
                10.53342323711351
              ],
              [
                98.00274420602814,
                10.597533437862758
              ],
              [
                98.04908504784494,
                10.601268557366195
              ],
              [
                98.11242240320112,
                10.596042612541767
              ],
              [
                98.15797187193613,
                10.55716260744735
              ],
              [
                98.20351281134229,
                10.538526413492113
              ],
              [
                98.21494552724019,
                10.55525441909545
              ],
              [
                98.22957791356127,
                10.595453249302345
              ],
              [
                98.22498740142741,
                10.618775292307356
              ],
              [
                98.22726321892571,
                10.628599447764145
              ],
              [
                98.19468132641697,
                10.651703261769907
              ],
              [
                98.16259844339346,
                10.693281239089998
              ],
              [
                98.19986773562938,
                10.715963390191655
              ],
              [
                98.22289909368976,
                10.774832616266695
              ],
              [
                98.18150977950305,
                10.798544755857506
              ],
              [
                98.16286522061294,
                10.826575561083834
              ],
              [
                98.1171419268666,
                10.820353390854761
              ],
              [
                98.06681486158573,
                10.825998088762795
              ],
              [
                98.05744154084854,
                10.846344061812102
              ],
              [
                98.01841840794326,
                10.851794558368198
              ],
              [
                97.99272583641249,
                10.839676778788855
              ],
              [
                97.97095477888756,
                10.847101682430994
              ],
              [
                97.96350127258236,
                10.885202203857391
              ],
              [
                97.90621167020767,
                10.846932878875442
              ],
              [
                97.8884575163721,
                10.83736290130135
              ],
              [
                97.86658457821045,
                10.830489248523213
              ],
              [
                97.83303840853019,
                10.830357957894051
              ],
              [
                97.82420968065227,
                10.855852435930185
              ],
              [
                97.85921872219403,
                10.919164141548903
              ],
              [
                97.89905130806613,
                10.936694756377491
              ],
              [
                97.9272069358866,
                10.936024371160283
              ],
              [
                98.17920684289994,
                10.994668491359924
              ],
              [
                98.22829891942132,
                11.065096585730565
              ],
              [
                98.22247035616292,
                11.143609652718167
              ],
              [
                98.18470151893963,
                11.241266886133175
              ],
              [
                98.08648650437756,
                11.336889403636366
              ],
              [
                98.01815887847998,
                11.255389510015974
              ],
              [
                97.97184189372148,
                11.111934613956423
              ],
              [
                97.93064145808479,
                11.101832713766202
              ],
              [
                97.87570522307564,
                11.129454536205303
              ],
              [
                97.83587776540082,
                11.252054223393877
              ],
              [
                97.81527735446053,
                11.460757615997094
              ],
              [
                97.92443450848978,
                11.547577136096246
              ],
              [
                98.06930994268313,
                11.489009622001129
              ],
              [
                98.09749746605935,
                11.560998884187404
              ],
              [
                98.02232249163087,
                11.603726578273024
              ],
              [
                97.94436635683411,
                11.686789337595469
              ],
              [
                97.7424912691174,
                11.883110295651985
              ],
              [
                97.6559653932675,
                11.76478103780375
              ],
              [
                97.53510878300882,
                11.603400543673695
              ],
              [
                97.41700137623998,
                11.752683056883777
              ],
              [
                97.39914750113117,
                11.818559278502656
              ],
              [
                97.4595754686128,
                11.904577985864673
              ],
              [
                97.5900451849209,
                12.01474973691302
              ],
              [
                97.7086520714863,
                12.267481102257795
              ],
              [
                97.8157476870368,
                12.326492598294504
              ],
              [
                97.91188025523493,
                12.317093645916412
              ],
              [
                97.97643570285945,
                12.437150273956535
              ],
              [
                97.79171581988444,
                12.422079826000921
              ],
              [
                97.77591848922981,
                12.494134064450796
              ],
              [
                97.79654420918067,
                12.570592062276031
              ],
              [
                97.84973597174525,
                12.639261079500212
              ],
              [
                97.8947050673051,
                12.659678423890803
              ],
              [
                97.91050886715124,
                12.75143246922999
              ],
              [
                97.79654769484364,
                12.782303014681467
              ],
              [
                97.85835136861544,
                12.851941145471045
              ],
              [
                97.93696037742922,
                12.816830281155983
              ],
              [
                98.08424570314443,
                12.878075206411419
              ],
              [
                98.12752736711901,
                12.963050094484784
              ],
              [
                98.24596256705424,
                12.95837879421007
              ],
              [
                98.26484112481262,
                13.031297673713254
              ],
              [
                98.24013629267156,
                13.083471279028316
              ],
              [
                98.22640683093351,
                13.157034241932298
              ],
              [
                98.22468740108225,
                13.217869666207953
              ],
              [
                98.23807621628917,
                13.242607072772294
              ],
              [
                97.84461557587375,
                13.239933329816553
              ],
              [
                97.40789122662882,
                13.269341420378751
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                97.97870713527423,
                7.315994308783912
              ],
              [
                98.94465845308177,
                6.069713043312731
              ],
              [
                99.65327661714427,
                5.4029067709766805
              ],
              [
                99.95540064058177,
                5.4685283098979784
              ],
              [
                100.29597681245677,
                5.566947102219923
              ],
              [
                100.34816187105052,
                5.8402453000948835
              ],
              [
                100.18611353120677,
                5.965918088322797
              ],
              [
                100.11744816009816,
                6.088837086755555
              ],
              [
                100.05153101167552,
                6.034206475577117
              ],
              [
                99.97188013276927,
                6.015086590151149
              ],
              [
                99.92793482026927,
                6.034206475577117
              ],
              [
                99.85652368745677,
                6.047863123799138
              ],
              [
                99.78785913667552,
                6.066981851762264
              ],
              [
                99.72194116792552,
                6.091562076826091
              ],
              [
                99.66975610933177,
                6.097024196398734
              ],
              [
                99.59834497651927,
                6.157103829955674
              ],
              [
                99.59561219062039,
                6.352990487089332
              ],
              [
                99.6213513575568,
                6.424300864379359
              ],
              [
                99.65413545466798,
                6.452791196860494
              ],
              [
                99.67430539021485,
                6.461918314843471
              ],
              [
                99.69722192964427,
                6.453305010493906
              ],
              [
                99.73636538477083,
                6.44085398671205
              ],
              [
                99.777223464995,
                6.459190688748578
              ],
              [
                99.83456114340997,
                6.49731241402224
              ],
              [
                99.71509089730078,
                6.564684083071008
              ],
              [
                99.7090809067918,
                6.514183277308736
              ],
              [
                99.68316027406622,
                6.512798920219133
              ],
              [
                99.6635910639345,
                6.489561505174101
              ],
              [
                99.6337203515694,
                6.504523749874491
              ],
              [
                99.58441904481936,
                6.600779736540562
              ],
              [
                99.60608902397313,
                6.670260691151837
              ],
              [
                99.629138451053,
                6.698821287888503
              ],
              [
                99.64090965726012,
                6.747761111608184
              ],
              [
                99.68564657969185,
                6.717597326043142
              ],
              [
                99.69442736564395,
                6.729319959708819
              ],
              [
                99.70046194806416,
                6.742406311113918
              ],
              [
                99.72297641730866,
                6.728898123120704
              ],
              [
                99.73038473549757,
                6.744029515241211
              ],
              [
                99.66076312892066,
                6.8081762943638955
              ],
              [
                99.61636316053365,
                6.8365169529017615
              ],
              [
                99.55411017191051,
                6.810309146232933
              ],
              [
                99.4982770063859,
                6.760610236484973
              ],
              [
                99.44806031436329,
                6.691201891609226
              ],
              [
                99.49397485933177,
                6.5631424917388355
              ],
              [
                99.33055407773091,
                6.423457806252407
              ],
              [
                99.32437499364838,
                6.469344177161266
              ],
              [
                99.27665424270826,
                6.471646244097737
              ],
              [
                99.26601006539227,
                6.497826415594551
              ],
              [
                99.21657007417552,
                6.494241039249487
              ],
              [
                99.17777886534819,
                6.482982829912821
              ],
              [
                99.13348596773021,
                6.502427846170562
              ],
              [
                99.15889185151927,
                6.610208306864309
              ],
              [
                99.29622095308177,
                6.686595440792324
              ],
              [
                99.36763208589427,
                6.757515664865258
              ],
              [
                99.39784448823802,
                7.005653845699868
              ],
              [
                99.36076899610912,
                7.0996903400616365
              ],
              [
                99.29622095308177,
                7.155563771046109
              ],
              [
                99.23579614839427,
                7.220963644192306
              ],
              [
                99.17537134370677,
                7.2100643197999466
              ],
              [
                99.10396021089427,
                7.1392123349442285
              ],
              [
                99.01606958589427,
                7.171914621332296
              ],
              [
                98.90620630464427,
                7.220963644192306
              ],
              [
                98.87393465283985,
                7.433422851073104
              ],
              [
                98.9020864315974,
                7.516506327786125
              ],
              [
                98.86157434663646,
                7.574365814416186
              ],
              [
                98.82586878023021,
                7.62541185323166
              ],
              [
                98.70845239839427,
                7.645828566383012
              ],
              [
                98.63704126558177,
                7.645828566383012
              ],
              [
                98.52168482026927,
                7.6240507043601875
              ],
              [
                98.27998560151927,
                7.395316844628305
              ],
              [
                98.12068384370677,
                7.596826818971207
              ],
              [
                97.88997095308177,
                7.602271734267964
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                97.17108128579822,
                14.572005422647218
              ],
              [
                97.63800023111072,
                13.91179193932929
              ],
              [
                97.78082249673572,
                13.91712391106005
              ],
              [
                97.80004857095447,
                13.994423662677006
              ],
              [
                97.72589085611072,
                14.10100134785111
              ],
              [
                97.75610325845447,
                14.191553256653426
              ],
              [
                97.81103489907947,
                14.207529256031298
              ],
              [
                97.81927464517322,
                14.239477870397018
              ],
              [
                97.75335667642322,
                14.292715511384912
              ],
              [
                97.74786351236072,
                14.431074306161051
              ],
              [
                97.73138402017322,
                14.508198667853318
              ],
              [
                97.60504124673572,
                14.614533004446242
              ],
              [
                97.31665013345447,
                14.667680906727721
              ],
              [
                97.16558812173572,
                14.622506010542626
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                98.09854393319493,
                10.53946307197769
              ],
              [
                98.06283836678868,
                10.575914217951498
              ],
              [
                98.03399925546056,
                10.555664114866607
              ],
              [
                98.01477318124181,
                10.540813191457499
              ],
              [
                98.00790672616368,
                10.525961551747578
              ],
              [
                97.97220115975743,
                10.519210569891813
              ],
              [
                97.96121483163243,
                10.530012069924295
              ],
              [
                97.95709495858556,
                10.48005196521188
              ],
              [
                97.98730736092931,
                10.471949566188103
              ],
              [
                98.01202659921056,
                10.458445097259538
              ],
              [
                98.02987938241368,
                10.4246813559203
              ],
              [
                98.03125267342931,
                10.380107613536193
              ],
              [
                98.03949241952306,
                10.288238686323728
              ],
              [
                98.07245140389806,
                10.173364942220417
              ],
              [
                98.05459862069493,
                10.037635369138584
              ],
              [
                97.99692039803868,
                10.002474423477103
              ],
              [
                98.01614647225743,
                9.952431134184192
              ],
              [
                98.07519798592931,
                9.97001478750513
              ],
              [
                98.09579735116368,
                10.06603180719047
              ],
              [
                98.12738304452306,
                10.155261461061825
              ],
              [
                98.13974266366368,
                10.203921706323586
              ],
              [
                98.17407493905431,
                10.225546096652396
              ],
              [
                98.21939354256993,
                10.206624835519703
              ],
              [
                98.22763328866368,
                10.252574514037237
              ],
              [
                98.22591624395132,
                10.287708337283426
              ],
              [
                98.26333885506993,
                10.262033915623649
              ],
              [
                98.39036818225445,
                10.235344740324111
              ],
              [
                98.37217756408108,
                10.302405138182952
              ],
              [
                98.33286398006064,
                10.35281753736185
              ],
              [
                98.31457832651215,
                10.367210747591338
              ],
              [
                98.30406253039162,
                10.331851472818533
              ],
              [
                98.29605926866245,
                10.30809139887969
              ],
              [
                98.27981736263361,
                10.303246350056853
              ],
              [
                98.27054845662018,
                10.313885977635362
              ],
              [
                98.26127892414003,
                10.324525341069972
              ],
              [
                98.26745872811681,
                10.35391049381069
              ],
              [
                98.27295189217931,
                10.398487972630122
              ],
              [
                98.24273948983556,
                10.429553362893097
              ],
              [
                98.19467430428868,
                10.428202758149153
              ],
              [
                98.14523582772618,
                10.429553362893097
              ],
              [
                98.12326317147618,
                10.472769616580846
              ],
              [
                98.15210228280431,
                10.482222369821939
              ],
              [
                98.17270164803868,
                10.49167483453031
              ],
              [
                98.16720848397618,
                10.533532274987849
              ],
              [
                98.12875633553868,
                10.534882420463411
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                98.6193776749487,
                8.03078112991424
              ],
              [
                98.6193776749487,
                7.921980753790704
              ],
              [
                98.6083913468237,
                7.887974720726563
              ],
              [
                98.59603172768307,
                7.864849020132894
              ],
              [
                98.56307274330807,
                7.862128264630914
              ],
              [
                98.52736717690182,
                7.868930119921173
              ],
              [
                98.5040212296362,
                7.883893808598515
              ],
              [
                98.5040212296362,
                7.902937720505609
              ],
              [
                98.52874046791744,
                7.935582381348317
              ],
              [
                98.53560692299557,
                7.958704114858523
              ],
              [
                98.51775413979244,
                8.034860579521759
              ],
              [
                98.49440819252682,
                8.083810770956946
              ],
              [
                98.47930199135494,
                8.06341557761822
              ],
              [
                98.4765554093237,
                8.03758018981649
              ],
              [
                98.46831566322994,
                8.00630357238824
              ],
              [
                98.4545827530737,
                7.992704293455675
              ],
              [
                98.45732933510494,
                7.97230452547346
              ],
              [
                98.46144920815182,
                7.945103252885332
              ],
              [
                98.4600759171362,
                7.9165399769134215
              ],
              [
                98.4600759171362,
                7.892055592584156
              ],
              [
                98.45046288002682,
                7.864849020132894
              ],
              [
                98.4381032608862,
                7.853285686067547
              ],
              [
                98.4278021805601,
                7.813830173902414
              ],
              [
                98.41853270567904,
                7.798184115280419
              ],
              [
                98.4054875992651,
                7.791382377061659
              ],
              [
                98.4022260876329,
                7.7781157585344065
              ],
              [
                98.40171104897213,
                7.762128174304834
              ],
              [
                98.39003834578351,
                7.753283356132006
              ],
              [
                98.37870886240326,
                7.725047336161231
              ],
              [
                98.37407353534395,
                7.711949558363525
              ],
              [
                98.40231122091964,
                7.7115244640334115
              ],
              [
                98.4274602555151,
                7.720964745296476
              ],
              [
                98.44771629799557,
                7.742397445569849
              ],
              [
                98.46968895424557,
                7.783218618760287
              ],
              [
                98.52324730385494,
                7.79546419653809
              ],
              [
                98.58229881752682,
                7.788661141970772
              ],
              [
                98.65508324135494,
                7.798185387407002
              ],
              [
                98.72649437416744,
                7.858047097928307
              ],
              [
                98.7347341202612,
                7.947823461352555
              ],
              [
                98.7072682999487,
                8.048458448649722
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                97.90739117672821,
                11.930202719140036
              ],
              [
                97.90189801266571,
                12.011480011630196
              ],
              [
                97.9121976952829,
                12.047744617224293
              ],
              [
                97.94241009762665,
                12.100789563590844
              ],
              [
                97.96026288082977,
                12.139727255726646
              ],
              [
                97.96232281735321,
                12.175974474095684
              ],
              [
                97.93760357907196,
                12.198794259598724
              ],
              [
                97.93073712399384,
                12.22899389537308
              ],
              [
                97.93073712399384,
                12.253151120685478
              ],
              [
                97.91013775875946,
                12.263886955545873
              ],
              [
                97.87443219235321,
                12.226980693552997
              ],
              [
                97.85520611813446,
                12.236375504193175
              ],
              [
                97.83117352536102,
                12.24644100201053
              ],
              [
                97.79890118649384,
                12.235704457366435
              ],
              [
                97.77692853024384,
                12.221612080430468
              ],
              [
                97.7693754296579,
                12.196780828091551
              ],
              [
                97.75701581051727,
                12.16456384567081
              ],
              [
                97.78173504879852,
                12.108846103925236
              ],
              [
                97.78997479489227,
                12.078632825743147
              ],
              [
                97.80027447750946,
                12.048416137843876
              ],
              [
                97.78104840329071,
                11.977225621281626
              ],
              [
                97.81057416012665,
                11.874436427033825
              ],
              [
                97.84353314450165,
                11.841508796194015
              ],
              [
                97.8792387109079,
                11.817986629833976
              ],
              [
                97.92730389645477,
                11.807905082578232
              ],
              [
                97.96369610836884,
                11.815298253511008
              ],
              [
                97.98978863766571,
                11.854277124635013
              ],
              [
                98.00420819332977,
                11.870404685782455
              ],
              [
                98.03167401364227,
                11.872420563863493
              ],
              [
                98.05639325192352,
                11.895938039113755
              ],
              [
                98.06257306149384,
                11.938936161364907
              ],
              [
                98.0495267968454,
                11.962447875496657
              ],
              [
                98.02686749508759,
                11.94901286032178
              ],
              [
                98.00283490231415,
                11.92415632512633
              ],
              [
                97.96300946286102,
                11.922812663710921
              ],
              [
                97.93485699704071,
                11.929530904239122
              ],
              [
                97.92181073239227,
                11.932218153856356
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    Offshore = 
    /* color: #5e6eff */
    /* shown: false */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[90.57285562012126, 21.853751396613237],
          [90.57285562012126, 5.432712438884859],
          [96.41758218262126, 5.432712438884859],
          [96.41758218262126, 21.853751396613237]]], null, false),
    Inshore = /* color: #8b827a */ee.Geometry.MultiPolygon(
        [[[[97.16447157738047, 14.409996987805703],
           [97.5875215302919, 12.832284967244261],
           [98.2515140026587, 12.979820906063372],
           [98.2572335683695, 12.879680025512801],
           [97.93359750623797, 12.608056026944174],
           [97.766722751603, 11.924534589258249],
           [98.01068347827896, 11.484490388017548],
           [97.93821018961587, 11.5327941834197],
           [97.88220447730724, 11.536678500517658],
           [97.95079679388611, 11.446217579607303],
           [97.99424886659666, 11.37967005221524],
           [97.994858137324, 11.304151707006238],
           [98.05708991130079, 11.30420187271869],
           [98.12608340814054, 11.260028654421195],
           [98.34615795905799, 11.119163866134064],
           [98.31468641236529, 12.540634232864141],
           [98.62448062002544, 12.534823749377495],
           [98.04078051811219, 13.818566315400028],
           [97.82651332446856, 14.71841767603059],
           [97.50510611063773, 14.76889345469858],
           [97.14523988987396, 14.755610027764813]]],
         [[[98.25617893135058, 11.029522349101798],
           [98.26630695259081, 11.012672809007702],
           [98.31042392646776, 10.993800179270238],
           [98.35196597969042, 11.01284130918461],
           [98.31574542915331, 11.06052297848382],
           [98.25514896308886, 11.047044846290238]]],
         [[[98.00778955857466, 10.947161821797751],
           [97.84574009988046, 10.959632726175352],
           [97.856384224102, 10.824778336512153],
           [98.02014917771528, 10.835231779159294],
           [98.0819635781138, 10.762049722922193],
           [98.16022486130903, 10.694923040215022],
           [97.85741446112017, 10.553222570428561],
           [97.87099703840008, 10.35911534175138],
           [98.04521957516171, 10.268220382799687],
           [98.0163840915645, 10.198618966281641],
           [97.9505567393979, 10.030383789045173],
           [97.99939226267982, 10.003078048841969],
           [98.05165572654545, 9.982879464718744],
           [98.09154281197593, 9.865969875140154],
           [97.96415289192669, 9.847955197411421],
           [97.94054467679952, 9.708095527002738],
           [97.80171526359294, 9.399117290833553],
           [97.87986416010888, 9.317620235685537],
           [98.12513918961997, 9.63401421635037],
           [98.3854075495181, 10.042092946946191],
           [98.40535730759814, 10.571424619719767],
           [98.38201136033248, 10.743498837947355],
           [98.25154871384811, 10.994348588108805],
           [98.13001245896528, 11.01187318034692],
           [98.03113550584028, 10.963340990143076]]],
         [[[98.03564383546377, 10.886559234525672],
           [98.02671744386221, 10.871387368845948],
           [98.0373604492333, 10.862283879001483],
           [98.04628684083487, 10.87543327518213]]],
         [[[98.15560910299997, 8.976030995421256],
           [98.15011593893747, 8.844768576360549],
           [98.27405545309763, 8.876316556754745],
           [98.27714535788279, 8.968909440826012],
           [98.2005843837617, 8.989595474437849]]],
         [[[98.09999046021355, 7.94154143688972],
           [98.23045310669792, 7.683038095492741],
           [98.61085471802605, 7.672150254103848],
           [98.88274357828257, 7.689816015348126],
           [98.8717800109948, 7.998662517587961],
           [98.34718284302605, 8.243375837121988],
           [98.14393577271355, 8.126475861232654]]],
         [[[99.24902437792676, 7.449657496005784],
           [99.12405489550488, 7.452721308700137],
           [99.12165163622754, 7.343772644967082],
           [99.17864321337598, 7.305974819001075],
           [99.27374361620801, 7.290309917144244],
           [99.32404827111623, 7.196140913126449],
           [99.37771028857831, 7.062166659662596],
           [99.51991035618556, 6.743615831275961],
           [99.02818265285187, 6.565986406689198],
           [99.22318129660067, 6.433543567132717],
           [99.4538333890021, 6.442924645703212],
           [99.5353633084089, 6.3352452635078125],
           [99.7990097271777, 6.0325722865247835],
           [99.93625707633424, 6.188595521065529],
           [99.96501242246678, 6.391312473117782],
           [99.78151570711226, 6.693625740222576],
           [99.43528258237663, 7.26356970057425],
           [99.34515474902051, 7.346837192942587],
           [99.32627199755566, 7.408123702923048]]],
         [[[99.68361080642288, 5.544962819156337],
           [100.01045406814163, 5.2852022212504135],
           [100.37025631423538, 5.342632553818332],
           [100.50758541579788, 5.659768229871591],
           [100.17524899001663, 6.102371520297641],
           [99.35951412673538, 6.195218070049458]]]]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
///////////////////////////////
// Global coral atlas project - Andaman Sea
// Contact: mitchell.lyons@gmail.com
// Region coordinator: Eva Kovacs (kovacsevam2@gmail.com)
// Description:
// - Developing a process to combine OBIA and supervised classification
// - This script loads the raw classification data (from *_classification script)
// - Then applied some cleanup and object-based relational rules
///////////////////////////////

// Table of contents
// 1. Setting constants
// 2. Data loads & vis
// 3. OBIA clean up rules
// 4. Export

// Load and libraries needed
var map_palettes = require('users/mitchest/global_reefs:Modules/colour_pals');
var pkg_vis = require('users/mitchest/global_reefs:Modules/pkg_vis');
var param_module = require('users/mitchest/global_reefs:Modules/reef_params');

// ###########################################
// SENSOR GENERICS
var sensor_params = param_module.dove;         //<------------ THIS IS WHERE YOU CHOOSE THE SENSOR
// REGION AND SENSOR SPECIFIC LOAD PATHS
var region_params = param_module.andm;         //<------------ THIS IS WHERE YOU CHOOSE THE REGION
//  ^^ all the data paths are in this module ^^
// ###########################################

// 1. Setting constants

// These will get written to the asset metadata 

var vars = {
  
  // analysis type
  geomorphic: true, // map geomorphic zonation (when set to true) or benthic habitat (when set to false)

  // analysis parameters
  image_data_scale: sensor_params.pixel,
  small_object_geo: ee.Number(400).int(), // smallest object size in pixels (geomorphic)
  small_object_benthic: ee.Number(130).int(), // smallest object size in pixels (benthic)
  smooth_radius: ee.Number(3), // radius in pixels for initial smooth 
  dist_to_land: 500, //distance to land in meters to disallow reef crest, and convert to terrestrial reef flat
  wave_height: 0.4, //cut off height for waves in metres, Hs95 threshold
  geo_depth_cutoff: 1000,
  shallowlag_depth_cutoff: 500,
  benthic_depth_cutoff: 1000,
  
  //############
  // Clean-up stage selection
  cleanup_stage: 1, // set to 1, 2 or 3
  
  /*
  - GEOMORPHIC 1: The first pass does a small object filter, just to generally clean noise and reduce the amount of cleaning needed
  -            2: The second pass runs the OBIA cleanup rules
  -            3: The third pass is the MANUAL cleanup stage, which includes AT LEAST the no_reef masking
                        - see below where it starts/ends (only that section is run)
                        - please put region specific stuff in here ONLY

  - BENTHIC 1: This is the main benthic stge - it does noise removal, no data reclaim and OBIA rules - review those if needed
            2: The second mas is the MANUAL stage - it's optional, but shuold include ALL region specific stuff
                        - see below where it starts/ends (only that section is run)
                        - please put region specific stuff in here ONLY
  */
  
  // DON'T TOUCH --->
  obia_2nd_pass: null,
  obia_clean: null, // run object-based relationship rules + small object clean up
  fast_clean: null, // run a faster (but less precise) version of the OBIA clean; only applies to geomorphic (`obia_clean: true` also)
  manual_clean: false, // apply manual touch ups
  // --------------<
  //############
  
  smooth_output: false, // run smoother over final output (includes noise removal) (should be false for second pass)
  
  // results/layers to show
  export_small_area: false,
  show_eg_area: false, // constrain the map add to the corresponding example_area polygon geomtery (you can change that)
                              // - you can either set this, or have it false and just navigate to the area you want to see (keeping in mind ALL tiles in the zoom area will calcualte)
  reproject_display: true,
  //reproject_res: ee.Number(sensor_params.pixel).pow(2),
  
  // export options
  do_export: true, // export the results?
  geomorph_output_name: region_params.sname + '_geo_clean', // DO NOT CHANGE - change in the pop up dialouge if you must
  benthic_output_name: region_params.sname + '_benthic_clean', // DO NOT CHANGE - change in the pop up dialouge if you must
  asset_output: region_params.asset // asset path

};


// Clean up stage auto-parameterisation (DON'T TOUCH) --->

if (vars.geomorphic) {
  var temp_outname = vars.geomorph_output_name;
  if (vars.cleanup_stage == 1) {
    vars.obia_2nd_pass = false;
    vars.obia_clean = false;
    vars.fast_clean = true;
    vars.manual_clean = false;
    vars.geomorph_output_name = temp_outname + '1';
  } else if (vars.cleanup_stage == 2) {
    vars.obia_2nd_pass = true;
    vars.obia_clean = true;
    vars.fast_clean = true;
    vars.manual_clean = false;
    vars.geomorph_output_name = temp_outname + '2';
  } else if (vars.cleanup_stage == 3) {
    vars.manual_clean = true;
    vars.obia_2nd_pass = false;
    vars.obia_clean = false;
    vars.fast_clean = false;
    vars.smooth_output = false;
    vars.do_export = false;
    vars.geomorph_output_name = temp_outname + '3';
  }
}

if (!vars.geomorphic) {
  var temp_outname = vars.benthic_output_name;
  if (vars.cleanup_stage == 1) {
    vars.obia_2nd_pass = true,
    vars.obia_clean = true, 
    vars.fast_clean = false, 
    vars.manual_clean = false;
    vars.benthic_output_name = temp_outname + '1';
  } else if (vars.cleanup_stage == 2) {
    vars.manual_clean = true;
    vars.obia_2nd_pass = false,
    vars.obia_clean = false, 
    vars.fast_clean = false,
    vars.smooth_output = false,
    vars.do_export = false;
    vars.benthic_output_name = temp_outname + '2';
  }
}
// -----------------------------------------<

/*
############################
MANUAL ADDITION
- review everything in there
- first review the reef_boundary object - as it is required for all cleanup stages
############################
*/

// This can be hand drawn or imported from elsewhere, or could just be a big box
// Reef_boundary defines export extent and can be used to clip out unwanted areas
//var reef_boundary = ee.FeatureCollection([ee.Feature(east),ee.Feature(west)]).geometry();

Map.addLayer(reef_boundary, {}, "Manual reef outline", false);


// ############################
// This is the section to add/remove manual cleanups
// You MUST review it for each region
// ############################

if (vars.manual_clean && vars.geomorphic) {
  
  print("Doing GEOMORPHIC manual clean ups - make sure this is what you want to do");
  print("Export the manual map, check 'manual' layer in the viewer for effects");
  
  var depth = ee.Image(region_params.pixels).select('depth');
  var depth_cont = depth.lt(900);
  Map.addLayer(depth_cont, {}, "depth contour", false);
  
// update these values based on inspection of the layer
  //Map.addLayer(waves.lt(vars.wave_height), {}, vars.wave_height + "m Hs95 threshold", false)
  
  // merged "Rivermouth" and "not reef" extents. Eventually to be moved over to _datagen script, although CR happy to rerun clean up script/assess result and iterate
  
  var not_reef = ee.Image().byte().paint(ee.Feature(noreefmask, {zone: 1}), "zone").clip(noreefmask);
  var inner_extent = ee.Image().byte().paint(ee.Feature(Inshore, {zone: 1}), "zone").clip(Inshore)
  var outer_extent_reef = ee.Image().byte().paint(ee.Feature(Offshore, {zone: 1}), "zone").clip(Offshore)
  //var not_reef = ee.Image().byte().paint(ee.Feature(mid_mask, {zone: 1}), "zone").clip(mid_mask);
  //var river = ee.Image().byte().paint(ee.Feature(rivermouth, {zone: 1}), "zone").clip(rivermouth);
  //var west_extent = ee.Image().byte().paint(ee.Feature(west, {zone: 1}), "zone").clip(west);
  //var east_extent = ee.Image().byte().paint(ee.Feature(east, {zone: 1}), "zone").clip(east);
 // var notreefcrest = ee.Image().byte().paint(ee.Feature(not_reef_crest, {zone: 1}), "zone").clip(not_reef_crest);
 //var kaneohebay = ee.Image().byte().paint(ee.Feature(kaneohe_bay, {zone: 1}), "zone").clip(kaneohe_bay);
  //var kaneohebayreef = ee.Image().byte().paint(ee.Feature(kaneohe_bay_reef, {zone: 1}), "zone").clip(kaneohe_bay_reef);
  //var notdeepwater = ee.Image().byte().paint(ee.Feature(not_deep_water, {zone: 1}), "zone").clip(not_deep_water);
 // var backreefslope = ee.Image().byte().paint(ee.Feature(back_reef_slope, {zone: 1}), "zone").clip(back_reef_slope);
//  var reefflat = ee.Image().byte().paint(ee.Feature(reef_flat, {zone: 1}), "zone").clip(reef_flat);
//  var notdeeplagoon = ee.Image().byte().paint(ee.Feature(not_deep_lagoon, {zone: 1}), "zone").clip(not_deep_lagoon);
//  var notreefslope = ee.Image().byte().paint(ee.Feature(not_reef_slope, {zone: 1}), "zone").clip(not_reef_slope);
//  var notDLouterreef = ee.Image().byte().paint(ee.Feature(not_DL_outer_reef, {zone: 1}), "zone").clip(not_DL_outer_reef);
 // var notDLshallowlagoon = ee.Image().byte().paint(ee.Feature(not_DL_shallow_lagoon, {zone: 1}), "zone").clip(not_DL_shallow_lagoon);
//  var notRSplateau = ee.Image().byte().paint(ee.Feature(not_RS_plateau, {zone: 1}), "zone").clip(not_RS_plateau);

  // define the manually edited map - uses the output from the second pass of cleaning
  var man_geo = ee.Image(region_params.geo_map_clean2);
  
  // "NOT REEF" CLEAN
  // remove
  man_geo = man_geo.where({
    test: not_reef.eq(1),
    value: ee.Image(0)
  });
  
   // "Rivermouth" CLEAN
  // remove
  man_geo = man_geo.where({
    test: river.eq(1),
    value: ee.Image(0)
  });
  
  // TRF -> Outer reef flat
  man_geo = man_geo.where({
    test: man_geo.eq(16),
    value: ee.Image(14)
  });
  
  /*// WAVE clean ############# ---> (to be integrated into RF classifier when feasible)
  // remove
  man_geo = man_geo.where({
    test: waves.lte(vars.wave_height)
               .and(man_geo.eq(22)),
    value: ee.Image(21)
  })*/
  
  //West Hawaii clean
  // Deep water -> Reef slope
  man_geo = man_geo.where({
    test: notdeepwater.eq(1)
                     .and(man_geo.eq(2)),
    value: ee.Image(22)
  });
  
  // Reef crest -> Inner reef flat
  man_geo = man_geo.where({
    test: notreefcrest.eq(1)
                     .and(man_geo.eq(15)),
    value: ee.Image(13)
  });
  
 // Deep water/shelter slope -> Back reef slope
  man_geo = man_geo.where({
    test: backreefslope.eq(1)
                     .and(man_geo.eq(2)).or(man_geo.eq(21)),
    value: ee.Image(24)
  });
  
  // Shallow/deep lagoon -> Inner reef flat (French Frigate Shoals)
  man_geo = man_geo.where({
    test: reefflat.eq(1)
                     .and(man_geo.eq(11)).or(man_geo.eq(12)),
    value: ee.Image(13)
  });
  
  // Deep water -> Deep lagoon
  man_geo = man_geo.where({
    test: west_extent.eq(1)
                     .and(man_geo.eq(2)),
    value: ee.Image(12)
  });
  
  // Sheltered slope -> Reef slope
  man_geo = man_geo.where({
    test: west_extent.eq(1)
                     .and(man_geo.eq(21)),
    value: ee.Image(22)
  });
  
  // Deep lagoon -> Reef slope (around the reef edge)
  man_geo = man_geo.where({
    test: notdeeplagoon.eq(1)
                     .and(man_geo.eq(12)),
    value: ee.Image(22)
  });
  
  // Reef slope -> Inner reef flat (insided the reef)
  man_geo = man_geo.where({
    test: notreefslope.eq(1)
                     .and(man_geo.eq(22)),
    value: ee.Image(13)
  });
  
  // Deep lagoon -> Outer reef flat (insided the reef)
  man_geo = man_geo.where({
    test: notDLouterreef.eq(1)
                     .and(man_geo.eq(12)),
    value: ee.Image(14)
  });
  
  // Deep lagoon -> Shallow lagoon (insided the reef)
  man_geo = man_geo.where({
    test: notDLshallowlagoon.eq(1)
                     .and(man_geo.eq(12)),
    value: ee.Image(11)
  });
  
  // Reef slope -> Plateau (Corona reef)
  man_geo = man_geo.where({
    test: notRSplateau.eq(1)
                     .and(man_geo.eq(22)),
    value: ee.Image(23)
  });
  

  //East Hawaii clean
  
  // Inner reef flat -> Outer reef flat
  man_geo = man_geo.where({
    test: east_extent.eq(1)
                     .and(man_geo.eq(13)),
    value: ee.Image(14)
  });
  
  // Reef crest -> Outer reef flat
  man_geo = man_geo.where({
    test: east_extent.eq(1)
                     .and(man_geo.eq(15)),
    value: ee.Image(14)
  });
  
  // Sheltered reef slope -> Reef slope
  man_geo = man_geo.where({
    test: east_extent.eq(1)
                     .and(man_geo.eq(21)),
    value: ee.Image(22)
  });
  
  // Deep lagoon -> Reef slope
  man_geo = man_geo.where({
    test: east_extent.eq(1)
                     .and(man_geo.eq(12)),
    value: ee.Image(22)
  });
  
  // Shallow lagoon -> Outer reef flat
  man_geo = man_geo.where({
    test: east_extent.eq(1)
                     .and(man_geo.eq(11)),
    value: ee.Image(14)
  });
  
  // Kaneohe Bay -> Deep lagoon
  man_geo = man_geo.where({
    test: kaneohebay.eq(1),
    value: ee.Image(12)
  });
  
  // Kaneohe Bay Reefs -> Outer reef flat
  man_geo = man_geo.where({
    test: kaneohebayreef.eq(1),
    value: ee.Image(14)
  });
  
  
    /*// LAND mask clean ############# ---> to be moved to first stage clean up
  var land_mask = mod_land.select('water_mask').mean().eq(0)

  var land_mask_buff = ee.Image(1)
    .cumulativeCost({
      source: land_mask, 
      maxDistance: 2000,
      geodeticDistance: false,
    }).lt(2000).unmask(0)
  
  Map.addLayer(land_mask_buff, {}, "Land mask", false)
  
  */
  
  
  // Add the manual layer to the map
  //var image = ee.Image(region_params.image);
  //Map.addLayer(image, {bands: ['b3','b2','b1'], min:200, max:1200}, 'Dove low tide', false);
  
  var geo_clean1 = ee.Image(region_params.geo_map_clean1);
  Map.addLayer(geo_clean1, map_palettes.geo, 'Geo clean stage 1', false);
  var geo_clean2 = ee.Image(region_params.geo_map_clean2);
  Map.addLayer(geo_clean2, map_palettes.geo, 'Geo clean stage 2', false);
  Map.addLayer(man_geo, map_palettes.geo, 'Geo clean stage 3 - MANUAL', true);
  
  // Export
  var output_name = (vars.geomorphic) ? vars.geomorph_output_name : vars.benthic_output_name;
  Export.image.toAsset({
    image: man_geo,
    description: output_name,
    assetId: vars.asset_output + 'in_out/' + output_name,
    region: reef_boundary,
    scale: vars.image_data_scale,
    crs: 'EPSG:4326',
    maxPixels: 1e13,
    pyramidingPolicy: {'.default': 'mode'}
  });
  
} 

if (vars.manual_clean && !vars.geomorphic) {
  
  print("Doing BENTHIC manual clean ups - make sure this is what you want to do");
  print("Export the manual map, check 'manual' layer in the viewer for effects");
  
  var depth = ee.Image(region_params.pixels).select('depth');
  var depth_cont = depth.lt(900);
  Map.addLayer(depth_cont, {}, "depth contour", false);
  
  // define the final geomorphic map (the manually edited geo map - stage 3)
  var geo_map = ee.Image(region_params.geo_map_clean3);
  
  var man_benthic = ee.Image(region_params.benthic_map_clean1);
  
  // Generic benthic rules
    // Coral in benthic && Deep/shallow lagoon in geo == sand
    man_benthic = man_benthic.where({
      test: man_benthic.eq(15)
                     .and(geo_map.eq(11).or(geo_map.eq(12))),
      value: ee.Image(11)
    });
    
    // BMA in benthic && inner/outer RF in geo == rubble 
    man_benthic = man_benthic.where({
      test: man_benthic.eq(18)
                     .and(geo_map.eq(13).or(geo_map.eq(14))),
      value: ee.Image(12)
    });
    
    
    // manual polygon guided rules
    // West Hawaii
    
    // East and West copied here to run in benthic clean, originally defined under manual cleanup for geo - sort out later PT
    //var west_extent = ee.Image().byte().paint(ee.Feature(west, {zone: 1}), "zone").clip(west);
    //var east_extent = ee.Image().byte().paint(ee.Feature(east, {zone: 1}), "zone").clip(east);
    //var steepslope = ee.Image().byte().paint(ee.Feature(steep_slope, {zone: 1}), "zone").clip(steep_slope);
    
    // Sand or BMA on Reef slope == coral/algae (on the steeper reef slope areas)
    man_benthic = man_benthic.where({
     test: steepslope.eq(1)
                      .and(geo_map.eq(22))
                      .and(man_benthic.eq(11).or(man_benthic.eq(18))),
     value: ee.Image(15)
     });
    
    // BMA on Reef Crest == coral/algae
    man_benthic = man_benthic.where({
      test: west_extent.eq(1)
                       .and(geo_map.eq(15))
                       .and(man_benthic.eq(18)),
      value: ee.Image(15)
    });
    
    // East and West Hawaii
    // BMA on DW/DL/SRS/RS/plateau/BRS == sand
    man_benthic = man_benthic.where({
      test: man_benthic.eq(18)
                     .and(geo_map.eq(2).or(geo_map.eq(12)).or(geo_map.eq(21)).or(geo_map.eq(22)).or(geo_map.eq(23)).or(geo_map.eq(24))),
      value: ee.Image(11)
    });
    
    // East Hawaii
    // Sand on RS and plateau == rock
    man_benthic = man_benthic.where({
      test: east_extent.eq(1)
                       .and(man_benthic.eq(11))
                       .and(geo_map.eq(14).or(geo_map.eq(22)).or(geo_map.eq(23))),
      value: ee.Image(13)
    });
  
  
  // Add the manual layer to the map
  //var image = ee.Image(region_params.image);
  //Map.addLayer(image, {bands: ['b3','b2','b1'], min:200, max:1200}, 'Dove low tide', false);
  
  var benthic_clean1 = ee.Image(region_params.benthic_map_clean1);
  Map.addLayer(geo_map, map_palettes.geo, 'Geo clean stage 3 - MANUAL', false);
  Map.addLayer(benthic_clean1, map_palettes.benthic, 'Benthic clean stage 1', false);
  Map.addLayer(man_benthic, map_palettes.benthic, 'Benthic clean stage 2 - MANUAL', true);
  
  // Export
  var output_name = (vars.geomorphic) ? vars.geomorph_output_name : vars.benthic_output_name;
  Export.image.toAsset({
    image: man_benthic,
    description: output_name,
    assetId: vars.asset_output + 'in_out/' + output_name,
    region: reef_boundary,
    scale: vars.image_data_scale,
    crs: 'EPSG:4326',
    maxPixels: 1e13,
    pyramidingPolicy: {'.default': 'mode'}
  });
  
}

// ############################
// END OF MANUAL SECTION
// ############################


// 2. Data loads & vis

// load input data

// define raw geo/benthic outputs
// Run check to see if the region has been split into multiple areas

// geo
if (ee.List(region_params.geo_map).length().getInfo() > 1) {
  var geo_map_raw = ee.Image(region_params.geo_map[0]).unmask(0, false)
               .add(ee.Image(region_params.geo_map[1]).unmask(0,false))
               .selfMask();
} else {
  var geo_map_raw = ee.Image(region_params.geo_map);
}

// benthic
if (ee.List(region_params.benthic_map).length().getInfo() > 1) {
    var benthic_map = ee.Image(region_params.benthic_map[0]).unmask(0, false)
             .add(ee.Image(region_params.benthic_map[1]).unmask(0,false))
             .selfMask();
} else {
    var benthic_map = ee.Image(region_params.benthic_map);
}

// set the geo map for further processing
if (vars.geomorphic && vars.obia_2nd_pass) {
  // if it's 2nd pass, you want to make sure you're loading the latest geo clean map
  var geo_map = ee.Image(region_params.geo_map_clean1);
} else if (vars.geomorphic) {
  var geo_map = geo_map_raw;
}

var depth = ee.Image(region_params.pixels).select('depth');
var image = ee.Image(region_params.image);

var display_pal = (vars.geomorphic) ? map_palettes.geo : map_palettes.benthic;
//Map.centerObject(eg_area, 11)
Map.addLayer(depth, {min:0, max:2500}, 'Depth data', false);
Map.addLayer(image, {bands: ['b3','b2','b1'], min:200, max:1200}, 'Dove low tide', false);

// load for display purposes
if (vars.geomorphic) {
  Map.addLayer(geo_map_raw, display_pal, 'Geomorphic map RAW', false);
  if (vars.cleanup_stage == 2) Map.addLayer(ee.Image(region_params.geo_map_clean1), display_pal, 'Geomorphic map - stage 1 clean', false);
}
if (!vars.geomorphic) {
  // Use the manually cleaned geomorphic map as input for the benthic clean
  var geo_map = ee.Image(region_params.geo_map_clean3);
  if (!vars.manual_clean) Map.addLayer(geo_map, map_palettes.geo, 'Final geo map (manual clean - stage 3)', false);
  Map.addLayer(benthic_map, display_pal, 'Benthic map RAW', false);
}

// 3. Object-based re-classificaiton and cleaning

/*

// if we want to retain the land/waves flags, need to add them in before makign the mask

######## Not that straight forwards - the land and bright masks are a LOT of not land and not breakign waves... =(

// add in land, for geomorphic clean up rules
  geo_map = geo_map.unmask(0).where({
    test: depth.eq(-2).and(globcover.select('landcover').neq(210)),
    value: ee.Image(1)
  })
  
  // change -3 to reef rim, hope that clouds have been handleded by masking
  geo_map = geo_map.unmask(0).where({
    test: depth.eq(-3),
    value: ee.Image(15)
  })
  
  // remask
  geo_map = geo_map.updateMask(geo_map.gt(0))

*/


/* OUTPUT EXTENT
  - to the mapping extent just so it doesn't balloon out
  - to the 'reef boundary' extent for noise/deep removal
*/  
var class_extent_mask = geo_map.gt(0);

/*

########
Initial small object clean
 - this was originally at the end, but we needed to massively reduce the number of objects to 
   iterate through in the OBIA cleaning, so this happens first now
 - future collabs with google might fix this, but need to change the parallel serialisation of vector procesing
 
 - includes a possible special case for:
      - geomorphic to clean up turbid areas over size threshold; fix shallow vs. deep lagoon
      - benthic to allow breaking waves (temporal class) to grow into surrounding class
########

*/

if (vars.geomorphic && !vars.obia_2nd_pass) {
  
  // make a smooth map with masked area as a value
  var smooth_map = geo_map
                      //.unmask(99)
                      .focal_mode({
                        radius: vars.smooth_radius, // relates to smoothness required
                        kernelType: 'circle', units: 'pixels', iterations: 2
                      });
  //smooth_map = smooth_map.updateMask(smooth_map.neq(99)).updateMask(class_extent_mask)
  
  //replace small objects with smooth underneath
  var clean_map = geo_map.where({
    test: geo_map.connectedPixelCount(vars.small_object_geo, false).lt(vars.small_object_geo), 
    value: smooth_map
  //}).updateMask(smooth_map.neq(99)).updateMask(class_extent_mask)
  }).updateMask(class_extent_mask);
  
  // shallow lagoon > 5m == deep lagoon
  clean_map = clean_map.where({
    test: clean_map.eq(11)
                   .and(depth.gt(vars.shallowlag_depth_cutoff)),
    value: ee.Image(12)
  });
  
  /*// deep lagoon == deep (to hard to differentiate deep water vs. deep lagoon effectively over large areas)
  clean_map = clean_map.where({
    test: clean_map.eq(12),
    value: ee.Image(2)
  })*/
  
  // deep water in depth data == deep (s2 + ls8 data should be good enough for this)
  clean_map = clean_map.where({
    test: depth.gt(vars.geo_depth_cutoff),
    value: ee.Image(2)
  });
  
    // deep water in depth data == deep (only for inshore reefs of Andaman Sea)
  var inner_extent = ee.Image().byte().paint(ee.Feature(Inshore, {zone: 1}), "zone").clip(Inshore);
  clean_map = clean_map.where({
    test: depth.gt(500)
                   .and(inner_extent.eq(1)),
    value: ee.Image(2)
  });
  
  // LAND mask cleaning
  Map.addLayer(land_dist.lte(vars.dist_to_land), {}, "Land mask (dist to land)", false);
  
  // reef crest close to land -> TRF
  clean_map = clean_map.where({
    test: land_dist.lte(vars.dist_to_land)
                   .and(clean_map.eq(15)),
    value: ee.Image(16)
  });
  
  // TRF far from land -> ORF
  clean_map = clean_map.where({
    test: land_dist.gt(vars.dist_to_land)
                   .and(clean_map.eq(16)),
    value: ee.Image(14)
  });
  
  
  
  /*//CLEAN UP SMALL (but slightly larger) TURBID AREAS
  var smooth_noturbid = clean_map
                          .updateMask(clean_map.neq(3))
                          .focal_mode({
                            radius: vars.smooth_radius.multiply(1.5),
                            kernelType: 'circle', units: 'pixels', iterations: 2
                          })
  
  clean_map = clean_map.where({
    test: clean_map.eq(3).connectedPixelCount(vars.small_object_geo.multiply(10), false).lt(vars.small_object_geo.multiply(10)), 
    value: smooth_noturbid
  }).updateMask(class_extent_mask)*/
}


if (!vars.geomorphic && vars.cleanup_stage == 1) {
  
  // make a smooth map with masked area as a value, and without temporal class (basically breaking waves)
  var smooth_map = benthic_map
                      //.unmask(99)
                      .focal_mode({
                        radius: vars.smooth_radius, // relates to smoothness required
                        kernelType: 'circle', units: 'pixels', iterations: 1
                      });
  //smooth_map = smooth_map.updateMask(smooth_map.neq(99)).updateMask(class_extent_mask)
  
  //replace small objects with smooth underneath
  var clean_map = benthic_map.where({
    test: benthic_map.connectedPixelCount(vars.small_object_benthic, false).lt(vars.small_object_benthic),
    value: smooth_map
  //}).updateMask(smooth_map.neq(99)).updateMask(class_extent_mask)
  }).updateMask(class_extent_mask);
  
  
  /*// CLEAN UP ALL TEMPORAL AREAS
  var smooth_notemp = benthic_map
                          .updateMask(benthic_map.neq(2))
                          .focal_mode({
                            radius: vars.smooth_radius.multiply(2),
                            kernelType: 'circle', units: 'pixels', iterations: 3
                          })
  
  
  clean_map = clean_map1.where({
    test: benthic_map.eq(2), 
    value: smooth_notemp
  }).updateMask(clean_map1.gte(0))
  
  // this catches any left over unmasked temporal, and assigned it back to temporal
  clean_map = clean_map.where({
    test: clean_map.unmask(99).eq(99).and(clean_map1.eq(2)),
    value: ee.Image(2)
  })*/
  
}



if (vars.geomorphic && vars.obia_2nd_pass) {
  var clean_map = geo_map;
}

if (vars.obia_clean) {
  
  if (vars.geomorphic && !vars.fast_clean) { // SHOULD TRY TO PUT THIS OUT TO A MODULE TO KEEP THE RULES THE SAME EVERYWEHRE?
    
    // #########
    // THE PLAN - vectorise one/few class/es at a time, thus only spending resources on what is actually needed to clean up
    // #########
    
    // FUNCTION that maps over feature colleciton and assigns neighbour percentages
    var set_neighbour_properties = function(f) {
      // make the 1px buffer
      var diff = f.buffer(vars.image_data_scale).difference(f, ee.ErrorMargin(0.5));
      // reduce the classes in the buffer zone
      var diff_classes = ee.Dictionary(
        clean_map.unmask(ee.Image(0)).reduceRegion({
          reducer: ee.Reducer.frequencyHistogram(),
          geometry: diff.geometry(),
          scale: vars.image_data_scale,
          maxPixels: 1e11
        }).get('classification')
      );
      // calculate the percentages
      var diff_sum = diff_classes.toArray().reduce(ee.Reducer.sum(), [0]).get([0]);
      var diff_percs = diff_classes.map(function(k,v){return(ee.Number(v).divide(diff_sum).multiply(100).toUint8())});
      
      /* NOW, we can try to do the class logic right here (see /users/mitchest/global_reefs/obia_dev),
         or we can return the neighbour % and do image logic via (painted) rasters */
      
      return(f.set(diff_percs));
    };
    
    // FUNCTION to reduce the map to vectors and map the neighbour properties function
    var reduce_neighbours = function() {
      // reduce map to vectors
      var map_fc = clean_map
            .updateMask(segment_id).updateMask(clean_map.eq(classn)) // only vectorise class/es of interest
            .reduceToVectors({
              scale: vars.image_data_scale, 
              eightConnected: false,
              bestEffort: true, 
              maxPixels: 1e13,
              tileScale: 1,
              geometry: reef_boundary
            });
      // map the function, calculate neighbour properties
      return(map_fc.map(set_neighbour_properties));
    };
    
    // first make a make size threshold, so we're not vecortising huge objects when we don't have to
    var segment_id = clean_map.connectedComponents(ee.Kernel.plus(1),vars.small_object_geo.sqrt()).select('labels');
    //Map.addLayer(segment_id.reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))))
    Map.addLayer(clean_map.updateMask(segment_id).reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))), display_pal, 'Map objects to be iterated through (OBIA)', false);
    
    // This is where we select the single or group of classes to vectorise for cleaning up
    //var classn = ee.Number(15) // one class
    var classn = clean_map.where({
      test: clean_map.neq(16) //TRF
              .and(clean_map.neq(15)) //RR
              .and(clean_map.neq(14)) //ORF
              .and(clean_map.neq(13)) //IRF
              //.and(clean_map.neq(12)) // deep L
              .and(clean_map.neq(11)), // shallow L 
      value: ee.Image(99) // 99 ensures it's ignored in logic
    });
    
    // Minimum size of object to reclass based on neighbourhood
    var max_size = ee.Number(1000).divide(vars.image_data_scale).pow(2); // the first number is the square dimension of the desired min size;
    // calculate neighbours
    var map_fc_neighbours = reduce_neighbours();
    
    // #########
    // REEF RIM
    // #########
    
    var focus_class = ee.Number(15); //RR
    
    // start the object-based neighbourhood rules
    // paint out to rasters (only paint the layers needed)
    var objsize = ee.Image(30000).paint(map_fc_neighbours, 'count').rename('count');
    //var nb24 = ee.Image().byte().paint(map_fc_neighbours, '24').unmask(0).rename('nb24') //OCL
    var nb22 = ee.Image().byte().paint(map_fc_neighbours, '22').unmask(0).rename('nb22'); //SL ex
    var nb21 = ee.Image().byte().paint(map_fc_neighbours, '21').unmask(0).rename('nb21'); //Sl sh
    var nb16 = ee.Image().byte().paint(map_fc_neighbours, '16').unmask(0).rename('nb16'); //TRF
    var nb15 = ee.Image().byte().paint(map_fc_neighbours, '15').unmask(0).rename('nb15'); //RR
    var nb14 = ee.Image().byte().paint(map_fc_neighbours, '14').unmask(0).rename('nb14'); //ORF
    var nb13 = ee.Image().byte().paint(map_fc_neighbours, '13').unmask(0).rename('nb13'); //IRF
    //var nb3 = ee.Image().byte().paint(map_fc_neighbours, '3').unmask(0).rename('nb3') //Turbid
    
    // RR surrounded by ORF --> ORF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb14.gt(75)),
      value: ee.Image(14)
    });
    
    // RR surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.gt(75)),
      value: ee.Image(13)
    });
    
    // RR surrounded by IRF + ORF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.add(nb14).gt(75)),
      value: ee.Image(13)
    });
    
    // RR with decent border to TRF --> TRF (often dark, probably seagrass)
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb16.gt(40)),
      value: ee.Image(16)
    });
    
    /*// RR surrounded by OCL --> OCL
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb24.gt(75)),
      value: ee.Image(24)
    })*/
    
    /* with 2nd/3rd pass method, we don't really need this
    // RR surrounded by IRF + ORF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.lte(75).and(nb14.lte(75))) // to ensure we're no re-writing previous rules
              .and(nb13.add(nb14).gt(75))
              .and(nb21.add(nb22).lte(0)), // to not get rid of complex reef rims (if touching slope, it's probably RR)
      value: ee.Image(13) // could try assigning to a place-holder, then deal with at the end?
    })*/
    
    /*// small RR objects touching OCL + stuff --> ORF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(objsize.lte(max_size))
              .and(nb13.lte(75).and(nb14.lte(75))) // to ensure we're no re-writing previous rules
              .and(nb24.gt(1)),
      value: ee.Image(14)
    })*/
    
    // ####
    // ORF
    // ####
    
    focus_class = ee.Number(14); // ORF
    
    //classn = ee.Number(14)
    //map_fc_neighbours = reduce_neighbours()
    //var nb22 = ee.Image().byte().paint(map_fc_neighbours, '22').unmask(0).rename('nb22') //SL ex
    //var nb21 = ee.Image().byte().paint(map_fc_neighbours, '21').unmask(0).rename('nb21') //Sl sh
    //nb15 = ee.Image().byte().paint(map_fc_neighbours, '15').unmask(0).rename('nb15') //RR
    //nb13 = ee.Image().byte().paint(map_fc_neighbours, '13').unmask(0).rename('nb13') //IRF
    //var nb1 = ee.Image().byte().paint(map_fc_neighbours, '1').unmask(0).rename('nb1') //Land
    
    // ORF surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.gt(75)),
      value: ee.Image(13)
    });
    
    // ORF surrounded by TRF --> TRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb16.gt(75)),
      value: ee.Image(16)
    });
    
    // ORF surrounded by RR --> RR
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb15.gt(85)),
      value: ee.Image(15)
    });
    
    // ORF touching slope and RR --> RR
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb21.gt(0).or(nb22.gt(0)))
              .and(nb15.gt(0)),
      value: ee.Image(15)
    });
    
    /*// ORF touching land --> TRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb1.gt(10)),
      value: ee.Image(16)
    })*/
    
    // ####
    // IRF
    // ####
    
    focus_class = ee.Number(13); // IRF
    
    //classn = ee.Number(13)
    //map_fc_neighbours = reduce_neighbours()
    //nb15 = ee.Image().byte().paint(map_fc_neighbours, '15').unmask(0).rename('nb15') //RR
    //nb14 = ee.Image().byte().paint(map_fc_neighbours, '14').unmask(0).rename('nb14') //ORF
    
    // IRF surrounded by ORF --> ORF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb14.gt(75)),
      value: ee.Image(14)
    });
    
    // IRF surrounded by TRF --> TRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb16.gt(75)),
      value: ee.Image(16)
    });
    
    // IRF surrounded by RR --> RR
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb15.gt(85)),
      value: ee.Image(15)
    });
    
    /*// IRF touching land --> TRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb1.gt(10)),
      value: ee.Image(16)
    })*/
    
    // ####
    // TRF
    // ####
    
    focus_class = ee.Number(16); // TRF
    
    //classn = ee.Number(16)
    //map_fc_neighbours = reduce_neighbours()
    //nb15 = ee.Image().byte().paint(map_fc_neighbours, '15').unmask(0).rename('nb15') //RR
    //nb14 = ee.Image().byte().paint(map_fc_neighbours, '14').unmask(0).rename('nb14') //ORF
    //nb13 = ee.Image().byte().paint(map_fc_neighbours, '13').unmask(0).rename('nb13') //IRF
    
    // TRF surrounded by ORF --> ORF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb14.gt(75)),
      value: ee.Image(14)
    });
    
    // TRF surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.gt(75)),
      value: ee.Image(13)
    });
    
    // TRF surrounded by IRF + ORF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.add(nb14).gt(75)),
      value: ee.Image(13)
    });
    
    /*// TRF not touching land --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb1.lt(10)),
      value: ee.Image(13)
    })*/
    
    
    // ####
    // LAGOONS
    // ####
    
    var nb11 = ee.Image().byte().paint(map_fc_neighbours, '11').unmask(0).rename('nb11'); // shallow lag
    //var nb12 = ee.Image().byte().paint(map_fc_neighbours, '12').unmask(0).rename('nb12') //deep lag
    
    // DL touching SL --> SL
    /* 
    This is a stop-gap until we have better depth product - below are the rules we want,
    but too much band-aiding is required to make it work, so for the moment just err on the side
    of shallow lagoon when it's mixed.
    */
    /*clean_map = clean_map.where({
      test: clean_map.eq(12)
              .and(nb11.gt(0)),
      value: ee.Image(11)
    })*/
    
    /*// SL sourrounded by DL --> DL
    clean_map = clean_map.where({
      test: clean_map.eq(11)
              .and(nb12.gt(75)),
      value: ee.Image(12)
    })*/
    
    /*// DL sourrounded by SL --> SL
    clean_map = clean_map.where({
      test: clean_map.eq(12)
              .and(nb11.gt(75)),
      value: ee.Image(11)
    })*/
    
    /*// DL/SL surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(11).or(clean_map.eq(12))
              .and(objsize.lte(max_size))
              .and(nb13.gt(80)),
      value: ee.Image(13)
    })*/
    
    // SL surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(11)
              .and(objsize.lte(max_size))
              .and(nb13.gt(80)),
      value: ee.Image(13)
    });
    
    /*// DL/SL touching OCL --> OCL
    clean_map = clean_map.where({
      test: clean_map.eq(11).or(clean_map.eq(12))
              .and(nb24.gt(0)),
      value: ee.Image(24)
    })*/
    
    
    /*// ####
    // Turbid
    // ####
    
    focus_class = ee.Number(3) // turbid
    
    // Turb surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.gt(75)),
      value: ee.Image(13)
    })
    
    // Turb surrounded by ORF --> ORF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb14.gt(75)),
      value: ee.Image(14)
    })
    
    // Turb surrounded by TRF --> TRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb16.gt(75)),
      value: ee.Image(16)
    })*/
  
  } else if (vars.geomorphic && vars.fast_clean) {
    print("Executing the fast version OBIA");
    
    /* fast version of the geo clean up
      - blanket version assigns the underlying most common in neighbourhood
      - mode OBIA version iterates through objects+buffers but take the mode instead of doing the class percs, to see if that speeds things up
    */
    
    
    //############
    //# blanket version
    //############
    // make a very smooth map to capture the broader neighbourhood
    var smooth_map = clean_map
                        .focal_mode({
                          radius: vars.smooth_radius.multiply(3), // relates to smoothness required
                          kernelType: 'circle', units: 'pixels', iterations: 2
                        });
    
    
    // first make a make size threshold, so we're not vectorising huge objects when we don't have t
    // - the unmask(99) captures small no data values/ data gaps
    var segment_id = clean_map.unmask(0).connectedComponents(ee.Kernel.plus(1),vars.small_object_geo.sqrt().multiply(2)).select('labels').pow(2).log().int();
    Map.addLayer(clean_map.unmask(0).updateMask(segment_id.gt(0)).reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))), display_pal, 'Map objects to be iterated through (OBIA)', false);
    
    
    // replace small objects with smooth underneath
    var clean_map = clean_map.unmask(0).where({
      test: segment_id.gt(0), 
      value: smooth_map
    }).selfMask();
    //############
    //############
    
    
    /*    
    //############
    //# mode OBIA version
    //############
    
    // #########
    // THE FASTER PLAN - vectorise one/few class/es at a time, thus only spending resources on what is actually needed to clean up
    //                 - BUT, just assign the mode of the neighbours, so save resouces even further??
    // #########
    
    // FUNCTION that maps over feature colleciton and assigns neighbour percentages
    var set_neighbour_mode = function(f) {
      // make the 1px buffer
      var diff = f.buffer(vars.image_data_scale).difference(f, ee.ErrorMargin(0.5))
      // reduce the classes in the buffer zone
      var diff_mode = ee.Number(ee.Dictionary(
        clean_map.unmask(ee.Image(0)).reduceRegion({
          reducer: ee.Reducer.mode(),
          geometry: diff.geometry(),
          scale: vars.image_data_scale,
          maxPixels: 1e11
        })).get('classification'))
      
      return(f.set('mode',diff_mode))
    }
    
    // FUNCTION to reduce the map to vectors and map the neighbour properties function
    var reduce_neighbours_mode = function() {
      // reduce map to vectors
      var map_fc = clean_map.unmask(0)
            .updateMask(classn.gt(0)) // only vectorise class/es of interest
            .reduceToVectors({
              scale: vars.image_data_scale, 
              eightConnected: false,
              bestEffort: true, 
              maxPixels: 1e13,
              tileScale: 1,
              geometry: reef_boundary
            })
      // map the function, calculate neighbour properties
      return(map_fc.map(set_neighbour_mode))
    }
    
    // first make a make size threshold, so we're not vecortising huge objects when we don't have to
    var segment_id = clean_map.unmask(0).connectedComponents(ee.Kernel.plus(1),vars.small_object_geo.sqrt()).select('labels')
    Map.addLayer(clean_map.unmask(0).updateMask(segment_id.gt(0)).reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))), display_pal, 'Map objects to be iterated through (OBIA)', false)
    
    // This is where we select the single or group of classes to vectorise for cleaning up
    var classn = segment_id.where({
      test: clean_map.neq(16) //TRF
              .and(clean_map.neq(15)) //RR
              .and(clean_map.neq(14)) //ORF
              .and(clean_map.neq(13)) //IRF
              //.and(clean_map.neq(12)) // deep L
              .and(clean_map.neq(11)) // shallow L 
              .and(clean_map.unmask(0).neq(0)), // no data values (want to reclaim the small gaps 
      value: ee.Image(0) // 99 ensures it's ignored in logic
    })
    
    // calculate neighbours
    var map_fc_neighbours = reduce_neighbours_mode()
    
    //print(map_fc_neighbours.limit(10))
    
    var mode_map = ee.Image().byte().paint(map_fc_neighbours, 'mode').unmask(0).rename('mode') // paint out the mode values to an image
    //Map.addLayer(mode_map, display_pal, "mode map", false)
    
    // replace small objects with mode underneath
    var clean_map = clean_map.unmask(0).where({
      test: segment_id.gt(0), 
      value: mode_map
    }).selfMask()
    
    //############
    //############
    */
    
  } else {
    
    if (vars.cleanup_stage == 1) {
      // BENTHIC CLEAN-UP RULES
      
      // reclaim shallow no data to surrounding class
      var smooth_map = clean_map
                          .focal_mode({
                            radius: vars.smooth_radius.multiply(3), // relates to smoothness required
                            kernelType: 'circle', units: 'pixels', iterations: 2
                          });
      
      var clean_map = clean_map.unmask(0).where({
        test: geo_map.gt(2).and(clean_map.eq(0)), 
        value: smooth_map
      }).selfMask();
      
      // cut benthic off to < 10 - 15 m
      clean_map = clean_map.where({
        test: depth.gt(vars.benthic_depth_cutoff),
        value: ee.Image(0)
      })
      
      // Deep (or land or missing) in geo == masked from benthic
      clean_map = clean_map.where({
        test: geo_map.unmask(0).lte(2),
        value: ee.Image(0)
      })
      
      // Deep lagoon in geo == masked from benthic
      clean_map = clean_map.where({
        test: geo_map.eq(12),
        value: ee.Image(0)
      })
      
      
      /*// turbid in geo == turbid (temporal - class num 2)
      // ############## ---> need to decide here whether to push geo turbid through regardless of benthic class
      clean_map = clean_map.where({
        test: geo_map.eq(3),
        value: ee.Image(2)
      })*/
      
      /*
      // Ignore in benthic + ORF in geo == rock
      clean_map = clean_map.where({
        test: clean_map.eq(0)
                       .and(geo_map.eq(14)),
        value: ee.Image(13)
      })
      
      // Ignore in benthic + IRF in geo == sand
      clean_map = clean_map.where({
        test: clean_map.eq(0)
                       .and(geo_map.eq(13)),
        value: ee.Image(11)
      })
      
      // Ignore in benthic + TRF in geo == sand
      clean_map = clean_map.where({
        test: clean_map.eq(0)
                       .and(geo_map.eq(16)),
        value: ee.Image(11)
      })
      
      // Ignore in benthic + RR in geo == rock
      */
      
      /*// seagrass in benthic + ORF/RR/slope in geo == coral/algae
      clean_map = clean_map.where({
        test: clean_map.eq(14)
                       .and(geo_map.eq(14).or(geo_map.eq(15)).or(geo_map.eq(21)).or(geo_map.eq(22))),
        value: ee.Image(15)
      })*/
      
      // ####--> CR: "Seagrass neighbouring deep water or no data not shallow a rock or coral algae class"
      
      /*// rock in benthic + TRF in geo == sand
      clean_map = clean_map.where({
        test: clean_map.eq(13)
                       .and(geo_map.eq(16)),
        value: ee.Image(11)
      })*/
    }
  }
}

// final smooth
if (!vars.manual_clean) {
  if (vars.smooth_output) {
    // smooth the output lightly to make nice edges, and get rid of noise
    var noise_smooth = clean_map.unmask(99) // unmasking to a value allows us to include masked areas in the smooth, then re-mask after
                          .focal_mode({
                            radius: 2, // relates to smoothness required
                            kernelType: 'circle', units: 'pixels', iterations: 2
                          });
    clean_map = clean_map.updateMask(noise_smooth.neq(99)).updateMask(clean_map.gt(1)); // this ignores 0/land; make it .gt(2) if you want to mask deep too;
  } else {
    // just clip to the classified extent and move on
    if (vars.geomorphic) {
      clean_map = clean_map.updateMask(clean_map.gt(1)); // this ignores 0/land; make it .gt(2) if you want to mask deep too
    } else {
      clean_map = clean_map.updateMask(clean_map.gt(1)); // this ignores 0/land; make it .gt(2) if you want to mask deep too
    }
  }
}

// 4. Export data

var output_name = (vars.geomorphic) ? vars.geomorph_output_name : vars.benthic_output_name;

if (vars.do_export) {
  print("For export, the image data scale must be set to:", vars.image_data_scale);
  
  if (vars.export_small_area) {
    var export_convhull = export_small;
  } else {
    //var export_convhull = clean_map.gt(2).reduceToVectors({scale: 1000, maxPixels: 1e13, bestEffort: true, geometry: region_extent, crs: "EPSG:4326"}).geometry().convexHull({maxError: 100})
    var export_convhull = reef_boundary;
  }
  Map.addLayer(export_convhull, {}, "Export footprint", false);
  
  Export.image.toAsset({
    image: clean_map.set(vars),
    description: output_name,
    assetId: vars.asset_output + 'in_out/' + output_name,
    region: export_convhull,
    scale: vars.image_data_scale,
    crs: 'EPSG:4326',
    maxPixels: 1e13,
    pyramidingPolicy: {'.default': 'mode'}
  });
  /*Export.image.toCloudStorage({
    image: clean_map,//.set(vars),
    description: 'swp_geo_clean',
    bucket: 'mitchest_unet_bucket',
    fileNamePrefix: 'swp_geo_clean',
    region: export_convhull,
    scale: 25,
    crs: 'EPSG:4326',
    maxPixels: 1e13
  })*/
  
} else {
  if (!vars.manual_clean) {
    if (vars.show_eg_area) {
      if (vars.reproject_display) {
        Map.addLayer(clean_map.clip(eg_area).reproject(ee.Projection('EPSG:4326').atScale(vars.image_data_scale)), display_pal, output_name + '_final', false);
      } else {
        Map.addLayer(clean_map.clip(eg_area), display_pal, output_name + '_final', false);
      }
    } else {
      if (vars.reproject_display) {
        Map.addLayer(clean_map.reproject(ee.Projection('EPSG:4326').atScale(vars.image_data_scale)), display_pal, output_name + '_final', true);
      } else {
        Map.addLayer(clean_map, display_pal, output_name + '_final', false);
      }
    }
  }
}

//Generate title
var title = ui.Label({
  value: 'Classes',
  style: {fontWeight: 'bold', fontSize: '12px'}
});

// generate the legend
var geo_legend = pkg_vis.discrete_legend(map_palettes.geo_atlas_names, map_palettes.geo_atlas_cols, 'Geomorphic Zone', false);
var benthic_legend = pkg_vis.discrete_legend(map_palettes.benthic_atlas_names, map_palettes.benthic_atlas_cols, 'Benthic Habitat', false);
//var mask_legend = pkg_vis.discrete_legend(["Low confidence depth","Water conditions"], ["#f7f7f7","#bababa"], 'Confidence Mask reason', false)
var legend = (vars.geomorphic) ? geo_legend : benthic_legend;
pkg_vis.add_lgds([title, legend]);//, mask_legend])
// generate the legend