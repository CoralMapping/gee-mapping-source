/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var centre_map = /* color: #d63000 */ee.Geometry.Point([178.66718749999995, -17.911111431319622]),
    pixels_east = ee.Image("projects/coral_atlas/sw_pacific/in_out/swp_pixels_east"),
    pixels_west = ee.Image("projects/coral_atlas/sw_pacific/in_out/swp_pixels_west"),
    mid_mask = /* color: #98ff00 */ee.Geometry.MultiPolygon(
        [[[[178.50957506843622, -18.17420088978383],
           [178.51138524796332, -18.175939445901463],
           [178.51152172812422, -18.179716646742296],
           [178.51303151262516, -18.178764130082104],
           [178.5120015538885, -18.17407509015142],
           [178.51388981950993, -18.171017022993443],
           [178.51878227540544, -18.170568555400234],
           [178.52281633452168, -18.168733696971707],
           [178.52994015825504, -18.167184116557458],
           [178.53723567283677, -18.164982271359477],
           [178.53923124107413, -18.165777374541797],
           [178.54002520410094, -18.16804041413426],
           [178.5400896179755, -18.170874292100663],
           [178.53952101003657, -18.173025176458296],
           [178.53757908952946, -18.17387126035105],
           [178.53028365950277, -18.176317815660493],
           [178.52612083385293, -18.176970157169723],
           [178.52266609627716, -18.1781117771671],
           [178.52070808757927, -18.180558194995513],
           [178.51832089557695, -18.180965934129816],
           [178.5155045385815, -18.18039509727916],
           [178.51208737505192, -18.18096587670093],
           [178.5124735560339, -18.1843092287169],
           [178.51526303637573, -18.185369325592987],
           [178.52341696929363, -18.183697760736557],
           [178.52637813788175, -18.18449276272807],
           [178.52693608415836, -18.186021634141554],
           [178.52496198530693, -18.187570934481034],
           [178.52277328822152, -18.18740785069224],
           [178.52193641947258, -18.18846791088564],
           [178.52633526933903, -18.191811111847997],
           [178.53148509870675, -18.191933422354975],
           [178.5341458619904, -18.19124032681271],
           [178.5404973329377, -18.191484949199502],
           [178.5454755128693, -18.192218814300563],
           [178.547535440722, -18.19278959270027],
           [178.55011037004704, -18.19360499550779],
           [178.54908040178532, -18.196866554869278],
           [178.5442309758266, -18.19870121584023],
           [178.53938153398747, -18.19743732148307],
           [178.5360340696798, -18.194909753523312],
           [178.52968266618961, -18.19368653523557],
           [178.52616360796208, -18.19368653523557],
           [178.52277935590033, -18.194216688178532],
           [178.521117907901, -18.19577613755491],
           [178.51894145579863, -18.196030945724743],
           [178.51647992317498, -18.195546791244194],
           [178.51564919963482, -18.193513376884418],
           [178.51456175405428, -18.189784118104324],
           [178.51527675179852, -18.186625651209614],
           [178.51238688440884, -18.18542414283101],
           [178.51310187821244, -18.189115222815236],
           [178.51212863333166, -18.190667028634895],
           [178.51029706840933, -18.190751081009534],
           [178.5042030895275, -18.19050645759315],
           [178.49398923759878, -18.190669539908864],
           [178.49055601005972, -18.191648030600017],
           [178.4788830364269, -18.23697874009311],
           [178.46515012627066, -18.287187456396726],
           [178.5612804973644, -18.29859650229789],
           [178.61689878349722, -18.30381181595877],
           [178.66736722832144, -18.287839422106845],
           [178.69998288994253, -18.269909471986345],
           [178.77208066826284, -18.23860912117723],
           [178.75525571438578, -18.195400986215194],
           [178.69105649834097, -18.195888093468643],
           [178.654320963673, -18.217165522259304],
           [178.6488277996105, -18.203285361161893],
           [178.63612485771597, -18.186651382969966],
           [178.62239194755972, -18.165122703171825],
           [178.61861539726675, -18.166101337134208],
           [178.61415220146597, -18.168711000885462],
           [178.60625577812613, -18.17393021136018],
           [178.60076261406363, -18.174582601696688],
           [178.59114957695425, -18.17914926576564],
           [178.58634305839956, -18.18795606606802],
           [178.5832531536144, -18.18143255298171],
           [178.58187986259878, -18.174582601696688],
           [178.58084989433706, -18.171646825979042],
           [178.57535673027456, -18.167406173885492],
           [178.56952024345816, -18.166753756728728],
           [178.5616238201183, -18.1677323815497],
           [178.55939222221792, -18.16137122217694],
           [178.55304061985342, -18.156967109350987],
           [178.55132413750113, -18.14979005522289],
           [178.5437710369152, -18.14554887251442],
           [178.533471354298, -18.15076877508011],
           [178.5327847087902, -18.15435736766349],
           [178.52591825371206, -18.16414406372492],
           [178.5231716716808, -18.165448915102036],
           [178.51836515312613, -18.164796490632238],
           [178.51424528007925, -18.16218676837857],
           [178.5053188884777, -18.152073726364016],
           [178.50360227470816, -18.137392462747588],
           [178.4998257244152, -18.130867061062272],
           [178.4950192058605, -18.127277986398415],
           [178.48197294121206, -18.133803521940948],
           [178.47682309990347, -18.13837125200592],
           [178.4723599041027, -18.14424387251854],
           [178.4668667400402, -18.15305243343235],
           [178.4646351421398, -18.16169744111456],
           [178.468068207388, -18.17360390808747],
           [178.47750974541128, -18.175561182628943],
           [178.4836466341627, -18.17639708290507],
           [178.4847195232433, -18.176091245009502],
           [178.48434402012933, -18.175020925410607],
           [178.48521305628682, -18.174317572789082],
           [178.48707986717642, -18.174052534734017],
           [178.48770214330733, -18.174949569273647],
           [178.48853899615938, -18.174664147435703],
           [178.48883940178433, -18.173257428676973],
           [178.48969770317495, -18.172870071862334],
           [178.4903092385638, -18.17270697359794],
           [178.49083494459248, -18.173277818533784],
           [178.49222969404653, -18.175071891400695],
           [178.49398923759878, -18.17719213865542],
           [178.4963280621378, -18.176539764200072],
           [178.49789438493266, -18.174908795950458],
           [178.50132761247173, -18.171973025719446],
           [178.50506124131525, -18.172054611373188],
           [178.5081511522056, -18.172870071862334]]],
         [[[179.25387449972985, -17.468008890105484],
           [179.36923094504235, -17.38841137346063],
           [179.37541075461266, -17.368096989273653],
           [179.3726641725814, -17.355645123932295],
           [179.36579771750328, -17.33991524303029],
           [179.35961790793297, -17.31893997106699],
           [179.35584135764, -17.305829209853062],
           [179.35523651606175, -17.29842027195481],
           [179.35592316156956, -17.29170037384915],
           [179.35557983881566, -17.285635864933585],
           [179.35231827265355, -17.283505044104686],
           [179.3495716906223, -17.284160683909157],
           [179.34613846308324, -17.285799773206733],
           [179.34425018793675, -17.283505044104686],
           [179.34510849482152, -17.27858767116694],
           [179.34751175409886, -17.27858767116694],
           [179.3495716906223, -17.279735069929064],
           [179.3502583361301, -17.275309349607365],
           [179.34974335199925, -17.269266730930667],
           [179.3466534472141, -17.26582431763703],
           [179.3437352038059, -17.26189005230034],
           [179.34304855829808, -17.25533275686526],
           [179.33961533075902, -17.251562206430634],
           [179.33686874872777, -17.249430991663647],
           [179.33738373285863, -17.24404330746359],
           [179.34528015619847, -17.238305131734744],
           [179.34837006098363, -17.229451596545818],
           [179.35386322504613, -17.22502466983371],
           [179.36210297113988, -17.22371296747824],
           [179.36656616694066, -17.2253525939679],
           [179.36759613520238, -17.228467844219992],
           [179.3660511828098, -17.231910954443386],
           [179.3667378283176, -17.236337716146657],
           [179.36622284418675, -17.241584111132447],
           [179.36107300287816, -17.247650069485136],
           [179.35901306635472, -17.250109184995697],
           [179.36038635737034, -17.253715828462134],
           [179.36330460077855, -17.253387954696784],
           [179.36690948969456, -17.248797660801465],
           [179.3696560717258, -17.247486127285967],
           [179.37326096064183, -17.24715824245071],
           [179.37755249506566, -17.246666414105615],
           [179.38115738398167, -17.24568275348345],
           [179.38888214594456, -17.243715416512277],
           [179.38853882319066, -17.239616730481586],
           [179.38716553217503, -17.235681906292864],
           [179.38885223926513, -17.228139925614073],
           [179.3926287895581, -17.227320126553213],
           [179.3952037102124, -17.2304353436336],
           [179.39640533985107, -17.23486214070079],
           [179.39571869434326, -17.239452781147733],
           [179.39709198535888, -17.241420163545612],
           [179.40704834522217, -17.242567793596095],
           [179.41374313892334, -17.242567793596095],
           [179.4200946098706, -17.239780679669845],
           [179.4255877739331, -17.238305131734744],
           [179.43005096973388, -17.235681906292864],
           [179.43235092885467, -17.230096304860666],
           [179.43733524339032, -17.226647301409407],
           [179.4411117936833, -17.224679761660433],
           [179.44265674607587, -17.226483340563778],
           [179.44128345506024, -17.229926487769518],
           [179.4395668412907, -17.23386143457426],
           [179.43991016404462, -17.242058971160137],
           [179.43973850266767, -17.24615760296759],
           [179.44042514817548, -17.251895534587565],
           [179.4417984391911, -17.25517427254239],
           [179.44265674607587, -17.259928339060362],
           [179.44128345506024, -17.26255121985189],
           [179.44076847092938, -17.26664939639187],
           [179.44059680955243, -17.26927218156394],
           [179.44042514817548, -17.273698046904695],
           [179.4414551164372, -17.278779464898243],
           [179.44488834397626, -17.285827651324567],
           [179.44969486253095, -17.292547763856465],
           [179.45398639695478, -17.2997593189771],
           [179.4575912858708, -17.30647892271775],
           [179.45982288377118, -17.31188720591645],
           [179.46068119065595, -17.316312046549367],
           [179.4608528520329, -17.32155616415289],
           [179.45947956101728, -17.32483366164284],
           [179.45741962449384, -17.328438841334012],
           [179.45432971970868, -17.33269941699128],
           [179.44883655564618, -17.340400975901915],
           [179.4436867143376, -17.349576879411035],
           [179.4381935502751, -17.355803123925615],
           [179.43321537034345, -17.358916166892435],
           [179.42832043304907, -17.376802976568847],
           [179.42540218964086, -17.378768889756294],
           [179.42076733246313, -17.38384740110687],
           [179.413900877385, -17.388106689063296],
           [179.40651943817602, -17.39220206474816],
           [179.40118267214237, -17.395783173558304],
           [179.39311458742557, -17.402007847088793],
           [179.3783517090076, -17.409870289647348],
           [179.36942531740604, -17.4144565582506],
           [179.36564876711307, -17.41674964937482],
           [179.2609568938983, -17.489931997828588],
           [179.48480332944519, -17.52005498067853],
           [179.5795604095233, -17.3510399468179],
           [179.5795604095233, -17.193676650461555],
           [179.47746944003646, -17.10705585116207],
           [179.31404780917708, -17.09261743698325],
           [179.25087642245833, -17.133304643978217],
           [179.2330236392552, -17.197598511200585],
           [179.23714351230208, -17.333984906634726]]],
         [[[179.966524097599, -18.498733956379176],
           [179.99124333588026, -18.446632680208626],
           [179.98025700775526, -18.38930301954071],
           [179.8951129647865, -18.384090285484287],
           [179.6753864022865, -18.480500310286786],
           [179.65616032806776, -18.553423241011863],
           [179.6973590585365, -18.740796118617663],
           [179.7962360116615, -18.82660605939499],
           [179.96927067963026, -18.811007504418544],
           [-179.97851699011107, -18.63418512443291],
           [179.96517807824827, -18.620520922369288],
           [179.94663864953733, -18.62572646219372],
           [179.92466599328733, -18.652402351225565],
           [179.92397934777952, -18.66606398845846],
           [179.91333634240843, -18.699725467609834],
           [179.9135080505444, -18.705009803675857],
           [179.91024643762327, -18.709968937716305],
           [179.90509656975348, -18.71216405070766],
           [179.89720017297483, -18.70915598655221],
           [179.8870721517346, -18.70574154900732],
           [179.87660080774046, -18.70606673650395],
           [179.86389786584593, -18.705578955024674],
           [179.8537698446057, -18.703302622864026],
           [179.84295517785765, -18.696961250409547],
           [179.83677536828733, -18.68313948753722],
           [179.83746201379515, -18.67712260317469],
           [179.83904986964623, -18.674723859691433],
           [179.83823445232616, -18.671024123447694],
           [179.83488709314085, -18.667202408568304],
           [179.82784897668577, -18.660209135770813],
           [179.8299089132092, -18.647848227742358],
           [179.83677536828733, -18.637438343954518],
           [179.83677536828733, -18.627678498536035],
           [179.8299089132092, -18.621822322266553],
           [179.82235581262327, -18.620520922369288],
           [179.8161758802409, -18.61385114386804],
           [179.81119782312132, -18.607180999284843],
           [179.801413124635, -18.593514627899776],
           [179.79892399507375, -18.590423240199897],
           [179.79780823571897, -18.586030197842373],
           [179.80098435416053, -18.58245075318575],
           [179.80746450205496, -18.579440729062203],
           [179.8214975057385, -18.578382723212684],
           [179.83136866688776, -18.57610526437229],
           [179.84055285521305, -18.572525580236018],
           [179.8520540723983, -18.56756212750857],
           [179.8618379293225, -18.562761283513556],
           [179.87814623440738, -18.556822134638598],
           [179.8925653157971, -18.55462455042764],
           [179.90423831823034, -18.556089791372585],
           [179.91050406095482, -18.556740701978633],
           [179.93376404626585, -18.550881522950736],
           [179.95033005198758, -18.546650522422826],
           [179.96500641687132, -18.536071348880125]]],
         [[[177.5142483299149, -18.174236777471638],
           [177.51150174788364, -18.174236777471638],
           [177.50532193831333, -18.173584385842453],
           [177.49725385359653, -18.172605793826435],
           [177.49055905989536, -18.171627196323946],
           [177.4852375572098, -18.17130099593728],
           [177.48060270003208, -18.177498699036803],
           [177.48008771590122, -18.179618915356976],
           [177.47734113386997, -18.179782007852936],
           [177.4713329856766, -18.178477263616685],
           [177.46755643538364, -18.177661793514556],
           [177.46343656233677, -18.177824887839854],
           [177.45914502791294, -18.178477263616685],
           [177.4467854087723, -18.18565323616405],
           [177.4431805198563, -18.19152426684019],
           [177.44146390608677, -18.198373552767038],
           [177.45313687971958, -18.216963114647164],
           [177.46274991682895, -18.22315919429798],
           [177.48266263655552, -18.224952755134304],
           [177.50154538802036, -18.223485297643176],
           [177.51356168440708, -18.219245906495082],
           [177.53210111311802, -18.201145806267085],
           [177.53759427718052, -18.19282891347893],
           [177.53896756819614, -18.186957926729125],
           [177.5372509544266, -18.18369618201706],
           [177.53347440413364, -18.1807605596271],
           [177.53124280623325, -18.1791296369544],
           [177.5262646263016, -18.180108192387486],
           [177.52128644636997, -18.18059746804588],
           [177.51853986433872, -18.18027128442607],
           [177.51768155745395, -18.178477263616685],
           [177.51699491194614, -18.176030841877548]]],
         [[[-178.6743208721046, -18.830205399892396],
           [-178.67157429007335, -18.82825570143479],
           [-178.669171030796, -18.826955889894794],
           [-178.66376369742198, -18.826062263628938],
           [-178.6600729778175, -18.825087393192167],
           [-178.65698307303234, -18.824274996841844],
           [-178.65475147513195, -18.822568951724463],
           [-178.65354984549327, -18.822081507081798],
           [-178.65183323172374, -18.822406470333974],
           [-178.6450526073341, -18.82354383676909],
           [-178.64239185599132, -18.824274996841844],
           [-178.63947361258312, -18.8248436746994],
           [-178.63749950674816, -18.82516863261122],
           [-178.63604038504405, -18.824193756990834],
           [-178.63501041678234, -18.82411251710056],
           [-178.63449543265148, -18.825087393192167],
           [-178.63346546438976, -18.826955889894794],
           [-178.63140552786632, -18.82914931603619],
           [-178.62917392996593, -18.830205399892396],
           [-178.62350910452648, -18.831830131324413],
           [-178.62033336905284, -18.832804962641585],
           [-178.61741512564464, -18.8340234938331],
           [-178.6153551891212, -18.83532325069453],
           [-178.61363857535167, -18.836541763617642],
           [-178.61114948538585, -18.838166433763487],
           [-178.6087462261085, -18.838816297421072],
           [-178.60702961233898, -18.839547391029836],
           [-178.60428303030773, -18.84027848145567],
           [-178.60239475516124, -18.840847105141798],
           [-178.60016315726085, -18.839872320500948],
           [-178.5981032207374, -18.83930369351391],
           [-178.5959574535255, -18.84035971352872],
           [-178.5926958873634, -18.84149695842523],
           [-178.59003513602062, -18.84385265549321],
           [-178.58883350638195, -18.845964631659374],
           [-178.58591526297374, -18.850432185990062],
           [-178.58488529471202, -18.851325682585678],
           [-178.58076542166515, -18.849132546086302],
           [-178.57126162486577, -18.82994203190516],
           [-178.57503817515874, -18.81726856774466],
           [-178.58774111705327, -18.80654412110215],
           [-178.60250399547124, -18.804919145295944],
           [-178.60937045054936, -18.799069102458855],
           [-178.61452029185796, -18.79256881638497],
           [-178.6165802283814, -18.748035113365347],
           [-178.62344668345952, -18.72690187222817],
           [-178.63511965709233, -18.716496844083814],
           [-178.65983889537358, -18.711944442929994],
           [-178.6879913611939, -18.72267490677938],
           [-178.7044708533814, -18.736656004383303],
           [-178.71271059947514, -18.75811311223647],
           [-178.71889040904546, -18.77891739885295],
           [-178.6989776893189, -18.815968671241205],
           [-178.6831848426392, -18.825392693183304],
           [-178.67906496959233, -18.82571765003357],
           [-178.6770050330689, -18.82896718397628]]],
         [[[166.67343565280186, -21.91717861541719],
           [166.6758389120792, -21.915267549256793],
           [166.6806454306339, -21.907410104046043],
           [166.67789884860264, -21.898013137566288],
           [166.66536756808506, -21.88170157143229],
           [166.6457981711124, -21.86784231264516],
           [166.61421247775303, -21.831037063228965],
           [166.60614439303623, -21.82434418148962],
           [166.55600136705323, -21.781391230244868],
           [166.53076714464112, -21.7606669723853],
           [166.50604790635987, -21.753970803191866],
           [166.49797982164307, -21.757318926830415],
           [166.4905983824341, -21.759710395909334],
           [166.48785180040284, -21.757318926830415],
           [166.4864785093872, -21.75524628807023],
           [166.47879750191052, -21.757518996804237],
           [166.48188740669568, -21.762142461299657],
           [166.47725254951794, -21.76469327451118],
           [166.4781108564027, -21.76692519887863],
           [166.48154408394177, -21.77138894346235],
           [166.4836040204652, -21.776490195776457],
           [166.48686558662732, -21.779997201496414],
           [166.48995549141247, -21.782866506018355],
           [166.49407536445935, -21.786373355787003],
           [166.49699360786755, -21.78748915363219],
           [166.50111348091443, -21.785098147614708],
           [166.50574833809216, -21.782866506018355],
           [166.50797993599255, -21.781910077557562],
           [166.5071216291078, -21.780156608809513],
           [166.5055766767152, -21.777446660387255],
           [166.50317341743786, -21.77792489030059],
           [166.5004268354066, -21.77617137282203],
           [166.4993968671449, -21.774258420212377],
           [166.49630696235974, -21.770591856400852],
           [166.4975085919984, -21.768838249276794],
           [166.49956852852185, -21.767244042382938],
           [166.50094181953747, -21.76708462071935],
           [166.50368840156872, -21.769475927074613],
           [166.5052333539613, -21.771229526404365],
           [166.50866658150036, -21.774099006343263],
           [166.5103831952699, -21.775852549158873],
           [166.51278645454724, -21.778399162876724],
           [166.51467472969372, -21.780949687044775],
           [166.5162196820863, -21.784137778457215],
           [166.51742131172497, -21.78796339457131],
           [166.51759297310193, -21.79083253965344],
           [166.5162196820863, -21.793382842617998],
           [166.51124150215466, -21.793064057229472],
           [166.5071216291078, -21.790513748591774],
           [166.50214344917615, -21.789557371152178],
           [166.5004268354066, -21.79274527113177],
           [166.50025517402966, -21.79481736809013],
           [166.50180012642224, -21.796730046379142],
           [166.5059199994691, -21.800395941728198],
           [166.5110698407777, -21.80246792803726],
           [166.51450306831677, -21.804380504181026],
           [166.5165630048402, -21.806930565975613],
           [166.5165630048402, -21.809002457747173],
           [166.51244313179333, -21.811552437232848],
           [166.5162196820863, -21.813464892041914],
           [166.52772099434216, -21.82188938108313],
           [166.52960926948865, -21.824917204036126],
           [166.53132588325818, -21.82539527548718],
           [166.53475911079724, -21.82316426171498],
           [166.5375056928285, -21.824757846530783],
           [166.53973729072888, -21.826829480255054],
           [166.54248387276013, -21.82969784665451],
           [166.5436855023988, -21.834159635610327],
           [166.54454380928357, -21.835593752497754],
           [166.54763371406872, -21.839577335049057],
           [166.55038029609997, -21.842126769631665],
           [166.5524402326234, -21.844357487593122],
           [166.55879170357068, -21.851368088807707],
           [166.55999333320935, -21.856466491829043],
           [166.56170994697888, -21.86236129348001],
           [166.56394154487927, -21.86634412982084],
           [166.5678897565492, -21.87000824112633],
           [166.5711513227113, -21.873194348419812],
           [166.5740695661195, -21.876061784172055],
           [166.57578617988904, -21.877176882515712],
           [166.57767445503552, -21.87892916230671],
           [166.58059269844372, -21.88147789449571],
           [166.58351094185193, -21.883230121462645],
           [166.58814579902966, -21.884185872554717],
           [166.59175068794568, -21.885300907401707],
           [166.5963855451234, -21.887690238435496],
           [166.59947544990857, -21.890716666947117],
           [166.6018787091859, -21.893265188506092],
           [166.6066852277406, -21.897406438880385],
           [166.61492497383435, -21.902065201745035],
           [166.6204610532411, -21.899676111605846],
           [166.62297159895473, -21.899317760500836],
           [166.62505299507458, -21.899915022421926],
           [166.6274562427893, -21.900412738388045],
           [166.62878662621225, -21.901338491780724],
           [166.62878664844135, -21.902463329699255],
           [166.6277352552703, -21.903259711159926],
           [166.62493502761623, -21.904314881735626],
           [166.62310574093047, -21.90464337373748],
           [166.62322105829188, -21.906201210926245],
           [166.6232934659608, -21.908834072966844],
           [166.6206110886796, -21.9125169896052],
           [166.6178537286101, -21.915075166026714],
           [166.61570261154486, -21.91635431639759],
           [166.61943359741136, -21.920338255258113],
           [166.62258666104356, -21.92467899561692],
           [166.6257082158649, -21.91916551619318],
           [166.62842760241855, -21.91816048394423],
           [166.63081725292102, -21.91789682107967],
           [166.6313254338925, -21.91878021159006],
           [166.63183361946423, -21.91918584217791],
           [166.63513806480788, -21.919454670101334],
           [166.6384425392594, -21.920440064667922],
           [166.64153245830437, -21.921425393946222],
           [166.6444507306703, -21.9218134792312],
           [166.6481414001559, -21.923664780624076],
           [166.64844185768445, -21.925993710958387],
           [166.64331350450405, -21.927825065776094],
           [166.64336722635974, -21.93089055656949],
           [166.64893024057326, -21.933259241105173],
           [166.65501619610927, -21.93508038156455],
           [166.6623077008446, -21.935552970352656],
           [166.66715493668602, -21.936466012679425],
           [166.66794765713217, -21.93556908645111],
           [166.66765737150425, -21.934045816536575],
           [166.66818563612557, -21.93251053568029],
           [166.66807016974803, -21.9314529623316],
           [166.66565876774843, -21.929559419724402],
           [166.66576213181781, -21.928015434441022],
           [166.666552132953, -21.926869553479982],
           [166.66751772370964, -21.92507802607769],
           [166.66861206947644, -21.92201254066831],
           [166.6707363968182, -21.921057039565316],
           [166.67157322822888, -21.91858864517568]]]]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
// Viewing script for looking at reefs and classifications for each region. 
// From this region Timor Sea onwards the map_viewer script is going to be used from the very beginning
// in the workflow 

// Load and libraries needed
var map_palettes = require('users/mitchest/global_reefs:Modules/colour_pals');
var param_module = require('users/mitchest/global_reefs:Modules/reef_params');
var pkg_vis = require('users/mitchest/global_reefs:Modules/pkg_vis');

// ###########################################
// SENSOR GENERICS
var sensor_params = param_module.dove  ;      //<------------ THIS IS WHERE YOU CHOOSE THE SENSOR
// REGION AND SENSOR SPECIFIC LOAD PATHS
var region_params = param_module.swpac;       //<------------ THIS IS WHERE YOU CHOOSE THE REGION
//  ^^ all the data paths are in this module ^^
// ###########################################

// Choose which layers will be shown in the map viewer
var vars = {
  raw: true,
  geo_clean1: true,
  geo_clean2: true,
  geo_clean3: false,
  benthic_clean1: false,
};

// choose where to centre the map (link this dynamically to map app?)
Map.centerObject(centre_map, 6);

// Add low-tide base map
var pixels = ee.ImageCollection([pixels_east, pixels_west]).mosaic();
Map.addLayer(pixels, {bands: ['b3','b2','b1'], min: 0, max: 3000}, sensor_params.sname, false); // image data

// Load the raw classifications
if (vars.raw) {
// geo raw (test if more than one map exists for the region)
  if (ee.List(region_params.geo_map).length().getInfo() > 1) {
    var geo_map_raw = ee.Image(region_params.geo_map[0]).unmask(0, false)
                 .add(ee.Image(region_params.geo_map[1]).unmask(0, false))
                 .selfMask();
  } else {
    var geo_map_raw = ee.Image(region_params.geo_map);
  }

  // benthic raw (test if more than one map exists for the region)
  if (ee.List(region_params.benthic_map).length().getInfo() > 1) {
    var benthic_map_raw = ee.Image(region_params.benthic_map[0]).unmask(0, false)
                     .add(ee.Image(region_params.benthic_map[1]).unmask(0, false))
                     .selfMask();
  } else {
      var benthic_map_raw = ee.Image(region_params.benthic_map);
  }

  // Add the raw region classification to the viewer
  Map.addLayer(geo_map_raw, map_palettes.geo, 'Geomorphic RAW', false);
  Map.addLayer(benthic_map_raw.updateMask(geo_map_raw.gt(2)), map_palettes.benthic, 'Benthic RAW', false);
}

// Load the clean classifications
var geo_clean1 = ee.Image(region_params.geo_map_clean1);
var geo_clean2 = ee.Image(region_params.geo_map_clean2);
var geo_clean3 = ee.Image(region_params.geo_map_clean3);

if (vars.geo_clean1) Map.addLayer(geo_clean1, map_palettes.geo, 'Geomorphic clean - stage 1', false);
if (vars.geo_clean2) Map.addLayer(geo_clean2, map_palettes.geo, 'Geomorphic clean - stage 2', false);
if (vars.geo_clean3) Map.addLayer(geo_clean3, map_palettes.geo, 'Geomorphic clean - stage 3', false);

// Geo Training Data
var geo_train = ee.FeatureCollection(region_params.geo_train_library);

var geo_buff = function(feature) {
  return feature.buffer(20);   // substitute in your value of Z here
};

var geo_train_buff = geo_train.map(geo_buff)

// Create an empty image into which to paint the features, cast to byte.
var empty = ee.Image().byte();

// Paint the interior of the polygons with different colors.
var geo_fill = empty.paint({
  featureCollection: geo_train_buff,
  color: 'class_num',
});

Map.addLayer(geo_fill, map_palettes.geo, 'Geo Training Data');


////////// UI SET UP //////////

//Generate title
var title = ui.Label({
  value: 'Coral Atlas map classes',
  style: {fontWeight: 'bold', fontSize: '18px'}
});

// generate the legend
var geo_legend = pkg_vis.discrete_legend(map_palettes.geo_atlas_names, map_palettes.geo_atlas_cols, 'Geomorphic Zone', false);
var benthic_legend = pkg_vis.discrete_legend(map_palettes.benthic_atlas_names, map_palettes.benthic_atlas_cols, 'Benthic Habitat', false);
//var mask_legend = pkg_vis.discrete_legend(["Low confidence depth","Water conditions"], ["#f7f7f7","#bababa"], 'Confidence Mask reason', false)
pkg_vis.add_lgds([title, geo_legend, benthic_legend]);//, mask_legend])
// generate the legend

