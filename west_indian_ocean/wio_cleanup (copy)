/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var MayotteNotRB = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[44.93353752487357, -12.911249544927387],
           [44.94109062545951, -12.95809511901116],
           [45.033101123506384, -13.06714418570024],
           [45.121676458316315, -13.103275530389817],
           [45.211628955537634, -13.077845799375721],
           [45.25969414108451, -13.020319175455509],
           [45.25076774948295, -12.995565235483856],
           [45.214375537568884, -13.011622126750671],
           [45.17729668014701, -13.039719183798846],
           [45.090779346162634, -13.04105705936047],
           [45.03996757858451, -13.014298174238446],
           [45.000142139131384, -12.931996527163442],
           [44.97130302780326, -12.861717532702869],
           [44.931477588350134, -12.871758596798994]]],
         [[[45.066060107881384, -12.576102055618168],
           [45.06194023483451, -12.606928082828533],
           [45.12511162155326, -12.620999601831386],
           [45.13335136764701, -12.634400329135246],
           [45.16425041549857, -12.65048027450181],
           [45.203389209443884, -12.686656446537798],
           [45.24046806686576, -12.71679932983544],
           [45.274800342256384, -12.746938634929284],
           [45.30913261764701, -12.787118795281767],
           [45.324238818818884, -12.740241321207941],
           [45.283040088350134, -12.666559207025417],
           [45.200642627412634, -12.606257991208416],
           [45.12305168502982, -12.57744239467687]]]]),
    BMAtoCoral = 
    /* color: #1380f0 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[57.801999542038345, -20.332731662532623],
           [57.78071353129616, -20.349149246855852],
           [57.75290438822975, -20.38262283497072],
           [57.78483340434303, -20.4061143803561],
           [57.83564517192116, -20.34432072663058],
           [57.805776092331314, -20.327580688514043]]],
         [[[46.379132744394916, -9.363840121135988],
           [46.39183568628945, -9.374171781241422],
           [46.43269109400429, -9.376373570699558],
           [46.436295982920306, -9.387043583178746],
           [46.44711064966835, -9.394834178478282],
           [46.458783623301166, -9.386027405660645],
           [46.47457646998085, -9.382978855232931],
           [46.48968267115273, -9.386196768787226],
           [46.498780724131244, -9.379760911814145],
           [46.455522057139056, -9.365195110463779],
           [46.410890099131244, -9.358250734312143]]],
         [[[46.26602095772106, -9.484091094053468],
           [46.240356820243804, -9.480493958729495],
           [46.21572394720031, -9.466397310403345],
           [46.227309521785564, -9.493616434845022],
           [46.256106401179544, -9.499098343833625],
           [46.287650291217155, -9.498482567353868],
           [46.321128206805234, -9.486300115325815],
           [46.35318808518665, -9.473434889019712],
           [46.40961969154483, -9.453791273695941],
           [46.441458884967155, -9.463264716631668],
           [46.471671287310905, -9.460894154609212],
           [46.496905509723014, -9.449041099412153],
           [46.4987937848695, -9.4410823904624],
           [46.46531981636364, -9.452427728277064],
           [46.44712371040661, -9.452766389330776],
           [46.42154616524059, -9.444977100798987],
           [46.397003013228904, -9.445916441330047]]]]),
    SGtoRB = 
    /* color: #ffc82d */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[44.448445469018495, -12.321078359117672],
           [44.48655429470209, -12.368199935205475],
           [44.49616733181146, -12.371050434455384],
           [44.50097385036615, -12.348077879907246],
           [44.47282138454584, -12.32057523606313],
           [44.450162082788026, -12.3140345485576]]],
         [[[44.30157592659927, -12.228031989796571],
           [44.29951599007583, -12.234323169554095],
           [44.3142788684938, -12.240530320115308],
           [44.332646635827786, -12.242962812308077],
           [44.345735884280096, -12.240656271181445],
           [44.35024192696548, -12.238852726238573],
           [44.327153471765286, -12.233400472560975]]],
         [[[44.22123840218521, -12.193889245577944],
           [44.26861694222427, -12.217965790817999],
           [44.27762916451431, -12.22174066032913],
           [44.28260734444595, -12.21486196887535],
           [44.25488403206802, -12.20001345239615],
           [44.209736895592556, -12.176984515316917],
           [44.214714989496294, -12.185436939991664]]],
         [[[44.203998477402614, -12.167784284373734],
           [44.20605841392605, -12.172482780836695],
           [44.23197928184597, -12.171727670938013],
           [44.231464297715114, -12.167364771720505],
           [44.20365515464871, -12.16459597160023]]]]),
    DL_SGtoSD = 
    /* color: #f6ff17 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[44.51724522032148, -12.26586971247598],
           [44.517588543075384, -12.342013892807694],
           [44.548487590926946, -12.34905695145454],
           [44.547285961288274, -12.262179346303313],
           [44.531664818702694, -12.225105587556078]]],
         [[[44.40244482739659, -12.13316362800548],
           [44.344251620609484, -12.180989957461227],
           [44.343736636478624, -12.189044071319936],
           [44.36639593823644, -12.188372904503423],
           [44.41806601269933, -12.169411740652926],
           [44.43746374829503, -12.132827974272223],
           [44.432142245609484, -12.107988425683828],
           [44.420125949222765, -12.10865979523274]]]]),
    SGtoRK = 
    /* color: #c28f56 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[44.40851124353974, -12.100236833710976],
           [44.502281270700394, -12.125580598812137],
           [44.50054147480959, -12.077992151041995],
           [44.48266895838349, -12.031410527464047],
           [44.43220527402953, -12.067001213904845]]],
         [[[44.512488995162045, -12.208197528132478],
           [44.518754635420834, -12.221032338514691],
           [44.532487545577084, -12.216754137545648],
           [44.52956930216888, -12.188314927265532],
           [44.51188818034271, -12.190496213686567]]],
         [[[43.66734196156403, -12.246025801394074],
           [43.60605852491806, -12.255000409752714],
           [43.60858969680278, -12.297856886329136],
           [43.63309534151488, -12.29039358685256],
           [43.77325757119539, -12.299702324424803],
           [43.77995239856942, -12.28477463934774],
           [43.73961176882459, -12.258774965759478],
           [43.70098776246897, -12.247367847929393]]],
         [[[43.773940936333965, -12.369967986497178],
           [43.782695666558574, -12.38036370440054],
           [43.80329503179295, -12.382040394329868],
           [43.87213124395115, -12.402327488361164],
           [43.89015568853123, -12.383046403117142],
           [43.87573613286717, -12.367955864271398],
           [43.78681553960545, -12.364434613093461]]],
         [[[43.66630261148744, -12.322737707302851],
           [43.66012268410097, -12.318041912626018],
           [43.650681426184704, -12.3136814019857],
           [43.64724819864564, -12.308482270699427],
           [43.642956615865536, -12.303702290718975],
           [43.62785046304994, -12.283323730449924],
           [43.61583416666322, -12.312339700543067],
           [43.65171139444642, -12.357618329894171],
           [43.66647427286439, -12.350743190256194],
           [43.675400664465954, -12.34001090393033],
           [43.67025082315736, -12.330452091129242]]]]),
    wcmc = ee.FeatureCollection("projects/coral_atlas/global_datasets/wcmc_reefs_2018v4_dissolved"),
    land_dist = ee.Image("projects/coral_atlas/global_datasets/mod44w6_global_distToLand"),
    json_extent = ee.FeatureCollection("projects/coral_atlas/wio_extent"),
    region_extent = 
    /* color: #00ffff */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[54.701770985703206, -2.9751249685105154],
          [52.548450673203206, -4.772691629173448],
          [52.196888173203206, -5.910289150084192],
          [51.757435048203206, -8.091037974566733],
          [48.285755360703206, -8.65623438835204],
          [44.814075673203206, -9.350691639103687],
          [46.440052235703206, -10.864858654100164],
          [45.736927235703206, -11.72673086956205],
          [43.583606923203206, -10.605801768506067],
          [41.781849110703206, -10.605801768506067],
          [41.737903798203206, -12.543027437564627],
          [44.638294423203206, -13.954584744088688],
          [46.352161610703206, -13.783928424683062],
          [48.857044423203206, -10.99430318398806],
          [49.955677235703206, -10.908013101551091],
          [52.680286610703206, -10.95116128603305],
          [53.339466298203206, -8.438948520327026],
          [54.613880360703206, -6.827435160865552],
          [55.624622548203206, -6.914694536706059],
          [56.108020985703206, -11.511507059571993],
          [58.788685048203206, -15.865441173681486],
          [56.942981923203206, -19.631456469862268],
          [54.438099110703206, -20.539442163648662],
          [54.130481923203206, -21.482966628121225],
          [54.965442860703206, -22.420415520660942],
          [55.844349110703206, -22.095048738332846],
          [57.074817860703206, -21.196440284100703],
          [58.481067860703206, -20.827232047085705],
          [59.184192860703206, -17.883867297837703],
          [63.754505360703206, -20.909357190677294],
          [64.9849741107032, -20.00354040738218],
          [63.666614735703206, -19.009403584868657],
          [61.776966298203206, -19.175515382142862],
          [60.370716298203206, -18.009288625640345],
          [60.458606923203206, -15.187980739313776],
          [58.964466298203206, -15.187980739313776],
          [56.811145985703206, -11.55456509703201],
          [57.514270985703206, -10.216806458907836],
          [56.327747548203206, -9.17720313716965],
          [56.327747548203206, -7.786369242288465],
          [57.250599110703206, -7.089164748909251],
          [56.108020985703206, -5.866575713917645],
          [57.602161610703206, -5.647957630653708],
          [57.206653798203206, -4.422260866394937],
          [56.547474110703206, -3.4138941523262103]]]),
    not_reef = 
    /* color: #01ff14 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[55.2248077855843, -20.980851493012523],
          [55.33741764886555, -21.08595829180467],
          [55.4884796605843, -21.2191575703884],
          [55.5763702855843, -21.37014202611179],
          [55.5763702855843, -21.549074333518252],
          [55.95265202386555, -21.487750868105195],
          [56.05702214105305, -21.23195887279921],
          [55.8839874730843, -20.93981411727935],
          [55.6917267308968, -20.672797751973356],
          [55.42530827386555, -20.62910598668815],
          [55.1479034887093, -20.793527159750223],
          [55.1204376683968, -20.867971649301655]]]),
    reef_boundary = 
    /* color: #d6b113 */
    /* shown: false */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[40.859926354273455, -2.4006076916703782],
          [40.859926354273455, -23.630158061970967],
          [65.42535604177345, -23.630158061970967],
          [65.42535604177345, -2.4006076916703782]]], null, false),
    waves = ee.Image("projects/coral_atlas/west_indian_ocean/in_out/wio_waves"),
    notBRS = 
    /* color: #6a87ff */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                63.387482463052024,
                -19.645365472856682
              ],
              [
                63.40773850553249,
                -19.668644153784328
              ],
              [
                63.41529160611843,
                -19.678989149430404
              ],
              [
                63.436920939614524,
                -19.671877036660018
              ],
              [
                63.4520271407864,
                -19.656035287644524
              ],
              [
                63.430397807290305,
                -19.644072113765077
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                56.291036095816565,
                -7.0867722217660205
              ],
              [
                56.28940531273551,
                -7.121011289921165
              ],
              [
                56.27386995812125,
                -7.1471573153460355
              ],
              [
                56.25842161681023,
                -7.177303878051007
              ],
              [
                56.23473116417594,
                -7.20216979235917
              ],
              [
                56.2546438839025,
                -7.205916530014025
              ],
              [
                56.27601572533317,
                -7.1734721625084825
              ],
              [
                56.300101054839665,
                -7.133589380808558
              ],
              [
                56.30795112093978,
                -7.104245236291353
              ],
              [
                56.30014052828841,
                -7.090191683349689
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.2730685259352,
                -5.999629727622204
              ],
              [
                55.30551252617934,
                -6.0411133762831986
              ],
              [
                55.33572492852309,
                -6.028480831205856
              ],
              [
                55.292466261530905,
                -5.981020808937045
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.36012077800136,
                -5.810591344497242
              ],
              [
                55.36406898967128,
                -5.819642578989526
              ],
              [
                55.37488365641933,
                -5.818617918244809
              ],
              [
                55.39239311686855,
                -5.868824092344553
              ],
              [
                55.387071614183,
                -5.876166794106461
              ],
              [
                55.394453053391985,
                -5.894608501413393
              ],
              [
                55.41556740275722,
                -5.850723065832636
              ],
              [
                55.38586998454433,
                -5.807517307218006
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.48387169271242,
                -4.637219583131101
              ],
              [
                55.48425732674021,
                -4.595983309592369
              ],
              [
                55.469805231341965,
                -4.56633766598496
              ],
              [
                55.44728591632287,
                -4.548840935771542
              ],
              [
                55.44447457485944,
                -4.620279988603722
              ],
              [
                55.51459907918703,
                -4.701378951626519
              ],
              [
                55.50653099447023,
                -4.744319659933407
              ],
              [
                55.51116585164797,
                -4.781441546865494
              ],
              [
                55.54103493123781,
                -4.808811235810369
              ],
              [
                55.5542528572632,
                -4.791705308715674
              ],
              [
                55.53929774107125,
                -4.7251322338930795
              ],
              [
                55.546055089364295,
                -4.66534661872443
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.50949121607328,
                -4.615556906649137
              ],
              [
                55.50193811548734,
                -4.644644106697568
              ],
              [
                55.51721597803617,
                -4.642077637192425
              ],
              [
                55.520820866952185,
                -4.622914370181706
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.50228143824125,
                -4.595537375921035
              ],
              [
                55.5050280202725,
                -4.613674752558617
              ],
              [
                55.52099252832914,
                -4.601697291529005
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.249847228469854,
                -4.468732409512815
              ],
              [
                55.209335143508916,
                -4.500991498844698
              ],
              [
                55.23238150961814,
                -4.521922788797144
              ],
              [
                55.269803689793925,
                -4.495568746798674
              ],
              [
                55.260007318970054,
                -4.4783539047080065
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.234832164921386,
                -4.384276051805047
              ],
              [
                55.23676325697225,
                -4.40085686758109
              ],
              [
                55.249337551273925,
                -4.404515335694935
              ],
              [
                55.255088207401855,
                -4.395058994482067
              ],
              [
                55.248307583012206,
                -4.39681334739751
              ],
              [
                55.23779332367383,
                -4.382179350426744
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                59.58320527844629,
                -16.423968090345323
              ],
              [
                59.61753755383692,
                -16.471383478899316
              ],
              [
                59.66422944836817,
                -16.481918657792697
              ],
              [
                59.69169526868067,
                -16.547750528447033
              ],
              [
                59.69856172375879,
                -16.60829600897816
              ],
              [
                59.66285615735254,
                -16.68460876375893
              ],
              [
                59.59556489758692,
                -16.770095486035274
              ],
              [
                59.48570161633692,
                -16.820054554554602
              ],
              [
                59.42665010266504,
                -16.830570576779582
              ],
              [
                59.56809907727442,
                -16.867372054843788
              ],
              [
                59.76173311047754,
                -16.66882241231975
              ],
              [
                59.71778779797754,
                -16.441091650114952
              ],
              [
                59.63538737136394,
                -16.406194869823004
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.828112600685486,
                -4.33543569353075
              ],
              [
                55.816439627052674,
                -4.357944236441032
              ],
              [
                55.81935787046088,
                -4.377200059743823
              ],
              [
                55.8370470899073,
                -4.38572574892624
              ],
              [
                55.84176799665467,
                -4.3695082258315034
              ],
              [
                55.85953473028816,
                -4.35654261774953
              ],
              [
                55.84219279949729,
                -4.33469217128254
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.920225785017635,
                -4.330324164971091
              ],
              [
                55.92168490672174,
                -4.355229183853476
              ],
              [
                55.934473679304745,
                -4.338540344514846
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.889240906477596,
                -4.341474963063471
              ],
              [
                55.887781784773495,
                -4.329749808490764
              ],
              [
                55.87542216563287,
                -4.340362364970015
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.86218624837686,
                -4.282937819597402
              ],
              [
                55.873000915124905,
                -4.289699478636757
              ],
              [
                55.87407379873086,
                -4.283665342744513
              ],
              [
                55.86733608968545,
                -4.280412880955775
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.21067641039947,
                -3.704742576824706
              ],
              [
                55.19780180712799,
                -3.7368612393882796
              ],
              [
                55.21891615649322,
                -3.732835764595293
              ],
              [
                55.22664091845611,
                -3.7144211236621274
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.671871107340266,
                -3.7872876060180074
              ],
              [
                55.65470496964495,
                -3.8306220000104907
              ],
              [
                55.68474571061175,
                -3.8301081662486345
              ],
              [
                55.691097181559016,
                -3.7927687564602595
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.35571387720689,
                -5.075299855178982
              ],
              [
                53.33065131617173,
                -5.12163602705173
              ],
              [
                53.34747413111314,
                -5.129928309541868
              ],
              [
                53.374768290048685,
                -5.080429485078754
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.31915000391587,
                -5.10966759466591
              ],
              [
                53.30181220484361,
                -5.127705646446462
              ],
              [
                53.31674674463853,
                -5.1321509648966686
              ],
              [
                53.327303919321146,
                -5.1204391938878775
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.36076496268776,
                -5.418901278323088
              ],
              [
                53.31141231681374,
                -5.44034811903238
              ],
              [
                53.34153888846901,
                -5.462221400086802
              ],
              [
                53.37724445487526,
                -5.454702549625735
              ],
              [
                53.38024852897194,
                -5.4321454334280554
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.27836750175026,
                -5.417790465007561
              ],
              [
                53.28137157584694,
                -5.431547316565776
              ],
              [
                53.29733608390358,
                -5.435563232677452
              ],
              [
                53.31175563956764,
                -5.420097536532065
              ],
              [
                53.2873797240403,
                -5.4095874727034285
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                50.71737073220993,
                -9.334594832932975
              ],
              [
                50.73007367410446,
                -9.34738340960935
              ],
              [
                50.744579060457,
                -9.331461136587095
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                51.088128305231436,
                -9.298999561205788
              ],
              [
                51.116967313404665,
                -9.342364400316043
              ],
              [
                51.11902721824729,
                -9.416885235545312
              ],
              [
                51.0943142934007,
                -9.447702781297629
              ],
              [
                51.040749675318985,
                -9.527282144078118
              ],
              [
                50.97071585246313,
                -9.588052558995026
              ],
              [
                50.982390057612704,
                -9.610313710010008
              ],
              [
                51.043504612114354,
                -9.605490154337069
              ],
              [
                51.172585272570245,
                -9.43856087273725
              ],
              [
                51.17121199262463,
                -9.316617163025764
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                52.7317163262088,
                -7.187090045550269
              ],
              [
                52.79832094046661,
                -7.1632456539209555
              ],
              [
                52.794201067419735,
                -7.132586746939729
              ],
              [
                52.72141664359161,
                -7.168014632151676
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                52.77188508841583,
                -7.007886132129423
              ],
              [
                52.761071160492904,
                -7.031397760126753
              ],
              [
                52.736522844763485,
                -7.0467309128523
              ],
              [
                52.755748918982235,
                -7.053886175831244
              ],
              [
                52.786991289587704,
                -7.014701240610714
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.0654323632129,
                -12.591768611633642
              ],
              [
                45.08568840569337,
                -12.584732146224223
              ],
              [
                45.102511220634774,
                -12.591098480385465
              ],
              [
                45.113497548759774,
                -12.60684610168998
              ],
              [
                45.1258571679004,
                -12.615892169871385
              ],
              [
                45.139933400810555,
                -12.615892169871385
              ],
              [
                45.15435295647462,
                -12.626278002096322
              ],
              [
                45.17254906243165,
                -12.633983347066696
              ],
              [
                45.18971520012696,
                -12.646378414598972
              ],
              [
                45.197611623466805,
                -12.656428027714208
              ],
              [
                45.24396019524415,
                -12.702986064896546
              ],
              [
                45.288411668714204,
                -12.73524151433346
              ],
              [
                45.29253154176108,
                -12.779106564680522
              ],
              [
                45.28532176392905,
                -12.823968278786719
              ],
              [
                45.2880683459603,
                -12.844053023804607
              ],
              [
                45.276395372327485,
                -12.871164882973922
              ],
              [
                45.24858622926108,
                -12.895261852812597
              ],
              [
                45.22043376344077,
                -12.940102811205337
              ],
              [
                45.22043376344077,
                -12.965865984953314
              ],
              [
                45.22489695924155,
                -12.998986146026331
              ],
              [
                45.23656993287436,
                -13.013704799762058
              ],
              [
                45.210477403577485,
                -13.03578114165239
              ],
              [
                45.17614512818686,
                -13.055514386430026
              ],
              [
                45.14249949830405,
                -13.069226391327973
              ],
              [
                45.10576396363608,
                -13.06655093796939
              ],
              [
                45.06731181519858,
                -13.055514386430026
              ],
              [
                45.03709941285483,
                -13.033439804749976
              ],
              [
                45.01066356080405,
                -13.013035788996849
              ],
              [
                44.98457103150717,
                -12.980586601437961
              ],
              [
                44.97907786744467,
                -12.96820795948679
              ],
              [
                44.97273001256353,
                -12.942868564959003
              ],
              [
                44.96723684850103,
                -12.915095197840863
              ],
              [
                44.960370393422906,
                -12.895350806107052
              ],
              [
                44.95144400182134,
                -12.87861705111915
              ],
              [
                44.927440658053726,
                -12.868341362158445
              ],
              [
                44.946666732272476,
                -12.981778925691852
              ],
              [
                45.03725440113532,
                -13.087362845182994
              ],
              [
                45.22505194752204,
                -13.082681126998674
              ],
              [
                45.28948558201493,
                -13.00424537529985
              ],
              [
                45.323028924448835,
                -12.864183695694965
              ],
              [
                45.33335721700408,
                -12.728256563383887
              ],
              [
                45.21594083516814,
                -12.633131167349902
              ],
              [
                45.122213723351734,
                -12.573492252356976
              ],
              [
                45.0652221462033,
                -12.568465867533114
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    notRC = 
    /* color: #8b1b05 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                63.35897378005308,
                -19.66080560630316
              ],
              [
                63.35382393874448,
                -19.66500854682159
              ],
              [
                63.325328150170265,
                -19.66274543869308
              ],
              [
                63.30987862624448,
                -19.67826325284056
              ],
              [
                63.29820565261167,
                -19.70864795124732
              ],
              [
                63.294085779564796,
                -19.73353324505831
              ],
              [
                63.30438546218198,
                -19.75873777212658
              ],
              [
                63.31743172683042,
                -19.770692373502364
              ],
              [
                63.31846169509214,
                -19.799444363645353
              ],
              [
                63.32910470046323,
                -19.82302358011929
              ],
              [
                63.34009102858823,
                -19.830128959683012
              ],
              [
                63.358287134545265,
                -19.83174377436466
              ],
              [
                63.37510994948667,
                -19.830451923932362
              ],
              [
                63.39982918776792,
                -19.826253337486527
              ],
              [
                63.42386178054136,
                -19.811718912556213
              ],
              [
                63.425921717064796,
                -19.800736466018027
              ],
              [
                63.442401209252296,
                -19.77812316037616
              ],
              [
                63.457164087670265,
                -19.766815303694507
              ],
              [
                63.459910669701515,
                -19.75001357856354
              ],
              [
                63.43107155837339,
                -19.756152875621353
              ],
              [
                63.39742592849058,
                -19.771984709150466
              ],
              [
                63.35897378005308,
                -19.781030765265317
              ],
              [
                63.34112099684995,
                -19.757122216719434
              ],
              [
                63.32498482741636,
                -19.746136006090286
              ],
              [
                63.327044763939796,
                -19.721575860180597
              ],
              [
                63.338031092064796,
                -19.705092593062616
              ],
              [
                63.37579659499448,
                -19.693133081161477
              ],
              [
                63.40806893386167,
                -19.67147439401659
              ],
              [
                63.39502266921323,
                -19.65789581372209
              ],
              [
                63.363780298607765,
                -19.658865750448278
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                59.61153532059345,
                -16.42994585013174
              ],
              [
                59.5926525691286,
                -16.444105389151165
              ],
              [
                59.64689756424579,
                -16.55339537348498
              ],
              [
                59.63694120438251,
                -16.616570980797796
              ],
              [
                59.663033733679384,
                -16.646177397268854
              ],
              [
                59.63488126785907,
                -16.695182407777324
              ],
              [
                59.599862346960634,
                -16.715241237803752
              ],
              [
                59.56381345780048,
                -16.71063775825573
              ],
              [
                59.55282712967548,
                -16.732338903472332
              ],
              [
                59.4772961238161,
                -16.8141891381164
              ],
              [
                59.48313261063251,
                -16.828320345564016
              ],
              [
                59.503731975866884,
                -16.82601998825323
              ],
              [
                59.52055479080829,
                -16.821747822006593
              ],
              [
                59.54149747879657,
                -16.810902659816936
              ],
              [
                59.5593502619997,
                -16.80794478065039
              ],
              [
                59.58544279129657,
                -16.78493747978403
              ],
              [
                59.62252164871845,
                -16.735626740311236
              ],
              [
                59.66097379715595,
                -16.70340349462209
              ],
              [
                59.67710996658954,
                -16.67906805138719
              ],
              [
                59.69015623123798,
                -16.6692014485878
              ],
              [
                59.69736600907001,
                -16.635980147574422
              ],
              [
                59.70938230545673,
                -16.58169534592866
              ],
              [
                59.70457578690204,
                -16.567216809781215
              ],
              [
                59.70732236893329,
                -16.547142493345337
              ],
              [
                59.70903898270282,
                -16.523445529238447
              ],
              [
                59.708695659948916,
                -16.495466204098182
              ],
              [
                59.69564939530048,
                -16.48624859887297
              ],
              [
                59.6860363581911,
                -16.473409060251615
              ],
              [
                59.67607999832782,
                -16.47703055475724
              ],
              [
                59.675736675573916,
                -16.465507382754478
              ],
              [
                59.66818357498798,
                -16.457605383167138
              ],
              [
                59.64243436844501,
                -16.444105389151165
              ],
              [
                59.6201183894411,
                -16.4335681560471
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                56.25391150735489,
                -7.18135521990668
              ],
              [
                56.257730982047896,
                -7.178246962093158
              ],
              [
                56.26244096981338,
                -7.171913277502194
              ],
              [
                56.26758004788727,
                -7.163876326179949
              ],
              [
                56.257173073517,
                -7.174542578174112
              ],
              [
                56.24824668191544,
                -7.175990273077357
              ],
              [
                56.24258185647599,
                -7.1814403772826685
              ],
              [
                56.24043608926407,
                -7.188508383878869
              ],
              [
                56.23897695862647,
                -7.196598126839712
              ],
              [
                56.24301100991837,
                -7.194809887396047
              ],
              [
                56.24970580361954,
                -7.186549790651255
              ],
              [
                56.252366554962315,
                -7.181781006627136
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.760208460300966,
                -4.586693132071576
              ],
              [
                55.76434979101996,
                -4.586864243678628
              ],
              [
                55.767203661411806,
                -4.581688099434422
              ],
              [
                55.761731955021425,
                -4.5807897565333375
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.76510413521519,
                -4.589938076120206
              ],
              [
                55.76654180011148,
                -4.591991406255027
              ],
              [
                55.769202551454256,
                -4.590708077420064
              ],
              [
                55.76883777102823,
                -4.587820579103629
              ],
              [
                55.76594098529215,
                -4.587884745859778
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.19917509814361,
                -3.7365186465077436
              ],
              [
                55.203123309813535,
                -3.732064926891052
              ],
              [
                55.20365813015946,
                -3.7288413225669137
              ],
              [
                55.20846464871415,
                -3.7243019146163796
              ],
              [
                55.2112112307454,
                -3.720105082664645
              ],
              [
                55.210782077303016,
                -3.7159082307250575
              ],
              [
                55.21498778103837,
                -3.7132530691853836
              ],
              [
                55.21515944241532,
                -3.7035745095572596
              ],
              [
                55.19722082852372,
                -3.703660160991948
              ],
              [
                55.19576170681962,
                -3.7330381128393753
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.38371079902288,
                -4.865353532696892
              ],
              [
                53.372123602219546,
                -4.879079531184894
              ],
              [
                53.359420660325014,
                -4.913970649101185
              ],
              [
                53.378389242478335,
                -4.919272571180837
              ],
              [
                53.38903224784943,
                -4.90456390937379
              ],
              [
                53.39031970817658,
                -4.871126154412039
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.32867721033677,
                -5.082481325608958
              ],
              [
                53.31863501978501,
                -5.094621248270158
              ],
              [
                53.32962134791001,
                -5.119840776465828
              ],
              [
                53.34841826868638,
                -5.111377384420133
              ],
              [
                53.360005411630716,
                -5.0888932851326185
              ],
              [
                53.36300944129869,
                -5.079147054884135
              ],
              [
                53.35193732691392,
                -5.0747013956996945
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.304387125497904,
                -5.108556228879029
              ],
              [
                53.30816367579087,
                -5.124884562914209
              ],
              [
                53.31992248011216,
                -5.112574234532677
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.32170533027678,
                -5.4060567630058545
              ],
              [
                53.32056807195998,
                -5.407652255397203
              ],
              [
                53.31730650579787,
                -5.421935362068974
              ],
              [
                53.316276537536154,
                -5.4341113896819175
              ],
              [
                53.322756754516135,
                -5.441246000295406
              ],
              [
                53.331768976806174,
                -5.448850462148551
              ],
              [
                53.347003924010764,
                -5.451499184688541
              ],
              [
                53.35331247961379,
                -5.447739704058611
              ],
              [
                53.35562990820266,
                -5.423088891014472
              ],
              [
                53.347990976928244,
                -5.417663013444322
              ],
              [
                53.34713267004348,
                -5.415526827800499
              ],
              [
                53.34365652716018,
                -5.415526827800499
              ],
              [
                53.336017595885764,
                -5.4086482587430895
              ],
              [
                53.329494463561545,
                -5.405230307146103
              ],
              [
                53.32292841589309,
                -5.405913899009305
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.20079062201968,
                -13.017780773125422
              ],
              [
                45.12268469550601,
                -13.043535890021626
              ],
              [
                45.03633902289859,
                -13.010923439944898
              ],
              [
                44.98964712836734,
                -12.972953800291556
              ],
              [
                44.98106405951968,
                -12.976132098396622
              ],
              [
                44.98484060981265,
                -12.98449584662958
              ],
              [
                44.992222049021635,
                -12.996204621182782
              ],
              [
                45.00132010200015,
                -13.001891541029911
              ],
              [
                45.024151065134916,
                -13.023467198196416
              ],
              [
                45.03977225043765,
                -13.035341370763204
              ],
              [
                45.06054327704898,
                -13.051061229772404
              ],
              [
                45.08697912909976,
                -13.062934077640787
              ],
              [
                45.10277197577945,
                -13.067448954509661
              ],
              [
                45.12663290717593,
                -13.070458826548485
              ],
              [
                45.14036581733218,
                -13.069288325117112
              ],
              [
                45.15032217719546,
                -13.067281738320236
              ],
              [
                45.17518911415312,
                -13.056245219439738
              ],
              [
                45.198020077287886,
                -13.045709900586763
              ],
              [
                45.21707449012968,
                -13.033668986549927
              ],
              [
                45.235270596086714,
                -13.018617020290952
              ],
              [
                45.24402532631132,
                -13.007076560243519
              ],
              [
                45.23956213051054,
                -13.004400434826314
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                44.94877536431133,
                -12.881612350730084
              ],
              [
                44.953410221489065,
                -12.889644596621032
              ],
              [
                44.96010501519024,
                -12.900521185513535
              ],
              [
                44.962679935844534,
                -12.90487168868353
              ],
              [
                44.967143131645315,
                -12.923109512563219
              ],
              [
                44.96851642266094,
                -12.92829617340439
              ],
              [
                44.9690314067918,
                -12.939840289590967
              ],
              [
                44.97349460259258,
                -12.944190107818589
              ],
              [
                44.97349460259258,
                -12.951551165744387
              ],
              [
                44.97624118462383,
                -12.954227860165027
              ],
              [
                44.97606952324688,
                -12.95874471677239
              ],
              [
                44.98207767144024,
                -12.974971266224342
              ],
              [
                44.992892338188284,
                -12.970287422451703
              ],
              [
                44.981906010063284,
                -12.91307050814189
              ],
              [
                44.966628147514456,
                -12.881110326809742
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.25799426230605,
                -12.889681601276202
              ],
              [
                45.26571902426894,
                -12.884996156503771
              ],
              [
                45.274302093116596,
                -12.87796782500847
              ],
              [
                45.27910861167128,
                -12.87361685434309
              ],
              [
                45.278078643409565,
                -12.85922464428706
              ],
              [
                45.289579955665424,
                -12.847509445377078
              ],
              [
                45.290266601173236,
                -12.838806372493094
              ],
              [
                45.227095214454486,
                -12.829768247136773
              ],
              [
                45.24202975424941,
                -12.86993520479734
              ],
              [
                45.240828124610736,
                -12.882486060746873
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.24872454795058,
                -12.88867758477668
              ],
              [
                45.23396166953261,
                -12.886334863955476
              ],
              [
                45.22503527793105,
                -12.907920533116197
              ],
              [
                45.23756655844863,
                -12.91494802340291
              ],
              [
                45.25301608237441,
                -12.891020283679257
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.20969827371578,
                -12.932798474127468
              ],
              [
                45.20592172342281,
                -12.954045543140891
              ],
              [
                45.219311310825155,
                -12.956889501527758
              ],
              [
                45.2301259775732,
                -12.932129245696112
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.28305306606092,
                -12.72885326193989
              ],
              [
                45.26623025111952,
                -12.718471609768038
              ],
              [
                45.26211037807264,
                -12.710601364697688
              ],
              [
                45.25198235683241,
                -12.707084793393902
              ],
              [
                45.23739113979139,
                -12.691008419273178
              ],
              [
                45.22513098123877,
                -12.680916324725763
              ],
              [
                45.218779510291505,
                -12.67354735492108
              ],
              [
                45.20933813455908,
                -12.663498416282017
              ],
              [
                45.199038451941895,
                -12.656463923584072
              ],
              [
                45.18410391214697,
                -12.637871830943988
              ],
              [
                45.15972799661963,
                -12.628826539853197
              ],
              [
                45.15303320291846,
                -12.621623579217337
              ],
              [
                45.13758367899268,
                -12.61425289796866
              ],
              [
                45.12453741434424,
                -12.613080270020438
              ],
              [
                45.103938049109864,
                -12.643901847144717
              ],
              [
                45.12299246195166,
                -12.661656067898784
              ],
              [
                45.15099756772485,
                -12.642848672907807
              ],
              [
                45.18618815000024,
                -12.681203098657065
              ],
              [
                45.290214944433835,
                -12.73847274729282
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.061688395573626,
                -12.59705008103259
              ],
              [
                45.06409165485097,
                -12.607939244010462
              ],
              [
                45.0877809248705,
                -12.60760419974196
              ],
              [
                45.114903422429094,
                -12.604421257337133
              ],
              [
                45.11026856525136,
                -12.595877374350435
              ],
              [
                45.09207245929433,
                -12.583479861472634
              ],
              [
                45.081944438054094,
                -12.584317550131843
              ],
              [
                45.07662293536855,
                -12.588338417634652
              ],
              [
                45.065464945866594,
                -12.591856625010678
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                44.944739930496546,
                -12.658525893289758
              ],
              [
                44.97340738044772,
                -12.75531605158549
              ],
              [
                45.00979959236178,
                -12.762682648316584
              ],
              [
                45.00722467170748,
                -12.710944518234125
              ],
              [
                44.97563897834811,
                -12.650653794636133
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                44.99999763783634,
                -12.670204037439879
              ],
              [
                45.054757617084384,
                -12.686951607529585
              ],
              [
                45.070722125141025,
                -12.66785928976794
              ],
              [
                44.99570610341251,
                -12.647090583584708
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                46.4583082891636,
                -12.32347050771603
              ],
              [
                46.43324572812844,
                -12.348625199676828
              ],
              [
                46.43049914609719,
                -12.353488161392791
              ],
              [
                46.43101413022805,
                -12.35717724446653
              ],
              [
                46.436850617044456,
                -12.36153700282711
              ],
              [
                46.43873889219094,
                -12.365393651542373
              ],
              [
                46.44354541074563,
                -12.364890613632701
              ],
              [
                46.454875061624534,
                -12.365393651542373
              ],
              [
                46.46071154844094,
                -12.36589668848382
              ],
              [
                46.464831421487816,
                -12.356003450950523
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                46.479079315774925,
                -12.292443065038528
              ],
              [
                46.465861389749534,
                -12.303512735444002
              ],
              [
                46.476847717874534,
                -12.309550540915547
              ],
              [
                46.484057495706566,
                -12.301835542627082
              ],
              [
                46.49143893491555,
                -12.294791215899066
              ],
              [
                46.4912672735386,
                -12.291604434649152
              ],
              [
                46.485087463968284,
                -12.292443065038528
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                47.37064251040342,
                -11.480535753029567
              ],
              [
                47.28652843569639,
                -11.538736225549375
              ],
              [
                47.31948742007139,
                -11.575063354136647
              ],
              [
                47.33253368471983,
                -11.586498696856667
              ],
              [
                47.347296563137796,
                -11.563291189509373
              ],
              [
                47.380255547512796,
                -11.538736225549375
              ],
              [
                47.41733440493467,
                -11.501395109601424
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                46.21438244043764,
                -9.385566748650627
              ],
              [
                46.2342951601642,
                -9.473285851119037
              ],
              [
                46.342098504890764,
                -9.45940130299509
              ],
              [
                46.419689447273576,
                -9.43772674173927
              ],
              [
                46.455395013679826,
                -9.448564192933484
              ],
              [
                46.49453380762514,
                -9.440097463318398
              ],
              [
                46.510326654304826,
                -9.399454268544186
              ],
              [
                46.449215204109514,
                -9.376759740370064
              ],
              [
                46.34896495996889,
                -9.372694891906315
              ],
              [
                46.2562678164142,
                -9.373372369956398
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                47.627532610200284,
                -9.760201337016902
              ],
              [
                47.639720567963955,
                -9.760370513705473
              ],
              [
                47.66083491732919,
                -9.726364274102803
              ],
              [
                47.65362513949716,
                -9.711644081894251
              ],
              [
                47.63542903354013,
                -9.690831671464162
              ],
              [
                47.6201511709913,
                -9.686770562710436
              ],
              [
                47.61019481112802,
                -9.677971325208969
              ],
              [
                47.60041011264169,
                -9.670017969943597
              ],
              [
                47.5816990225538,
                -9.662402879039403
              ],
              [
                47.56796611239755,
                -9.66646428230799
              ],
              [
                47.56075633456552,
                -9.677971325208969
              ],
              [
                47.55903972079599,
                -9.69066245958069
              ],
              [
                47.5542332022413,
                -9.69218536345969
              ],
              [
                47.54977000644052,
                -9.698446117873361
              ],
              [
                47.54256022860849,
                -9.70572198286097
              ],
              [
                47.51526606967294,
                -9.7348238614273
              ],
              [
                47.52556575229013,
                -9.740068697969463
              ],
              [
                47.53947032382333,
                -9.744805898852027
              ],
              [
                47.55251658847177,
                -9.75191157404641
              ],
              [
                47.55749476840341,
                -9.761047219600401
              ],
              [
                47.56796611239755,
                -9.766799164185365
              ],
              [
                47.574317583344815,
                -9.771366814081961
              ],
              [
                47.59045375277841,
                -9.771366814081961
              ],
              [
                47.602298387788174,
                -9.766968337521696
              ],
              [
                47.61362803866708,
                -9.761385572032285
              ],
              [
                47.621524462006924,
                -9.759524629403431
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                52.75602583549783,
                -7.076935376740097
              ],
              [
                52.7488160576658,
                -7.079831378755195
              ],
              [
                52.73800139091775,
                -7.091926249392546
              ],
              [
                52.73250822685525,
                -7.105894577922588
              ],
              [
                52.72907499931619,
                -7.125824262734697
              ],
              [
                52.72753004692361,
                -7.141154199938684
              ],
              [
                52.733194872363065,
                -7.166191991793118
              ],
              [
                52.73954634331033,
                -7.167554553285269
              ],
              [
                52.749674364550565,
                -7.163126213541086
              ],
              [
                52.762892290575955,
                -7.158357184173955
              ],
              [
                52.77353529594705,
                -7.149670609748762
              ],
              [
                52.7762818779783,
                -7.133829960647359
              ],
              [
                52.77267698906228,
                -7.104872519487724
              ],
              [
                52.76907210014627,
                -7.085623328238472
              ],
              [
                52.75928740165994,
                -7.078127850359325
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                52.73158734629545,
                -7.024495413221058
              ],
              [
                52.739655431012245,
                -7.038636147062533
              ],
              [
                52.75150006602201,
                -7.032502869587088
              ],
              [
                52.7592248279849,
                -7.022962054776992
              ],
              [
                52.76042645762357,
                -7.012058026779333
              ],
              [
                52.74978345225248,
                -7.008139329350144
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                51.081197547586875,
                -9.179241670570303
              ],
              [
                50.99811344114156,
                -9.179241670570303
              ],
              [
                50.95348148313375,
                -9.233465708747856
              ],
              [
                50.92532901731344,
                -9.61685978455494
              ],
              [
                51.034505653055625,
                -9.620921736300918
              ],
              [
                51.10935001340719,
                -9.467210729005341
              ],
              [
                51.11484317746969,
                -9.42589335586662
              ],
              [
                51.12102298704,
                -9.405571520267687
              ],
              [
                51.12308292356344,
                -9.370344178132845
              ],
              [
                51.105916785868125,
                -9.335113261538583
              ],
              [
                51.08463077512594,
                -9.304622093241917
              ],
              [
                51.07364444700094,
                -9.267351499936968
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    notSL = 
    /* color: #18faff */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[59.638051022284046, -16.385113304999265],
           [59.63747166513683, -16.386719023397536],
           [59.63845871805431, -16.39303883777417],
           [59.64547537683727, -16.392704773877227],
           [59.65266369699718, -16.385870295888406],
           [59.6491017234254, -16.379262033499604],
           [59.63888787149669, -16.384038120978833]]],
         [[[55.92726365830179, -4.580810414679744],
           [55.92842237259622, -4.589323237524131],
           [55.93945161606546, -4.596723749769661],
           [55.952111642615755, -4.593087669534037],
           [55.93855039383646, -4.580938749445284],
           [55.93352929856058, -4.57871427691615]]],
         [[[53.38542735893341, -4.868646049930336],
           [53.3902338774881, -4.883612058595852],
           [53.39092054418197, -4.893574839600482],
           [53.38800227958771, -4.909010748322284],
           [53.3752135070047, -4.918417425313263],
           [53.394353750534975, -4.9193580857071755],
           [53.402850988694155, -4.894643931190626],
           [53.3986452849588, -4.87181031955577],
           [53.3905782199801, -4.866171016616823]]]]),
    notRS = 
    /* color: #cdffb1 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                56.23603116066767,
                -7.200658750714251
              ],
              [
                56.26326009071769,
                -7.168513765468862
              ],
              [
                56.27244397438468,
                -7.149267247496633
              ],
              [
                56.289781773456944,
                -7.113326889815983
              ],
              [
                56.292270863422765,
                -7.081983238164409
              ],
              [
                56.28712102211417,
                -7.082153589863299
              ],
              [
                56.26600667274894,
                -7.1265532211206315
              ],
              [
                56.23888417519034,
                -7.169049882923931
              ],
              [
                56.23064442909659,
                -7.194000986881247
              ],
              [
                56.234850132831944,
                -7.20149456621353
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.3376331376205,
                -5.814690034760336
              ],
              [
                55.33196831218105,
                -5.831426043231253
              ],
              [
                55.34690285197597,
                -5.868311807215317
              ],
              [
                55.38209343425136,
                -5.896657542209159
              ],
              [
                55.39273643962245,
                -5.891193416609064
              ],
              [
                55.38655663005214,
                -5.875825275240834
              ],
              [
                55.39204979411464,
                -5.868824092344553
              ],
              [
                55.37454033366542,
                -5.819642578989526
              ],
              [
                55.36458397380214,
                -5.82083801416446
              ],
              [
                55.36012077800136,
                -5.811274461613691
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.410114515192056,
                -4.556027157040039
              ],
              [
                55.367686235535324,
                -4.597908836878544
              ],
              [
                55.351206743347824,
                -4.649239661902916
              ],
              [
                55.36501522396936,
                -4.664200662875082
              ],
              [
                55.37149051613818,
                -4.665821022733948
              ],
              [
                55.39101204901779,
                -4.662907184890436
              ],
              [
                55.39976673330511,
                -4.671248000462848
              ],
              [
                55.40968022376144,
                -4.678861445927304
              ],
              [
                55.41894295169075,
                -4.72270419385055
              ],
              [
                55.456365131866534,
                -4.816448866093658
              ],
              [
                55.543225788604815,
                -4.812343528772174
              ],
              [
                55.50443031741341,
                -4.776762903523618
              ],
              [
                55.50065376712044,
                -4.712439404403126
              ],
              [
                55.43954231692513,
                -4.641608243008132
              ],
              [
                55.44778206301888,
                -4.549551343988759
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.493398993223856,
                -4.596932859210054
              ],
              [
                55.485159247130106,
                -4.613188044883674
              ],
              [
                55.48378595611448,
                -4.635431379913749
              ],
              [
                55.50181040069456,
                -4.647066076478262
              ],
              [
                55.510393469542215,
                -4.6227698748294275
              ],
              [
                55.50181040069456,
                -4.594879546193957
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.212800440307944,
                -4.497264329196222
              ],
              [
                55.248763498779624,
                -4.468513445069405
              ],
              [
                55.22172683190951,
                -4.454479865518051
              ],
              [
                55.19589179467806,
                -4.469968130037858
              ],
              [
                55.19898169946322,
                -4.494012797884519
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.237321254887206,
                -4.381708661553993
              ],
              [
                55.24822175232373,
                -4.397198448704215
              ],
              [
                55.25766312805615,
                -4.394117632678941
              ],
              [
                55.25186955658398,
                -4.383676994868549
              ],
              [
                55.24092614380322,
                -4.381195182445789
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                59.542178209354496,
                -16.45623815582866
              ],
              [
                59.536685045291996,
                -16.70170917344621
              ],
              [
                59.56003099255762,
                -16.739193173043283
              ],
              [
                59.618395860721684,
                -16.720123286782073
              ],
              [
                59.665087755252934,
                -16.65237691127468
              ],
              [
                59.663027818729496,
                -16.567495712295862
              ],
              [
                59.61976915173731,
                -16.438457354556203
              ],
              [
                59.55179124646387,
                -16.435823023261843
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.852925767275465,
                -4.359623588421032
              ],
              [
                55.836703767153395,
                -4.373402219247135
              ],
              [
                55.83327053961433,
                -4.386667121315257
              ],
              [
                55.8439993756739,
                -4.387522913366598
              ],
              [
                55.861680497500075,
                -4.3633892020885
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.91087023997369,
                -4.340508790930588
              ],
              [
                55.921513245344784,
                -4.355913846289375
              ],
              [
                55.92013995432916,
                -4.330580921933151
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.85276286387506,
                -4.310749537479082
              ],
              [
                55.86495082163873,
                -4.335740786110828
              ],
              [
                55.8756796576983,
                -4.340447949496965
              ],
              [
                55.8881251075274,
                -4.3300921513473485
              ],
              [
                55.873018906355526,
                -4.308096308642123
              ],
              [
                55.86168925547662,
                -4.307582779410871
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.8547189784794,
                -4.2807552460055325
              ],
              [
                55.84690838582803,
                -4.2804984722325745
              ],
              [
                55.8446338725834,
                -4.286061884687516
              ],
              [
                55.85806637532998,
                -4.298044481629411
              ],
              [
                55.87428837545205,
                -4.299756265830215
              ],
              [
                55.874717528894436,
                -4.290854946031404
              ],
              [
                55.861757094934475,
                -4.282723842069514
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.692185617195754,
                -4.27719858268964
              ],
              [
                55.66368981902183,
                -4.291235487690717
              ],
              [
                55.65188294437173,
                -4.3242297560663445
              ],
              [
                55.6581109773296,
                -4.334280744907191
              ],
              [
                55.66257685471414,
                -4.3334864155632
              ],
              [
                55.66558359747043,
                -4.3316650437860895
              ],
              [
                55.667783027973876,
                -4.332766906986063
              ],
              [
                55.637935460377456,
                -4.344855793288283
              ],
              [
                55.66265469929278,
                -4.361244961572723
              ],
              [
                55.65733319476932,
                -4.3660375487809135
              ],
              [
                55.64617520141965,
                -4.372199401620932
              ],
              [
                55.753291937408044,
                -4.39154044383805
              ],
              [
                55.78762422447517,
                -4.369289643969999
              ],
              [
                55.80341707634194,
                -4.3398491101844705
              ],
              [
                55.796550618493555,
                -4.2771985823949255
              ],
              [
                55.723766170265144,
                -4.272063065314076
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.76308989797191,
                -4.576926577884321
              ],
              [
                55.76097631744807,
                -4.577439916803712
              ],
              [
                55.75812244705622,
                -4.57989967405843
              ],
              [
                55.760311129612376,
                -4.585867223885809
              ],
              [
                55.763100626987864,
                -4.583963602291873
              ],
              [
                55.76498890213435,
                -4.577568252173901
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.18449805041412,
                -3.7018304269569944
              ],
              [
                55.18398306628326,
                -3.7204166304280624
              ],
              [
                55.19780180712799,
                -3.7363473500172995
              ],
              [
                55.2109339024649,
                -3.703457806005205
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.671871107340266,
                -3.787630178938081
              ],
              [
                55.69058219742816,
                -3.789171755400169
              ],
              [
                55.6929854567055,
                -3.756284196870975
              ],
              [
                55.64783851456683,
                -3.7561129042498282
              ],
              [
                55.63153068375628,
                -3.7691310475296937
              ],
              [
                55.63874046158831,
                -3.814350447954211
              ],
              [
                55.655391615152766,
                -3.828224106482748
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.36628813514123,
                -4.8715873424663325
              ],
              [
                53.346461246103146,
                -4.9105836146244215
              ],
              [
                53.3700646854342,
                -4.923239810183643
              ],
              [
                53.38113684424768,
                -4.914089746933494
              ],
              [
                53.39049238929162,
                -4.884158757105654
              ],
              [
                53.38405508765588,
                -4.865515350480603
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.3014688820897,
                -5.128047595118687
              ],
              [
                53.32129577112779,
                -5.107701330808468
              ],
              [
                53.29915145350083,
                -5.107188391418856
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.33768943262681,
                -5.076069302265164
              ],
              [
                53.31314185572251,
                -5.086841465033535
              ],
              [
                53.3303938241063,
                -5.122234442793429
              ],
              [
                53.3564005227147,
                -5.0738464526234965
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.29619832639789,
                -5.3330725369637175
              ],
              [
                53.263925987530705,
                -5.369989775096002
              ],
              [
                53.30443807249164,
                -5.3834913555177035
              ],
              [
                53.32795568113422,
                -5.352385999671645
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.31141231681374,
                -5.440177230889103
              ],
              [
                53.36196659232643,
                -5.4183031483301045
              ],
              [
                53.346688729777604,
                -5.4018116169021475
              ],
              [
                53.319023119567404,
                -5.389080225112215
              ],
              [
                53.29438971197463,
                -5.393438226116041
              ],
              [
                53.28683661138869,
                -5.409844537241894
              ],
              [
                53.31018255865432,
                -5.419243785958078
              ],
              [
                53.30983923590041,
                -5.430693582195367
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                50.71676991739059,
                -9.332477473623397
              ],
              [
                50.73900006570602,
                -9.325955926166305
              ],
              [
                50.72011731424118,
                -9.318417881775293
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                50.924642371805625,
                -9.240243128011784
              ],
              [
                50.866964149149375,
                -9.40421668874566
              ],
              [
                50.987813758524375,
                -9.629045493331004
              ],
              [
                51.04068546262594,
                -9.179919522333895
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    Deep = 
    /* color: #0c16c2 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.22752818329987,
                -4.408108871795463
              ],
              [
                55.24091777070221,
                -4.414227587181845
              ],
              [
                55.24602469666657,
                -4.4121737582671585
              ],
              [
                55.238085357982484,
                -4.401818951026618
              ],
              [
                55.22963103516754,
                -4.401690584742926
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.10923834644881,
                -4.2909914005764485
              ],
              [
                55.04881354176131,
                -4.30331627503444
              ],
              [
                55.074219425550375,
                -4.350559774055848
              ],
              [
                55.22734137379256,
                -4.338235667410778
              ],
              [
                55.28364630543319,
                -4.403277280043641
              ],
              [
                55.2019354900035,
                -4.459413893211122
              ],
              [
                55.22184820973006,
                -4.447091587584681
              ],
              [
                55.241760929456625,
                -4.451883619850726
              ],
              [
                55.274719913831625,
                -4.492956898680837
              ],
              [
                55.24794073902694,
                -4.513492671837868
              ],
              [
                55.23214789234725,
                -4.532658869311558
              ],
              [
                55.21360846363631,
                -4.5107546022620015
              ],
              [
                55.17652960621444,
                -4.495695035243141
              ],
              [
                55.11679144703475,
                -4.490903289511004
              ],
              [
                54.978089054456625,
                -4.531974370997968
              ],
              [
                54.91697760426131,
                -4.6524360040557715
              ],
              [
                54.980714183904006,
                -4.867446367255372
              ],
              [
                55.07272468195088,
                -4.967327610463236
              ],
              [
                55.26017890558369,
                -4.968011676737542
              ],
              [
                55.273254757092175,
                -4.845957072348354
              ],
              [
                55.30716420883822,
                -4.645328294065157
              ],
              [
                55.34836293930697,
                -4.535817464465671
              ],
              [
                55.39436818833041,
                -4.29072742675142
              ],
              [
                55.19455434555697,
                -4.305791140344339
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.79562920448245,
                -4.47278322018755
              ],
              [
                55.7818962943262,
                -4.549449268891032
              ],
              [
                55.83614128944339,
                -4.630213595310534
              ],
              [
                55.8917595755762,
                -4.591885902082193
              ],
              [
                55.93982476112308,
                -4.46799132425887
              ],
              [
                55.82790154334964,
                -4.441293046025351
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                56.51728440642244,
                -5.164048643290083
              ],
              [
                56.875713361500566,
                -5.140797029815418
              ],
              [
                56.82764817595369,
                -4.774132471344284
              ],
              [
                56.521404279469316,
                -4.750867128151854
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                59.55351282951431,
                -16.533729913227678
              ],
              [
                59.53497340080337,
                -16.611388274644575
              ],
              [
                59.56106593010025,
                -16.675202579352693
              ],
              [
                59.593338268967436,
                -16.656784137184257
              ],
              [
                59.5967714965065,
                -16.635732319737603
              ],
              [
                59.58647181388931,
                -16.59493784820497
              ],
              [
                59.60295130607681,
                -16.533729913227678
              ],
              [
                59.5747988402565,
                -16.4955473878938
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.82117717051568,
                -4.308927445808635
              ],
              [
                55.810190836200114,
                -4.319197927056913
              ],
              [
                55.82289378428521,
                -4.319882641422618
              ],
              [
                55.83267848277154,
                -4.319283533248809
              ],
              [
                55.82993190074029,
                -4.306873329048051
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.7622374049447,
                -4.5610817119859774
              ],
              [
                55.7576454631112,
                -4.567541377858183
              ],
              [
                55.762602185370724,
                -4.570129505810936
              ],
              [
                55.76743016159753,
                -4.561680623849451
              ],
              [
                55.7652629367135,
                -4.5610817119859774
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.71091965100533,
                -3.7313159072799964
              ],
              [
                55.7095463599897,
                -3.8080538077779056
              ],
              [
                55.791247143559765,
                -3.9298266636375776
              ],
              [
                55.891507419560014,
                -3.993361063616616
              ],
              [
                55.8908207740522,
                -3.751528778021327
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.12287161608795,
                -3.724099564361653
              ],
              [
                55.12364409228424,
                -3.7459399019339044
              ],
              [
                55.19805929919342,
                -3.741743173392664
              ],
              [
                55.19402525683502,
                -3.731122791000546
              ],
              [
                55.18072150012115,
                -3.705085182061557
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.320491846662975,
                -3.747443628452631
              ],
              [
                55.31980520115516,
                -3.8580927030910788
              ],
              [
                55.404605921370006,
                -3.843363153383337
              ],
              [
                55.41078573094032,
                -3.746073272679222
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.26492169506689,
                -4.873348693067708
              ],
              [
                53.29401773333353,
                -4.967073279212991
              ],
              [
                53.38963264885736,
                -4.9669022625227965
              ],
              [
                53.40113390568452,
                -4.941762443327266
              ],
              [
                53.35332481042124,
                -4.9229506204654285
              ],
              [
                53.31581861812553,
                -4.891479944724156
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.124339277890286,
                -5.25163236231433
              ],
              [
                53.218753035214505,
                -5.4560435993407665
              ],
              [
                53.36535185113247,
                -5.181200792805181
              ],
              [
                53.25411527886685,
                -5.109393539012181
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.33688933180449,
                -5.399080786231485
              ],
              [
                53.33997923658965,
                -5.404976800540399
              ],
              [
                53.35293967054961,
                -5.412923511595184
              ],
              [
                53.36366850660918,
                -5.418648496781997
              ],
              [
                53.36461264418242,
                -5.421553692394682
              ],
              [
                53.368818347917774,
                -5.423177177971778
              ],
              [
                53.37645727919219,
                -5.411641791065571
              ],
              [
                53.36263853834746,
                -5.394466474160993
              ],
              [
                53.35087973402617,
                -5.383357801229904
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.44910670219687,
                -5.4547502049421155
              ],
              [
                53.341646680224216,
                -5.486533789670236
              ],
              [
                53.422327527392184,
                -5.59895883502795
              ],
              [
                53.51708460747031,
                -5.521391257645976
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                50.84093216338972,
                -10.01183757588908
              ],
              [
                50.81106308379988,
                -10.044293031438755
              ],
              [
                50.816899570616286,
                -10.111898094436233
              ],
              [
                50.86496475616316,
                -10.081139548789313
              ],
              [
                50.86530807891707,
                -10.027727632193288
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    notSRS = 
    /* color: #e7ff78 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.76433165988321,
                -4.589617246095629
              ],
              [
                55.76585515460367,
                -4.592461959582767
              ],
              [
                55.76933129748697,
                -4.591841684676566
              ],
              [
                55.768987974733065,
                -4.5874997452364195
              ],
              [
                55.76493247470255,
                -4.587927523694005
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.7651041360795,
                -4.57853440232471
              ],
              [
                55.76184256991739,
                -4.5870044743944804
              ],
              [
                55.76731427630777,
                -4.586041971260488
              ],
              [
                55.76885922870035,
                -4.579111910425983
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.3686055637301,
                -4.876205440500802
              ],
              [
                53.35641760596643,
                -4.895276138308276
              ],
              [
                53.35993666419397,
                -4.906820915542953
              ],
              [
                53.37924856910119,
                -4.913576655552374
              ],
              [
                53.3865441776217,
                -4.890829207974152
              ],
              [
                53.384913394540646,
                -4.8732977528464385
              ],
              [
                53.377703616708615,
                -4.8717583837001905
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                50.716941578767546,
                -9.332392778983523
              ],
              [
                50.73865674295212,
                -9.32621001471362
              ],
              [
                50.72037480630661,
                -9.318587277819127
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                50.72990201272751,
                -9.34738340960935
              ],
              [
                50.74475072183395,
                -9.33154583145327
              ],
              [
                50.71702740945602,
                -9.334679527037853
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                50.94530595782609,
                -9.247495590857218
              ],
              [
                50.88350786212297,
                -9.45684875316213
              ],
              [
                50.96933855059953,
                -9.599055088522832
              ],
              [
                51.02152360919328,
                -9.458203377969488
              ],
              [
                51.03250993731828,
                -9.233263152856834
              ],
              [
                51.025643482240156,
                -9.195984998379663
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.06728062136878,
                -12.589911681303422
              ],
              [
                45.08684999278793,
                -12.584550550337896
              ],
              [
                45.1071060089134,
                -12.593262330899067
              ],
              [
                45.13045192577543,
                -12.610685004215226
              ],
              [
                45.159634321734885,
                -12.625426340624431
              ],
              [
                45.24409160806581,
                -12.697110710464829
              ],
              [
                45.291420818820164,
                -12.734188731173987
              ],
              [
                45.297257297268544,
                -12.777719086248583
              ],
              [
                45.29519736293017,
                -12.813542291534581
              ],
              [
                45.290047528210344,
                -12.830615111659153
              ],
              [
                45.28867423860238,
                -12.859579545635544
              ],
              [
                45.285241361888275,
                -12.872465504432684
              ],
              [
                45.27219476810977,
                -12.880665467251982
              ],
              [
                45.245758951102694,
                -12.905765441046194
              ],
              [
                45.22671338344669,
                -12.938876356289793
              ],
              [
                45.22259351575541,
                -12.961963043346119
              ],
              [
                45.226026738443274,
                -12.992741961744391
              ],
              [
                45.24010295221053,
                -13.012478608956776
              ],
              [
                45.22362348213043,
                -13.029203351162431
              ],
              [
                45.1631987590357,
                -13.06432163114266
              ],
              [
                45.13023981933042,
                -13.072682390800061
              ],
              [
                45.07187503016284,
                -13.058970596721592
              ],
              [
                45.01763010792066,
                -13.01950313881393
              ],
              [
                44.982611233634344,
                -12.98370941464536
              ],
              [
                44.9690053383704,
                -12.930250738091718
              ],
              [
                44.96179556954632,
                -12.898460125325645
              ],
              [
                44.95046593341197,
                -12.880053186737987
              ],
              [
                44.93982294231722,
                -12.883065324085255
              ],
              [
                44.95424248024044,
                -12.953672809953055
              ],
              [
                44.97072195095727,
                -12.98712909080442
              ],
              [
                45.04951289165046,
                -13.073302840609827
              ],
              [
                45.2173974906912,
                -13.077650312387346
              ],
              [
                45.27541895840861,
                -13.001725768752378
              ],
              [
                45.31009451198681,
                -12.871897921110548
              ],
              [
                45.322454117178204,
                -12.73128683072382
              ],
              [
                45.1845683136181,
                -12.618659975143174
              ],
              [
                45.108007439356925,
                -12.57845327054445
              ],
              [
                45.070585307873365,
                -12.572421721538863
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                44.95316513169569,
                -12.878731935715377
              ],
              [
                44.962778168805066,
                -12.900485589106864
              ],
              [
                44.96689804185194,
                -12.9028281774735
              ],
              [
                44.97136123765272,
                -12.921233465171797
              ],
              [
                44.97273452866835,
                -12.929933674604388
              ],
              [
                44.97616775620741,
                -12.954024978833708
              ],
              [
                44.983034211285535,
                -12.972091928263628
              ],
              [
                44.98818405259413,
                -12.982128555482664
              ],
              [
                44.99436386216444,
                -12.995175564894053
              ],
              [
                45.00809677232069,
                -13.010897972885955
              ],
              [
                45.03178604234022,
                -13.02661938403023
              ],
              [
                45.050668793805066,
                -13.040332991557023
              ],
              [
                45.08225448716444,
                -13.06040031507733
              ],
              [
                45.12825973618788,
                -13.06842678812995
              ],
              [
                45.16739853013319,
                -13.05872810035384
              ],
              [
                45.20310409653944,
                -13.037991697723662
              ],
              [
                45.23331649888319,
                -13.013908533072046
              ],
              [
                45.21992691148085,
                -12.98915395339735
              ],
              [
                45.217523652203504,
                -12.97175736704617
              ],
              [
                45.219727574547605,
                -12.94685826350915
              ],
              [
                45.244446812828855,
                -12.909715464613893
              ],
              [
                45.2578364002312,
                -12.87959562889104
              ],
              [
                45.277405797203855,
                -12.86286082172961
              ],
              [
                45.289422093590574,
                -12.830392113838581
              ],
              [
                45.27946573372729,
                -12.795240850854368
              ],
              [
                45.28848524723516,
                -12.744346538351492
              ],
              [
                45.27749891911016,
                -12.726932976463457
              ],
              [
                45.22225585791119,
                -12.684250476206692
              ],
              [
                45.17247405859479,
                -12.638024020779621
              ],
              [
                45.15462127539166,
                -12.623283391021879
              ],
              [
                45.12063232275494,
                -12.605191457383034
              ],
              [
                45.10432681076973,
                -12.593652420362138
              ],
              [
                45.0864740275666,
                -12.586616006620169
              ],
              [
                45.058664884500196,
                -12.591977101263401
              ],
              [
                45.10467013352363,
                -12.628161557017421
              ],
              [
                45.1957470675417,
                -12.688788696558564
              ],
              [
                45.25342529019795,
                -12.741033648627104
              ],
              [
                45.26647155484639,
                -12.756957276370862
              ],
              [
                45.2451855441042,
                -12.79110946653539
              ],
              [
                45.243125607580765,
                -12.860738816322495
              ],
              [
                45.219436337561234,
                -12.917854823362454
              ],
              [
                45.2063900729128,
                -12.949308418290084
              ],
              [
                45.20913665494405,
                -12.998278764320993
              ],
              [
                45.1957470675417,
                -13.024704889507575
              ],
              [
                45.136008908362015,
                -13.047449170184628
              ],
              [
                45.07695739469014,
                -13.034070434703079
              ],
              [
                45.0144726534792,
                -12.990250016884232
              ],
              [
                44.999709775061234,
                -12.951775336613117
              ],
              [
                44.98014037808858,
                -12.894888841407193
              ],
              [
                44.96263091763936,
                -12.87012244133831
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    notTRF = 
    /* color: #007a00 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[55.93983436648838, -4.5775170906586435],
           [55.94567085330478, -4.59719490946505],
           [55.95803047244541, -4.58701384482381],
           [55.952880631136814, -4.582650486954896],
           [55.946357475403445, -4.57948492187818]]],
         [[[56.55640098204929, -10.367126295717428],
           [56.675877300408665, -10.515686790330534],
           [56.744541851189915, -10.477202937392848],
           [56.64909812560398, -10.333352679822562],
           [56.581463543084446, -10.328961842868994]]]]),
    notIRF = 
    /* color: #fffe64 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.13792558395689,
                -12.60845678017535
              ],
              [
                45.121617753146346,
                -12.61515755996249
              ],
              [
                45.13775392257994,
                -12.618675399148652
              ],
              [
                45.141187150119,
                -12.616665211247872
              ],
              [
                45.14341874801939,
                -12.621355625122748
              ],
              [
                45.14650865280455,
                -12.618340368928216
              ],
              [
                45.14719529831236,
                -12.623198264195157
              ],
              [
                45.15423341476744,
                -12.624705868110627
              ],
              [
                45.15749498092955,
                -12.629396134578702
              ],
              [
                45.16401811325377,
                -12.631071208898845
              ],
              [
                45.16676469528502,
                -12.628893610142882
              ],
              [
                45.16727967941588,
                -12.635091342489451
              ],
              [
                45.177579362033065,
                -12.638441405514508
              ],
              [
                45.187535721896346,
                -12.646146383773596
              ],
              [
                45.19663377487486,
                -12.655358552616763
              ],
              [
                45.20298524582213,
                -12.661890616289574
              ],
              [
                45.209508378146346,
                -12.665407812053656
              ],
              [
                45.22238298141783,
                -12.6814858031887
              ],
              [
                45.23439927780455,
                -12.690361759269345
              ],
              [
                45.24092241012877,
                -12.697562779162455
              ],
              [
                45.24057908737486,
                -12.703089004977974
              ],
              [
                45.248475510714705,
                -12.703758842368138
              ],
              [
                45.25465532028502,
                -12.709452388900742
              ],
              [
                45.26152177536314,
                -12.71246656776409
              ],
              [
                45.2646116801483,
                -12.719666961351138
              ],
              [
                45.28308462692388,
                -12.73021600634958
              ],
              [
                45.28789114547857,
                -12.737081022191207
              ],
              [
                45.290981050263724,
                -12.744615581656024
              ],
              [
                45.29115271164068,
                -12.754996163154546
              ],
              [
                45.29458593917974,
                -12.760855980865296
              ],
              [
                45.295959230195365,
                -12.77441675266707
              ],
              [
                45.3035123307813,
                -12.777597569114354
              ],
              [
                45.3035123307813,
                -12.735071768502666
              ],
              [
                45.277248140107474,
                -12.703926301439845
              ],
              [
                45.17863941341738,
                -12.619955316599338
              ],
              [
                45.15134525448183,
                -12.611076911997399
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.06791782528261,
                -12.590471126881141
              ],
              [
                45.07547092586855,
                -12.590136059781104
              ],
              [
                45.080620767177145,
                -12.584607389453923
              ],
              [
                45.08456897884707,
                -12.588125647990736
              ],
              [
                45.09298038631777,
                -12.586617828810084
              ],
              [
                45.1001901641498,
                -12.593151647925065
              ],
              [
                45.11512470394472,
                -12.60705640110169
              ],
              [
                45.12422275692324,
                -12.597004847842665
              ],
              [
                45.099846841395895,
                -12.57572776061396
              ],
              [
                45.07358265072207,
                -12.576062846522778
              ],
              [
                45.067145428582975,
                -12.582429309500075
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.0119901265796,
                -12.645397529060597
              ],
              [
                45.01971488854249,
                -12.642717555125538
              ],
              [
                45.02417808434327,
                -12.638027533082607
              ],
              [
                45.02761131188233,
                -12.635347481835332
              ],
              [
                45.03482108971436,
                -12.63987005201022
              ],
              [
                45.037052687614754,
                -12.638697541502657
              ],
              [
                45.037739333122566,
                -12.64322005238035
              ],
              [
                45.043747481315926,
                -12.647742483183535
              ],
              [
                45.05439048668702,
                -12.648914952169175
              ],
              [
                45.028411061495866,
                -12.621906547430962
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.25411255434667,
                -12.892476412023473
              ],
              [
                45.237461400782216,
                -12.915400103202398
              ],
              [
                45.247246099268544,
                -12.920921554074267
              ],
              [
                45.263897252833,
                -12.898165699267535
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.21463043764745,
                -12.976965728628619
              ],
              [
                45.22218353823339,
                -12.984493089458672
              ],
              [
                45.21909363344823,
                -12.996870920305986
              ],
              [
                45.23608810976659,
                -12.9948637464042
              ],
              [
                45.23282654360448,
                -12.966928893033229
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.22716171816503,
                -12.9334698520135
              ],
              [
                45.21394379213964,
                -12.951036408789744
              ],
              [
                45.21342880800878,
                -12.956724361805913
              ],
              [
                45.23866303042089,
                -12.953378522820236
              ],
              [
                45.233598790180245,
                -12.932549529190826
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.15270147377226,
                -13.064271827542424
              ],
              [
                45.15664968544218,
                -13.074806354685634
              ],
              [
                45.21638784462187,
                -13.048051121358345
              ],
              [
                45.25140676552031,
                -13.010421676411479
              ],
              [
                45.24162206703398,
                -13.003564139713054
              ],
              [
                45.22943410927031,
                -13.01309773685629
              ],
              [
                45.23338232094023,
                -13.019286015991566
              ],
              [
                45.22188100868437,
                -13.026310361785278
              ],
              [
                45.20831975990507,
                -13.035508608562985
              ],
              [
                45.179823971330855,
                -13.052566270233346
              ],
              [
                45.15870962196562,
                -13.06326851579564
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                46.4392538763218,
                -12.329340151829715
              ],
              [
                46.432387421243675,
                -12.34141443495574
              ],
              [
                46.43942553769875,
                -12.34443291877453
              ],
              [
                46.44818026792336,
                -12.33135257098801
              ],
              [
                46.45401675473977,
                -12.329340151829715
              ],
              [
                46.45916659604836,
                -12.3244767417527
              ],
              [
                46.452128479593284,
                -12.318271570364486
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                46.42500598203469,
                -12.367405793498408
              ],
              [
                46.461569855325706,
                -12.37210073113688
              ],
              [
                46.4586516119175,
                -12.363381494094607
              ],
              [
                46.44852359067727,
                -12.363381494094607
              ],
              [
                46.441142151468284,
                -12.36086627550323
              ],
              [
                46.4363356329136,
                -12.359021766490427
              ],
              [
                46.43530566465188,
                -12.351140535986133
              ],
              [
                46.42706591855813,
                -12.352985100579016
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                44.961042115227286,
                -12.626016343838991
              ],
              [
                44.937352845207755,
                -12.623001142569597
              ],
              [
                44.925107086238945,
                -12.664098123637267
              ],
              [
                44.96424588018426,
                -12.711994391386433
              ],
              [
                44.97248562627801,
                -12.774614341879941
              ],
              [
                45.00166806036004,
                -12.77327503981307
              ],
              [
                45.012997711238945,
                -12.71165948376755
              ],
              [
                44.96939572149285,
                -12.651703916405593
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    RCtoORF = 
    /* color: #d6c772 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[51.15282304509833, -10.12348653193581],
          [51.13909013494208, -10.129232100275852],
          [51.121237351738955, -10.141060887393227],
          [51.097548081719424, -10.1478199982397],
          [51.09136827214911, -10.147144093575758],
          [51.071798875176455, -10.152889237722269],
          [51.06046922429755, -10.154916911028952],
          [51.052572800957705, -10.154578966370348],
          [51.02931119974378, -10.184488607505397],
          [51.03102781351331, -10.19597744907016],
          [51.046820660193, -10.223346254434679],
          [51.05128385599378, -10.237198702050351],
          [51.0633001523805, -10.251726229009599],
          [51.07050993021253, -10.255442466146398],
          [51.078406353552374, -10.246320715356493],
          [51.08218290384534, -10.235171552354466],
          [51.09042264993909, -10.237198702050351],
          [51.108618755896124, -10.230103621462712],
          [51.13951780374769, -10.211858400669174],
          [51.16149045999769, -10.17097179346953],
          [51.134541394989895, -10.193274266982499],
          [51.113081951696905, -10.217602379447435],
          [51.07394315775159, -10.211520516333504],
          [51.055403729040655, -10.207465876312039],
          [51.04235746439222, -10.196315349905007],
          [51.03789426859144, -10.182123206380329],
          [51.05471708353284, -10.166240773358597],
          [51.103814224570655, -10.159823055376146],
          [51.15016080911878, -10.144612361229905],
          [51.15737058695081, -10.127376174201675]]]),
    RCtoDL = 
    /* color: #b6a6ff */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[51.058150311071905, -10.192598421010974],
          [51.06398679788831, -10.208817428727594],
          [51.07668973978284, -10.211858400669174],
          [51.097632427771124, -10.214223580967657],
          [51.12715818460706, -10.19868064571247],
          [51.13848783548597, -10.184150694132944],
          [51.137801189978155, -10.158130290206838],
          [51.119605084021124, -10.154750861504667],
          [51.07325651224378, -10.183136951867535]]]),
    wio_geo = ee.Image("projects/coral_atlas/west_indian_ocean/in_out/wio_geo"),
    SRStoRS = 
    /* color: #ffc82d */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[51.04249849390029, -9.529458675251796],
          [51.06447115015029, -9.539616077350798],
          [51.172961140384665, -9.425835961085388],
          [51.17914094995498, -9.309307924662855],
          [51.08987703393935, -9.230019523226801],
          [51.04249849390029, -9.166304803594919],
          [51.027392292728415, -9.202908279159622],
          [51.06378450464248, -9.2855910504213],
          [51.09537019800185, -9.324892423231791],
          [51.120776081790915, -9.35944687043081],
          [51.126269245853415, -9.395352754707147],
          [51.11940279077529, -9.42177168893203],
          [51.093310261478415, -9.450897914355268],
          [51.06172456811904, -9.485439776946954],
          [51.04524507593154, -9.522009721569372]]]),
    SStoBRS = 
    /* color: #fffea1 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[50.98138704370498, -9.258484085944575],
          [50.958727741947165, -9.347251574723215],
          [50.92714204858779, -9.522686905891337],
          [50.96559419702529, -9.584305047453686],
          [50.98482027124404, -9.509142964477366],
          [51.00129976343154, -9.475958042931298],
          [51.030138874759665, -9.325569994345427],
          [51.030138874759665, -9.232052782573744],
          [51.01434602807998, -9.213075239587427]]]),
    SStoSL = 
    /* color: #9ea3c2 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[51.103266621341696, -10.213196560152781],
          [51.134508991947165, -10.20711461278597],
          [51.15236177515029, -10.190557611755981],
          [51.161974812259665, -10.173999750619659],
          [51.17090120386123, -10.148992373819116],
          [51.18463411401748, -10.138515729560135],
          [51.17776765893935, -10.118913346307224],
          [51.148241902103415, -10.139191652434409],
          [51.10944643091201, -10.158116913627167],
          [51.087817097415915, -10.161158369051504],
          [51.06550111841201, -10.16149630675706],
          [51.0486783034706, -10.166565329463948],
          [51.0431851394081, -10.181771914913],
          [51.05588808130263, -10.196639875416235],
          [51.06000795434951, -10.205425162328847],
          [51.09537019800185, -10.212182910333796]]]),
    SLtoPR = 
    /* color: #dfff4a */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[59.55947283863478, -16.703979259656336],
          [59.58144549488478, -16.71318642892292],
          [59.59517840504103, -16.71680340960515],
          [59.61852435230666, -16.687536781721317],
          [59.63569049000197, -16.652016203102335],
          [59.6374071037715, -16.633595530984127],
          [59.628824034923845, -16.612541167696037],
          [59.62082920120004, -16.60234213040542],
          [59.62357578323129, -16.575361422767614],
          [59.631128883817226, -16.540149202838073],
          [59.63456211135629, -16.519413767036063],
          [59.61773929641488, -16.502955487551407],
          [59.61087284133676, -16.478265442247007],
          [59.568987465360195, -16.498676105387386],
          [59.56315097854379, -16.54870603484473],
          [59.566240883328945, -16.588194182529648],
          [59.56864414260629, -16.635398783398433],
          [59.5583444599891, -16.682104455834114]]]),
    toBRS = 
    /* color: #ffba95 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[59.60774313927436, -16.46454771896152],
          [59.616669530875924, -16.494177494481185],
          [59.63383566857124, -16.520511264618612],
          [59.64001547814155, -16.54947426583826],
          [59.627655859000924, -16.594884755835803],
          [59.6372688961103, -16.62844214043442],
          [59.65031516075874, -16.66199365628732],
          [59.62010275841499, -16.70014313654748],
          [59.59675681114936, -16.717899779267476],
          [59.564484472282174, -16.706062200991457],
          [59.55555808068061, -16.715269269779178],
          [59.56242453575874, -16.74617546435217],
          [59.57890402794624, -16.76524274245304],
          [59.58851706505561, -16.764585281912165],
          [59.60087668419624, -16.74617546435217],
          [59.61263544939019, -16.734339641554694],
          [59.63666804216363, -16.712638724022717],
          [59.65932734392144, -16.68633127281941],
          [59.679240063648, -16.659362377186625],
          [59.69709284685113, -16.602123118970017],
          [59.68747980974175, -16.587646120171996],
          [59.66413386247613, -16.523802733611387],
          [59.64834101579644, -16.509319850593403],
          [59.60645563981988, -16.450060402090916]]]),
    SLtoIRF = 
    /* color: #8bd64d */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[47.37853515357988, -11.531730267212449],
          [47.370982052993945, -11.541821860546376],
          [47.358965756607226, -11.550231244406472],
          [47.33939635963457, -11.558640376034573],
          [47.328753354263476, -11.570076389954934],
          [47.31021392555254, -11.579157597561894],
          [47.31124389381426, -11.600345934768361],
          [47.35862243385332, -11.573776176786515],
          [47.39776122779863, -11.539467187889219],
          [47.37887847633379, -11.528366322160965]]]),
    TRFtoRC = 
    /* color: #ff0d29 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[57.30602622889162, -20.51525287836684],
          [57.519572981821305, -20.53197250575586],
          [57.53124595545412, -20.508821766204775],
          [57.34997154139162, -20.467656257069574],
          [57.287143477426774, -20.479556797464383]]]),
    TRFtoORF = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[42.864168097189484, -11.195905049205999],
           [42.754304815939484, -12.056769746682779],
           [43.193757940939484, -12.807773662116553],
           [44.215486456564484, -13.000533194598347],
           [44.808748175314484, -12.529083296074981],
           [45.094392706564484, -12.389624631817437],
           [45.599763800314484, -12.81848641481299],
           [46.390779425314484, -13.054051046539394],
           [48.588045050314484, -11.023417977296786],
           [52.455232550314484, -10.289236994418744],
           [52.674959112814484, -8.674695509191116],
           [54.498689581564484, -6.715062857407767],
           [55.751130987814484, -6.8132515537114795],
           [56.014802862814484, -9.82408459609343],
           [56.245515753439484, -11.472991202209673],
           [58.563630987814484, -15.266663545524581],
           [59.025056769064484, -15.996676821256605],
           [57.827547003439484, -18.232969503545487],
           [56.9973871246446, -19.861052299642775],
           [54.8660394683946, -20.490093017425774],
           [54.7671625152696, -21.505496284609986],
           [55.1516839996446, -21.97492005112679],
           [56.4700433746446, -21.382786795328286],
           [56.7666742340196, -20.664944273359843],
           [57.2061273590196, -19.995322409092413],
           [57.7334711090196, -19.14649912708198],
           [59.1726800933946, -17.65583373439081],
           [61.6885492340196, -19.436842911373457],
           [63.7100336090196, -20.294434854215105],
           [64.29230899964459, -19.75769015695366],
           [63.6660882965196, -19.12574062628435],
           [61.6665765777696, -19.2502524204233],
           [60.1284906402696, -17.865088015711788],
           [60.070801428056, -15.455038143574592],
           [58.807373693681, -15.274946194759645],
           [56.63921707187242, -11.578286993792487],
           [57.329982635187214, -10.219011866517704],
           [56.165431853937214, -9.168569595183461],
           [56.220363494562214, -7.766819003316089],
           [57.022365447687214, -7.068693674253754],
           [55.901759978937214, -5.758614740931816],
           [57.483791228937214, -5.561825124572022],
           [57.07349586284258, -4.419811289885991],
           [56.45826148784258, -3.521103898517837],
           [54.73340797221758, -3.1043219565162596],
           [52.59107398784258, -4.857823824398052],
           [51.86597633159258, -8.12399786941739],
           [44.977548597217584, -9.372700865803413],
           [46.534211441242334, -10.89009893544037],
           [45.743195816242334, -11.859434686192309],
           [43.963410659992334, -10.96560869542345]]],
         [[[57.81321447237223, -20.200303327074064],
           [57.762402704794106, -20.464286796538],
           [57.864026239950356, -20.453993467357677],
           [57.88737218721598, -20.257001140772964]]],
         [[[57.42045324190348, -20.144874147496573],
           [57.446545771200356, -20.17839182024517],
           [57.534436396200356, -20.094584152099692],
           [57.46714513643473, -20.06749823078436]]]]),
    depth_pal = {"opacity":1,"bands":["depth"],"max":5,"palette":["e4e1ff","7f89ff","3a52ff","0007ff","000258"]},
    wio_benthic = ee.Image("projects/coral_atlas/west_indian_ocean/in_out/wio_benthic"),
    RCtoIRF = 
    /* color: #fffe44 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[55.659204329888894, -4.334751664179756],
           [55.669160689752175, -4.329274193622515],
           [55.66529830877073, -4.323283164810927],
           [55.65182289067991, -4.329445365177744]]],
         [[[55.641437377374245, -4.348102832274304],
           [55.65422614995725, -4.352638752251315],
           [55.647445525567605, -4.339202079783282]]]]),
    SSBRStoSL = 
    /* color: #61f1f4 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[47.59276366952485, -9.687179116346291],
           [47.585897214446724, -9.690224948811181],
           [47.55602813485688, -9.724404059517544],
           [47.583150632415474, -9.759594740247222],
           [47.602376706634224, -9.75485774946257],
           [47.61027312997407, -9.741999863736947],
           [47.62675262216157, -9.741323119180288],
           [47.635335691009224, -9.753504311155895],
           [47.64460540536469, -9.738277751694888],
           [47.65112853768891, -9.715605810020225],
           [47.640828855071724, -9.702746413933353],
           [47.59894347909516, -9.685486975255515]]],
         [[[46.25038479518611, -9.40622340341489],
           [46.25931118678767, -9.425867826694434],
           [46.330036784724705, -9.429933909852755],
           [46.334842192647045, -9.405545989593882],
           [46.270640837666576, -9.387932764844745]]]]),
    RCtoORF2 = 
    /* color: #ffc756 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[55.33929678436959, -5.819532133315801],
          [55.333116974799275, -5.8584678623598325],
          [55.36813589569771, -5.845148049131459],
          [55.363329377143025, -5.816116589567722]]]),
    MoreDeep = 
    /* color: #1b27ff */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[54.97193475746061, -4.238376289551878],
          [55.42237421058561, -4.271244437181423],
          [55.45533319496061, -4.068535503752379],
          [55.23147412172192, -3.952120122279829],
          [55.01313348792936, -3.9753817066470383]]]),
    RCtoIRF2 = 
    /* color: #fffe44 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.659204329888894,
                -4.334751664179756
              ],
              [
                55.669160689752175,
                -4.329274193622515
              ],
              [
                55.66529830877073,
                -4.323283164810927
              ],
              [
                55.65182289067991,
                -4.329445365177744
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.641437377374245,
                -4.348102832274304
              ],
              [
                55.65422614995725,
                -4.352638752251315
              ],
              [
                55.647445525567605,
                -4.339202079783282
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                47.27158998556605,
                -11.579461643890012
              ],
              [
                47.28480791159144,
                -11.599472871643533
              ],
              [
                47.31931184835902,
                -11.596782369818476
              ],
              [
                47.31364702291957,
                -11.590224163011682
              ],
              [
                47.31965517111293,
                -11.587197246399292
              ],
              [
                47.32703661032191,
                -11.58047064766063
              ],
              [
                47.3208568007516,
                -11.570716792066495
              ],
              [
                47.2853228957223,
                -11.555749007824549
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                46.13475192333875,
                -9.376827643454927
              ],
              [
                46.2308822944325,
                -9.497396375688599
              ],
              [
                46.24324191357312,
                -9.357857947235685
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                51.15290579490269,
                -10.10397714507844
              ],
              [
                51.16492209128941,
                -10.126622223923384
              ],
              [
                51.18586477927769,
                -10.133043671935397
              ],
              [
                51.18895468406285,
                -10.127974118400282
              ],
              [
                51.18277487449254,
                -10.111413018656622
              ],
              [
                51.17247519187535,
                -10.105329134887462
              ],
              [
                51.16148886375035,
                -10.108709084533347
              ],
              [
                51.15668234519566,
                -10.105329134887462
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                51.153592440410506,
                -10.187451824088079
              ],
              [
                51.1422627895316,
                -10.196237364397888
              ],
              [
                51.15530905418004,
                -10.200630043705933
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.29520670442564,
                -5.758073615577071
              ],
              [
                53.29709497957212,
                -5.767638068513723
              ],
              [
                53.30550628571076,
                -5.773018001300501
              ],
              [
                53.305592138037454,
                -5.78236870635847
              ],
              [
                53.312201180744,
                -5.782838385015353
              ],
              [
                53.31614939241392,
                -5.764051417546372
              ],
              [
                53.318724313068216,
                -5.757561229623883
              ],
              [
                53.31443277864439,
                -5.744580631479481
              ],
              [
                53.29812494783384,
                -5.750558575310261
              ],
              [
                53.29374759236438,
                -5.752949724696832
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.28197481703087,
                -5.413085971490063
              ],
              [
                53.29141619276329,
                -5.418896402244171
              ],
              [
                53.30549242567345,
                -5.416332983798188
              ],
              [
                53.30755236219689,
                -5.412915075622324
              ],
              [
                53.30223085951134,
                -5.406933689833423
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.34832207834808,
                -5.434191158585586
              ],
              [
                53.343086267226184,
                -5.4484603740577935
              ],
              [
                53.357505822890246,
                -5.4484603740577935
              ],
              [
                53.36523058485314,
                -5.442821115768935
              ],
              [
                53.36591723036095,
                -5.437010915552233
              ],
              [
                53.36523058485314,
                -5.431713331183104
              ],
              [
                53.35699083875939,
                -5.424364991894854
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.65503862645146,
                -3.805372220554712
              ],
              [
                55.66018848849534,
                -3.8033168345054644
              ],
              [
                55.66602495457646,
                -3.798863445531388
              ],
              [
                55.65950182225224,
                -3.793039763102444
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.838132991883604,
                -4.376751939394748
              ],
              [
                55.85126508722052,
                -4.383170441037057
              ],
              [
                55.85624326715216,
                -4.367338037459903
              ],
              [
                55.85006345758185,
                -4.364171516610309
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.822170534207224,
                -4.362437891154656
              ],
              [
                55.822127618862986,
                -4.365561628485353
              ],
              [
                55.823372163845896,
                -4.368514190174713
              ],
              [
                55.824659624173044,
                -4.371124416191418
              ],
              [
                55.82676247604072,
                -4.373563471631376
              ],
              [
                55.82852200515449,
                -4.37510392360749
              ],
              [
                55.83152607925117,
                -4.370996044632586
              ],
              [
                55.82551793105781,
                -4.362181145042702
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.851256740269505,
                -4.29519975149983
              ],
              [
                55.86636294144138,
                -4.290021561595102
              ],
              [
                55.87430228012546,
                -4.295285341120438
              ],
              [
                55.87812174576267,
                -4.284329791695867
              ],
              [
                55.84769476669773,
                -4.281334106310278
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.258010829058826,
                -4.379818527407898
              ],
              [
                55.229343379107654,
                -4.376823220073382
              ],
              [
                55.23586651143187,
                -4.409257480001241
              ],
              [
                55.26118656453246,
                -4.408915173285934
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.35521307790457,
                -4.645910963031452
              ],
              [
                55.396583469750276,
                -4.663704862431732
              ],
              [
                55.433833988549104,
                -4.6086107570909345
              ],
              [
                55.435550602318635,
                -4.554710216817644
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.44239585237682,
                -4.670518558602551
              ],
              [
                55.43432776766002,
                -4.6806128762013195
              ],
              [
                55.446515725423694,
                -4.688311834135644
              ],
              [
                55.45767371492565,
                -4.679073074445793
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.48256461458385,
                -4.724068102288702
              ],
              [
                55.48101966219127,
                -4.740833565150735
              ],
              [
                55.45552795307652,
                -4.746650032094654
              ],
              [
                55.45977651222561,
                -4.757769776019711
              ],
              [
                55.4798180325526,
                -4.75315078889819
              ],
              [
                55.49578254060924,
                -4.746992204509995
              ],
              [
                55.493722604085804,
                -4.7278318129657775
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.496154133136905,
                -4.780879444567066
              ],
              [
                55.49254924422089,
                -4.786524537272645
              ],
              [
                55.50456554060761,
                -4.790715560827764
              ],
              [
                55.502162251106206,
                -4.783146035573707
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                56.58070870804062,
                -10.364343193524466
              ],
              [
                56.59293998006754,
                -10.361515146625672
              ],
              [
                56.60199537568282,
                -10.381566937137512
              ],
              [
                56.60917296190687,
                -10.391645121766105
              ],
              [
                56.61211808261318,
                -10.398921138931383
              ],
              [
                56.620135645987546,
                -10.409422664929936
              ],
              [
                56.628840417912855,
                -10.41992397410005
              ],
              [
                56.632420012635734,
                -10.42530086518548
              ],
              [
                56.644509449261996,
                -10.433644867449976
              ],
              [
                56.64712070388197,
                -10.43317417859072
              ],
              [
                56.626901575544764,
                -10.413119442525527
              ],
              [
                56.620156695204436,
                -10.385379068692718
              ],
              [
                56.61686552172269,
                -10.381123614468525
              ],
              [
                56.60641558074419,
                -10.355942536279686
              ],
              [
                56.620705808870696,
                -10.343741537412575
              ],
              [
                56.57641717361679,
                -10.32668504484843
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                56.65022822086627,
                -10.436970217172895
              ],
              [
                56.65782440565385,
                -10.444735949859266
              ],
              [
                56.66280258558549,
                -10.441612819923167
              ],
              [
                56.649927982314004,
                -10.426587594314393
              ],
              [
                56.64537895582475,
                -10.42785379300262
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                57.70443238575737,
                -20.436191397651676
              ],
              [
                57.72571839649956,
                -20.442625554565332
              ],
              [
                57.73670472462456,
                -20.436834825460004
              ],
              [
                57.74700440724175,
                -20.425252713029234
              ],
              [
                57.74734772999565,
                -20.40305122731986
              ],
              [
                57.77962006886284,
                -20.387604827810698
              ],
              [
                57.7995327885894,
                -20.36121364858639
              ],
              [
                57.79644283083761,
                -20.321940832249453
              ],
              [
                57.77412690480034,
                -20.3599261585281
              ],
              [
                57.688639539077684,
                -20.400155145353963
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                57.78449161612187,
                -20.309407230127995
              ],
              [
                57.81264408194218,
                -20.27817211313118
              ],
              [
                57.80921085440312,
                -20.25176226021794
              ],
              [
                57.79376135112857,
                -20.23726741952989
              ],
              [
                57.78929813467656,
                -20.25240645643799
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                57.726741869244194,
                -20.177436349040182
              ],
              [
                57.76931389072857,
                -20.164223429866812
              ],
              [
                57.744937975201225,
                -20.13070271457168
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                63.32898554372036,
                -19.68283257145161
              ],
              [
                63.3094161467477,
                -19.730991499789965
              ],
              [
                63.35404810475551,
                -19.797872762078914
              ],
              [
                63.45498499440395,
                -19.763627890677096
              ],
              [
                63.49137720631801,
                -19.72808298279924
              ],
              [
                63.49137720631801,
                -19.684125617921634
              ],
              [
                63.43953547047817,
                -19.66602201763201
              ],
              [
                63.40348658131801,
                -19.673780953911027
              ],
              [
                63.39078363942348,
                -19.66957824338178
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    RCtoORF3 = 
    /* color: #ffc756 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.33929678436959,
                -5.819532133315801
              ],
              [
                55.333116974799275,
                -5.8584678623598325
              ],
              [
                55.36813589569771,
                -5.845148049131459
              ],
              [
                55.363329377143025,
                -5.816116589567722
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                43.506915678114375,
                -11.926392658304064
              ],
              [
                43.50296746644445,
                -11.913627711464002
              ],
              [
                43.51309548768469,
                -11.909596550929056
              ],
              [
                43.51876031312414,
                -11.903717667927056
              ],
              [
                43.52133523377844,
                -11.900190277085507
              ],
              [
                43.522880186171015,
                -11.895151067927433
              ],
              [
                43.52133523377844,
                -11.88809601826973
              ],
              [
                43.51704369935461,
                -11.883560532624061
              ],
              [
                43.512923826307734,
                -11.883056585110332
              ],
              [
                43.511378873915156,
                -11.881376753328569
              ],
              [
                43.51532708558508,
                -11.87364939369107
              ],
              [
                43.49232446107336,
                -11.313008866314455
              ],
              [
                43.14350854310461,
                -11.338593277865346
              ],
              [
                43.17646752747961,
                -11.832321102203176
              ],
              [
                43.523910154432734,
                -12.027147416453223
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                43.718756638793565,
                -12.274879754714837
              ],
              [
                43.71832748421397,
                -12.269595971553105
              ],
              [
                43.71103185572926,
                -12.266408876448143
              ],
              [
                43.709315237298256,
                -12.26204752601617
              ],
              [
                43.70090380682758,
                -12.258860339613284
              ],
              [
                43.690432434174625,
                -12.258021599842035
              ],
              [
                43.68322263662195,
                -12.25684735975713
              ],
              [
                43.67678531739249,
                -12.255169864897628
              ],
              [
                43.67275126404055,
                -12.25248585102713
              ],
              [
                43.6659706211712,
                -12.24861085673042
              ],
              [
                43.62674588940111,
                -12.242739394259143
              ],
              [
                43.62073772450368,
                -12.251965917921538
              ],
              [
                43.59699679070081,
                -12.333640628673626
              ],
              [
                43.63622152122414,
                -12.41634119358034
              ],
              [
                43.67707704212393,
                -12.4257292488325
              ],
              [
                43.715185973631854,
                -12.42363373080356
              ],
              [
                43.73887530940788,
                -12.425142505939043
              ],
              [
                43.751664117489675,
                -12.394043208962541
              ],
              [
                43.83431929997707,
                -12.425226325763028
              ],
              [
                43.92384173926684,
                -12.410463780361823
              ],
              [
                43.898092459853586,
                -12.367206327954133
              ],
              [
                43.88092627529285,
                -12.38598563886182
              ],
              [
                43.872477288280706,
                -12.386781646407787
              ],
              [
                43.87256311890763,
                -12.376134646365466
              ],
              [
                43.872477287777095,
                -12.368840781586716
              ],
              [
                43.869129881502616,
                -12.362468963054202
              ],
              [
                43.854109469371224,
                -12.355593932309587
              ],
              [
                43.795229454284915,
                -12.329601329923106
              ],
              [
                43.73734219526262,
                -12.292662771154447
              ],
              [
                43.76111736127429,
                -12.302055266699165
              ],
              [
                43.77004377736395,
                -12.292830497210288
              ],
              [
                43.766438895508784,
                -12.29345946332129
              ],
              [
                43.768756313488424,
                -12.289643683453892
              ],
              [
                43.75708330780394,
                -12.28394086775953
              ],
              [
                43.75124680497305,
                -12.27966367486131
              ],
              [
                43.74669776600604,
                -12.280502345612716
              ],
              [
                43.73365146561086,
                -12.270605860477158
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                44.20584584919939,
                -12.185539758565815
              ],
              [
                44.214772240800954,
                -12.195103827515704
              ],
              [
                44.22181035725603,
                -12.200640762387955
              ],
              [
                44.23193837849627,
                -12.206513142648076
              ],
              [
                44.24258138386736,
                -12.210204286460636
              ],
              [
                44.25185109822283,
                -12.215573131055422
              ],
              [
                44.26215078084002,
                -12.219767465116897
              ],
              [
                44.27348043171892,
                -12.225639421085694
              ],
              [
                44.280690209550954,
                -12.228659233386793
              ],
              [
                44.291676537675954,
                -12.233524413978877
              ],
              [
                44.310902611894704,
                -12.245099828335048
              ],
              [
                44.315880791826345,
                -12.247448401212063
              ],
              [
                44.32326223103533,
                -12.248287172175354
              ],
              [
                44.33150197712908,
                -12.246777382522277
              ],
              [
                44.34729482380877,
                -12.243925534061237
              ],
              [
                44.349354760332204,
                -12.246777382522277
              ],
              [
                44.354332940263845,
                -12.249964706104828
              ],
              [
                44.369095818681814,
                -12.249964706104828
              ],
              [
                44.377335564775564,
                -12.254829494190743
              ],
              [
                44.39244176594744,
                -12.277642475310643
              ],
              [
                44.39810659138689,
                -12.28334541188367
              ],
              [
                44.40458869607414,
                -12.275860388430385
              ],
              [
                44.44235419900383,
                -12.300013318766805
              ],
              [
                44.4931127855162,
                -12.345062595559995
              ],
              [
                44.48246978014511,
                -12.34724258476482
              ],
              [
                44.48246978014511,
                -12.364681844525578
              ],
              [
                44.53516982286972,
                -12.38312594922794
              ],
              [
                44.54615615099472,
                -12.328963651938503
              ],
              [
                44.56240267151398,
                -12.20500231531322
              ],
              [
                44.53974336975617,
                -12.178827126149779
              ],
              [
                44.50986612291689,
                -12.091877617636053
              ],
              [
                44.485490207389546,
                -12.062669651488353
              ],
              [
                44.450400298859655,
                -12.042530368595646
              ],
              [
                44.39066213967997,
                -12.071740529508805
              ],
              [
                44.373496001984655,
                -12.134850451637787
              ],
              [
                44.337790435578405,
                -12.160450307103437
              ],
              [
                44.22410006952882,
                -12.15188656860394
              ],
              [
                44.184961275583504,
                -12.164220682316332
              ],
              [
                44.197149233347176,
                -12.167576804704852
              ],
              [
                44.204444841867684,
                -12.175547425480426
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                45.03757112960229,
                -12.626090775472209
              ],
              [
                45.016285118860104,
                -12.62357811094676
              ],
              [
                44.99208086470971,
                -12.644516227491131
              ],
              [
                45.01010530928979,
                -12.669472219779344
              ],
              [
                45.05387896041284,
                -12.651216062400536
              ],
              [
                45.04752748946557,
                -12.63212106961759
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                46.45964661355934,
                -12.32157784418613
              ],
              [
                46.45054856058083,
                -12.328118343611097
              ],
              [
                46.44127884622536,
                -12.337677241544574
              ],
              [
                46.428919227084734,
                -12.352434153335853
              ],
              [
                46.43578568216286,
                -12.362830568753916
              ],
              [
                46.44591370340309,
                -12.365848805478324
              ],
              [
                46.455355079135515,
                -12.365848805478324
              ],
              [
                46.472864539584734,
                -12.349751140343505
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                46.456385047397234,
                -12.314198623406687
              ],
              [
                46.48968735452614,
                -12.31822367864954
              ],
              [
                46.50994339700661,
                -12.285853779466972
              ],
              [
                46.463079841098406,
                -12.277802615711543
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                47.70351453091799,
                -10.118734474066663
              ],
              [
                47.773380711337914,
                -10.116030601574497
              ],
              [
                47.77698560025393,
                -10.04876446170537
              ],
              [
                47.70557446744143,
                -10.043017457841731
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                46.47070188457929,
                -9.768643115754143
              ],
              [
                46.541769694637885,
                -9.763906253670994
              ],
              [
                46.55241270000898,
                -9.693352885253203
              ],
              [
                46.48666639263593,
                -9.691999197968842
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                46.244958527342654,
                -9.362600468405482
              ],
              [
                46.24358523632703,
                -9.382586096129732
              ],
              [
                46.50279391552625,
                -9.449648075277832
              ],
              [
                46.527856476561404,
                -9.443890739902903
              ],
              [
                46.531289704100466,
                -9.368697900517295
              ],
              [
                46.390869441313534,
                -9.357886654018097
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                46.23363469612714,
                -9.4723263312725
              ],
              [
                46.22917150032636,
                -9.501448274289746
              ],
              [
                46.261958823324406,
                -9.50805116129674
              ],
              [
                46.26487706673261,
                -9.477405917969836
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                50.71165643323697,
                -9.32507794343911
              ],
              [
                50.71208558667935,
                -9.33303931666807
              ],
              [
                50.71766458143033,
                -9.349723732317948
              ],
              [
                50.744443756235015,
                -9.342779047271694
              ],
              [
                50.73955140699185,
                -9.317370483535326
              ],
              [
                50.71217141736783,
                -9.321012491291235
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                51.01557669334019,
                -10.172921360856117
              ],
              [
                51.05265555076207,
                -10.215159243411277
              ],
              [
                51.07050833396519,
                -10.251986098728617
              ],
              [
                51.08836111716832,
                -10.250634730068873
              ],
              [
                51.09797415427769,
                -10.238810008505872
              ],
              [
                51.101407381816756,
                -10.226309109255142
              ],
              [
                51.11170706443394,
                -10.23306641323344
              ],
              [
                51.129903170390975,
                -10.223268275553675
              ],
              [
                51.14191946677769,
                -10.214821362582716
              ],
              [
                51.151875826640975,
                -10.21245618673018
              ],
              [
                51.15668234519566,
                -10.197588964483849
              ],
              [
                51.11136374168004,
                -10.203671093884072
              ],
              [
                51.167325350566756,
                -10.175962675350625
              ],
              [
                51.18346152000035,
                -10.150279554085666
              ],
              [
                51.145352694316756,
                -10.10127314840611
              ],
              [
                51.04029593162144,
                -10.133043671935397
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                52.80185682073075,
                -6.996809805421099
              ],
              [
                52.705726449637,
                -6.96784379746837
              ],
              [
                52.69821885367281,
                -7.059506527882589
              ],
              [
                52.70611527701266,
                -7.154216960447623
              ],
              [
                52.731864483555626,
                -7.159667325120352
              ],
              [
                52.746627361973594,
                -7.100391122599057
              ],
              [
                52.77512315054781,
                -7.067683736538138
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.30035654573423,
                -5.772078652575925
              ],
              [
                53.301558175372904,
                -5.775836042688255
              ],
              [
                53.3067080166815,
                -5.775152882703018
              ],
              [
                53.30636469392759,
                -5.77088311413417
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                52.69178327345392,
                -5.953770872489208
              ],
              [
                52.8277390840008,
                -6.34700139607899
              ],
              [
                53.22736676954767,
                -6.27875321290522
              ],
              [
                53.24796613478205,
                -5.878642172794373
              ],
              [
                53.25482451449747,
                -5.5903299808824904
              ],
              [
                53.0969041230633,
                -5.75841520595583
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.63972405482917,
                -5.6922589406145185
              ],
              [
                53.64238480617195,
                -5.707461266500242
              ],
              [
                53.66126755763679,
                -5.701739089967022
              ],
              [
                53.67045144130378,
                -5.697554178464409
              ],
              [
                53.685900965229564,
                -5.68739069503575
              ],
              [
                53.70143631984382,
                -5.6756896556542165
              ],
              [
                53.68821839381843,
                -5.669454698233348
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                53.30720903944298,
                -5.4332513443483865
              ],
              [
                53.33536150526329,
                -5.432909563984309
              ],
              [
                53.35699083875939,
                -5.425561239275976
              ],
              [
                53.36814882826134,
                -5.4207762355237845
              ],
              [
                53.322315240614856,
                -5.397021549006774
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.210666939191654,
                -3.717638233692893
              ],
              [
                55.20937947560395,
                -3.7200364315433716
              ],
              [
                55.21092442799653,
                -3.7232911195414613
              ],
              [
                55.213327687273875,
                -3.7171243320922356
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.66877153660771,
                -3.795924953390395
              ],
              [
                55.664050856192574,
                -3.7965672804065105
              ],
              [
                55.66018846776005,
                -3.7989224318837214
              ],
              [
                55.6600168063831,
                -3.8038040174246266
              ],
              [
                55.658815176744426,
                -3.8120255726546812
              ],
              [
                55.66139009739872,
                -3.817934766932993
              ],
              [
                55.668084891099895,
                -3.8165645226041076
              ],
              [
                55.671088965196574,
                -3.8116830094216483
              ],
              [
                55.67289140965458,
                -3.8084286519038124
              ],
              [
                55.67374971653935,
                -3.8044891500253337
              ],
              [
                55.67340639378544,
                -3.8009778396900873
              ],
              [
                55.672290594835246,
                -3.7972952305645626
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.64312993577388,
                -4.354694517053291
              ],
              [
                55.64862309983638,
                -4.3516135261936135
              ],
              [
                55.64089833787349,
                -4.348190188230165
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.660050636501005,
                -4.334208518921855
              ],
              [
                55.66238952276199,
                -4.337353769542509
              ],
              [
                55.66889119741409,
                -4.333823385293336
              ],
              [
                55.66663814184158,
                -4.3306353271695155
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.666691992990636,
                -4.301611100513004
              ],
              [
                55.678708289377354,
                -4.328999056865401
              ],
              [
                55.69072458576407,
                -4.326260305722466
              ],
              [
                55.71201059650626,
                -4.359124664009533
              ],
              [
                55.78136179279532,
                -4.390618325840266
              ],
              [
                55.82530801453865,
                -4.350907942829453
              ],
              [
                55.86058418476101,
                -4.369736300421399
              ],
              [
                55.90873580733793,
                -4.362719778609833
              ],
              [
                55.94727291298534,
                -4.344061577173539
              ],
              [
                55.86654849223383,
                -4.290699231399096
              ],
              [
                55.81706735920157,
                -4.313935803109915
              ],
              [
                55.75114939045157,
                -4.263266308588703
              ],
              [
                55.685918067209386,
                -4.275591629732688
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.66898822786148,
                -4.206977904255943
              ],
              [
                55.65682172776993,
                -4.20755570014019
              ],
              [
                55.65940062280913,
                -4.217635755050811
              ],
              [
                55.67688862558623,
                -4.217892549756221
              ],
              [
                55.67712465997954,
                -4.21207184893395
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.18918378062324,
                -4.525006112002212
              ],
              [
                55.28325421519355,
                -4.55888832609282
              ],
              [
                55.28771741099433,
                -4.451958954340111
              ],
              [
                55.189527103377145,
                -4.452985814233423
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.455037319292884,
                -4.579017315359618
              ],
              [
                55.46843212520337,
                -4.586657030600836
              ],
              [
                55.48096340572095,
                -4.6075323446688286
              ],
              [
                55.49203083706309,
                -4.652059088429053
              ],
              [
                55.50524876308848,
                -4.658389606607151
              ],
              [
                55.52965917426029,
                -4.666636467080723
              ],
              [
                55.54356374579349,
                -4.658595082585807
              ],
              [
                55.523525384424154,
                -4.637082744185579
              ],
              [
                55.519233850000326,
                -4.597386550660362
              ],
              [
                55.46378629825307,
                -4.549132887254035
              ],
              [
                55.44404616689486,
                -4.56350615276884
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.40394370393932,
                -4.654606881736762
              ],
              [
                55.39424519368318,
                -4.671031684869496
              ],
              [
                55.36965465160435,
                -4.6629903828397605
              ],
              [
                55.3780228360194,
                -4.69327333985834
              ],
              [
                55.433984444906116,
                -4.680955053909141
              ],
              [
                55.44205252962291,
                -4.670176375797151
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.457424236490894,
                -4.679586342074018
              ],
              [
                55.44575126285808,
                -4.688996181848227
              ],
              [
                55.470642162516285,
                -4.742715377449574
              ],
              [
                55.48025519962566,
                -4.740833565150735
              ],
              [
                55.48240105025933,
                -4.725008880905564
              ],
              [
                55.48797996158855,
                -4.710894954129992
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.4590590221943,
                -4.775132575467983
              ],
              [
                55.492962144142545,
                -4.786080683517018
              ],
              [
                55.49811198545114,
                -4.777869618879127
              ],
              [
                55.482490800148405,
                -4.752637086726823
              ],
              [
                55.459230683571256,
                -4.7578547371020425
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.50370723372284,
                -4.812801609576332
              ],
              [
                55.5452492869455,
                -4.8078409639443604
              ],
              [
                55.54130107527558,
                -4.788853331710609
              ],
              [
                55.52979976301972,
                -4.7878269581748185
              ],
              [
                55.53366214400116,
                -4.799202512070735
              ],
              [
                55.504651371296085,
                -4.790906074160919
              ],
              [
                55.49847156172577,
                -4.788682269561601
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.525721578714546,
                -4.7119223526496405
              ],
              [
                55.52638672978261,
                -4.703539225599299
              ],
              [
                55.52868272451027,
                -4.698663391095348
              ],
              [
                55.533349763044306,
                -4.684506082337838
              ],
              [
                55.51913418282717,
                -4.679245285923883
              ],
              [
                55.512181824925236,
                -4.735360294227143
              ],
              [
                55.51029354977875,
                -4.776417176015497
              ],
              [
                55.52848965573578,
                -4.790786504972009
              ],
              [
                55.52986294675141,
                -4.774877587179928
              ],
              [
                55.5211082165268,
                -4.762389683476179
              ],
              [
                55.52024990964203,
                -4.753322981137168
              ],
              [
                55.51973492551117,
                -4.747506543221497
              ],
              [
                55.523683137181095,
                -4.741861130112805
              ],
              [
                55.52677304196625,
                -4.735873520335364
              ],
              [
                55.528146332981876,
                -4.729543705062217
              ],
              [
                55.526429719212345,
                -4.72133196661392
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                55.94070296643315,
                -4.61506257813227
              ],
              [
                55.975550225954635,
                -4.574680697719454
              ],
              [
                55.92473845837651,
                -4.569718359978716
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                56.23470609447059,
                -7.20002195173387
              ],
              [
                56.24517743846473,
                -7.194401760594204
              ],
              [
                56.25015561839637,
                -7.186737751446522
              ],
              [
                56.25770871898231,
                -7.178051718148766
              ],
              [
                56.27968137523231,
                -7.145520199901992
              ],
              [
                56.29015271922645,
                -7.129877220087756
              ],
              [
                56.29530256053504,
                -7.104496754813049
              ],
              [
                56.29701917430457,
                -7.095468465938217
              ],
              [
                56.30165403148231,
                -7.088313847087497
              ],
              [
                56.286719491687386,
                -7.083544039459868
              ],
              [
                56.25908200999793,
                -7.119997742775561
              ],
              [
                56.24208753367957,
                -7.152531078575268
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                56.59425666924863,
                -10.367250038432584
              ],
              [
                56.599149018491794,
                -10.377803542939352
              ],
              [
                56.602324753965426,
                -10.384388749403044
              ],
              [
                56.6079037487164,
                -10.39224016045171
              ],
              [
                56.61344364714999,
                -10.404380878595553
              ],
              [
                56.618850980524016,
                -10.41062785398809
              ],
              [
                56.62451580596347,
                -10.41729678420743
              ],
              [
                56.63155392241855,
                -10.42683563885913
              ],
              [
                56.63352801317178,
                -10.429790093851283
              ],
              [
                56.63618877959628,
                -10.430887453305116
              ],
              [
                56.64707435124772,
                -10.438984603552885
              ],
              [
                56.657445538411594,
                -10.448431961874661
              ],
              [
                56.640708554158664,
                -10.431127945000114
              ],
              [
                56.63121511533664,
                -10.423628453894944
              ],
              [
                56.621258755473356,
                -10.411472569145063
              ],
              [
                56.61233236387179,
                -10.400413678998051
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                56.63885404661105,
                -10.418444011635303
              ],
              [
                56.64142896726535,
                -10.416333613878242
              ],
              [
                56.63790990903781,
                -10.410762095147744
              ],
              [
                56.63387586667941,
                -10.406203505780546
              ],
              [
                56.63181593015597,
                -10.404008605660888
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                56.65696609876908,
                -10.446028129736344
              ],
              [
                56.660399326308145,
                -10.451008170218506
              ],
              [
                56.66529167555131,
                -10.455397292247318
              ],
              [
                56.67121399305619,
                -10.459701947817265
              ],
              [
                56.67602051161088,
                -10.465441395699422
              ],
              [
                56.67842377088822,
                -10.474978772727388
              ],
              [
                56.681342014296426,
                -10.474725571819171
              ],
              [
                56.69301498792924,
                -10.4578450448925
              ],
              [
                56.68168533705033,
                -10.452865114031871
              ],
              [
                56.668124088271036,
                -10.443833510290423
              ],
              [
                56.663060071672184,
                -10.441934315199815
              ],
              [
                56.65954101942338,
                -10.443749101540735
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                56.678072268568656,
                -10.477265553348614
              ],
              [
                56.679617220961234,
                -10.483004676069841
              ],
              [
                56.67841559132256,
                -10.486296183755394
              ],
              [
                56.679617220961234,
                -10.489250071111206
              ],
              [
                56.686826998793265,
                -10.493554256495555
              ],
              [
                56.691290194594046,
                -10.49482018197677
              ],
              [
                56.694809252821585,
                -10.493976232231628
              ],
              [
                56.69961577137627,
                -10.49017842988596
              ],
              [
                56.704078967177054,
                -10.484270644705441
              ],
              [
                56.70622473438897,
                -10.477265553348614
              ],
              [
                56.70618181685344,
                -10.472412519647731
              ],
              [
                56.705795580946585,
                -10.470935515294137
              ],
              [
                56.70287733753838,
                -10.463845719229592
              ],
              [
                56.69592505177178,
                -10.458190646680686
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                57.31309297409219,
                -20.474757675502545
              ],
              [
                57.314809587861724,
                -20.479260482840335
              ],
              [
                57.33334901657266,
                -20.478295606678298
              ],
              [
                57.336782244111724,
                -20.485692835493918
              ],
              [
                57.345021990205474,
                -20.4799037302437
              ],
              [
                57.331289080049224,
                -20.46961144817966
              ],
              [
                57.31961610641641,
                -20.47411440652451
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                57.32407930221719,
                -20.380332202554676
              ],
              [
                57.30073335495157,
                -20.434712093771715
              ],
              [
                57.31309297409219,
                -20.440502902827188
              ],
              [
                57.32613923874063,
                -20.423129821496676
              ],
              [
                57.34708192672891,
                -20.386125057053448
              ],
              [
                57.342275408174224,
                -20.378723037686818
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    RCtoTRF = 
    /* color: #1bb154 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[45.073189372763345, -12.641816757163951],
           [45.03061644512276, -12.704790238145707],
           [45.04022966177205, -12.822656060410678],
           [45.02237646888026, -12.953850806424729],
           [45.099282412872824, -13.0261123446533],
           [45.20777474691597, -12.993998705479559],
           [45.209148063155624, -12.947158874228037],
           [45.22837454758383, -12.923066387289424],
           [45.24348105953236, -12.836046427772416],
           [45.28262067629399, -12.785996297994584],
           [45.26614083016702, -12.763730013415087],
           [45.1967881608094, -12.706129941477421],
           [45.10752236879109, -12.633776473358088]]],
         [[[55.44316226022716, -4.6560067816257265],
           [55.527962980442005, -4.681328369657116],
           [55.530709562473255, -4.667641138251842],
           [55.49431735055919, -4.654295830588358],
           [55.49019747751232, -4.648478565957279],
           [55.48058444040294, -4.608098585251912],
           [55.46959811227794, -4.587907733447742],
           [55.45792513864513, -4.582089924314073]]],
         [[[57.34732274077801, -20.321186397229415],
           [57.34938267730145, -20.383954784993914],
           [57.33530644439129, -20.415490284194323],
           [57.31711033843426, -20.437689975613402],
           [57.30646733306317, -20.461173116712434],
           [57.30646733306317, -20.46728457839002],
           [57.31608037017254, -20.474682338057747],
           [57.33290318511395, -20.470822681848425],
           [57.349726000055355, -20.486260724163873],
           [57.3686087515202, -20.489155184128293],
           [57.39847783111004, -20.510057994550003],
           [57.42079381011395, -20.51359511110877],
           [57.432810446352896, -20.512470196564095],
           [57.44894627593426, -20.50619922877649],
           [57.49065792992171, -20.52179786528858],
           [57.52138789575497, -20.52581350304676],
           [57.457872667535824, -20.49108479375075],
           [57.36139897368817, -20.454096383531194],
           [57.38749150298504, -20.381214211913445],
           [57.3917791348685, -20.250416429785062],
           [57.35376316534087, -20.25713966477227]]],
         [[[57.617420766960635, -19.97898078086932],
           [57.593875963482475, -19.986223715236807],
           [57.577396471294975, -19.99558017372633],
           [57.555423815044975, -19.997838545938574],
           [57.548214037212944, -20.002677805875933],
           [57.581859667095756, -20.025904181999344],
           [57.631298143658256, -20.028484678712353],
           [57.73429496983013, -20.115551570248186],
           [57.721935350689506, -20.091048742724038],
           [57.71163566807232, -20.03525828100439],
           [57.69069298008404, -20.00783951915069],
           [57.65189750889263, -19.985255774015737]]],
         [[[57.539628386597684, -20.01933145802638],
           [57.50907266150003, -20.03578208658018],
           [57.48710000525003, -20.097053572332136],
           [57.4912198782969, -20.12768033218439],
           [57.3538907767344, -20.218235921032488],
           [57.4205072883496, -20.225176414134246],
           [57.50426614294534, -20.16893637346761],
           [57.51269724933418, -20.13869287240998],
           [57.56556895343574, -20.02325522930491],
           [57.5521793660334, -20.01357782636538]]]]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
///////////////////////////////
// Global coral atlas project - North Caribbean and Bahamas
// Contact: mitchell.lyons@gmail.com
// Region coordinator: Eva Kovacs (kovacsevam2@gmail.com)
// Description:
// - Developing a process to combine OBIA and supervised classification
// - This script loads the raw classification data (from *_classification script)
// - Then applied some cleanup and object-based relational rules
///////////////////////////////

// Table of contents
// 1. Setting constants
// 2. Data loads & vis
// 3. OBIA clean up rules
// 4. Export

// Load and libraries needed
var map_palettes = require('users/mitchest/global_reefs:Modules/colour_pals')
var param_module = require('users/mitchest/global_reefs:Modules/reef_params')

// ###########################################
// SENSOR GENERICS
var sensor_params = param_module.dove         //<------------ THIS IS WHERE YOU CHOOSE THE SENSOR
// REGION AND SENSOR SPECIFIC LOAD PATHS
var region_params = param_module.wio          //<------------ THIS IS WHERE YOU CHOOSE THE REGION
//  ^^ all the data paths are in this module ^^
// ###########################################

// 1. Setting constants

// These will get written to the asset metadata 

var vars = {
  
  // analysis type
  geomorphic: false, // map geomorphic zonation (when set to true) or benthic habitat (when set to false)

  // analysis parameters
  image_data_scale: ee.Number(sensor_params.pixel),
  small_object_geo: ee.Number(400).int(), // smallest object szie in pixels (geomorphic)
  small_object_benthic: ee.Number(130).int(), // smallest object szie in pixels (benthic)
  smooth_radius: ee.Number(3), // radius in pixels for initial smooth 
  dist_to_land: 2000, //distance to land in METERS to disallow reef crest, and convert to terrestrial reef flat
  
  //############
  /* This is a stop-gap until we figure out how to chain together vectorisations in GEE
  - GEOMORPHIC: for large regions, the first pass does the small object filter, then the second pass does the OBIA clean
  -           : *in an ideal world* for smaller regions, can do both at once, but not handling that at present
              : 1st stage  - obia_2nd_pass + obia_clean set to false (no changes needed ML thinks); 
              : 2nd stage -  obia_2nd_pass + obia_clean set to true (object-based clean-up; review any OBIA rules); 
              : 3rd stage - manual_clean set to true (chop out all non-region-specific code, review final masks and any manual edits)
  - BENTHIC : can do both at once
            : One stage only - should have obia_2nd_pass and obia_clean set to true (so it uses the most recent geo map) */
  
  // CHANGE FOR EACH PASS
  obia_2nd_pass: true,
  obia_clean: true, // run object-based relationship rules + small object clean up
  fast_clean: true, // run a faster (but less precise) version of the OBIA clean; only applies to geomorphic (`obia_clean: true` also)
  smooth_output: false, // run smoother over final output (includes noise removal) (should be false for second pass)
  //############
  
  //CHANGE TO TRUE FOR MANUAL CLEAN
  // apply any manual touch ups
  manual_clean: false,
  
  // results/layers to show
  export_small_area: false,
  show_eg_area: false, // contrain the map add toe the corresponding example_area polygon geomtery (you can change that)
                              // - you can either set this, or have it false and just navigate to the area you want to see (keeping in mind ALL tiles in the zoom area will calcualte)
  reproject_display: true,
  //reproject_res: ee.Number(sensor_params.pixel).pow(2),
  
  
  //CHANGE DEPENDING ON WHETHER 1ST PASS, 2ND PASSS, MANUAL OR BENTHIC
  //CHANGE NAME OF INPUT LAYER AT circa LINE 140 DEPENDING ON PASS (// DEFINE THE MANUALLY EDITED MAP)
    // export options 
  do_export: true, // export the results?
  //geomorph_output_name: region_params.sname + '_geo-clean_manual2',
  benthic_output_name: region_params.sname + '_benthic-clean_July10',
  asset_output: region_params.asset // asset path
}

/*
############################
MANUAL ADDITION
############################
*/


//REEF BOUNDARY
//This can be hand drawn or imported from elsewhere, or could just be a big box

//reef_boundary = ee.FeatureCollection([ee.Feature(fl_cari_extent),ee.Feature(bahamas_extent)]).geometry()
Map.addLayer(reef_boundary, {}, "Manual reef outline", false)
Map.addLayer(region_extent, {}, "region_extent", false)


if (vars.manual_clean) {
  
  vars.obia_2nd_pass = false
  vars.obia_clean = false
  vars.fast_clean = false
  vars.smooth_output = false
  vars.do_export = false
  
  print("Doing manual clean ups - make sure this is what you want to do")
  print("Export the manual map, check 'manual' layer and ignore the 'final' map layer")
  
  //ADD DEPTH
  var depth = ee.Image(region_params.pixels).select('depth')
  var depth_cont = depth.lt(900)
  Map.addLayer(depth_cont, {}, "depth contour", false)
  
  //ADD WAVES
  Map.addLayer(waves.lt(0.4), {}, "0.4m Hs95 threshold", false)
  
  //DEFINE AREAS OF NO REEF and/or SPLITS

  var no_reef = ee.Image().byte().paint(ee.Feature(not_reef, {zone: 1}), "zone").clip(not_reef); //import CR not_reef layer
  var wio_extent = ee.Image().byte().paint(ee.Feature(region_extent, {zone: 1}), "zone").clip(region_extent)
  var notReefSlope = ee.Image().byte().paint(ee.Feature(notRS, {zone: 1}), "zone").clip(notRS)
  var notBackReefSlope = ee.Image().byte().paint(ee.Feature(notBRS, {zone: 1}), "zone").clip(notBRS)
  var notShelteredReefSlope = ee.Image().byte().paint(ee.Feature(notSRS, {zone: 1}), "zone").clip(notSRS)
  var CresttoIRF = ee.Image().byte().paint(ee.Feature(notRC, {zone: 1}), "zone").clip(notRC)
  var notShallowLagoon = ee.Image().byte().paint(ee.Feature(notSL, {zone: 1}), "zone").clip(notSL)
  var notTRFlat = ee.Image().byte().paint(ee.Feature(notTRF, {zone: 1}), "zone").clip(notTRF)
  var notIRFlat = ee.Image().byte().paint(ee.Feature(notIRF, {zone: 1}), "zone").clip(notIRF)
  var DeepWater = ee.Image().byte().paint(ee.Feature(Deep, {zone: 1}), "zone").clip(Deep)
  var CrestToORF = ee.Image().byte().paint(ee.Feature(RCtoORF, {zone: 1}), "zone").clip(RCtoORF)
  var CrestToDL = ee.Image().byte().paint(ee.Feature(RCtoDL, {zone: 1}), "zone").clip(RCtoDL)
  
  var SRStoReefSlope = ee.Image().byte().paint(ee.Feature(SRStoRS, {zone: 1}), "zone").clip(SRStoRS)
  var SStoBackReefSlope = ee.Image().byte().paint(ee.Feature(SStoBRS, {zone: 1}), "zone").clip(SStoBRS)
  var SStoShallowLagoon = ee.Image().byte().paint(ee.Feature(SStoSL, {zone: 1}), "zone").clip(SStoSL)
  var SLtoPatchReef = ee.Image().byte().paint(ee.Feature(SLtoPR, {zone: 1}), "zone").clip(SLtoPR)
  var SLtoInnerRF = ee.Image().byte().paint(ee.Feature(SLtoIRF, {zone: 1}), "zone").clip(SLtoIRF)
  var TRFtoReefCrest = ee.Image().byte().paint(ee.Feature(TRFtoRC, {zone: 1}), "zone").clip(TRFtoRC)
  var TRFtoOuterRF = ee.Image().byte().paint(ee.Feature(TRFtoORF, {zone: 1}), "zone").clip(TRFtoORF)
  var SLSStoBRS = ee.Image().byte().paint(ee.Feature(toBRS, {zone: 1}), "zone").clip(toBRS)
  
  var DeepMore = ee.Image().byte().paint(ee.Feature(MoreDeep, {zone: 1}), "zone").clip(MoreDeep)
  var RCtoInnerRF = ee.Image().byte().paint(ee.Feature(RCtoIRF, {zone: 1}), "zone").clip(RCtoIRF)
  var RCtoOuterRF2 = ee.Image().byte().paint(ee.Feature(RCtoORF2, {zone: 1}), "zone").clip(RCtoORF2)
  var SSBRStoShallowLagoon = ee.Image().byte().paint(ee.Feature(SSBRStoSL, {zone: 1}), "zone").clip(SSBRStoSL)
  
  var RCtoInnerRF2 = ee.Image().byte().paint(ee.Feature(RCtoIRF2, {zone: 1}), "zone").clip(RCtoIRF2)
  var RCtoOuterRF3 = ee.Image().byte().paint(ee.Feature(RCtoORF3, {zone: 1}), "zone").clip(RCtoORF3)
  var RCtoTerrRF = ee.Image().byte().paint(ee.Feature(RCtoTRF, {zone: 1}), "zone").clip(RCtoTRF)
  
  // Benthic 
  var MayNotRubble = ee.Image().byte().paint(ee.Feature(MayotteNotRB, {zone: 1}), "zone").clip(MayotteNotRB)
  var BMAtoCA = ee.Image().byte().paint(ee.Feature(BMAtoCoral, {zone: 1}), "zone").clip(BMAtoCoral)
  var SGtoRubble = ee.Image().byte().paint(ee.Feature(SGtoRB, {zone: 1}), "zone").clip(SGtoRB)
  var SGtoRock = ee.Image().byte().paint(ee.Feature(SGtoRK, {zone: 1}), "zone").clip(SGtoRK)
  var SGtoSand = ee.Image().byte().paint(ee.Feature(DL_SGtoSD, {zone: 1}), "zone").clip(DL_SGtoSD)
  

  // DEFINE THE MANUALLY EDITED MAP
  // 1st pass output for 2nd pass run
  //var man_geo = ee.Image(region_params.geo_map_clean)
  // 2nd pass output for manual run
  var man_geo = ee.Image(region_params.geo_map_clean_p2)
  
   // "NOT REEF" CLEAN
  // remove
 man_geo = man_geo.where({
   test: no_reef.eq(1),
  value: ee.Image(0)
 })
  
  
  // WAVE clean ############# ---> (to be integrated into RF classifier when DATA IS AVAILABLE)
  // remove
 man_geo = man_geo.where({
    test: waves.lte(0.4)
               .and(man_geo.eq(22)), //Reef Slope
    value: ee.Image(21) //Sheltered Slope
  })
  
  //WIO clean

 /* // Deep -> deep lagoon
  man_geo = man_geo.where({
    test: wio_extent.eq(1)
                     .and(man_geo.eq(2).or(man_geo.eq(23))),
    value: ee.Image(12)
  })*/
  
  // Deep water anomalies
  man_geo = man_geo.where({
    test: DeepMore.eq(1), 
    value: ee.Image(2)
  })
 
   man_geo = man_geo.where({
    test: DeepWater.eq(1), 
    value: ee.Image(2)
  })
  
    // Reef crest -> Inner reef flat
  man_geo = man_geo.where({
    test: CresttoIRF.eq(1)
                     .and(man_geo.eq(15)), // RC
    value: ee.Image(13) //IRF
  })
  
     // Reef crest -> Outer reef flat
  man_geo = man_geo.where({
    test: CrestToORF.eq(1)
                     .and(man_geo.eq(15)), //RC
    value: ee.Image(14) //ORF
  })
 
  // Reef crest -> Outer reef flat2
  man_geo = man_geo.where({
    test: RCtoOuterRF2.eq(1)
                     .and(man_geo.eq(15)), //RC
    value: ee.Image(14) //ORF
  })
 
  // Reef crest -> Outer reef flat3
  man_geo = man_geo.where({
    test: RCtoOuterRF3.eq(1)
                     .and(man_geo.eq(15)), //RC
    value: ee.Image(14) //ORF
  })
   
  // RC to IRF
  man_geo = man_geo.where({
    test: RCtoInnerRF.eq(1)
                     .and(man_geo.eq(15)), //RC
    value: ee.Image(13) //ORF
  })
  
   // RC to IRF2
  man_geo = man_geo.where({
    test: RCtoInnerRF2.eq(1)
                     .and(man_geo.eq(15)), //RC
    value: ee.Image(13) //ORF
  })
  
   // Reef crest -> Terrestrial reef flat
  man_geo = man_geo.where({
    test: RCtoTerrRF.eq(1)
                     .and(man_geo.eq(15)), //RC
    value: ee.Image(16) //TRF
  })
  
     // Reef crest -> Deep Lagoon
  man_geo = man_geo.where({
    test: CrestToDL.eq(1)
                     .and(man_geo.eq(15)), //RC
    value: ee.Image(12) //DL
  })
  
  //Reef Slope to Back Reef Slope
   man_geo = man_geo.where({
    test: notReefSlope.eq(1)
                     .and(man_geo.eq(22)), //RS
    value: ee.Image(24) //BRS
  })
  
  // Shallow Lagoon to Inner Reef Flat
   man_geo = man_geo.where({
    test: notShallowLagoon.eq(1)
                     .and(man_geo.eq(11)), //SL
    value: ee.Image(13) //IRF
  })
  
  // Sheltered Reef Slope to Back Reef Slope
   man_geo = man_geo.where({
    test: notShelteredReefSlope.eq(1)
                     .and(man_geo.eq(21)), //SRS
    value: ee.Image(24) //BRS
  })
  
  // Terrestrial Reef Flat to Inner Reef Flat
   man_geo = man_geo.where({
    test: notTRFlat.eq(1)
                     .and(man_geo.eq(16)), //TRF
    value: ee.Image(13) //IRF
  })
  
  //Inner Reef Flat to Outer Reef Flat
   man_geo = man_geo.where({
    test: notIRFlat.eq(1)
                     .and(man_geo.eq(13)), //IRF
    value: ee.Image(14) //ORF
  })
  
  //BRS to RS
   man_geo = man_geo.where({
    test: notBackReefSlope.eq(1)
                     .and(man_geo.eq(24)), //brs
    value: ee.Image(22) //rs
  })
  
  //SRS to RS
   man_geo = man_geo.where({
    test: SRStoReefSlope.eq(1)
                     .and(man_geo.eq(21)), //ss
    value: ee.Image(22) //rs
  })
  
  //SRS to BRS
   man_geo = man_geo.where({
    test: SStoBackReefSlope.eq(1)
                     .and(man_geo.eq(21)), //ss
    value: ee.Image(24) //brs
  })
  
  //SRS to SL
   man_geo = man_geo.where({
    test: SStoShallowLagoon.eq(1)
                     .and(man_geo.eq(21)), //srs
    value: ee.Image(11) //sl
  })
  
    //SRS and BRS to SL
   man_geo = man_geo.where({
    test: SSBRStoShallowLagoon.eq(1)
                     .and(man_geo.eq(21).or(man_geo.eq(24))), //srs or BRS
    value: ee.Image(11) //sl
  })
  
  //SL to PR
   man_geo = man_geo.where({
    test: SLtoPatchReef.eq(1)
                     .and(man_geo.eq(11)), //sl
    value: ee.Image(25) //pr
  })
  
  //SL&SS to BRS
   man_geo = man_geo.where({
    test: SLSStoBRS.eq(1)
                     .and(man_geo.eq(11).or(man_geo.eq(21))), //SL and SS
    value: ee.Image(24) //brs
  })
  
  // SL to IRF
   man_geo = man_geo.where({
    test: SLtoInnerRF.eq(1)
                     .and(man_geo.eq(11)), //SL
    value: ee.Image(13) //IRF
  })
  
  //TRF to RC
   man_geo = man_geo.where({
    test: TRFtoReefCrest.eq(1)
                     .and(man_geo.eq(16)), //TRF
    value: ee.Image(15) //rc
  })
  /*
  //TRF to ORF
   man_geo = man_geo.where({
    test: TRFtoOuterRF.eq(1)
                     .and(man_geo.eq(16)), //TRF
    value: ee.Image(14) //ORF
  })
  */
  // Add the manual layer to the map
  var image = ee.Image(region_params.image);
  Map.addLayer(image, {bands: ['b3','b2','b1'], min:200, max:1200}, 'Dove low tide', true);
  
  var geo_clean_p1 = ee.Image(region_params.geo_map_clean);
  Map.addLayer(geo_clean_p1, map_palettes.geo, 'Geo Clean Pass 1', false);
  
  var geo_clean_p2 = ee.Image(region_params.geo_map_clean_p2);
  Map.addLayer(geo_clean_p2, map_palettes.geo, 'Geo Clean Pass 2', false);
  
  var man_geo = ee.Image(region_params.geo_map_clean_man);
  Map.addLayer(man_geo, map_palettes.geo, 'Manually cleaned GEO', false);
  
  var output_name = (vars.manual_clean) ? vars.geomorph_output_name + "_man" : output_name;
  
  // Export
  Export.image.toAsset({
    image: man_geo,
    description: vars.geomorph_output_name,
    assetId: vars.asset_output + 'in_out/' + vars.geomorph_output_name,
    region: reef_boundary,
    scale: vars.image_data_scale,
    crs: 'EPSG:4326',
    maxPixels: 1e13,
    pyramidingPolicy: {'.default': 'mode'}
  });
}
/*
############################
*/
/* TRIAL #######
    Looks like with the sentinel/ls8 depth we can try to retain full resolution,
    because theres more (good) data either side of the depth threshold/marginal areas
  ##############
  
  Used to be --> output resolution (bigger for geomorphic) - relates back to object size and the min mapping unit defined in classification stage
*/
//if (vars.geomorphic) vars.image_data_scale = ee.Number(sensor_params.pixel)//.pow(2)

// 2. Data loads & vis

// load input data
if (vars.obia_2nd_pass) {
  // if it's 2nd pass, you want to make sure you're loading the latest geo clean map
  // - could change the path in reef_params to a list, check if it length is > 1, then take last element??
  
  // OR run a separate operation that joins the east/west clean1 maps via EPSG:3832, load via one ee.Image(), then save here as EPSG:4326
  //var geo_map = geo1.unmask(0, false).add(geo2.unmask(0,false)).selfMask().clip(swp_extent)
  
  var geo_map = ee.Image(region_params.geo_map_clean)
} else {
  //print(ee.List(region_params.geo_map).length())
  if (ee.List(region_params.geo_map).length().getInfo() > 1) {
    var geo_map = ee.Image(region_params.geo_map[0]).unmask(0, false)
             .add(ee.Image(region_params.geo_map[1]).unmask(0,false))
             .selfMask()
  } else {
    var geo_map = ee.Image(region_params.geo_map)
  }
}

//var benthic_map = (vars.obia_2nd_pass) ? ee.Image(region_params.benthic_map_clean) : ee.ImageCollection(region_params.benthic_map).mosaic()
//var benthic_map = ee.Image(region_params.benthic_map)

if (ee.List(region_params.benthic_map).length().getInfo() > 1) {
    var benthic_map = ee.Image(region_params.benthic_map[0]).unmask(0, false)
             .add(ee.Image(region_params.benthic_map[1]).unmask(0,false))
             .selfMask()
} else {
    var benthic_map = ee.Image(region_params.benthic_map)
}


var depth = ee.Image(region_params.pixels).select('depth')
var image = ee.Image(region_params.image)

var display_pal = (vars.geomorphic) ? map_palettes.geo : map_palettes.benthic
//Map.centerObject(eg_area, 11)
Map.addLayer(depth, {min:0, max:2500}, 'Depth data', false)
Map.addLayer(image, {bands: ['b3','b2','b1'], min:200, max:1200}, 'Dove low tide', false)

if (vars.geomorphic) {
  if (vars.obia_2nd_pass) {
    if (ee.List(region_params.geo_map).length().getInfo() > 1) {
      var geo_map_display = ee.Image(region_params.geo_map[0]).unmask(0, false)
                       .add(ee.Image(region_params.geo_map[1]).unmask(0,false))
                       .selfMask()
    } else {
    var geo_map_display = ee.Image(region_params.geo_map)
    }
    Map.addLayer(geo_map_display, display_pal, 'Raw GEO classification', false)
  } else {
    Map.addLayer(geo_map, display_pal, 'Raw GEO classification', false)
  }
}
if (!vars.geomorphic) {
  Map.addLayer(geo_map, map_palettes.geo, 'Clean GEO classification', false)
  Map.addLayer(benthic_map, display_pal, 'Raw BENTHIC classification', false)
}

// 3. Object-based re-classificaiton and cleaning

/*

// if we want to retain the land/waves flags, need to add them in before makign the mask

######## Not that straight forwards - the land and bright masks are a LOT of not land and not breakign waves... =(

// add in land, for geomorphic clean up rules
  geo_map = geo_map.unmask(0).where({
    test: depth.eq(-2).and(globcover.select('landcover').neq(210)),
    value: ee.Image(1)
  })
  
  // change -3 to reef rim, hope that clouds have been handleded by masking
  geo_map = geo_map.unmask(0).where({
    test: depth.eq(-3),
    value: ee.Image(15)
  })
  
  // remask
  geo_map = geo_map.updateMask(geo_map.gt(0))

*/

/* OUTPUT EXTENT
  - to the mapping extent just so it doesn't balloon out
  - to the 'reef boundary' extent for noise/deep removal
*/  
var class_extent_mask = geo_map.gt(0)


/*

########
Initial small object clean
 - this was originally at the end, but we needed to massively reduce the number of objects to 
   iterate through in the OBIA cleaning, so this happens first now
 - future collabs with google might fix this, but need to change the parallel serialisation of vector procesing
 
 - includes a possible special case for:
      - geomorphic to clean up turbid areas over size threshold; fix shallow vs. deep lagoon
      - benthic to allow breaking waves (temporal class) to grow into surrounding class
########

*/

if (vars.geomorphic && !vars.obia_2nd_pass) {
  
  // make a smooth map with masked area as a value
  var smooth_map = geo_map
                      //.unmask(99)
                      .focal_mode({
                        radius: vars.smooth_radius, // relates to smoothness required
                        kernelType: 'circle', units: 'pixels', iterations: 2
                      })
  //smooth_map = smooth_map.updateMask(smooth_map.neq(99)).updateMask(class_extent_mask)
  
  //replace small objects with smooth underneath
  var clean_map = geo_map.where({
    test: geo_map.connectedPixelCount(vars.small_object_geo, false).lt(vars.small_object_geo), 
    value: smooth_map
  //}).updateMask(smooth_map.neq(99)).updateMask(class_extent_mask)
  }).updateMask(class_extent_mask)
  
  
  // shallow lagoon > 5m == deep lagoon
  clean_map = clean_map.where({
    test: clean_map.eq(11)
                   .and(depth.gt(500)),
    value: ee.Image(12)
  })
  
  /*// deep lagoon == deep (to hard to differentiate deep water vs. deep lagoon effectively over large areas)
  clean_map = clean_map.where({
    test: clean_map.eq(12),
    value: ee.Image(2)
  })*/
  
  // DEEP WATER in depth data == deep (s2 + ls8 data should be good enough for this)
  clean_map = clean_map.where({
    test: depth.gt(1000), // set at 20m (2000) but may need changing based on depth data
    // if you change this value, change the value in the benthic rules to be the same
    value: ee.Image(2)
  })
  
  
  // LAND mask cleaning
  Map.addLayer(land_dist.lte(vars.dist_to_land), {}, "Land mask", false)
  
  /*
  // reef crest close to land -> TRF
  clean_map = clean_map.where({
    test: land_dist.lte(vars.dist_to_land)
                   .and(clean_map.eq(15)),
    value: ee.Image(16)
  })
  */
  
  // TRF far from land -> ORF
  clean_map = clean_map.where({
    test: land_dist.gt(vars.dist_to_land)
                   .and(clean_map.eq(16)),
    value: ee.Image(14)
  })
  
  
  
  /*//CLEAN UP SMALL (but slightly larger) TURBID AREAS
  var smooth_noturbid = clean_map
                          .updateMask(clean_map.neq(3))
                          .focal_mode({
                            radius: vars.smooth_radius.multiply(1.5),
                            kernelType: 'circle', units: 'pixels', iterations: 2
                          })
  
  clean_map = clean_map.where({
    test: clean_map.eq(3).connectedPixelCount(vars.small_object_geo.multiply(10), false).lt(vars.small_object_geo.multiply(10)), 
    value: smooth_noturbid
  }).updateMask(class_extent_mask)*/
}


if (!vars.geomorphic) {
  
  // make a smooth map with masked area as a value, and without temporal class (basically breaking waves)
  var smooth_map = benthic_map
                      //.unmask(99)
                      .focal_mode({
                        radius: vars.smooth_radius, // relates to smoothness required
                        kernelType: 'circle', units: 'pixels', iterations: 1
                      })
  //smooth_map = smooth_map.updateMask(smooth_map.neq(99)).updateMask(class_extent_mask)
  
  //replace small objects with smooth underneath
  var clean_map = benthic_map.where({
    test: benthic_map.connectedPixelCount(vars.small_object_benthic, false).lt(vars.small_object_benthic),
    value: smooth_map
  //}).updateMask(smooth_map.neq(99)).updateMask(class_extent_mask)
  }).updateMask(class_extent_mask)
  
  
  /*// CLEAN UP ALL TEMPORAL AREAS
  var smooth_notemp = benthic_map
                          .updateMask(benthic_map.neq(2))
                          .focal_mode({
                            radius: vars.smooth_radius.multiply(2),
                            kernelType: 'circle', units: 'pixels', iterations: 3
                          })
  
  
  clean_map = clean_map1.where({
    test: benthic_map.eq(2), 
    value: smooth_notemp
  }).updateMask(clean_map1.gte(0))
  
  // this catches any left over unmasked temporal, and assigned it back to temporal
  clean_map = clean_map.where({
    test: clean_map.unmask(99).eq(99).and(clean_map1.eq(2)),
    value: ee.Image(2)
  })*/
  
}



if (vars.geomorphic && vars.obia_2nd_pass) {
  var clean_map = geo_map
}

Map.addLayer(clean_map, display_pal, 'Clean map - init smooth/loaded', false)

if (vars.obia_clean) {
  
  if (vars.geomorphic && !vars.fast_clean) { // SHOULD TRY TO PUT THIS OUT TO A MODULE TO KEEP THE RULES THE SAME EVERYWEHRE?
    
    // #########
    // THE PLAN - vectorise one/few class/es at a time, thus only spending resources on what is actually needed to clean up
    // #########
    
    // FUNCTION that maps over feature colleciton and assigns neighbour percentages
    var set_neighbour_properties = function(f) {
      // make the 1px buffer
      var diff = f.buffer(vars.image_data_scale).difference(f, ee.ErrorMargin(0.5))
      // reduce the classes in the buffer zone
      var diff_classes = ee.Dictionary(
        clean_map.unmask(ee.Image(0)).reduceRegion({
          reducer: ee.Reducer.frequencyHistogram(),
          geometry: diff.geometry(),
          scale: vars.image_data_scale,
          maxPixels: 1e11
        }).get('classification')
      )
      // calculate the percentages
      var diff_sum = diff_classes.toArray().reduce(ee.Reducer.sum(), [0]).get([0])
      var diff_percs = diff_classes.map(function(k,v){return(ee.Number(v).divide(diff_sum).multiply(100).toUint8())})
      
      /* NOW, we can try to do the class logic right here (see /users/mitchest/global_reefs/obia_dev),
         or we can return the neighbour % and do image logic via (painted) rasters */
      
      return(f.set(diff_percs))
    }
    
    // FUNCTION to reduce the map to vectors and map the neighbour properties function
    var reduce_neighbours = function() {
      // reduce map to vectors
      var map_fc = clean_map
            .updateMask(segment_id).updateMask(clean_map.eq(classn)) // only vectorise class/es of interest
            .reduceToVectors({
              scale: vars.image_data_scale, 
              eightConnected: false,
              bestEffort: true, 
              maxPixels: 1e13,
              tileScale: 1,
              geometry: reef_boundary
            })
      // map the function, calculate neighbour properties
      return(map_fc.map(set_neighbour_properties))
    }
    
    // first make a make size threshold, so we're not vecortising huge objects when we don't have to
    var segment_id = clean_map.connectedComponents(ee.Kernel.plus(1),vars.small_object_geo.sqrt()).select('labels')
    //Map.addLayer(segment_id.reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))))
    Map.addLayer(clean_map.updateMask(segment_id).reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))), display_pal, 'Map objects to be iterated through (OBIA)', false)
    
    // This is where we select the single or group of classes to vectorise for cleaning up
    //var classn = ee.Number(15) // one class
    var classn = clean_map.where({
      test: clean_map.neq(16) //TRF
              .and(clean_map.neq(15)) //RR
              .and(clean_map.neq(14)) //ORF
              .and(clean_map.neq(13)) //IRF
              //.and(clean_map.neq(12)) // deep L
              .and(clean_map.neq(11)), // shallow L 
      value: ee.Image(99) // 99 ensures it's ignored in logic
    })
    
    // Minimum size of object to reclass based on neighbourhood
    var max_size = ee.Number(1000).divide(vars.image_data_scale).pow(2) // the first number is the square dimension of the desired min size
    // calculate neighbours
    var map_fc_neighbours = reduce_neighbours()
    
    // #########
    // REEF RIM
    // #########
    
    var focus_class = ee.Number(15) //RR
    
    // start the object-based neighbourhood rules
    // paint out to rasters (only paint the layers needed)
    var objsize = ee.Image(30000).paint(map_fc_neighbours, 'count').rename('count')
    //var nb24 = ee.Image().byte().paint(map_fc_neighbours, '24').unmask(0).rename('nb24') //OCL
    var nb22 = ee.Image().byte().paint(map_fc_neighbours, '22').unmask(0).rename('nb22') //SL ex
    var nb21 = ee.Image().byte().paint(map_fc_neighbours, '21').unmask(0).rename('nb21') //Sl sh
    var nb16 = ee.Image().byte().paint(map_fc_neighbours, '16').unmask(0).rename('nb16') //TRF
    var nb15 = ee.Image().byte().paint(map_fc_neighbours, '15').unmask(0).rename('nb15') //RR
    var nb14 = ee.Image().byte().paint(map_fc_neighbours, '14').unmask(0).rename('nb14') //ORF
    var nb13 = ee.Image().byte().paint(map_fc_neighbours, '13').unmask(0).rename('nb13') //IRF
    //var nb3 = ee.Image().byte().paint(map_fc_neighbours, '3').unmask(0).rename('nb3') //Turbid
    
    // RR surrounded by ORF --> ORF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb14.gt(75)),
      value: ee.Image(14)
    })
    
    // RR surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.gt(75)),
      value: ee.Image(13)
    })
    
    // RR surrounded by IRF + ORF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.add(nb14).gt(75)),
      value: ee.Image(13)
    })
    
    // RR with decent border to TRF --> TRF (often dark, probably seagrass)
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb16.gt(40)),
      value: ee.Image(16)
    })
    
    /*// RR surrounded by OCL --> OCL
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb24.gt(75)),
      value: ee.Image(24)
    })*/
    
    /* with 2nd/3rd pass method, we don't really need this
    // RR surrounded by IRF + ORF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.lte(75).and(nb14.lte(75))) // to ensure we're no re-writing previous rules
              .and(nb13.add(nb14).gt(75))
              .and(nb21.add(nb22).lte(0)), // to not get rid of complex reef rims (if touching slope, it's probably RR)
      value: ee.Image(13) // could try assigning to a place-holder, then deal with at the end?
    })*/
    
    /*// small RR objects touching OCL + stuff --> ORF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(objsize.lte(max_size))
              .and(nb13.lte(75).and(nb14.lte(75))) // to ensure we're no re-writing previous rules
              .and(nb24.gt(1)),
      value: ee.Image(14)
    })*/
    
    // ####
    // ORF
    // ####
    
    focus_class = ee.Number(14) // ORF
    
    //classn = ee.Number(14)
    //map_fc_neighbours = reduce_neighbours()
    //var nb22 = ee.Image().byte().paint(map_fc_neighbours, '22').unmask(0).rename('nb22') //SL ex
    //var nb21 = ee.Image().byte().paint(map_fc_neighbours, '21').unmask(0).rename('nb21') //Sl sh
    //nb15 = ee.Image().byte().paint(map_fc_neighbours, '15').unmask(0).rename('nb15') //RR
    //nb13 = ee.Image().byte().paint(map_fc_neighbours, '13').unmask(0).rename('nb13') //IRF
    //var nb1 = ee.Image().byte().paint(map_fc_neighbours, '1').unmask(0).rename('nb1') //Land
    
    // ORF surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.gt(75)),
      value: ee.Image(13)
    })
    
    // ORF surrounded by TRF --> TRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb16.gt(75)),
      value: ee.Image(16)
    })
    
    // ORF surrounded by RR --> RR
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb15.gt(85)),
      value: ee.Image(15)
    })
    
    // ORF touching slope and RR --> RR
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb21.gt(0).or(nb22.gt(0)))
              .and(nb15.gt(0)),
      value: ee.Image(15)
    })
    
    /*// ORF touching land --> TRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb1.gt(10)),
      value: ee.Image(16)
    })*/
    
    // ####
    // IRF
    // ####
    
    focus_class = ee.Number(13) // IRF
    
    //classn = ee.Number(13)
    //map_fc_neighbours = reduce_neighbours()
    //nb15 = ee.Image().byte().paint(map_fc_neighbours, '15').unmask(0).rename('nb15') //RR
    //nb14 = ee.Image().byte().paint(map_fc_neighbours, '14').unmask(0).rename('nb14') //ORF
    
    // IRF surrounded by ORF --> ORF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb14.gt(75)),
      value: ee.Image(14)
    })
    
    // IRF surrounded by TRF --> TRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb16.gt(75)),
      value: ee.Image(16)
    })
    
    // IRF surrounded by RR --> RR
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb15.gt(85)),
      value: ee.Image(15)
    })
    
    /*// IRF touching land --> TRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb1.gt(10)),
      value: ee.Image(16)
    })*/
    
    // ####
    // TRF
    // ####
    
    focus_class = ee.Number(16) // TRF
    
    //classn = ee.Number(16)
    //map_fc_neighbours = reduce_neighbours()
    //nb15 = ee.Image().byte().paint(map_fc_neighbours, '15').unmask(0).rename('nb15') //RR
    //nb14 = ee.Image().byte().paint(map_fc_neighbours, '14').unmask(0).rename('nb14') //ORF
    //nb13 = ee.Image().byte().paint(map_fc_neighbours, '13').unmask(0).rename('nb13') //IRF
    
    // TRF surrounded by ORF --> ORF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb14.gt(75)),
      value: ee.Image(14)
    })
    
    // TRF surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.gt(75)),
      value: ee.Image(13)
    })
    
    // TRF surrounded by IRF + ORF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.add(nb14).gt(75)),
      value: ee.Image(13)
    })
    
    /*// TRF not touching land --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb1.lt(10)),
      value: ee.Image(13)
    })*/
    
    
    // ####
    // LAGOONS
    // ####
    
    var nb11 = ee.Image().byte().paint(map_fc_neighbours, '11').unmask(0).rename('nb11') // shallow lag
    //var nb12 = ee.Image().byte().paint(map_fc_neighbours, '12').unmask(0).rename('nb12') //deep lag
    
    // DL touching SL --> SL
    /* 
    This is a stop-gap until we have better depth product - below are the rules we want,
    but too much band-aiding is required to make it work, so for the moment just err on the side
    of shallow lagoon when it's mixed.
    */
    /*clean_map = clean_map.where({
      test: clean_map.eq(12)
              .and(nb11.gt(0)),
      value: ee.Image(11)
    })*/
    
    /*// SL sourrounded by DL --> DL
    clean_map = clean_map.where({
      test: clean_map.eq(11)
              .and(nb12.gt(75)),
      value: ee.Image(12)
    })*/
    
    /*// DL sourrounded by SL --> SL
    clean_map = clean_map.where({
      test: clean_map.eq(12)
              .and(nb11.gt(75)),
      value: ee.Image(11)
    })*/
    
    /*// DL/SL surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(11).or(clean_map.eq(12))
              .and(objsize.lte(max_size))
              .and(nb13.gt(80)),
      value: ee.Image(13)
    })*/
    
    // SL surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(11)
              .and(objsize.lte(max_size))
              .and(nb13.gt(80)),
      value: ee.Image(13)
    });
    
    /*// DL/SL touching OCL --> OCL
    clean_map = clean_map.where({
      test: clean_map.eq(11).or(clean_map.eq(12))
              .and(nb24.gt(0)),
      value: ee.Image(24)
    })*/
    
    
    /*// ####
    // Turbid
    // ####
    
    focus_class = ee.Number(3) // turbid
    
    // Turb surrounded by IRF --> IRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb13.gt(75)),
      value: ee.Image(13)
    })
    
    // Turb surrounded by ORF --> ORF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb14.gt(75)),
      value: ee.Image(14)
    })
    
    // Turb surrounded by TRF --> TRF
    clean_map = clean_map.where({
      test: clean_map.eq(focus_class)
              .and(nb16.gt(75)),
      value: ee.Image(16)
    })*/
  
  } else if (vars.geomorphic && vars.fast_clean) {
    print("Executing the fast version OBIA");
    
    /* fast version of the geo clean up
      - blanket version assigns the underlying most common in neighbourhood
      - mode OBIA version iterates through objects+buffers but take the mode instead of doing the class percs, to see if that speeds things up
    */
    
    
    //############
    //# blanket version
    //############
    // make a very smooth map to capture the broader neighbourhood
    var smooth_map = clean_map
                        .focal_mode({
                          radius: vars.smooth_radius.multiply(3), // relates to smoothness required
                          kernelType: 'circle', units: 'pixels', iterations: 2
                        })
    
    
    // first make a make size threshold, so we're not vectorising huge objects when we don't have t
    // - the unmask(99) captures small no data values/ data gaps
    var segment_id = clean_map.unmask(0).connectedComponents(ee.Kernel.plus(1),vars.small_object_geo.sqrt().multiply(2)).select('labels').pow(2).log().int()
    Map.addLayer(clean_map.unmask(0).updateMask(segment_id.gt(0)).reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))), display_pal, 'Map objects to be iterated through (OBIA)', false)
    
    
    // replace small objects with smooth underneath
    var clean_map = clean_map.unmask(0).where({
      test: segment_id.gt(0), 
      value: smooth_map
    }).selfMask()
    //############
    //############
    
    
    /*    
    //############
    //# mode OBIA version
    //############
    
    // #########
    // THE FASTER PLAN - vectorise one/few class/es at a time, thus only spending resources on what is actually needed to clean up
    //                 - BUT, just assign the mode of the neighbours, so save resouces even further??
    // #########
    
    // FUNCTION that maps over feature colleciton and assigns neighbour percentages
    var set_neighbour_mode = function(f) {
      // make the 1px buffer
      var diff = f.buffer(vars.image_data_scale).difference(f, ee.ErrorMargin(0.5))
      // reduce the classes in the buffer zone
      var diff_mode = ee.Number(ee.Dictionary(
        clean_map.unmask(ee.Image(0)).reduceRegion({
          reducer: ee.Reducer.mode(),
          geometry: diff.geometry(),
          scale: vars.image_data_scale,
          maxPixels: 1e11
        })).get('classification'))
      
      return(f.set('mode',diff_mode))
    }
    
    // FUNCTION to reduce the map to vectors and map the neighbour properties function
    var reduce_neighbours_mode = function() {
      // reduce map to vectors
      var map_fc = clean_map.unmask(0)
            .updateMask(classn.gt(0)) // only vectorise class/es of interest
            .reduceToVectors({
              scale: vars.image_data_scale, 
              eightConnected: false,
              bestEffort: true, 
              maxPixels: 1e13,
              tileScale: 1,
              geometry: reef_boundary
            })
      // map the function, calculate neighbour properties
      return(map_fc.map(set_neighbour_mode))
    }
    
    // first make a make size threshold, so we're not vecortising huge objects when we don't have to
    var segment_id = clean_map.unmask(0).connectedComponents(ee.Kernel.plus(1),vars.small_object_geo.sqrt()).select('labels')
    Map.addLayer(clean_map.unmask(0).updateMask(segment_id.gt(0)).reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))), display_pal, 'Map objects to be iterated through (OBIA)', false)
    
    // This is where we select the single or group of classes to vectorise for cleaning up
    var classn = segment_id.where({
      test: clean_map.neq(16) //TRF
              .and(clean_map.neq(15)) //RR
              .and(clean_map.neq(14)) //ORF
              .and(clean_map.neq(13)) //IRF
              //.and(clean_map.neq(12)) // deep L
              .and(clean_map.neq(11)) // shallow L 
              .and(clean_map.unmask(0).neq(0)), // no data values (want to reclaim the small gaps 
      value: ee.Image(0) // 99 ensures it's ignored in logic
    })
    
    // calculate neighbours
    var map_fc_neighbours = reduce_neighbours_mode()
    
    //print(map_fc_neighbours.limit(10))
    
    var mode_map = ee.Image().byte().paint(map_fc_neighbours, 'mode').unmask(0).rename('mode') // paint out the mode values to an image
    //Map.addLayer(mode_map, display_pal, "mode map", false)
    
    // replace small objects with mode underneath
    var clean_map = clean_map.unmask(0).where({
      test: segment_id.gt(0), 
      value: mode_map
    }).selfMask()
    
    //############
    //############
    */
    
  } else {
    
    // BENTHIC CLEAN-UP RULES
    
    
    // reclaim shallow no data to surrounding class
    var smooth_map = clean_map
                        .focal_mode({
                          radius: vars.smooth_radius.multiply(3), // relates to smoothness required
                          kernelType: 'circle', units: 'pixels', iterations: 2
                        })
    
    var clean_map = clean_map.unmask(0).where({
      test: geo_map.gt(2).and(clean_map.eq(0)), 
      value: smooth_map
    }).selfMask()
    
    // cut benthic off to < 10 - 15 m
    clean_map = clean_map.where({
      test: depth.gt(1000), // match to geo at least, not deeper or you end up with deep water benthic classes!
      value: ee.Image(0)
    })
    
    // No reef == masked from benthic
    clean_map = clean_map.where({
      test: no_reef.eq(1)),
      value: ee.Image(0)
    })
    
    // Deep (or land or missing) in geo == masked from benthic
    clean_map = clean_map.where({
      test: geo_map.unmask(0).lte(2),
      value: ee.Image(0)
    })
    
    // Deep in geo  == masked from benthic
    clean_map = clean_map.where({
      test: geo_map.eq(2),
      value: ee.Image(0)
    })
    
    /*// Deep lagoon in geo == masked from benthic
    clean_map = clean_map.where({
      test: geo_map.eq(12),
      value: ee.Image(0)
    })*/
    
    // Deep/shallow lagoon in geo && rock in benthic == seagrass
    clean_map = clean_map.where({
      test: geo_map.eq(11).or(geo_map.eq(12))
                   .and(clean_map.eq(13)),
      value: ee.Image(14)
    })
    
    // Deep/shallow lagoon in geo && coral in benthic == sand
    clean_map = clean_map.where({
      test: geo_map.eq(11).or(geo_map.eq(12))
                   .and(clean_map.eq(15)),
      value: ee.Image(11)
    })
    
    /*// turbid in geo == turbid (temporal - class num 2)
    // ############## ---> need to decide here whether to push geo turbid through regardless of benthic class
    clean_map = clean_map.where({
      test: geo_map.eq(3),
      value: ee.Image(2)
    })*/
    
    /*
    // Ignore in benthic + ORF in geo == rock
    clean_map = clean_map.where({
      test: clean_map.eq(0)
                     .and(geo_map.eq(14)),
      value: ee.Image(13)
    })
    
    // Ignore in benthic + IRF in geo == sand
    clean_map = clean_map.where({
      test: clean_map.eq(0)
                     .and(geo_map.eq(13)),
      value: ee.Image(11)
    })
    
    // Ignore in benthic + TRF in geo == sand
    clean_map = clean_map.where({
      test: clean_map.eq(0)
                     .and(geo_map.eq(16)),
      value: ee.Image(11)
    })
    
    // Ignore in benthic + RR in geo == rock
    */
    
    /*// seagrass in benthic + ORF/RR/slope in geo == coral/algae
    clean_map = clean_map.where({
      test: clean_map.eq(14)
                     .and(geo_map.eq(14).or(geo_map.eq(15)).or(geo_map.eq(21)).or(geo_map.eq(22))),
      value: ee.Image(15)
    })*/
    
    // ####--> CR: "Seagrass neighbouring deep water or no data not shallow a rock or coral algae class"
    
    // Seagrass in ben + ORF in geo == Rubble
    clean_map = clean_map.where({
      test: SGtoRubble.eq(1)
                     .and(clean_map.eq(14)),
                     .and(geo_map.eq(14)),
      value: ee.Image(12)
    })
        
    // Seagrass in ben + ORF in geo == Rock
    clean_map = clean_map.where({
      test: SGtoRock.eq(1)
                     .and(clean_map.eq(14)),
                     .and(geo_map.eq(14)),
      value: ee.Image(13)
    })
    
    // Deep lagoon in geo + Seagrass in Ben == Sand
    clean_map = clean_map.where({
      test: SGtoSand.eq(1)
                     .and(clean_map.eq(14)),
                     .and(geo_map.eq(12)),
      value: ee.Image(11)
    })
     
    // BMA to Coral/Algae
    clean_map = clean_map.where({
      test: BMAtoCA.eq(1)
                     .and(clean_map.eq(18)),
      value: ee.Image(15)
    })
    
    // MAYOTTE RB to Coral/Algae on PRs
    clean_map = clean_map.where({
      test: MayNotRB.eq(1)
                     .and(clean_map.eq(12)),
                     .and(geo_map.eq(13)),
      value: ee.Image(15)
    
    // MAYOTTE IRF Rubble to Rock 
    clean_map = clean_map.where({
      test: MayNotRB.eq(1)
                     .and(clean_map.eq(12)),
                     .and(geo_map.eq(13)),
      value: ee.Image(13)
    
    // coral or algae in benthic + TRF in geo == seagrass
    clean_map = clean_map.where({
      test: clean_map.eq(15)
                     .and(geo_map.eq(16)),
      value: ee.Image(14)
    })
    
    // rock in benthic + TRF in geo == sand
    clean_map = clean_map.where({
      test: clean_map.eq(13)
                     .and(geo_map.eq(16)),
      value: ee.Image(11)
    })
    
    // seagrass in benthic and slope in geo == coral
    clean_map = clean_map.where({
      test: clean_map.eq(14)
                     .and(geo_map.eq(21).or(geo_map.eq(22))),
      value: ee.Image(15)
    })
    
    // coral or algae in benthic + plat in geo == seagrass
    clean_map = clean_map.where({
      test: clean_map.eq(15)
                     .and(geo_map.eq(23)),
      value: ee.Image(14)
    })
    
    /*// BMA in benthic and slope/plat in geo == sand
    clean_map = clean_map.where({
      test: clean_map.eq(18)
                     .and(geo_map.eq(2).or(geo_map.eq(12)).or(geo_map.eq(21)).or(geo_map.eq(22)).or(geo_map.eq(23))),
      value: ee.Image(11)
    })*/
    
    
    
    
  }
  
/*  // ####
  // Final small object clean (safety net for oddities with scaling and border buffers??)
  // ####
  
  var clean_size = (vars.geomorphic) ? vars.small_object_geo : vars.small_object_benthic
  
  var map_vsmooth = clean_map
                        .focal_mode({
                          radius: 10, // relates to smoothness required
                          kernelType: 'circle', units: 'pixels', iterations: 1
                        })
                        .updateMask(class_extent_mask)
  
  clean_map = clean_map.where({
    test: clean_map.connectedPixelCount(clean_size, false).lt(clean_size), 
    value: map_vsmooth
  })*/

}

// final smooth
if (vars.smooth_output) {
  // smooth the output lightly to make nice edges, and get rid of noise
  var noise_smooth = clean_map.unmask(99) // unmasking to a value allows us to include masked areas in the smooth, then re-mask after
                        .focal_mode({
                          radius: 2, // relates to smoothness required
                          kernelType: 'circle', units: 'pixels', iterations: 2
                        })
  clean_map = clean_map.updateMask(noise_smooth.neq(99)).updateMask(clean_map.gt(1)) // this ignores 0/land; make it .gt(2) if you want to mask deep too
} else {
  // just clip to the classified extent and move on
  if (vars.geomorphic) {
    clean_map = clean_map.updateMask(clean_map.gt(1)) // this ignores 0/land; make it .gt(2) if you want to mask deep too
  } else {
    clean_map = clean_map.updateMask(clean_map.gt(1)) // this ignores 0/land; make it .gt(2) if you want to mask deep too
  }
  
}


// 4. Export data

var output_name = (vars.geomorphic) ? vars.geomorph_output_name : vars.benthic_output_name


if (vars.do_export) {
  print("For export, the image data scale must be set to:", vars.image_data_scale)
  
  if (vars.export_small_area) {
    var export_convhull = export_small
  } else {
    //var export_convhull = clean_map.gt(2).reduceToVectors({scale: 1000, maxPixels: 1e13, bestEffort: true, geometry: region_extent, crs: "EPSG:4326"}).geometry().convexHull({maxError: 100})
    var export_convhull = reef_boundary
  }
  Map.addLayer(export_convhull, {}, "Export footprint", true)
  Export.image.toAsset({
    image: clean_map.set(vars),
    description: output_name,
    assetId: vars.asset_output + 'in_out/' + output_name,
    region: export_convhull,
    scale: vars.image_data_scale,
    crs: 'EPSG:4326',
    maxPixels: 1e13,
    pyramidingPolicy: {'.default': 'mode'}
  })
  /*Export.image.toCloudStorage({
    image: clean_map,//.set(vars),
    description: 'swp_geo_clean',
    bucket: 'mitchest_unet_bucket',
    fileNamePrefix: 'swp_geo_clean',
    region: export_convhull,
    scale: 25,
    crs: 'EPSG:4326',
    maxPixels: 1e13
  })*/
  
  
} else {
  if (vars.show_eg_area) {
    if (vars.reproject_display) {
      Map.addLayer(clean_map.clip(eg_area).reproject(ee.Projection('EPSG:4326').atScale(vars.image_data_scale)), display_pal, output_name + '_final', false)
    } else {
      Map.addLayer(clean_map.clip(eg_area), display_pal, output_name + '_final', false)
    }
  } else {
    if (vars.reproject_display) {
      Map.addLayer(clean_map.reproject(ee.Projection('EPSG:4326').atScale(vars.image_data_scale)), display_pal, output_name + '_final', false)
    } else {
      Map.addLayer(clean_map, display_pal, output_name + '_final', false)
    }
  }
}

//Generate Legend title
var title = ui.Label({
  value: 'Classes',
  style: {fontWeight: 'bold', fontSize: '12px'}
});

/*// generate the legend
var geo_legend = pkg_vis.discrete_legend(map_palettes.geo_atlas_names, map_palettes.geo_atlas_cols, 'Geomorphic Zone', false);
var benthic_legend = pkg_vis.discrete_legend(map_palettes.benthic_atlas_names, map_palettes.benthic_atlas_cols, 'Benthic Habitat', false);
//var mask_legend = pkg_vis.discrete_legend(["Low confidence depth","Water conditions"], ["#f7f7f7","#bababa"], 'Confidence Mask reason', false)
var legend = (vars.geomorphic) ? geo_legend : benthic_legend;
pkg_vis.add_lgds([title, legend]);//, mask_legend])
// generate the legend*/