/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var extra_reefs = 
    /* color: #45ff00 */
    /* shown: false */
    ee.Geometry({
      "type": "GeometryCollection",
      "geometries": [
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -89.64844603212985,
                22.361905934571908
              ],
              [
                -89.636944719874,
                22.367620900191206
              ],
              [
                -89.62458510073337,
                22.38095490768399
              ],
              [
                -89.61222548159274,
                22.408571286621633
              ],
              [
                -89.60226912172946,
                22.43523016963011
              ],
              [
                -89.60278410586032,
                22.44586055807947
              ],
              [
                -89.61050886782321,
                22.478222692920767
              ],
              [
                -89.61771864565524,
                22.498048696813274
              ],
              [
                -89.63454146059665,
                22.518664727123483
              ],
              [
                -89.65273756655368,
                22.539119132967325
              ],
              [
                -89.6621789422861,
                22.549424468632935
              ],
              [
                -89.66835875185642,
                22.556558480985167
              ],
              [
                -89.6812333551279,
                22.567021031700637
              ],
              [
                -89.69496626528415,
                22.57177647413434
              ],
              [
                -89.72140211733493,
                22.580018852361366
              ],
              [
                -89.73444838198337,
                22.582079369884056
              ],
              [
                -89.74663633974704,
                22.587626763875914
              ],
              [
                -89.75401777895603,
                22.587468270005143
              ],
              [
                -89.76019758852634,
                22.58461534914379
              ],
              [
                -89.76517576845798,
                22.581920869630256
              ],
              [
                -89.77135557802829,
                22.57954334394139
              ],
              [
                -89.77530378969821,
                22.575897724870718
              ],
              [
                -89.77822203310642,
                22.571617962029602
              ],
              [
                -89.7826852289072,
                22.563533602995033
              ],
              [
                -89.79212660463962,
                22.554973176787573
              ],
              [
                -89.80002302797946,
                22.542924269581913
              ],
              [
                -89.80534453066501,
                22.533886898875902
              ],
              [
                -89.80397123964939,
                22.51977473383636
              ],
              [
                -89.80139631899509,
                22.501379186786618
              ],
              [
                -89.79212660463962,
                22.49265630495159
              ],
              [
                -89.78405851992282,
                22.49059445252479
              ],
              [
                -89.77530378969821,
                22.48536038147897
              ],
              [
                -89.77187056215915,
                22.475843381633283
              ],
              [
                -89.76723570498142,
                22.45839385001659
              ],
              [
                -89.7581376520029,
                22.441100783363815
              ],
              [
                -89.74531277040998,
                22.431944048600386
              ],
              [
                -89.74239452700178,
                22.424644928604945
              ],
              [
                -89.73999126772443,
                22.416075906782165
              ],
              [
                -89.73690136293928,
                22.414171607909427
              ],
              [
                -89.73054989199201,
                22.412267282930998
              ],
              [
                -89.72797497133772,
                22.41369552911215
              ],
              [
                -89.7214518390135,
                22.40623674829417
              ],
              [
                -89.71458538393537,
                22.40179302898864
              ],
              [
                -89.70737560610334,
                22.398301435581626
              ],
              [
                -89.70909221987287,
                22.392746447157602
              ],
              [
                -89.71613033632795,
                22.390206949965016
              ],
              [
                -89.71269710878889,
                22.3765563581923
              ],
              [
                -89.70960720400373,
                22.373064131230638
              ],
              [
                -89.70308407167951,
                22.370206789455228
              ],
              [
                -89.69415768007795,
                22.362904427375142
              ],
              [
                -89.68797787050764,
                22.359570613025326
              ],
              [
                -89.68231304506818,
                22.359888122591922
              ],
              [
                -89.67613323549787,
                22.362586924684727
              ],
              [
                -89.66840847353498,
                22.358459323842663
              ],
              [
                -89.65690716127912,
                22.35560168237781
              ],
              [
                -89.65072735170881,
                22.358459323842663
              ],
              [
                -89.65072735170881,
                22.36068189334185
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -86.83113834008412,
                21.59313309130659
              ],
              [
                -86.901176181881,
                21.610370407429773
              ],
              [
                -87.00417300805287,
                21.574616650541955
              ],
              [
                -86.98700687035756,
                21.55673646223995
              ],
              [
                -86.95231888994452,
                21.512979608443835
              ],
              [
                -86.94683810815053,
                21.48391580788754
              ],
              [
                -86.92468720443574,
                21.445570636485048
              ],
              [
                -86.91189983628351,
                21.433588229435895
              ],
              [
                -86.8956830178185,
                21.407542752673603
              ],
              [
                -86.88229343041615,
                21.4235236862775
              ],
              [
                -86.86135074242787,
                21.433430986953436
              ],
              [
                -86.85482761010365,
                21.435028875703225
              ],
              [
                -86.84212466820912,
                21.43566802630456
              ],
              [
                -86.81809207543569,
                21.410419449733403
              ],
              [
                -86.81088086884594,
                21.407382065972932
              ],
              [
                -86.80435719374563,
                21.391558662797273
              ],
              [
                -86.79474612817006,
                21.37525593703793
              ],
              [
                -86.79251482974244,
                21.351754303137064
              ],
              [
                -86.7968060646935,
                21.33432776031178
              ],
              [
                -86.82180275119181,
                21.288591889252288
              ],
              [
                -86.80669655001994,
                21.230039345659836
              ],
              [
                -86.80944313205119,
                21.18682993823288
              ],
              [
                -86.80189003146525,
                21.140725978197686
              ],
              [
                -86.7497049728715,
                21.13240012196819
              ],
              [
                -86.72670234835978,
                21.14520893779485
              ],
              [
                -86.70850624240275,
                21.19803359122074
              ],
              [
                -86.70747627414103,
                21.21531756054158
              ],
              [
                -86.74524177707072,
                21.280594281215226
              ],
              [
                -86.75107826388712,
                21.30746451943624
              ],
              [
                -86.755198136934,
                21.33081204520507
              ],
              [
                -86.75622810519572,
                21.37685654454436
              ],
              [
                -86.766184465059,
                21.42736093209764
              ],
              [
                -86.79972628913332,
                21.54268827646399
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -87.03219456263892,
                20.352972310658465
              ],
              [
                -87.03219456263892,
                20.32399964320574
              ],
              [
                -87.03219456263892,
                20.29759759861614
              ],
              [
                -87.01502842494361,
                20.267326303776162
              ],
              [
                -86.99442905970923,
                20.257019834057456
              ],
              [
                -86.97108311244361,
                20.259596515647814
              ],
              [
                -86.94087071009986,
                20.291801425286923
              ],
              [
                -86.90722508021705,
                20.331082352247332
              ],
              [
                -86.89211887904517,
                20.340740069042013
              ],
              [
                -86.86259312220923,
                20.381939544318815
              ],
              [
                -86.83444065638892,
                20.419910563024462
              ],
              [
                -86.7891220528733,
                20.457872215631042
              ],
              [
                -86.7671493966233,
                20.485533273999334
              ],
              [
                -86.74723667689673,
                20.505471873233084
              ],
              [
                -86.72801060267798,
                20.546627222855808
              ],
              [
                -86.70397800990455,
                20.563343420550616
              ],
              [
                -86.67033238002173,
                20.6186224193921
              ],
              [
                -86.6627792794358,
                20.636615906501834
              ],
              [
                -86.67651218959205,
                20.643041636297472
              ],
              [
                -86.70260471888892,
                20.655249774925107
              ],
              [
                -86.71908421107642,
                20.671954059814812
              ],
              [
                -86.74174351283423,
                20.695722374130256
              ],
              [
                -86.76234287806861,
                20.695080036209706
              ],
              [
                -86.81246800013892,
                20.6636021469578
              ],
              [
                -86.90310520717017,
                20.59227097734061
              ],
              [
                -86.95185703822486,
                20.531195263868053
              ],
              [
                -86.98344273158423,
                20.47459810263365
              ],
              [
                -87.00129551478736,
                20.450151960997015
              ],
              [
                -87.02258152552955,
                20.42827579995618
              ],
              [
                -87.03562779017798,
                20.360053692029563
              ]
            ]
          ],
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -86.80396211954265,
                20.98373337362931
              ],
              [
                -86.78267610880046,
                21.023476818545305
              ],
              [
                -86.7847360453239,
                21.03757678591268
              ],
              [
                -86.8122018656364,
                21.03757678591268
              ],
              [
                -86.82936800333171,
                21.004888460266166
              ],
              [
                -86.83898104044108,
                20.98109442193427
              ],
              [
                -86.8616403421989,
                20.90991317322004
              ],
              [
                -86.92173596464949,
                20.820394517130378
              ],
              [
                -86.98490735136824,
                20.761978767491165
              ],
              [
                -87.04052563750105,
                20.67334916421674
              ],
              [
                -87.10163708769636,
                20.594309578899175
              ],
              [
                -87.09202405058699,
                20.59559510361208
              ],
              [
                -87.00619336211042,
                20.68491248665164
              ],
              [
                -86.96404636209571,
                20.721907973559038
              ],
              [
                -86.95323169534767,
                20.73924707161387
              ],
              [
                -86.95923984354103,
                20.745507924418995
              ],
              [
                -86.95185840433204,
                20.756423663330615
              ],
              [
                -86.9384688169297,
                20.775524309840304
              ],
              [
                -86.9058531553086,
                20.80970682990725
              ],
              [
                -86.89675510233009,
                20.81789022755746
              ],
              [
                -86.8809622556504,
                20.811311452699485
              ],
              [
                -86.87169254129493,
                20.815643848917464
              ],
              [
                -86.86568439310157,
                20.836020486098
              ],
              [
                -86.85865959897524,
                20.8509153119534
              ],
              [
                -86.8452700115729,
                20.87032478608466
              ],
              [
                -86.83806023374086,
                20.8930996496302
              ],
              [
                -86.82690224423891,
                20.906140791051428
              ],
              [
                -86.82312569394594,
                20.915922448035175
              ],
              [
                -86.80853447690492,
                20.9491111810384
              ],
              [
                -86.79291329160219,
                20.978926664858413
              ],
              [
                -86.80372795835024,
                20.984696716849022
              ],
              [
                -86.80836281552797,
                20.979567792750608
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -87.46058265899363,
                20.148576129956446
              ],
              [
                -87.47053901885691,
                20.114729675163737
              ],
              [
                -87.47946541045847,
                20.072169456064277
              ],
              [
                -87.48186866973582,
                20.044112083676705
              ],
              [
                -87.47706215118113,
                20.02733976568901
              ],
              [
                -87.47912208770457,
                20.012501223126336
              ],
              [
                -87.47980873321238,
                19.999919623138485
              ],
              [
                -87.46744911407175,
                19.990240784954608
              ],
              [
                -87.46797142926789,
                19.970558646540645
              ],
              [
                -87.46522484723664,
                19.952487634738876
              ],
              [
                -87.4521785825882,
                19.928282145441838
              ],
              [
                -87.43947564069367,
                19.927636614951734
              ],
              [
                -87.43432579938508,
                19.91149749593981
              ],
              [
                -87.43329583112336,
                19.89245121740331
              ],
              [
                -87.44428215924836,
                19.86533052905033
              ],
              [
                -87.45355187360383,
                19.839496988972467
              ],
              [
                -87.46728478376008,
                19.839496988972467
              ],
              [
                -87.4741512388382,
                19.83626750082908
              ],
              [
                -87.47827111188508,
                19.822379953653197
              ],
              [
                -87.48754082624055,
                19.80623011717556
              ],
              [
                -87.48925744001008,
                19.79330906743549
              ],
              [
                -87.48342095319367,
                19.78006390303521
              ],
              [
                -87.46659813825227,
                19.778125493908227
              ],
              [
                -87.44908867780305,
                19.789755594871078
              ],
              [
                -87.43947564069367,
                19.77844856373375
              ],
              [
                -87.4247127622757,
                19.737090304808916
              ],
              [
                -87.41853295270539,
                19.691842442219325
              ],
              [
                -87.44393883649445,
                19.693781898877674
              ],
              [
                -87.45629845563508,
                19.696044568613512
              ],
              [
                -87.47186107914992,
                19.70499223943264
              ],
              [
                -87.48490734379835,
                19.709194020523892
              ],
              [
                -87.50138683598585,
                19.713395691233128
              ],
              [
                -87.50893993657179,
                19.710486854038148
              ],
              [
                -87.50447674077101,
                19.706931536728064
              ],
              [
                -87.48113079350539,
                19.69885097624475
              ],
              [
                -87.46945781987257,
                19.676223236576096
              ],
              [
                -87.46190471928664,
                19.685597973795925
              ],
              [
                -87.45126171391554,
                19.682688631303925
              ],
              [
                -87.45538158696242,
                19.674606847126775
              ],
              [
                -87.4488584546382,
                19.662968361845298
              ],
              [
                -87.44954510014601,
                19.63257500177712
              ],
              [
                -87.43855877202101,
                19.621903627795486
              ],
              [
                -87.42825908940382,
                19.614788984766637
              ],
              [
                -87.41280956547804,
                19.597971304350885
              ],
              [
                -87.4158994702632,
                19.562389651467964
              ],
              [
                -87.42070598881789,
                19.559801588390332
              ],
              [
                -87.42619915288039,
                19.54912538920063
              ],
              [
                -87.42997570317335,
                19.523564346155645
              ],
              [
                -87.4327222852046,
                19.508355224362223
              ],
              [
                -87.43100567143507,
                19.49767562443703
              ],
              [
                -87.44061870854445,
                19.47566695376686
              ],
              [
                -87.44683118859001,
                19.469353631858354
              ],
              [
                -87.43927808800407,
                19.465792985968402
              ],
              [
                -87.42142530480095,
                19.50204317704822
              ],
              [
                -87.42039533653923,
                19.518547270394308
              ],
              [
                -87.41627546349235,
                19.544109107478924
              ],
              [
                -87.41009565392204,
                19.556403233213835
              ],
              [
                -87.39876600304314,
                19.581312140782483
              ],
              [
                -87.39910932579704,
                19.609127925910915
              ],
              [
                -87.40425916710564,
                19.63596883165884
              ],
              [
                -87.40872236290642,
                19.668301314154387
              ],
              [
                -87.39773603478142,
                19.727776039588573
              ],
              [
                -87.41249891319939,
                19.765259604985836
              ],
              [
                -87.43856433747303,
                19.810287639978405
              ],
              [
                -87.44371417878162,
                19.82708300721219
              ],
              [
                -87.44422916291248,
                19.83741773567935
              ],
              [
                -87.43530277131092,
                19.851303968078785
              ],
              [
                -87.42637637970935,
                19.86276726766908
              ],
              [
                -87.41847995636951,
                19.878749922036747
              ],
              [
                -87.41985324738513,
                19.891825440382732
              ],
              [
                -87.43341449616443,
                19.929081165137095
              ],
              [
                -87.44714740632068,
                19.9476389449198
              ],
              [
                -87.45676044343006,
                19.966355886899258
              ],
              [
                -87.46139530060779,
                19.982973378937217
              ],
              [
                -87.46276859162342,
                20.00217004704709
              ],
              [
                -87.46294025300037,
                20.011202963311373
              ],
              [
                -87.46414188263904,
                20.031363851768976
              ],
              [
                -87.46482852814685,
                20.069842451181945
              ],
              [
                -87.46482852814685,
                20.077742876956506
              ],
              [
                -87.46242526886951,
                20.097089176672792
              ],
              [
                -87.4507522952367,
                20.138030959208567
              ],
              [
                -87.453327215891,
                20.146089102348366
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -87.44833069251355,
                19.37341328619865
              ],
              [
                -87.45725708411511,
                19.360781372073284
              ],
              [
                -87.43871765540418,
                19.342965471048327
              ],
              [
                -87.43219452307996,
                19.339402057409096
              ],
              [
                -87.42670135901746,
                19.345880933434874
              ],
              [
                -87.42498474524793,
                19.352683476441346
              ],
              [
                -87.43082123206433,
                19.35657051652369
              ],
              [
                -87.43047790931043,
                19.358837913792097
              ],
              [
                -87.43528442786511,
                19.36823108088155
              ],
              [
                -87.44283752845105,
                19.373737168559142
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -87.46069031165418,
                19.301819508058028
              ],
              [
                -87.48609619544324,
                19.272978765649295
              ],
              [
                -87.51459198401746,
                19.241215670686984
              ],
              [
                -87.53244476722058,
                19.225007641154676
              ],
              [
                -87.54274444983777,
                19.195504924691807
              ],
              [
                -87.53793793128308,
                19.195180689619242
              ],
              [
                -87.53450470374402,
                19.19842301159811
              ],
              [
                -87.52180176184949,
                19.217551410535844
              ],
              [
                -87.49330597327527,
                19.25061559467649
              ],
              [
                -87.43734436438855,
                19.310891949114925
              ],
              [
                -87.44695740149793,
                19.312835978146143
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -87.54205780432996,
                19.154970592930074
              ],
              [
                -87.5444610636073,
                19.1484841747869
              ],
              [
                -87.53828125403699,
                19.148808501750654
              ],
              [
                -87.5338180582362,
                19.154970592930074
              ],
              [
                -87.53519134925183,
                19.165024036960318
              ],
              [
                -87.54137115882214,
                19.163402555188398
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -87.54016952918347,
                19.142808349739024
              ],
              [
                -87.55115585730847,
                19.138916242613483
              ],
              [
                -87.55424576209363,
                19.09252824201108
              ],
              [
                -87.55424576209363,
                19.082470386095768
              ],
              [
                -87.55973892615613,
                19.070465048817383
              ],
              [
                -87.56729202674207,
                19.067544700122962
              ],
              [
                -87.58308487342175,
                19.031198281138902
              ],
              [
                -87.59338455603894,
                19.00620550283998
              ],
              [
                -87.61089401648816,
                18.979585687474454
              ],
              [
                -87.62222366736707,
                18.952636907819457
              ],
              [
                -87.63467540514472,
                18.929416497236684
              ],
              [
                -87.63501872789863,
                18.903758844212522
              ],
              [
                -87.64394511950019,
                18.8904412956295
              ],
              [
                -87.64669170153144,
                18.87062542160484
              ],
              [
                -87.6449750877619,
                18.860879050240015
              ],
              [
                -87.65870799791816,
                18.841059682011785
              ],
              [
                -87.66351451647284,
                18.832286427658495
              ],
              [
                -87.6669477440119,
                18.819938108311636
              ],
              [
                -87.66523113024238,
                18.815063522001203
              ],
              [
                -87.6717542625666,
                18.803688937802367
              ],
              [
                -87.67054545152962,
                18.786471262330398
              ],
              [
                -87.67432200182259,
                18.773794523904115
              ],
              [
                -87.67294871080696,
                18.769893797159593
              ],
              [
                -87.67569529283821,
                18.75851616204687
              ],
              [
                -87.68324839342415,
                18.742586183798938
              ],
              [
                -87.69183146227181,
                18.73608371988027
              ],
              [
                -87.70659434068978,
                18.721777418259464
              ],
              [
                -87.71414744127571,
                18.710721719535062
              ],
              [
                -87.72204386461556,
                18.687131786619883
              ],
              [
                -87.72925364244759,
                18.664364608574346
              ],
              [
                -87.73303019274056,
                18.62890677620077
              ],
              [
                -87.74401652086556,
                18.56415275903171
              ],
              [
                -87.74298655260384,
                18.54657707292515
              ],
              [
                -87.74710642565071,
                18.5296506283982
              ],
              [
                -87.75877939928353,
                18.517605791382056
              ],
              [
                -87.76598917711556,
                18.500350898711975
              ],
              [
                -87.76310216810167,
                18.48235392699416
              ],
              [
                -87.76722204114854,
                18.448812341395442
              ],
              [
                -87.76619207288682,
                18.444578471531056
              ],
              [
                -87.76687871839464,
                18.428944817482673
              ],
              [
                -87.76928197767198,
                18.413961231727303
              ],
              [
                -87.77752172376573,
                18.39799902056211
              ],
              [
                -87.7922846021837,
                18.379754682226814
              ],
              [
                -87.80533086683214,
                18.352932584515425
              ],
              [
                -87.82146703626573,
                18.33012090403502
              ],
              [
                -87.83863317396104,
                18.280902607203142
              ],
              [
                -87.84275304700792,
                18.239822340813042
              ],
              [
                -87.84469337912277,
                18.199403481889764
              ],
              [
                -87.84572334738449,
                18.173309678491655
              ],
              [
                -87.83473701925949,
                18.13416165937469
              ],
              [
                -87.8299305007048,
                18.122741835864456
              ],
              [
                -87.82787056418137,
                18.11980518938624
              ],
              [
                -87.8189441725798,
                18.12730985469136
              ],
              [
                -87.81379433127121,
                18.144275737720754
              ],
              [
                -87.82203407736496,
                18.154062998437293
              ],
              [
                -87.82787056418137,
                18.195815815453933
              ],
              [
                -87.82787056418137,
                18.23495000084322
              ],
              [
                -87.81757088156418,
                18.304428863141165
              ],
              [
                -87.80521126242355,
                18.33571733458844
              ],
              [
                -87.7801487013884,
                18.374494142782364
              ],
              [
                -87.77877541037277,
                18.38492003355217
              ],
              [
                -87.7581760451384,
                18.416193921585027
              ],
              [
                -87.75233955832199,
                18.450718904317124
              ],
              [
                -87.7530262038298,
                18.50216778654079
              ],
              [
                -87.74787636252121,
                18.512585932455785
              ],
              [
                -87.73689003439621,
                18.533094803393787
              ],
              [
                -87.73174019308762,
                18.541883566365385
              ],
              [
                -87.73139687033371,
                18.58386807878321
              ],
              [
                -87.71903725119309,
                18.636903485160456
              ],
              [
                -87.71903725119309,
                18.65219283044579
              ],
              [
                -87.70736427756027,
                18.708133579853673
              ],
              [
                -87.69843788595871,
                18.718539122593075
              ],
              [
                -87.67303200216965,
                18.7383729145675
              ],
              [
                -87.65998573752121,
                18.76178029525035
              ],
              [
                -87.6592990920134,
                18.80143538538981
              ],
              [
                -87.6541492507048,
                18.81865968696343
              ],
              [
                -87.63835640402512,
                18.855377304857694
              ],
              [
                -87.62840004416184,
                18.888838577400676
              ],
              [
                -87.61398048849777,
                18.912549800880956
              ],
              [
                -87.61363716574387,
                18.93593292031608
              ],
              [
                -87.5937244460173,
                18.96158563209094
              ],
              [
                -87.58342476340012,
                18.991779337449614
              ],
              [
                -87.54565926047043,
                19.076162773144347
              ],
              [
                -87.53432960959152,
                19.130340257165482
              ],
              [
                -87.53467293234543,
                19.143638601760248
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -87.44124390797505,
                18.503505409498462
              ],
              [
                -87.43643738942036,
                18.459221566065523
              ],
              [
                -87.42133118824849,
                18.406456781662158
              ],
              [
                -87.40347840504536,
                18.384303778405588
              ],
              [
                -87.36571290211567,
                18.39081966327279
              ],
              [
                -87.33618714527974,
                18.41492629459394
              ],
              [
                -87.31490113453755,
                18.454010950353176
              ],
              [
                -87.30322816090474,
                18.498296139481557
              ],
              [
                -87.31490113453755,
                18.517830084670425
              ],
              [
                -87.31146790699849,
                18.53280459896661
              ],
              [
                -87.29773499684224,
                18.553636523301794
              ],
              [
                -87.28606202320942,
                18.563400612975684
              ],
              [
                -87.2682092400063,
                18.580323711274893
              ],
              [
                -87.2407434196938,
                18.620672009374136
              ],
              [
                -87.22907044606099,
                18.65125224536735
              ],
              [
                -87.2340710443617,
                18.705977496786968
              ],
              [
                -87.2450573724867,
                18.733941297413967
              ],
              [
                -87.27526977483045,
                18.758649641555603
              ],
              [
                -87.29824241844368,
                18.78093716058271
              ],
              [
                -87.32364830223274,
                18.788738012551267
              ],
              [
                -87.33669456688118,
                18.77508628457003
              ],
              [
                -87.34768089500618,
                18.752330947511343
              ],
              [
                -87.42801841942024,
                18.615083873632532
              ],
              [
                -87.42458519188118,
                18.595561056547748
              ],
              [
                -87.42183860984993,
                18.56822535260064
              ],
              [
                -87.42458519188118,
                18.54739520829007
              ],
              [
                -87.43282493797493,
                18.529817797354635
              ],
              [
                -87.44449791160774,
                18.516145227964316
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -88.05624428387624,
                17.498040355453742
              ],
              [
                -88.03976479168874,
                17.44891828502676
              ],
              [
                -88.04594460125905,
                17.341458603378516
              ],
              [
                -88.03289833661061,
                17.33293775977472
              ],
              [
                -88.01779213543874,
                17.346046586056517
              ],
              [
                -88.03564491864186,
                17.35587759107677
              ],
              [
                -88.0322116911028,
                17.45088342228619
              ],
              [
                -88.05143776532155,
                17.513101799146924
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -87.8124851286028,
                17.539292638229824
              ],
              [
                -87.80493202801686,
                17.526197691295714
              ],
              [
                -87.78982582684499,
                17.50393411256987
              ],
              [
                -87.76647987957936,
                17.493456189993722
              ],
              [
                -87.75137367840749,
                17.501314688563546
              ],
              [
                -87.7410739957903,
                17.53470951435958
              ],
              [
                -87.74382057782155,
                17.566788947378832
              ],
              [
                -87.7410739957903,
                17.5929720253544
              ],
              [
                -87.74931374188405,
                17.617187995271276
              ],
              [
                -87.75274696942311,
                17.63093074906555
              ],
              [
                -87.7630466520403,
                17.632893914112113
              ],
              [
                -87.77746620770436,
                17.629621960491026
              ],
              [
                -87.8014988004778,
                17.620460174483522
              ],
              [
                -87.80973854657155,
                17.59231749461671
              ],
              [
                -87.81729164715749,
                17.56940742573966
              ],
              [
                -87.82827797528249,
                17.54060208091273
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -87.6406161533425,
                17.126229885863637
              ],
              [
                -87.61727020607688,
                17.10654288967666
              ],
              [
                -87.58225128517844,
                17.12885466126125
              ],
              [
                -87.5849978672097,
                17.18396637665263
              ],
              [
                -87.55959198342063,
                17.198397691036185
              ],
              [
                -87.51290008888938,
                17.17806233307791
              ],
              [
                -87.51152679787376,
                17.212827880437946
              ],
              [
                -87.4971072422097,
                17.303974379500396
              ],
              [
                -87.44423553810813,
                17.403593682391566
              ],
              [
                -87.43736908303,
                17.453383002541912
              ],
              [
                -87.47444794045188,
                17.483512039214396
              ],
              [
                -87.5465457187722,
                17.45600311665761
              ],
              [
                -87.59873077736594,
                17.37476208403592
              ],
              [
                -87.58431122170188,
                17.25217721793343
              ],
              [
                -87.6179568515847,
                17.236438488863666
              ],
              [
                -87.64198944435813,
                17.150507643856436
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -88.09347975995036,
                17.32956584049402
              ],
              [
                -88.10378451317091,
                17.295470579811564
              ],
              [
                -88.12781203534098,
                17.220724518825115
              ],
              [
                -88.08798659588786,
                17.100006212256115
              ],
              [
                -88.0852400138566,
                17.0251740345698
              ],
              [
                -88.15398255069233,
                16.830345280034315
              ],
              [
                -88.24461975772358,
                16.605438430496637
              ],
              [
                -88.29817810733296,
                16.427694044895308
              ],
              [
                -88.33388367373921,
                16.26297078464365
              ],
              [
                -88.34349671084858,
                16.117899900491825
              ],
              [
                -88.32289734561421,
                16.07435788315394
              ],
              [
                -88.28307190616108,
                16.066440127423657
              ],
              [
                -88.22951355655171,
                16.15879429965723
              ],
              [
                -88.13063660342671,
                16.313061340553205
              ],
              [
                -87.97214905887742,
                16.500664209510678
              ],
              [
                -87.9652826037993,
                16.51383110126881
              ],
              [
                -87.98588196903367,
                16.548060820185885
              ],
              [
                -88.05729310184617,
                16.633502845694924
              ],
              [
                -88.06827942997117,
                16.687444122541812
              ],
              [
                -88.0696527209868,
                16.838661474795245
              ],
              [
                -88.03944031864305,
                16.954294158857074
              ],
              [
                -88.00098817020555,
                17.001577970248878
              ],
              [
                -87.9872552600493,
                17.07510684589477
              ],
              [
                -87.9927484241118,
                17.09479716530497
              ],
              [
                -88.0147210803618,
                17.109235410498908
              ],
              [
                -88.04356019168992,
                17.144669990060432
              ],
              [
                -88.05042664676805,
                17.1958413355295
              ],
              [
                -88.04630677372117,
                17.25093312452422
              ],
              [
                -88.04493348270555,
                17.326985217569966
              ],
              [
                -88.05454651981492,
                17.340094468978915
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -87.87787307049723,
                16.70713349596074
              ],
              [
                -87.8545271232316,
                16.70713349596074
              ],
              [
                -87.8380476310441,
                16.71502525210537
              ],
              [
                -87.81744826580973,
                16.726862274262487
              ],
              [
                -87.7831159904191,
                16.746589011230018
              ],
              [
                -87.75702346112223,
                16.755794122626398
              ],
              [
                -87.74603713299723,
                16.782091986820888
              ],
              [
                -87.73505080487223,
                16.812330030852372
              ],
              [
                -87.72543776776286,
                16.858335192906544
              ],
              [
                -87.70895827557536,
                16.87804826668135
              ],
              [
                -87.68149245526286,
                16.89381724432339
              ],
              [
                -87.6952253654191,
                16.92009594440248
              ],
              [
                -87.73505080487223,
                16.917468239281977
              ],
              [
                -87.7556501701066,
                16.921409783215537
              ],
              [
                -87.7941023185441,
                16.92666504680514
              ],
              [
                -87.81882155682536,
                16.87804826668135
              ],
              [
                -87.83942092205973,
                16.8491350549145
              ],
              [
                -87.85727370526286,
                16.80970082699309
              ],
              [
                -87.87512648846598,
                16.77157327761558
              ],
              [
                -87.89160598065348,
                16.72554708586035
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -87.02092146369607,
                16.067299322596384
              ],
              [
                -87.00306868049294,
                16.046183858184964
              ],
              [
                -86.99414228889138,
                16.02836594387027
              ],
              [
                -86.98040937873513,
                16.02836594387027
              ],
              [
                -86.951570267407,
                16.062680506160678
              ],
              [
                -86.9234178015867,
                16.076536633727706
              ],
              [
                -86.90487837287576,
                16.077196425245923
              ],
              [
                -86.88359236213357,
                16.084453987406945
              ],
              [
                -86.87741255256326,
                16.09566969843499
              ],
              [
                -86.86779951545388,
                16.110842887328154
              ],
              [
                -86.86985945197732,
                16.127993790305442
              ],
              [
                -86.90487837287576,
                16.128653410784356
              ],
              [
                -86.9453904578367,
                16.123376385472444
              ],
              [
                -86.984529251782,
                16.106884775983637
              ],
              [
                -87.0168015906492,
                16.077196425245923
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -83.32304845777188,
                16.085946313462635
              ],
              [
                -83.2478607746664,
                16.065492658518902
              ],
              [
                -83.21146856275234,
                16.06516274361922
              ],
              [
                -83.18091283765469,
                16.0628533240042
              ],
              [
                -83.15722356763516,
                16.047346526907795
              ],
              [
                -83.13628087964688,
                16.048666301335953
              ],
              [
                -83.12323461499844,
                16.04239729492788
              ],
              [
                -83.10332189527188,
                16.021939165594258
              ],
              [
                -83.08890233960781,
                16.03117858069778
              ],
              [
                -83.09061895337734,
                16.05856433075526
              ],
              [
                -83.15859685865078,
                16.094852892375496
              ],
              [
                -83.18812261548672,
                16.094852892375496
              ],
              [
                -83.22211156812344,
                16.099141102725927
              ],
              [
                -83.27120672193203,
                16.105738168538835
              ],
              [
                -83.29935918775234,
                16.106397863058888
              ],
              [
                -83.3185852619711,
                16.095512623072985
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -83.30099320745354,
                15.959599033599932
              ],
              [
                -83.29584336614495,
                15.94837567091754
              ],
              [
                -83.28451371526604,
                15.919654206579388
              ],
              [
                -83.26906419134026,
                15.907768260944952
              ],
              [
                -83.26254105901604,
                15.904796664708053
              ],
              [
                -83.25567460393792,
                15.905457023222889
              ],
              [
                -83.25292802190667,
                15.911400152250588
              ],
              [
                -83.26322770452386,
                15.921965281023239
              ],
              [
                -83.26975083684808,
                15.937481806283907
              ],
              [
                -83.27558732366448,
                15.951346622200417
              ],
              [
                -83.2824537787426,
                15.959929122986871
              ],
              [
                -83.2985899481762,
                15.962569818502635
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -83.30305314397698,
                15.858896439337961
              ],
              [
                -83.31987595891839,
                15.89456083045254
              ],
              [
                -83.32880235051995,
                15.910409642947988
              ],
              [
                -83.34184861516839,
                15.920974823803316
              ],
              [
                -83.35146165227776,
                15.922625583122997
              ],
              [
                -83.3535215888012,
                15.899513718522135
              ],
              [
                -83.33532548284417,
                15.883003617547574
              ],
              [
                -83.32227921819573,
                15.861868713023275
              ],
              [
                -83.3147261176098,
                15.836107553056166
              ],
              [
                -83.3099195990551,
                15.824877300880592
              ],
              [
                -83.2982466254223,
                15.821243850395465
              ],
              [
                -83.28897691106683,
                15.825207611322826
              ],
              [
                -83.29000687932854,
                15.837428718155815
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -82.99520151448456,
                15.714523480164893
              ],
              [
                -83.00447122884003,
                15.714853970318272
              ],
              [
                -83.01683084798066,
                15.707583063059625
              ],
              [
                -82.9969181282541,
                15.69502361209942
              ],
              [
                -82.986275122883,
                15.706591555598116
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -82.97561919883265,
                15.259045804884241
              ],
              [
                -82.97493255332483,
                15.250433929692978
              ],
              [
                -82.97218597129358,
                15.231221551989615
              ],
              [
                -82.96875274375452,
                15.214657749347602
              ],
              [
                -82.95433318809046,
                15.21068224286532
              ],
              [
                -82.94952666953577,
                15.224596187305066
              ],
              [
                -82.95158660605921,
                15.245796619936083
              ],
              [
                -82.95982635215296,
                15.265670083994692
              ],
              [
                -82.96875274375452,
                15.268982145173135
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -82.45445525840296,
                15.111270251407618
              ],
              [
                -82.4345425386764,
                15.069503303272706
              ],
              [
                -82.40913665488733,
                15.045632793071334
              ],
              [
                -82.34939849570765,
                15.058231451302397
              ],
              [
                -82.34184539512171,
                15.086078471474602
              ],
              [
                -82.33497894004358,
                15.14374997359817
              ],
              [
                -82.35008514121546,
                15.149052312521828
              ],
              [
                -82.3796108980514,
                15.164958532040437
              ],
              [
                -82.40982330039515,
                15.16363305944122
              ],
              [
                -82.44346893027796,
                15.152366206890251
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -82.82717136518616,
                14.348712661153375
              ],
              [
                -82.7919816623459,
                14.350710228091014
              ],
              [
                -82.76812002716018,
                14.337403568874166
              ],
              [
                -82.74108332967096,
                14.348797045745764
              ],
              [
                -82.72983914960048,
                14.345553929153478
              ],
              [
                -82.72692083910961,
                14.329421373078187
              ],
              [
                -82.71490515832944,
                14.32376537605235
              ],
              [
                -82.70666559960449,
                14.331748581245796
              ],
              [
                -82.70494882811055,
                14.339731957859241
              ],
              [
                -82.70031412126275,
                14.346549647925103
              ],
              [
                -82.69636575843191,
                14.355362947303655
              ],
              [
                -82.69842597876811,
                14.375318215103468
              ],
              [
                -82.69087263749422,
                14.39128293913991
              ],
              [
                -82.70683580490135,
                14.445146827204491
              ],
              [
                -82.70769540264513,
                14.459777433144858
              ],
              [
                -82.68572815676085,
                14.506645245314317
              ],
              [
                -82.65293973564106,
                14.52509254896883
              ],
              [
                -82.6476141022805,
                14.540879517956926
              ],
              [
                -82.6414362103095,
                14.583738388869715
              ],
              [
                -82.66066032851944,
                14.599360910969803
              ],
              [
                -82.6850380616591,
                14.588900928188675
              ],
              [
                -82.72040117677867,
                14.592391566682542
              ],
              [
                -82.7322458504798,
                14.584167201509484
              ],
              [
                -82.74614979026913,
                14.58092601025765
              ],
              [
                -82.75610524819096,
                14.574610603406255
              ],
              [
                -82.76640341260351,
                14.566134709340082
              ],
              [
                -82.76760521624925,
                14.56139953532329
              ],
              [
                -82.77824796473787,
                14.557245869436153
              ],
              [
                -82.76983410624214,
                14.53206658532193
              ],
              [
                -82.77807534184403,
                14.488609018575378
              ],
              [
                -82.76571674739567,
                14.456785381721243
              ],
              [
                -82.79013818721697,
                14.438956777348713
              ],
              [
                -82.80734762549827,
                14.425114787179586
              ],
              [
                -82.82665848435924,
                14.400424113839144
              ],
              [
                -82.83678437324708,
                14.369666233110806
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -81.14914316394307,
                14.486383584793286
              ],
              [
                -81.16699594714619,
                14.435851889983331
              ],
              [
                -81.19308847644307,
                14.36003284366617
              ],
              [
                -81.21918100573994,
                14.348059063294826
              ],
              [
                -81.23840707995869,
                14.317456495393012
              ],
              [
                -81.24527353503682,
                14.290842175070896
              ],
              [
                -81.26999277331807,
                14.262893749240677
              ],
              [
                -81.25625986316182,
                14.228286134834676
              ],
              [
                -81.22467416980244,
                14.175033303795235
              ],
              [
                -81.24802011706807,
                14.097794499703848
              ],
              [
                -81.18210214831807,
                14.119104374341891
              ],
              [
                -81.17660898425557,
                14.105785936122738
              ],
              [
                -81.15463632800557,
                14.091134755507415
              ],
              [
                -81.13403696277119,
                14.135085472284016
              ],
              [
                -81.14914316394307,
                14.157723439311521
              ],
              [
                -81.15188974597432,
                14.204323911014663
              ],
              [
                -81.15738291003682,
                14.277533833532896
              ],
              [
                -81.10519785144307,
                14.332093027174524
              ],
              [
                -81.12030405261494,
                14.49834993304827
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -80.39657968738057,
                14.330762472834843
              ],
              [
                -80.39245981433369,
                14.277533833532896
              ],
              [
                -80.35126108386494,
                14.277533833532896
              ],
              [
                -80.29495615222432,
                14.322778981051702
              ],
              [
                -80.16586679675557,
                14.337415165582431
              ],
              [
                -80.13428110339619,
                14.348059063294826
              ],
              [
                -80.10544199206807,
                14.374666594136874
              ],
              [
                -80.10681528308369,
                14.398610664822664
              ],
              [
                -80.13428110339619,
                14.422552166862605
              ],
              [
                -80.26337045886494,
                14.47308688496217
              ],
              [
                -80.38696665027119,
                14.349389514954856
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -81.42264258990518,
                13.289885336230268
              ],
              [
                -81.37183082232706,
                13.29389484374951
              ],
              [
                -81.33200538287393,
                13.325968515760486
              ],
              [
                -81.32101905474893,
                13.412813329863045
              ],
              [
                -81.30453956256143,
                13.462234067454853
              ],
              [
                -81.29492652545206,
                13.519656158302453
              ],
              [
                -81.35397803912393,
                13.539683868436516
              ],
              [
                -81.34985816607706,
                13.491614536527193
              ],
              [
                -81.41165626178018,
                13.455556184824298
              ],
              [
                -81.4240158809208,
                13.309932210700536
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -80.10414495119234,
                13.554282736371862
              ],
              [
                -80.09453191408296,
                13.522239556973924
              ],
              [
                -80.05607976564546,
                13.477108494786428
              ],
              [
                -80.02861394533296,
                13.493133655723176
              ],
              [
                -80.03548040041109,
                13.531856685849911
              ],
              [
                -80.08766545900484,
                13.575913162426696
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -81.88090133966136,
                12.191796600167903
              ],
              [
                -81.90562057794261,
                12.167633776074181
              ],
              [
                -81.90562057794261,
                12.135413259931633
              ],
              [
                -81.88914108575511,
                12.116616158736726
              ],
              [
                -81.85892868341136,
                12.12332956125454
              ],
              [
                -81.82459640802074,
                12.139441037746085
              ],
              [
                -81.82459640802074,
                12.166291332492333
              ],
              [
                -81.83558273614574,
                12.195823523600446
              ],
              [
                -81.85892868341136,
                12.199850385863414
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -81.47715378106761,
                12.470850714130238
              ],
              [
                -81.49225998223949,
                12.456100509022715
              ],
              [
                -81.50049972833324,
                12.434644168058545
              ],
              [
                -81.49912643731761,
                12.406480032058226
              ],
              [
                -81.47440719903636,
                12.386360926885086
              ],
              [
                -81.45655441583324,
                12.378312850225722
              ],
              [
                -81.44282150567699,
                12.386360926885086
              ],
              [
                -81.43732834161449,
                12.405138806700448
              ],
              [
                -81.46891403497386,
                12.427938698002743
              ],
              [
                -81.46342087091136,
                12.460123375463148
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -82.2626175850673,
                9.426692959408262
              ],
              [
                -82.2571244210048,
                9.409758218597206
              ],
              [
                -82.24545144737199,
                9.396887260702872
              ],
              [
                -82.23377847373918,
                9.385370734852149
              ],
              [
                -82.21111917198137,
                9.423306077678872
              ],
              [
                -82.25369119346574,
                9.431434537984611
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -82.06623696983293,
                9.288481327352057
              ],
              [
                -82.07104348838762,
                9.283060146703004
              ],
              [
                -82.0758500069423,
                9.268829148714337
              ],
              [
                -82.06143045127824,
                9.258663796914007
              ],
              [
                -82.04563760459855,
                9.24782043093562
              ],
              [
                -82.03602456748918,
                9.239009950023144
              ],
              [
                -82.01954507530168,
                9.239009950023144
              ],
              [
                -82.01748513877824,
                9.247142709463516
              ],
              [
                -82.0483841866298,
                9.2722175339248
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -82.07379007041887,
                9.160237607016544
              ],
              [
                -82.07859658897355,
                9.141934140859126
              ],
              [
                -82.03121804893449,
                9.12295177464887
              ],
              [
                -82.02915811241105,
                9.134476903283312
              ],
              [
                -82.05044412315324,
                9.150747038436588
              ],
              [
                -82.05319070518449,
                9.169050050871279
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -82.02709817588762,
                9.114816165553396
              ],
              [
                -82.07310342491105,
                9.1121042546595
              ],
              [
                -82.08477639854387,
                9.089052181424869
              ],
              [
                -82.07447671592668,
                9.07955971977434
              ],
              [
                -82.0593705147548,
                9.078881677179044
              ],
              [
                -82.0428910225673,
                9.08973020477595
              ],
              [
                -82.0319046944423,
                9.094476332285101
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -81.91036843955949,
                9.183285074871607
              ],
              [
                -81.93508767784074,
                9.183962918903207
              ],
              [
                -81.93646096885637,
                9.155492354396678
              ],
              [
                -81.91242837608293,
                9.149391222247084
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -81.83621072471574,
                9.082949913514453
              ],
              [
                -81.82110452354387,
                9.061930195820118
              ],
              [
                -81.77166604698137,
                9.057183637629349
              ],
              [
                -81.7517533272548,
                9.034128035363707
              ],
              [
                -81.73664712608293,
                9.045656021120113
              ],
              [
                -81.75449990928605,
                9.072101180720015
              ],
              [
                -81.7792191475673,
                9.078881677179044
              ],
              [
                -81.81080484092668,
                9.082271877331575
              ],
              [
                -81.81492471397355,
                9.110748291491742
              ],
              [
                -81.84170388877824,
                9.1053243873659
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -79.00545510730467,
                9.560910834750622
              ],
              [
                -78.98416909656248,
                9.55820239310762
              ],
              [
                -78.95464333972654,
                9.553462568359578
              ],
              [
                -78.93953713855467,
                9.556171047726961
              ],
              [
                -78.92237100085936,
                9.573098555193935
              ],
              [
                -78.92237100085936,
                9.581223459286704
              ],
              [
                -78.95121011218748,
                9.576483955523893
              ],
              [
                -79.00476846179686,
                9.571744385615109
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -78.8756791063281,
                9.554139690221836
              ],
              [
                -78.8255539842578,
                9.563619254828765
              ],
              [
                -78.8145676561328,
                9.573098555193935
              ],
              [
                -78.82143411121092,
                9.581223459286704
              ],
              [
                -78.87430581531248,
                9.586639953980159
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -78.7816086717578,
                9.592733407133855
              ],
              [
                -78.7603226610156,
                9.587994064142407
              ],
              [
                -78.7376633592578,
                9.58054639137154
              ],
              [
                -78.71843728503904,
                9.573775637959214
              ],
              [
                -78.70951089343748,
                9.581900525851317
              ],
              [
                -78.67037209949217,
                9.573098555193935
              ],
              [
                -78.66350564441404,
                9.583254654928478
              ],
              [
                -78.6607590623828,
                9.597472683871308
              ],
              [
                -78.67861184558592,
                9.604919984808618
              ],
              [
                -78.74658975085936,
                9.604919984808618
              ],
              [
                -78.7871018358203,
                9.606274021929009
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -78.65869912585936,
                9.5148643987958
              ],
              [
                -78.64565286121092,
                9.512832795298342
              ],
              [
                -78.61818704089842,
                9.512832795298342
              ],
              [
                -78.6003342576953,
                9.508769552091392
              ],
              [
                -78.5900345750781,
                9.509446762644894
              ],
              [
                -78.61818704089842,
                9.528408113434821
              ],
              [
                -78.65801248035154,
                9.52569941347208
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -95.87111913505099,
                19.162439580698273
              ],
              [
                -95.85738622489474,
                19.148169770271927
              ],
              [
                -95.84022008719943,
                19.139737029425152
              ],
              [
                -95.83060705009005,
                19.146872453570573
              ],
              [
                -95.83266698661349,
                19.157250701565665
              ],
              [
                -95.85463964286349,
                19.166331132888626
              ],
              [
                -95.86493932548068,
                19.17735669848018
              ],
              [
                -95.87867223563693,
                19.17541106404025
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -95.8718057805588,
                19.08718486988773
              ],
              [
                -95.85807287040255,
                19.0625250183278
              ],
              [
                -95.84571325126193,
                19.05214082534286
              ],
              [
                -95.82717382255099,
                19.046948485086705
              ],
              [
                -95.82168065848849,
                19.059280027860922
              ],
              [
                -95.8278604680588,
                19.07031273633218
              ],
              [
                -95.84777318778536,
                19.097566866951297
              ],
              [
                -95.86356603446505,
                19.097566866951297
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -86.59800349281375,
                16.276118520591737
              ],
              [
                -86.59045039222781,
                16.307095008316036
              ],
              [
                -86.55817805336062,
                16.326205717039866
              ],
              [
                -86.54513178871218,
                16.341361158611452
              ],
              [
                -86.48058711097781,
                16.360468518315855
              ],
              [
                -86.40230952308718,
                16.39340784832417
              ],
              [
                -86.34051142738406,
                16.413827436258686
              ],
              [
                -86.28901301429812,
                16.42700022654992
              ],
              [
                -86.24438105629031,
                16.423707112655794
              ],
              [
                -86.22103510902468,
                16.419096659474995
              ],
              [
                -86.20112238929812,
                16.42634160823497
              ],
              [
                -86.20386897132937,
                16.43951355034568
              ],
              [
                -86.23820124672,
                16.44083069542797
              ],
              [
                -86.25948725746218,
                16.43951355034568
              ],
              [
                -86.28283320472781,
                16.44083069542797
              ],
              [
                -86.337078199845,
                16.436220648553302
              ],
              [
                -86.4744073014075,
                16.390772906771378
              ],
              [
                -86.52178584144656,
                16.3657391850179
              ],
              [
                -86.56435786293093,
                16.346632341101607
              ],
              [
                -86.59869013832156,
                16.317639078367485
              ],
              [
                -86.60692988441531,
                16.291277838889265
              ],
              [
                -86.60830317543093,
                16.26820884607339
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -85.94500361488406,
                16.41185144074707
              ],
              [
                -85.90929804847781,
                16.450050460787022
              ],
              [
                -85.86191950843875,
                16.500751334540116
              ],
              [
                -85.83239375160281,
                16.49745947299761
              ],
              [
                -85.81359693995681,
                16.4926657800536
              ],
              [
                -85.80853272631121,
                16.502520404763555
              ],
              [
                -85.81660090492312,
                16.52321679303922
              ],
              [
                -85.83492562609877,
                16.526096866417316
              ],
              [
                -85.84947405860964,
                16.526014506068023
              ],
              [
                -85.875652418595,
                16.51984302636866
              ],
              [
                -85.91616450355593,
                16.502068063470794
              ],
              [
                -85.95461665199343,
                16.457952768176984
              ],
              [
                -85.97040949867312,
                16.41843801438111
              ],
              [
                -85.97864924476687,
                16.392090382003527
              ],
              [
                -85.95736323402468,
                16.38747917970726
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -81.701786647487,
                12.61326031593921
              ],
              [
                -81.70590652053387,
                12.60186880161877
              ],
              [
                -81.71792281692059,
                12.590476780943327
              ],
              [
                -81.72719253127606,
                12.57807900712978
              ],
              [
                -81.72547591750653,
                12.571377258503214
              ],
              [
                -81.73543227736981,
                12.55931367050519
              ],
              [
                -81.73783553664715,
                12.555627461277442
              ],
              [
                -81.73405898635419,
                12.548254884379512
              ],
              [
                -81.73920882766278,
                12.532838814113308
              ],
              [
                -81.73852218215497,
                12.52781163525803
              ],
              [
                -81.73165572707684,
                12.51775698354345
              ],
              [
                -81.73165572707684,
                12.507701940068854
              ],
              [
                -81.73440230910809,
                12.503679813052143
              ],
              [
                -81.73886550490887,
                12.498652066230216
              ],
              [
                -81.73817885940106,
                12.490607467906152
              ],
              [
                -81.73543227736981,
                12.480886577771248
              ],
              [
                -81.72684920852215,
                12.473847084589087
              ],
              [
                -81.71654952590497,
                12.485914669988906
              ],
              [
                -81.70968307082684,
                12.507366765209488
              ],
              [
                -81.70110000197919,
                12.524795280895967
              ],
              [
                -81.68702376906903,
                12.534514518611243
              ],
              [
                -81.67775405471356,
                12.532838814113308
              ],
              [
                -81.67363418166669,
                12.543563134585275
              ],
              [
                -81.67123092238934,
                12.573052712051986
              ],
              [
                -81.67329085891278,
                12.59248717430818
              ],
              [
                -81.679813991237,
                12.605219299589109
              ],
              [
                -81.69492019240887,
                12.614935495900294
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -80.06746483189585,
                15.877052289796294
              ],
              [
                -80.08257103306772,
                15.853274664297484
              ],
              [
                -80.07433128697397,
                15.80306825618811
              ],
              [
                -80.01390648228647,
                15.789853972038935
              ],
              [
                -79.95897484166147,
                15.792496897839106
              ],
              [
                -79.8944301639271,
                15.781924987810209
              ],
              [
                -79.84636497838022,
                15.777960379386979
              ],
              [
                -79.81615257603647,
                15.799104061478241
              ],
              [
                -79.81065941197397,
                15.82288806499025
              ],
              [
                -79.77632713658335,
                15.821566804823375
              ],
              [
                -79.71178245884897,
                15.859879841546219
              ],
              [
                -79.68431663853647,
                15.887619222795582
              ],
              [
                -79.69255638463022,
                15.925919702917682
              ],
              [
                -79.74336815220835,
                15.951009161457634
              ],
              [
                -79.79967308384897,
                15.953649974523838
              ],
              [
                -79.81340599400522,
                15.921957922738992
              ],
              [
                -79.8779506717396,
                15.873089546991686
              ],
              [
                -79.9933071170521,
                15.846669270805686
              ],
              [
                -80.02901268345835,
                15.857237796601048
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -78.78618431431772,
                15.801746866575805
              ],
              [
                -78.7683315311146,
                15.788532496210467
              ],
              [
                -78.7353725467396,
                15.792496897839106
              ],
              [
                -78.7133998904896,
                15.80306825618811
              ],
              [
                -78.6859340701771,
                15.820245536022298
              ],
              [
                -78.65434837681772,
                15.833457835415754
              ],
              [
                -78.62962913853647,
                15.851953602895977
              ],
              [
                -78.61726951939585,
                15.877052289796294
              ],
              [
                -78.5925502811146,
                15.874410469920148
              ],
              [
                -78.56645775181772,
                15.882335825607315
              ],
              [
                -78.5486049686146,
                15.894223274279799
              ],
              [
                -78.5376186404896,
                15.910072113376211
              ],
              [
                -78.55821800572397,
                15.927240278941024
              ],
              [
                -78.61040306431772,
                15.929881404929533
              ],
              [
                -78.66258812291147,
                15.91799606441093
              ],
              [
                -78.66808128697397,
                15.894223274279799
              ],
              [
                -78.66258812291147,
                15.881014954648837
              ],
              [
                -78.6584682498646,
                15.869126726252432
              ],
              [
                -78.67220116002085,
                15.850632532845411
              ],
              [
                -78.69554710728647,
                15.846669270805686
              ],
              [
                -78.7188930545521,
                15.828173019302605
              ],
              [
                -78.75047874791147,
                15.814960374488653
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        },
        {
          "type": "Polygon",
          "coordinates": [
            [
              [
                -83.95132883620202,
                17.401292998073256
              ],
              [
                -83.95064219069421,
                17.39695211271075
              ],
              [
                -83.94317492079675,
                17.396624494538795
              ],
              [
                -83.9378534762418,
                17.399409317293767
              ],
              [
                -83.93081530165612,
                17.400064456068602
              ],
              [
                -83.92240389418542,
                17.403258648108352
              ],
              [
                -83.91073092055261,
                17.404650970761345
              ],
              [
                -83.89304979872644,
                17.40587948194158
              ],
              [
                -83.88978823256433,
                17.40972876349718
              ],
              [
                -83.88738497328698,
                17.41300468392818
              ],
              [
                -83.8884149415487,
                17.41808224450239
              ],
              [
                -83.89845713210046,
                17.421767482315662
              ],
              [
                -83.92214640211999,
                17.421276121571047
              ],
              [
                -83.92875536513269,
                17.42111233436233
              ],
              [
                -83.9430032594198,
                17.417754664208754
              ],
              [
                -83.9483677606826,
                17.411530543310104
              ],
              [
                -83.95072802138269,
                17.410302053812693
              ],
              [
                -83.9521013385005,
                17.408930260227887
              ],
              [
                -83.95304543987412,
                17.40747650922177
              ],
              [
                -83.95270208023418,
                17.406227581129862
              ],
              [
                -83.95064219069421,
                17.40473287176358
              ]
            ]
          ],
          "geodesic": true,
          "evenOdd": true
        }
      ],
      "coordinates": []
    }),
    wcmc = ee.FeatureCollection("projects/coral_atlas/global_datasets/wcmc_reefs_2018v4_filtered"),
    slopes_to_dl = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[-87.6239683168876, 17.139007340097205],
           [-87.61984844384072, 17.13080524193242],
           [-87.6133253115165, 17.13178951282488],
           [-87.60645885643838, 17.14753713809408],
           [-87.59053112480288, 17.197782366477522],
           [-87.57302166435366, 17.207293331189295],
           [-87.5531089446271, 17.208605150027214],
           [-87.5366294524396, 17.204013743401415],
           [-87.53216625663882, 17.214508219674055],
           [-87.53765942070132, 17.251234194817396],
           [-87.52632976982241, 17.296147992921906],
           [-87.49783398124819, 17.34891589073191],
           [-87.4707114836896, 17.39740963867979],
           [-87.46624828788882, 17.432133747407804],
           [-87.46899486992007, 17.452113495027554],
           [-87.47689129325991, 17.458008739877773],
           [-87.50676037284975, 17.456043679453384],
           [-87.51568676445132, 17.440977512273754],
           [-87.54898907158022, 17.41608285720258],
           [-87.55585552665835, 17.40232382852208],
           [-87.55516888115054, 17.387580862824613],
           [-87.57473827812319, 17.361368213203473],
           [-87.57877854046038, 17.29839347322029],
           [-87.56607559856585, 17.281347397402115],
           [-87.56161240276506, 17.261021167961594],
           [-87.57740524944475, 17.224952989685107],
           [-87.60487106975725, 17.223641286820925],
           [-87.62169388469866, 17.185269862125587],
           [-87.63062027630022, 17.1508271996967]]],
         [[[-87.44423288306785, 18.489577230268164],
           [-87.43255990943504, 18.478506442079638],
           [-87.40578073463035, 18.402945530364583],
           [-87.37625497779442, 18.38339851222495],
           [-87.35977548560692, 18.402945530364583],
           [-87.33368295631004, 18.435518962940932],
           [-87.31445688209129, 18.47004006284332],
           [-87.32132333716942, 18.517576618640888],
           [-87.32132333716942, 18.531900115601633],
           [-87.30484384498192, 18.561194438406947],
           [-87.27806467017723, 18.58007033799351],
           [-87.24441904029442, 18.62692559992364],
           [-87.23411935767723, 18.67376795019143],
           [-87.24167245826317, 18.70433861709557],
           [-87.28424447974754, 18.754410539408013],
           [-87.30553049048973, 18.76546337890831],
           [-87.32132333716942, 18.77196471085053],
           [-87.33642953834129, 18.77196471085053],
           [-87.40990060767723, 18.662709116685182],
           [-87.43942636451317, 18.56509996833982],
           [-87.45109933814598, 18.4986938129057]]],
         [[[-87.86024956365289, 16.71001957101921],
           [-87.84068016668023, 16.72350091969395],
           [-87.82969383855523, 16.73303593238031],
           [-87.81973747869195, 16.73829642485021],
           [-87.8060045685357, 16.743885538948522],
           [-87.7953615631646, 16.75276203007981],
           [-87.77579216619195, 16.757364492160757],
           [-87.76892571111382, 16.76196684292339],
           [-87.75587944646539, 16.785634316025906],
           [-87.74523644109429, 16.799438980538447],
           [-87.74077324529351, 16.814228578269024],
           [-87.73087279931343, 16.86510818177744],
           [-87.72091643945015, 16.876935848911696],
           [-87.7075268520478, 16.88613463350848],
           [-87.69928710595406, 16.892376410617928],
           [-87.69345061913765, 16.898617981240413],
           [-87.69448058739937, 16.905844804959646],
           [-87.69894378320015, 16.912085929775852],
           [-87.71061675683296, 16.9147137099696],
           [-87.73258941308296, 16.91175745467495],
           [-87.75284545556343, 16.91438523944956],
           [-87.7734448207978, 16.91931223711715],
           [-87.7895809902314, 16.920954541035172],
           [-87.79404418603218, 16.91799838367246],
           [-87.79919402734077, 16.908472672176472],
           [-87.8002239956025, 16.899603473511362],
           [-87.805717159665, 16.88613463350848],
           [-87.82013671532906, 16.86642240357797],
           [-87.83867614404, 16.84112202927289],
           [-87.84622924462593, 16.822062370894415],
           [-87.85275237695015, 16.800371462252354],
           [-87.8661419643525, 16.776705824950326],
           [-87.87541167870796, 16.75435223901299],
           [-87.8833081020478, 16.729365712246786],
           [-87.88159148827827, 16.719830516001593],
           [-87.87541167870796, 16.715227147184606],
           [-87.86751525536812, 16.71391187854921]]],
         [[[-88.06111950189178, 17.34282745234033],
           [-88.08103222161834, 17.348726222121876],
           [-88.0899586132199, 17.34151658885338],
           [-88.09957165032928, 17.31398629324399],
           [-88.11124520353115, 17.282844090838427],
           [-88.1174244335324, 17.26743760803071],
           [-88.13733701510269, 17.21582577075709],
           [-88.11948437005584, 17.17601578718398],
           [-88.09751171380584, 17.109745682775397],
           [-88.09133190423553, 17.052642608003417],
           [-88.0789722850949, 16.988298693530023],
           [-88.09339184075897, 16.942671566079895],
           [-88.11330456048553, 16.893401901905023],
           [-88.13047069818084, 16.850033949963922],
           [-88.14214367181366, 16.804026771254957],
           [-88.14077038079803, 16.781018995516305],
           [-88.1393970897824, 16.74748839208688],
           [-88.14214367181366, 16.731049664040942],
           [-88.15862316400116, 16.719870518986323],
           [-88.1661762645871, 16.69356406422363],
           [-88.16342968255584, 16.67843621202915],
           [-88.15450329095428, 16.661991537052145],
           [-88.15107006341522, 16.646203319961174],
           [-88.14832348138397, 16.63238756283982],
           [-88.12978405267303, 16.566584602069756],
           [-88.1448902538449, 16.503776118716047],
           [-88.15381664544647, 16.463612210705858],
           [-88.20119518548553, 16.389846987684198],
           [-88.2101215770871, 16.352953890519764],
           [-88.27466625482147, 16.30089641960278],
           [-88.2822193554074, 16.264645705090008],
           [-88.29114574700897, 16.20597128626344],
           [-88.30281872064178, 16.1875083035009],
           [-88.33863482995233, 16.181743882460946],
           [-88.33108172936639, 16.169873563425384],
           [-88.32833514733514, 16.14744990440092],
           [-88.32833514733514, 16.1230447999178],
           [-88.32558856530389, 16.103254670903134],
           [-88.31322894616326, 16.091379646026454],
           [-88.29537616296014, 16.08478210315108],
           [-88.2713435701867, 16.112490310178902],
           [-88.24662433190545, 16.148769013542132],
           [-88.23357806725701, 16.175808812112095],
           [-88.19031940026483, 16.239766272502404],
           [-88.15383867931764, 16.295772807588968],
           [-88.12568621349733, 16.3451960844736],
           [-88.08792071056764, 16.391313199168355],
           [-88.0357356519739, 16.436760814719214],
           [-87.99041704845827, 16.484831499059126],
           [-87.97805742931764, 16.513141525390733],
           [-87.99385027599733, 16.538156237227522],
           [-88.0474086256067, 16.592782352452932],
           [-88.0693812818567, 16.634893102992702],
           [-88.07830767345827, 16.71645635480605],
           [-88.08654741955202, 16.801271452863517],
           [-88.07350115490358, 16.85910808325624],
           [-88.05023793877783, 16.93059287796954],
           [-88.04543142022314, 16.957523238292985],
           [-88.03375844659033, 16.977225935362373],
           [-88.00835256280126, 17.00874594782144],
           [-87.99255971612158, 17.079646572192328],
           [-88.00011281670751, 17.08489739954514],
           [-88.02826528252783, 17.105899229597995],
           [-88.0433714836997, 17.130179642415904],
           [-88.0543578118247, 17.16364203997853],
           [-88.05367116631689, 17.203001839407293],
           [-88.04474477471533, 17.235795279535537],
           [-88.04817800225439, 17.248911025989738],
           [-88.04611806573095, 17.27448404997083],
           [-88.04474477471533, 17.297431178141647],
           [-88.05023793877783, 17.32758590826223]]],
         [[[-89.77661653542664, 22.48983049033281],
           [-89.77249666237977, 22.48634111236719],
           [-89.7687201120868, 22.480313797785087],
           [-89.7687201120868, 22.472699972744053],
           [-89.7632269480243, 22.46064389381697],
           [-89.75910707497742, 22.449221377867392],
           [-89.7525839426532, 22.443827084893886],
           [-89.73919435525086, 22.42669088053567],
           [-89.72443147683289, 22.41431341721879],
           [-89.71447511696961, 22.406378565702536],
           [-89.70451875710633, 22.39431672366349],
           [-89.68220277810242, 22.37495210512252],
           [-89.66023012185242, 22.37145983790974],
           [-89.64718385720398, 22.379714146472402],
           [-89.6368841745868, 22.461913004155484],
           [-89.70108552956727, 22.55325837394097],
           [-89.74468751931336, 22.558331346303664],
           [-89.76769014382508, 22.52725646341206],
           [-89.7745565989032, 22.507910403194202],
           [-89.7742132761493, 22.5015668432337],
           [-89.77867647195008, 22.493319780321517]]],
         [[[-81.12337597502493, 14.414932964038076],
           [-81.12612255705618, 14.468128907863564],
           [-81.13024243010305, 14.488738913405179],
           [-81.14603527678274, 14.481425904768193],
           [-81.17762097014212, 14.451506542029078],
           [-81.18860729826712, 14.39764154622128],
           [-81.19135388029837, 14.377023104899228],
           [-81.20577343596243, 14.348420182979268],
           [-81.21263989104055, 14.335780518537499],
           [-81.25246533049368, 14.313160393384758],
           [-81.2538386215093, 14.277229629978802],
           [-81.24628552092337, 14.259927586616133],
           [-81.23049267424368, 14.235968719119027],
           [-81.21401318205618, 14.220660333774935],
           [-81.2153864730718, 14.212672938547984],
           [-81.22067018532898, 14.177971106652345],
           [-81.1719183542743, 14.130033486270886],
           [-81.16367860818055, 14.140687164651164],
           [-81.16436525368836, 14.156666746383648],
           [-81.16985841775086, 14.173310948736123],
           [-81.17329164528992, 14.193948063814721],
           [-81.16505189919617, 14.215914539897128],
           [-81.16505189919617, 14.233219958086094],
           [-81.17603822732117, 14.247196443489726],
           [-81.16917177224305, 14.277143139171573],
           [-81.15406557107117, 14.295109245462998],
           [-81.13621278786805, 14.312408583829695],
           [-81.12041994118836, 14.327710734012827],
           [-81.11836000466492, 14.402875682934454]]],
         [[[-80.23292752708052, 14.412258881259636],
           [-80.27206632102583, 14.361045179095083],
           [-80.22331448997114, 14.349736676676619],
           [-80.17936917747114, 14.355058396028406],
           [-80.15533658469771, 14.351067118371192],
           [-80.14503690208052, 14.355723602054034],
           [-80.12649747336958, 14.363705920164282],
           [-80.11894437278364, 14.37168795350224],
           [-80.11551114524458, 14.379004567107188],
           [-80.11345120872114, 14.391641790018495],
           [-80.11757108176802, 14.398957750122033],
           [-80.1271841188774, 14.412923916993252],
           [-80.13405057395552, 14.412258881259636],
           [-80.13885709251021, 14.405608414833864],
           [-80.14709683860396, 14.398957750122033],
           [-80.17044278586958, 14.406273470400695],
           [-80.21370145286177, 14.415584040089085]]],
         [[[-80.091660787085, 13.574384565184252],
           [-80.09183244846196, 13.57121408633748],
           [-80.08822755954594, 13.566708596178799],
           [-80.08633928439946, 13.556696089767618],
           [-80.08939418260027, 13.52772550707171],
           [-80.0881925529616, 13.520882551897902],
           [-80.0823560661452, 13.51504084930146],
           [-80.07583293382098, 13.507529878470308],
           [-80.06553325120379, 13.494176457487525],
           [-80.05557689134051, 13.491171834813825],
           [-80.04579219285418, 13.49234030367934],
           [-80.03858241502215, 13.514540125273895],
           [-80.0442472404616, 13.526557211568319],
           [-80.05420360032488, 13.539741928084588],
           [-80.06244334641863, 13.545416138201336],
           [-80.07548961106707, 13.561770456779252],
           [-80.0878492302077, 13.570781539008518]]],
         [[[-81.37679199139474, 13.441534226946176],
           [-81.38812164227365, 13.420830397044815],
           [-81.38606170575021, 13.402796574330374],
           [-81.40108428164987, 13.393359136332103],
           [-81.4085519086327, 13.363213666580082],
           [-81.41653326159548, 13.323378478950705],
           [-81.4131842033088, 13.311604911599341],
           [-81.38640502850411, 13.310602614185363],
           [-81.36014239235087, 13.32229583904049],
           [-81.3469229118049, 13.34868699708386],
           [-81.34760955731271, 13.413149489884466],
           [-81.34280303875802, 13.455224487379267],
           [-81.31877044598458, 13.50730709887627],
           [-81.33216003338693, 13.519324549849951],
           [-81.3469229118049, 13.506639444952302],
           [-81.35413268963693, 13.490615190341366],
           [-81.35687927166818, 13.476593085489649],
           [-81.3634024039924, 13.46423959741031],
           [-81.36855224530099, 13.453888886653758]]]]),
    mid_mask = 
    /* color: #5000ff */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[-80.09904129008585, 13.582730761549266],
           [-80.0853083799296, 13.585400511676912],
           [-80.0743220518046, 13.574721330851832],
           [-80.05303604106241, 13.548688814694922],
           [-80.03861648539835, 13.538007983151568],
           [-80.04204971293741, 13.678155617594749],
           [-80.04548294047648, 13.710844763953691],
           [-80.10934097270304, 13.714847204119161],
           [-80.19791824321085, 13.689497264780842],
           [-80.20547134379679, 13.556699123513974],
           [-80.17182571391398, 13.485932070211936],
           [-80.14367324809366, 13.416479865647345],
           [-80.07912857035929, 13.377738173987252],
           [-80.06745559672648, 13.39443794404866],
           [-79.99999361179204, 13.451205449829853],
           [-79.99450044772954, 13.46856787269564],
           [-80.01115160129399, 13.47674780842217],
           [-80.03775911472172, 13.483258169502568],
           [-80.06041841647954, 13.482423517735896],
           [-80.06059007785649, 13.487431384603342],
           [-80.07003145358891, 13.491437602513232],
           [-80.0774128927979, 13.49944983669708],
           [-80.0858243002686, 13.510132397184043],
           [-80.09063081882329, 13.521148286497557],
           [-80.09286241672368, 13.53366572432965],
           [-80.09045915744633, 13.545681845415027],
           [-80.08891420505375, 13.554026016789397],
           [-80.08891420505375, 13.562536769800296],
           [-80.09354906223149, 13.566207980883176],
           [-80.10127382419438, 13.570212873692105]]],
         [[[-80.36751968364054, 13.375066103311452],
           [-80.25628311137491, 13.385086215517594],
           [-80.31670791606241, 13.581395875214085]]],
         [[[-87.07475343010528, 21.649854588756686],
           [-87.05140748283965, 21.621770765082577],
           [-86.99853577873809, 21.59815059821531],
           [-86.97930970451934, 21.58282734711877],
           [-86.89828553459746, 21.572610945613466],
           [-86.82138123772246, 21.55153734296251],
           [-86.80352845451934, 21.538125274297588],
           [-86.7904821898709, 21.507464464896966],
           [-86.76713624260528, 21.423113916160034],
           [-86.74585023186309, 21.36981124487418],
           [-86.74516358635528, 21.334637976597303],
           [-86.7410437133084, 21.325683433678567],
           [-86.68748536369903, 21.325043802560206],
           [-86.64754952971954, 21.489671978642374],
           [-86.65578927581329, 21.709291424088384],
           [-86.69012155120392, 21.724601254118774],
           [-87.01009835784454, 21.67100972456287]]]]),
    rf_to_sl = 
    /* color: #0b4a8b */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-87.4723096898445, 17.466748146514185],
          [-87.47608624013746, 17.47002304296321],
          [-87.48123608144606, 17.471332985048363],
          [-87.48501263173902, 17.47002304296321],
          [-87.48981915029371, 17.467730621633944],
          [-87.49256573232496, 17.464783180371636],
          [-87.4949689916023, 17.46183569140418],
          [-87.49359570058668, 17.45626808210973],
          [-87.49050579580152, 17.452665420726714],
          [-87.48981915029371, 17.44349468859006],
          [-87.49290905507887, 17.438581606625448],
          [-87.49840221914137, 17.43465104576685],
          [-87.50698528798902, 17.43727142908266],
          [-87.51385174306715, 17.440874394679994],
          [-87.51934490712965, 17.439891774757342],
          [-87.52689800771559, 17.431047957255792],
          [-87.54681072744215, 17.42056584075419],
          [-87.5495573094734, 17.413359036575944],
          [-87.55299053701246, 17.40549674411932],
          [-87.55642376455152, 17.394685539751276],
          [-87.55333385976637, 17.390426404956177],
          [-87.55665335343694, 17.384600662007937],
          [-87.56248984025335, 17.377720092690247],
          [-87.56866964982366, 17.372149918597334],
          [-87.57313284562444, 17.367562589190726],
          [-87.57484945939397, 17.364285854996837],
          [-87.57587942765569, 17.3505229315933],
          [-87.57484945939397, 17.345279641403774],
          [-87.57690939591741, 17.33839759559684],
          [-87.57931265519476, 17.33085982073457],
          [-87.58068594621038, 17.3249604767091],
          [-87.57725271867132, 17.314144520568984],
          [-87.57828268693304, 17.29611651265944],
          [-87.57450613664007, 17.291527283066518],
          [-87.57141623185491, 17.283331945616485],
          [-87.56214651749944, 17.259071609619635],
          [-87.5655797450385, 17.25185846159542],
          [-87.56660971330022, 17.245628697712224],
          [-87.56283316300726, 17.240054520206186],
          [-87.56660971330022, 17.23316853918204],
          [-87.57278952287054, 17.22890566037102],
          [-87.58068594621038, 17.22497060801583],
          [-87.58034262345647, 17.219723741205673],
          [-87.57210287736272, 17.208245700930608],
          [-87.56626639054632, 17.209885464582925],
          [-87.56042990372991, 17.210869315797275],
          [-87.55699667619085, 17.21578849336736],
          [-87.55287680314397, 17.209229560866202],
          [-87.54292044328069, 17.208573654823862],
          [-87.53433737443304, 17.21021341556914],
          [-87.53433737443304, 17.219067872382663],
          [-87.53502401994085, 17.23972662217037],
          [-87.53742727921819, 17.24792389834757],
          [-87.53124746964788, 17.271857860440964],
          [-87.52781424210882, 17.289560435351778],
          [-87.5267842738471, 17.3003778376511],
          [-87.52026114152288, 17.309227966424352],
          [-87.51888785050726, 17.320699721510938],
          [-87.505154940351, 17.337086700464788],
          [-87.494168612226, 17.356749143983315],
          [-87.4828389613471, 17.38066893978224],
          [-87.46601614640569, 17.405896022361837],
          [-87.46155295060491, 17.43013695086172],
          [-87.46292624162054, 17.451754522314324],
          [-87.47082266496038, 17.463217345843777]]]),
    slopes_to_brs = 
    /* color: #ffc82d */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-89.77787855607188, 22.577683091838818],
          [-89.81427076798595, 22.546295485576714],
          [-89.81530073624766, 22.532343145978913],
          [-89.80980757218516, 22.501579600582534],
          [-89.8005378578297, 22.49016046055098],
          [-89.78096846085704, 22.482547177001766],
          [-89.76895216447032, 22.44733029606348],
          [-89.7620857093922, 22.464463950735595],
          [-89.76654890519298, 22.479692087720633],
          [-89.7789085243336, 22.499676476031347],
          [-89.78268507462657, 22.519023688567447],
          [-89.7624290321461, 22.544075889511088],
          [-89.75796583634532, 22.56753838439019],
          [-89.76654890519298, 22.582755165524624]]]),
    slopelag_to_brs = 
    /* color: #00ffff */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-87.00374229116267, 16.05522951107638],
          [-86.98915107412165, 16.052260104177833],
          [-86.98571784658259, 16.047310994282736],
          [-86.9754181639654, 16.049455623670276],
          [-86.96632011098689, 16.054239713697374],
          [-86.96426017446345, 16.05506454518826],
          [-86.96202857656306, 16.056549233260327],
          [-86.96065528554743, 16.05852880013195],
          [-86.95945365590876, 16.06364259009054],
          [-86.95722205800837, 16.069745973806903],
          [-86.9647751585943, 16.070900646958066],
          [-86.9670067564947, 16.06760156302806],
          [-86.96906669301814, 16.07320997314892],
          [-86.97524650258845, 16.07700380795502],
          [-86.98571784658259, 16.08030273589526],
          [-86.99241264028376, 16.077828545072574],
          [-86.99464423818415, 16.075354323455826],
          [-86.99842078847712, 16.07502442491382],
          [-87.00202567739314, 16.070900646958066],
          [-87.0032273070318, 16.06694173967608]]]),
    trf_to_orf = 
    /* color: #bf04c2 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[-86.99416716765425, 16.096133022948216],
           [-86.9855840988066, 16.083597804114987],
           [-86.96292479704879, 16.080628820653253],
           [-86.8812139816191, 16.111965852425],
           [-86.86267455290816, 16.128786849061765],
           [-86.88018401335738, 16.134723330544514],
           [-86.94301207732222, 16.128457039318928]]],
         [[[-86.58929055142086, 16.286584959184744],
           [-86.57796090054195, 16.31426483051244],
           [-86.4792970150544, 16.357264481942284],
           [-86.33180016588078, 16.41423430732323],
           [-86.27875680040226, 16.422302730414042],
           [-86.23463982652531, 16.42394930623234],
           [-86.21713036607609, 16.422961362415073],
           [-86.19996422838078, 16.426583798528654],
           [-86.1929261119257, 16.424113963047034],
           [-86.18588799547062, 16.431852675978124],
           [-86.1815964610468, 16.435474946338868],
           [-86.19135544663662, 16.448920627301128],
           [-86.2943522728085, 16.445627885062816],
           [-86.354777077496, 16.441676520644453],
           [-86.60059616929287, 16.327710993728605],
           [-86.61089585191006, 16.282897080950114],
           [-86.61089585191006, 16.259827102890878],
           [-86.58960984116787, 16.262463809013216]]],
         [[[-85.93789875058613, 16.412721704853517],
           [-85.89635669736347, 16.461786094728325],
           [-85.83455860166035, 16.495695835407943],
           [-85.80709278134785, 16.50359628102198],
           [-85.81739246396504, 16.529270499558226],
           [-85.84554492978535, 16.529928767985737],
           [-85.91146289853535, 16.509850571577644],
           [-85.96055805234394, 16.461127594424077],
           [-85.98905384091816, 16.405805593442548],
           [-85.97703754453144, 16.386043920996386],
           [-85.93686878232441, 16.38999641590916],
           [-85.942018623633, 16.3955956464206]]]]),
    dl_to_deep = 
    /* color: #0a00ff */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-83.19302375697336, 14.454235050264513],
          [-82.98703010462961, 14.12286429051773],
          [-82.89501960658274, 14.213407485718934],
          [-82.85244758509836, 14.256003525863738],
          [-82.75357063197336, 14.298591521437883],
          [-82.75219734095774, 14.370440460951638],
          [-82.75357063197336, 14.405026171016626],
          [-82.74121101283274, 14.47684088560965],
          [-82.68353279017649, 14.555278548209033],
          [-82.68490608119211, 14.601796202814427],
          [-83.08590705775461, 14.69347359742251]]]),
    srs_to_rs = 
    /* color: #89ffab */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[-81.69100291118053, 12.621112833122647],
           [-81.70679575786022, 12.608381497732598],
           [-81.69340617045788, 12.591628776619386],
           [-81.71194559916881, 12.571691612774952],
           [-81.73803812846569, 12.475167210114044],
           [-81.73391825541881, 12.468798012441509],
           [-81.70061594828991, 12.485893925774935],
           [-81.66113383159069, 12.54488290377665],
           [-81.66010386332897, 12.598832580875039]]],
         [[[-81.49934298381237, 12.450779039751465],
           [-81.47822863444713, 12.44541501078072],
           [-81.47428042277721, 12.422449009337402],
           [-81.46037585124401, 12.404175340460833],
           [-81.46535403117565, 12.385229724894028],
           [-81.44732958659557, 12.376007909686988],
           [-81.43994814738659, 12.379864344772129],
           [-81.43634325847057, 12.388583031446576],
           [-81.43651491984753, 12.398139718581866],
           [-81.44595629557995, 12.419263783239304],
           [-81.46398074016003, 12.428651706110085],
           [-81.46277911052135, 12.453963879495387],
           [-81.47428005423522, 12.466535497858754],
           [-81.49058825358776, 12.467708528735699]]],
         [[[-82.3974885365771, 9.41062863910445],
           [-82.36590284321773, 9.40995123391333],
           [-82.34599012349116, 9.42891807720829],
           [-82.31852430317866, 9.41198344550442],
           [-82.24642652485835, 9.36862701081178],
           [-82.20728773091304, 9.3510119114845],
           [-82.15922254536616, 9.335428580148445],
           [-82.14823621724116, 9.326620301974124],
           [-82.14823621724116, 9.283930884075186],
           [-82.15098279927241, 9.261567683664348],
           [-82.11321729634273, 9.16464407578863],
           [-82.05004590962398, 9.163288312607433],
           [-82.02326673481929, 9.144985003471456],
           [-81.94361585591304, 9.137527829780403],
           [-81.89143079731929, 9.12193505319069],
           [-81.8481721303271, 9.06769400887773],
           [-81.71015638325679, 8.970717753370787],
           [-81.51240247700679, 9.048029603713363],
           [-81.48974317524898, 9.10430761572759],
           [-82.20866102192866, 9.443142525567112],
           [-82.27045911763179, 9.476330619539521],
           [-82.37482923481929, 9.466171339197171],
           [-82.41808790181148, 9.428240707889108]]],
         [[[-80.11867594561974, 9.426717393705923],
           [-80.01430582843224, 9.226157145281459],
           [-79.86324381671349, 9.291216330044232],
           [-79.70943522296349, 9.413169668425422],
           [-79.60781168780724, 9.518827783675759],
           [-79.53365397296349, 9.53778861365043],
           [-79.20406412921349, 9.507992551144179],
           [-79.03652262530724, 9.551331418310024],
           [-78.96373820147912, 9.567582072882407],
           [-78.84426188311974, 9.577061262707591],
           [-78.81748270831505, 9.565550783519164],
           [-78.80409433711971, 9.587894582172833],
           [-78.77147745929162, 9.601435106655437],
           [-78.66882395587365, 9.595341809927334],
           [-78.6767200318449, 9.575704972248824],
           [-78.66264414630334, 9.518827783675759],
           [-78.63191675982873, 9.522553659324023],
           [-78.60118937335412, 9.518827783675759],
           [-78.58196329913537, 9.470405180742215],
           [-78.57200693927209, 9.435523129989365],
           [-78.35674357257287, 9.32712924978433],
           [-78.20980143390099, 9.251233465323725],
           [-77.73559638510169, 8.865841065697893],
           [-77.20645069057628, 8.417202812831679],
           [-77.06912158901378, 8.251430749790336],
           [-77.00595020229503, 8.292200875751039],
           [-77.10482715542003, 8.498704117333457],
           [-77.67062305385753, 9.114824562664737],
           [-78.45065235073253, 9.599919187659989],
           [-78.93679737026378, 9.691982703644285],
           [-79.57125781948253, 9.74341897627511]]]]),
    sheltered = 
    /* color: #00ff19 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[-81.75252118129059, 8.978996214139737],
           [-81.78548016566559, 9.016975163542643],
           [-81.84178509730621, 9.045456755095607],
           [-81.86925091761871, 9.086140831736879],
           [-81.90358319300934, 9.121396628873804],
           [-81.94066205043121, 9.133599747867587],
           [-82.04640545863434, 9.148514103572314],
           [-82.12056317347809, 9.16613935421292],
           [-82.13978924769684, 9.219009850732768],
           [-82.15214886683746, 9.300333601179235],
           [-82.16038861293121, 9.332857818731114],
           [-82.30046429652496, 9.396542280241425],
           [-82.32655682582184, 9.41144546572305],
           [-82.34852948207184, 9.422283742567988],
           [-82.42406048793121, 9.370798903924394],
           [-82.43367352504059, 9.247475303108235],
           [-82.22493329066559, 9.079360472556264],
           [-81.89122357386871, 8.957292170151007],
           [-81.78548016566559, 8.936943451844105]]],
         [[[-79.05887169645328, 9.42880795162807],
           [-78.97510094450016, 9.40103471124572],
           [-78.5926393966486, 9.409841102285144],
           [-78.57547325895328, 9.43016268670915],
           [-78.5933260421564, 9.493829221605207],
           [-78.60568566129703, 9.514823042065105],
           [-78.66748375700016, 9.514145842158792],
           [-78.82060570524234, 9.561546590727865],
           [-78.83777184293766, 9.57305720552989],
           [-78.85356468961734, 9.574411369875714],
           [-78.96342797086734, 9.566286302848242],
           [-78.97441429899234, 9.563577904011499],
           [-79.13302941129703, 9.51617743785301]]]]),
    sg_to_ca = 
    /* color: #069300 */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[-83.34731130447854, 16.101448636164093],
           [-83.33220510330666, 16.07901723355444],
           [-83.27864675369729, 16.072419280269386],
           [-83.18526296463479, 16.050644481667852],
           [-83.11591176834573, 16.002467532385662],
           [-83.10217885818948, 15.983985617407994],
           [-83.07471303787698, 15.987946171593526],
           [-83.07677297440041, 16.04866483640818],
           [-83.12895803299416, 16.09551115849026],
           [-83.22096853104104, 16.115961722658078],
           [-83.32465200272073, 16.108705312121124]]],
         [[[-83.34868459549416, 16.048004950282337],
           [-83.33014516678323, 16.012367855125554],
           [-83.3067992195176, 16.021607713442116],
           [-83.32602529373635, 16.05856286590032]]],
         [[[-83.28551320877541, 15.910701237957905],
           [-83.23607473221291, 15.890890055945917],
           [-83.23126821365823, 15.89617322860383],
           [-83.27315358963479, 15.96484183363008],
           [-83.30542592850198, 15.970783203841867]]],
         [[[-83.36035756912698, 15.906078803381922],
           [-83.30885915604104, 15.81625044658881],
           [-83.27864675369729, 15.827481178073885],
           [-83.32259206619729, 15.912021914027262],
           [-83.34113149490823, 15.925228197301548],
           [-83.3617308601426, 15.925888488672864]]],
         [[[-83.43717315471731, 15.848043536369127],
           [-83.43871810710989, 15.83441932242148],
           [-83.42721679485403, 15.833923879140706],
           [-83.42386939800345, 15.842676531522876],
           [-83.43554237163626, 15.84796096814458]]],
         [[[-83.01850063792537, 15.699001328638508],
           [-83.00648434153865, 15.691399328098223],
           [-82.98554165355037, 15.694374057714837],
           [-82.95773251048396, 15.716187415123581],
           [-82.94743282786678, 15.754189953432586],
           [-82.95155270091365, 15.77599689588875],
           [-82.96837551585506, 15.783926111993653],
           [-83.02124721995662, 15.710899542933898]]],
         [[[-82.92511684886287, 15.714865459948475],
           [-82.91207058421443, 15.72742368752314],
           [-82.9103539704449, 15.736015712472499],
           [-82.92408688060115, 15.738989790383153],
           [-82.93610317698787, 15.725771333428638]]],
         [[[-82.88117153636287, 15.71651790257634],
           [-82.88735134593318, 15.696687706304182],
           [-82.88220150462459, 15.692060382873983],
           [-82.87396175853084, 15.692060382873983],
           [-82.87052853099178, 15.69966235876834],
           [-82.87121517649959, 15.709908051613896],
           [-82.86778194896053, 15.727093217777714],
           [-82.88014156810115, 15.725440860999573]]],
         [[[-83.0610940448328, 15.524682701378632],
           [-83.06006407657108, 15.51781855554493],
           [-83.05165266910038, 15.504172286367105],
           [-83.03611731448612, 15.499209783075262],
           [-83.03337073245487, 15.505330186647477],
           [-83.04006552615604, 15.523028711220745],
           [-83.05800414004764, 15.530140774789107]]],
         [[[-82.97315429221501, 15.270094536302604],
           [-82.97830413352361, 15.263470396793164],
           [-82.97555755149236, 15.23813113535056],
           [-82.97006438742986, 15.211629295563817],
           [-82.95650313865056, 15.207819381926628],
           [-82.94877837668767, 15.21411398473768],
           [-82.94860671531072, 15.247902846449687],
           [-82.95718978415837, 15.26794171389077],
           [-82.96800445090642, 15.27290973228893]]],
         [[[-82.72500432885825, 15.17198285076699],
           [-82.71401800073325, 15.120284982983454],
           [-82.68655218042075, 15.059291809353535],
           [-82.67419256128012, 15.0367464281012],
           [-82.61514104760825, 15.034093873547583],
           [-82.58904851831137, 15.084486763878976],
           [-82.57806219018637, 15.124262190130032],
           [-82.52313054956137, 15.128239322660665],
           [-82.524503840577, 15.142821503271824],
           [-82.57531560815512, 15.235593631300866],
           [-82.63024724878012, 15.276665378795537],
           [-82.66595281518637, 15.27269104462141],
           [-82.72363103784262, 15.227643333822293]]],
         [[[-82.55883611596762, 15.053987228363082],
           [-82.513517512452, 15.047356316375367],
           [-82.50939763940512, 15.076530784801395],
           [-82.5519696608895, 15.087138690744567]]],
         [[[-82.64398015893637, 14.920002895281204],
           [-82.62200750268637, 14.926637754040113],
           [-82.63162053979575, 14.95317514015241],
           [-82.65221990503012, 14.946541101128075]]],
         [[[-82.67693914331137, 14.821783093446092],
           [-82.67007268823325, 14.800540509450478],
           [-82.63024724878012, 14.793901775026471],
           [-82.62612737573325, 14.85098824332898],
           [-82.66457952417075, 14.858952599510927]]],
         [[[-82.458585871827, 15.079182810902124],
           [-82.38030828393637, 14.99695464893193],
           [-82.34185613549887, 15.019504234064351],
           [-82.32949651635825, 15.149449435243893],
           [-82.39404119409262, 15.173308271000332],
           [-82.45171941674887, 15.156077159637046]]],
         [[[-81.25303252145861, 14.304735990334027],
           [-81.25577910348986, 14.234197173227445],
           [-81.22419341013048, 14.212898100963557],
           [-81.23655302927111, 14.172956936996732],
           [-81.19398100778673, 14.119691115151587],
           [-81.13492949411486, 14.111700166197407],
           [-81.15003569528673, 14.183608602443112],
           [-81.14179594919298, 14.199585162170166],
           [-81.15552885934923, 14.26481107041325],
           [-81.09647734567736, 14.322034587397168],
           [-81.11158354684923, 14.516219222645924],
           [-81.16102202341173, 14.482980451730308],
           [-81.19810088083361, 14.37658296078335],
           [-81.26264555856798, 14.322034587397168]]],
         [[[-80.41257841989611, 14.283443581185837],
           [-80.40296538278673, 14.259487212849155],
           [-80.36725981638048, 14.259487212849155],
           [-80.33979399606798, 14.27545840819574],
           [-80.28486235544298, 14.320703973401871],
           [-80.16538603708361, 14.332679215286932],
           [-80.10084135934923, 14.35795818090228],
           [-80.09260161325548, 14.39653636012595],
           [-80.12830717966173, 14.436437805910778],
           [-80.14890654489611, 14.417818020171005],
           [-80.21757109567736, 14.445747114794113],
           [-80.21894438669298, 14.484310098280753],
           [-80.26563628122423, 14.484310098280753],
           [-80.31507475778673, 14.435107872848548],
           [-80.37824614450548, 14.372592067088132],
           [-80.41120512888048, 14.306066698949056]]],
         [[[-89.75578515400576, 22.526978587735854],
           [-89.75887505879092, 22.522538738867695],
           [-89.7629949318378, 22.51905018609654],
           [-89.76814477314639, 22.52031876093068],
           [-89.77054803242373, 22.507632488617993],
           [-89.76608483662295, 22.49938578735845],
           [-89.75853173603701, 22.492407425336562],
           [-89.75029198994326, 22.47940135706912],
           [-89.74720208515811, 22.470518461967057],
           [-89.7468587624042, 22.46385591679965],
           [-89.73243920674014, 22.442279763249278],
           [-89.7241268286269, 22.427903457660417],
           [-89.70627404542377, 22.42853816408442],
           [-89.7021541723769, 22.42250833589343],
           [-89.70112420411517, 22.41679562553179],
           [-89.68910790772846, 22.41520871984002],
           [-89.67915154786517, 22.41140007221291],
           [-89.66713525147846, 22.4110826801974],
           [-89.64996911378314, 22.418699888429426],
           [-89.63795281739642, 22.425999320976473],
           [-89.63417626710346, 22.448529930595022],
           [-89.63451958985736, 22.46249072523036],
           [-89.64104272218158, 22.48438095746252],
           [-89.6640453466933, 22.50785359207844],
           [-89.67297173829486, 22.504681847168126],
           [-89.68910790772846, 22.517368390253484],
           [-89.6966610083144, 22.527516786342833],
           [-89.7083339819472, 22.53956703838646],
           [-89.71693228663169, 22.534208165864204],
           [-89.723112096202, 22.531988375456553],
           [-89.72688864649497, 22.52786581289898],
           [-89.72070883692466, 22.52754868760569],
           [-89.72414206446372, 22.522157446236278],
           [-89.72929190577231, 22.51962031868154],
           [-89.73787497461997, 22.518986029514323],
           [-89.74027823389731, 22.515497387057035],
           [-89.74783133448325, 22.518351737435804],
           [-89.75229453028403, 22.51771744244606],
           [-89.7557277578231, 22.519937462173402]]],
         [[[-81.48045323139972, 12.46905263975457],
           [-81.49521610981769, 12.462683291775537],
           [-81.50276921040363, 12.44390956661961],
           [-81.50448582417316, 12.422787503245015],
           [-81.49212620503253, 12.397304636242275],
           [-81.46912358052082, 12.390598204302247],
           [-81.45573399311847, 12.378190850633052],
           [-81.44818089253253, 12.378861533479952],
           [-81.43719456440753, 12.38992755162156],
           [-81.43822453266925, 12.409375778858072],
           [-81.46431706196613, 12.429493106163985],
           [-81.45951054341144, 12.457319508937434],
           [-81.47496006733722, 12.467711737399156]]],
         [[[-79.95279501368645, 15.759964356835587],
           [-79.8237056582177, 15.734851145201592],
           [-79.68362997462395, 15.841891103535353],
           [-79.67401693751458, 15.93963112955873],
           [-79.75092123438958, 15.968679808297393],
           [-79.89237020899895, 15.943592560894906],
           [-79.9885005800927, 15.860386098308215]]],
         [[[-78.83905600001458, 15.77318058933414],
           [-78.7525386660302, 15.750712482105824],
           [-78.57950399806145, 15.841891103535353],
           [-78.50671957423333, 15.919822799820611],
           [-78.54654501368645, 15.970000102717679],
           [-78.7085933535302, 15.964718872802731],
           [-78.84729574610833, 15.861707104485408]]]]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
///////////////////////////////
// Global coral atlas project - Mesoamerican reefs
// Contact: mitchell.lyons@gmail.com
// Region coordinator: 
// Description:
// - Developing a process to combine OBIA and supervised classification
// - This script loads the raw classification data (from *_classification script)
// - Then applied some cleanup and object-based relational rules
///////////////////////////////

// Table of contents 
// 1. Setting constants
// 2. Data loads & vis
// 3. OBIA clean up rules
// 4. Export

// Load and libraries needed
var map_palettes = require('users/mitchest/global_reefs_modules:colour_pals');
var pkg_vis = require('users/mitchest/global_reefs_modules:pkg_vis');
var param_module = require('users/mitchest/global_reefs_modules:reef_params');

// ###########################################
// SENSOR GENERICS
var sensor_params = param_module.dove;         //<------------ THIS IS WHERE YOU CHOOSE THE SENSOR
// REGION AND SENSOR SPECIFIC LOAD PATHS
var region_params = param_module.mesoamerica;  //<------------ THIS IS WHERE YOU CHOOSE THE REGION
//  ^^ all the data paths are in this module ^^
// ###########################################

// 1. Setting constants

// These will get written to the asset metadata 

var vars = {
  
  // analysis type
  geomorphic: false, // map geomorphic zonation (when set to true) or benthic habitat (when set to false)

  // analysis parameters
  image_data_scale: sensor_params.pixel,
  small_object_geo: ee.Number(400).int(), // smallest object szie in pixels (geomorphic)
  small_object_benthic: ee.Number(130).int(), // smallest object szie in pixels (benthic)
  smooth_radius: ee.Number(3), // radius in pixels for initial smooth 
  dist_to_land_ORF: 1000, //distance to land in meters to convert terrestrial reef flat to ORF
  dist_to_land_RC: 500, //distance to land in meters to convert reef crest to TRF
  wave_height: 0.5, //cut off height for waves in metres, Hs95 threshold
  geo_depth_cutoff: 1500, //depth in centimetres
  shallowlag_depth_cutoff: 500, //depth in centimetres
  benthic_depth_cutoff: 1000, //depth in centimetres
  
  //############
  // Clean-up stage selection
  cleanup_stage: 2, // set to 1, 2 or 3
  geo_refinement: false, // set to true to apply the refinement_mask (the other stage 3 masks will still run)
  
  /*
  - GEOMORPHIC 1: The first pass does a small object filter, just to generally clean noise and reduce the amount of cleaning needed
  -            2: The second pass runs the OBIA cleanup rules
  -            3: The third pass is the MANUAL cleanup stage, which includes AT LEAST the no_reef masking
                        - see below where it starts/ends (only that section is run)
                        - please put region specific stuff in here ONLY

  - BENTHIC 1: This is the main benthic stge - it does noise removal, no data reclaim and OBIA rules - review those if needed
            2: The second mas is the MANUAL stage - it's optional, but shuold include ALL region specific stuff
                        - see below where it starts/ends (only that section is run)
                        - please put region specific stuff in here ONLY
  */
  
  // DON'T TOUCH --->
  obia_2nd_pass: null,
  obia_clean: null, // run object-based relationship rules + small object clean up
  fast_clean: null, // run a faster (but less precise) version of the OBIA clean; only applies to geomorphic (`obia_clean: true` also)
  manual_clean: false, // apply manual touch ups
  // --------------<
  //############
  
  reproject_display: true,
  
  // export options
  do_export: true, // export the results?
  geomorph_output_name: region_params.sname + '_geo_clean', // DO NOT CHANGE - change in the pop up dialouge if you must
  benthic_output_name: region_params.sname + '_benthic_clean', // DO NOT CHANGE - change in the pop up dialouge if you must
  asset_output: region_params.asset // asset path

};


// Clean up stage auto-parameterisation (DON'T TOUCH) --->

if (vars.geomorphic) {
  var temp_outname = vars.geomorph_output_name;
  if (vars.cleanup_stage == 1) {
    vars.obia_2nd_pass = false;
    vars.obia_clean = false;
    vars.fast_clean = true;
    vars.manual_clean = false;
    vars.geomorph_output_name = temp_outname + '1';
  } else if (vars.cleanup_stage == 2) {
    vars.obia_2nd_pass = true;
    vars.obia_clean = true;
    vars.fast_clean = true;
    vars.manual_clean = false;
    vars.geomorph_output_name = temp_outname + '2';
  } else if (vars.cleanup_stage == 3) {
    vars.manual_clean = true;
    vars.obia_2nd_pass = false;
    vars.obia_clean = false;
    vars.fast_clean = false;
    vars.do_export = false;
    vars.geomorph_output_name = temp_outname + '3';
  }
}

if (!vars.geomorphic) {
  var temp_outname = vars.benthic_output_name;
  if (vars.cleanup_stage == 1) {
    vars.obia_2nd_pass = true,
    vars.obia_clean = true, 
    vars.fast_clean = false, 
    vars.manual_clean = false;
    vars.benthic_output_name = temp_outname + '1';
  } else if (vars.cleanup_stage == 2) {
    vars.manual_clean = true;
    vars.obia_2nd_pass = false,
    vars.obia_clean = false, 
    vars.fast_clean = false,
    vars.do_export = false;
    vars.benthic_output_name = temp_outname + '2';
  }
}

//Region extent is created in map viewer and exported to GEE asset
var region_extent = ee.FeatureCollection(region_params.extent_mask).geometry();
Map.addLayer(region_extent, {}, "Manual reef outline", false);
// -----------------------------------------<

//################################################################################################
//START OF CLEAN 3 - Manual Cleanup
//Review everything in this section
//This is the section to add/remove manual cleanups
//You MUST review it for each region

//###############################################################################################

if (vars.manual_clean && vars.geomorphic) {
  
  print("Doing GEOMORPHIC manual clean ups - make sure this is what you want to do");
  print("Export the manual map, check 'manual' layer in the viewer for effects");
  
  var depth = ee.Image(region_params.pixels).select('depth');
  
  // define the manually edited map - uses the output from the second pass of cleaning
  var man_geo = ee.Image(region_params.geo_map_clean2);
  
  // import the mid mask from asset ****only use ee.FC if mid_mask created in map viewer****
  //var mid_mask = ee.FeatureCollection(region_params.mid_mask).geometry();
  //Map.addLayer(mid_mask, {color: 'red'}, "mid mask import", true, 0.4);
  var midmask = ee.Image().byte().paint(ee.Feature(mid_mask.dissolve(),{zone: 1}), "zone").clip(mid_mask.dissolve());
  
  // the "MID MASK" CLEAN
  man_geo = man_geo.where({
    test: midmask.eq(1),
    value: ee.Image(2)
  });
  
  // WAVE clean (un-comment this sectio nbased on whether you have waves or not)
  /*
  //var waves = ee.Image(region_params.waves)
  man_geo = man_geo.where({
    test: waves.lte(vars.wave_height)
               .and(man_geo.eq(22)),
    value: ee.Image(21)
  })*/
  
  /*// clean reef crest below wave threshold
  man_geo = man_geo.where({
    test: man_geo.eq(15)
                 .and(waves.lte(0.5)),
    value: ee.Image(14)
  })*/
  
  // use a distance to deepwater to cut out RC/slope
  
  var dist_to_deep = man_geo.eq(2).fastDistanceTransform(256).sqrt()
                                  .multiply(ee.Image.pixelArea().sqrt())
                                  .uint16()
                                  .selfMask()
  Map.addLayer(dist_to_deep, {}, "distance to deepwater", false)
  
  man_geo = man_geo.where({
    test: man_geo.eq(15)
                 .and(dist_to_deep.gte(300)),
    value: ee.Image(14)
  })
  
  man_geo = man_geo.where({
    test: man_geo.eq(21).or(man_geo.eq(22))
                 .and(dist_to_deep.gte(1500)),
    value: ee.Image(24)
  })
  
  /*
  ##############
  
  The rest of the manual geometry paintings and rules should go here
      - make the geom, paint the layer, use it in a rule
      - consult previous regions *_cleanup script for ideas/hints/existing rules etc.
  e.g. 
  var notreefcrest = ee.Image().byte().paint(ee.Feature(not_reef_crest, {zone: 1}), "zone").clip(not_reef_crest);
  var notdeepwater = ee.Image().byte().paint(ee.Feature(not_deep_water, {zone: 1}), "zone").clip(not_deep_water);
  
  
  // Reef crest -> Inner reef flat (inside the reef)
  man_geo = man_geo.where({
    test: notreefcrest.eq(1)
                     .and(man_geo.eq(15)),
    value: ee.Image(13)
  });
  
  // Deep water -> Deep lagoon (inside the reef)
  man_geo = man_geo.where({
    test: notdeepwater.eq(1)
                     .and(man_geo.eq(2)),
    value: ee.Image(12)
  });
  
  ##############
  */
  
  
  // This rule combines the WCMC (buffered) layer and an "extra reefs" layer to keep only those areas
  // useufl for regions where htere's very large stretchs of coastline where theres no reefs, or lots of turbid/cloudy/artefact flled water
  
  var combined_mask = ee.FeatureCollection(wcmc.filterBounds(region_extent).geometry().buffer(300))
                          .merge(ee.FeatureCollection(extra_reefs))
                          .geometry().dissolve()
  Map.addLayer(combined_mask, {}, "Combined WCMC + extra reef mask", false)
  
  
  var combined_mask_i = ee.Image().byte().paint(ee.Feature(combined_mask, {zone: 1}), 'zone')
                          .unmask(0, false)
  
  
  // use combiend mask to get rid of everything not within it
  man_geo = man_geo.where({
    test: combined_mask_i.eq(0),
    value: ee.Image(0)
  })
  
  // some manual masking rules mostly for the deeper classes
  var slopes_to_dl_i = ee.Image().byte().paint(ee.Feature(slopes_to_dl, {zone: 1}), "zone").clip(slopes_to_dl);
  var rf_to_sl_i = ee.Image().byte().paint(ee.Feature(rf_to_sl, {zone: 1}), "zone").clip(rf_to_sl);
  var slopes_to_brs_i = ee.Image().byte().paint(ee.Feature(slopes_to_brs, {zone: 1}), "zone").clip(slopes_to_brs);
  var slopelag_to_brs_i = ee.Image().byte().paint(ee.Feature(slopelag_to_brs, {zone: 1}), "zone").clip(slopelag_to_brs);
  var trf_to_orf_i = ee.Image().byte().paint(ee.Feature(trf_to_orf, {zone: 1}), "zone").clip(trf_to_orf);
  var dl_to_deep_i = ee.Image().byte().paint(ee.Feature(dl_to_deep, {zone: 1}), "zone").clip(dl_to_deep);
  var srs_to_rs_i = ee.Image().byte().paint(ee.Feature(srs_to_rs, {zone: 1}), "zone").clip(srs_to_rs);
  var sheltered_i = ee.Image().byte().paint(ee.Feature(sheltered, {zone: 1}), "zone").clip(sheltered);
  
  
  // Any slopes -> Deep lagoon (inside the reef)
  man_geo = man_geo.where({
    test: slopes_to_dl_i.eq(1)
                        .and(man_geo.eq(21).or(man_geo.eq(22)).or(man_geo.eq(24))),
    value: ee.Image(12)
  });
  
  // IRF or ORF -> Shallow lagoon (lighthouse reef)
  man_geo = man_geo.where({
    test: rf_to_sl_i.eq(1)
                    .and(man_geo.eq(13).or(man_geo.eq(14))),
    value: ee.Image(11)
  });
  
  // slope -> brs (one off)
  man_geo = man_geo.where({
    test: slopes_to_brs_i.eq(1)
                         .and(man_geo.eq(21).or(man_geo.eq(22))),
    value: ee.Image(24)
  });
  
  // slope/lagoons -> brs (one off)
  man_geo = man_geo.where({
    test: slopelag_to_brs_i.eq(1)
                           .and(man_geo.eq(21).or(man_geo.eq(22)).or(man_geo.eq(11)).or(man_geo.eq(12))),
    value: ee.Image(24)
  });
  
  // TRF -> ORF
  man_geo = man_geo.where({
    test: trf_to_orf_i.eq(1)
                      .and(man_geo.eq(16)),
    value: ee.Image(14)
  });
  
  // DL -> Deep
  man_geo = man_geo.where({
    test: dl_to_deep_i.eq(1)
                      .and(man_geo.eq(12)),
    value: ee.Image(2)
  });
  
  // SRS -> RS
  man_geo = man_geo.where({
    test: srs_to_rs_i.eq(1)
                      .and(man_geo.eq(21)),
    value: ee.Image(22)
  });
  
  // RS -> BRS
  man_geo = man_geo.where({
    test: sheltered_i.eq(1)
                      .and(man_geo.eq(22)),
    value: ee.Image(24)
  });
  
  // ORF -> TRF
  man_geo = man_geo.where({
    test: sheltered_i.eq(1)
                      .and(man_geo.eq(14)),
    value: ee.Image(16)
  });
  
  
  //mask to deep and anything removed to this point
  man_geo = man_geo.updateMask(man_geo.gt(2)).selfMask()
  
  if (vars.geo_refinement) {
    // make the mask image layer
    var refine = ee.Image().byte().paint(ee.Feature(refinement_mask, {zone: 1}), "zone").clip(refinement_mask);
    // apply
    man_geo = man_geo.where({
      test: refine.eq(1),
      value: ee.Image(0)
    });
  }
  
  // Add data + the manual layer to the map
  var lowtide_image = ee.Image(region_params.image);
  Map.addLayer(lowtide_image, {min:0, max:1500}, sensor_params.sname + ' low tide', false);
  var geo_clean1 = ee.Image(region_params.geo_map_clean1);
  Map.addLayer(geo_clean1, map_palettes.geo, 'Geo clean stage 1', false);
  var geo_clean2 = ee.Image(region_params.geo_map_clean2);
  Map.addLayer(geo_clean2, map_palettes.geo, 'Geo clean stage 2', false);
  //Map.addLayer(man_geo.updateMask(man_geo), map_palettes.geo, 'Geo clean stage 3', false);
  Map.addLayer(man_geo.updateMask(man_geo.gt(2)), map_palettes.geo, 'Geo clean stage 3 - no DW', false);
  Map.addLayer(wcmc, {color:'#d63000'}, "WCMC layer", false);
  //Map.addLayer(gbr30.lt(-20), {}, "Deep reef mask", false)
  //Map.addLayer(global_reef_mask, {}, "Global mask", false)
  //Map.addLayer(global_reef_mask.updateMask(global_reef_mask.eq(1)), {palette: ['F8FF23'], opacity: 0.4}, 'global_reef_mask - land', false);
  //Map.addLayer(global_reef_mask.updateMask(global_reef_mask.eq(3)), {palette: ['0000ff'], opacity: 0.4}, 'global_reef_mask - reef', false);
  //Map.addLayer(global_reef_mask.updateMask(global_reef_mask.eq(2)), {palette: ['FF0000'], opacity: 0.4}, 'global_reef_mask - water', false);

  
  // Export
  var output_name = (vars.geomorphic) ? vars.geomorph_output_name : vars.benthic_output_name;
  Export.image.toAsset({
    image: man_geo,
    description: output_name,
    assetId: vars.asset_output + 'in_out/' + output_name,
    region: region_extent,
    scale: vars.image_data_scale,
    crs: 'EPSG:4326',
    maxPixels: 1e13,
    pyramidingPolicy: {'.default': 'mode'}
  });
  
} 

if (vars.manual_clean && !vars.geomorphic) {
  
  print("Doing BENTHIC manual clean ups - make sure this is what you want to do");
  print("Export the manual map, check 'manual' layer in the viewer for effects");
  
  var depth = ee.Image(region_params.segments).select('depth');
  
  // define the final geomorphic map (the manually edited geo map - stage 3)
  var geo_map = ee.Image(region_params.geo_map_clean3);
  
  // define the clean benthic map to apply 2nd stage rules to
  var man_benthic = ee.Image(region_params.benthic_map_clean1);
  
  /*// extra depth cutoff refinement
  man_benthic = man_benthic.where({
          test: depth.gt(vars.benthic_depth_cutoff),
          value: ee.Image(0)
        });*/
  
  /*
  **Generic benthic rules**
    - should be generally applicable, but still review
  */
  
  // BMA on outer RF,reef crest, reef slope -> rubble 
  man_benthic = man_benthic.where({
    test: man_benthic.eq(18)
                     .and(geo_map.eq(14).or(geo_map.eq(15)).or(geo_map.eq(22))),
    value: ee.Image(12)
  });
  
  // "not sand" on shallow lagoon, deep lagoon -> seagrass (not 100% true, but more often than not here)
  man_benthic = man_benthic.where({
    test: man_benthic.neq(11)
                     .and(geo_map.eq(11).or(geo_map.eq(12))),
    value: ee.Image(14)
  });
  
  // rock/rubble on TRF -> seagrass (not 100% true, but more often than not here)
  man_benthic = man_benthic.where({
    test: man_benthic.eq(12).or(man_benthic.eq(13))
                     .and(geo_map.eq(11).or(geo_map.eq(12))),
    value: ee.Image(14)
  });
  
  // Sand on RC -> Rock
  man_benthic = man_benthic.where({
    test: man_benthic.eq(11)
                     .and(geo_map.eq(15)),
    value: ee.Image(13)
  }); 
  
  /*// Sand on reef slope -> coral/algae
  man_benthic = man_benthic.where({
    test: man_benthic.eq(11)
                     .and(geo_map.eq(22)),
    value: ee.Image(15)
  }); */
  
  // Seagrass on RC, slope -> Coral/Algae
  /*// except for these two areas
  var sg_orf = ee.Image().byte().paint(ee.Feature(sg_on_orf, {zone: 1}), "zone").unmask(geo_map.eq(42));*/
  
  man_benthic = man_benthic.where({
    test: man_benthic.eq(14)
                     .and(geo_map.eq(15).or(geo_map.eq(21)).or(geo_map.eq(22))),
                     //.and(sg_orf.eq(0)),
    value: ee.Image(15)
  }); 
  
  
  // set a max distance coral can extend
  var dist_to_ben = man_benthic.neq(15).and(man_benthic.neq(14)) // add seagrass here (might be generally applicable for all regions, if not, do only .neq(15)
                          .fastDistanceTransform(256).sqrt() // distance to anything not coral/algae
                          .multiply(ee.Image.pixelArea().sqrt())
                          .uint16()
                          .selfMask();
  
  man_benthic = man_benthic.where({
    test: man_benthic.eq(15)
                     .and(dist_to_ben.gt(200)),
    value: ee.Image(0)
  });
    
  /*
  
  **Manual polygon guided rules**
   - same as per geomorphic clean section
   - add a geometry, paint the layer, create a rule
  
  */
  
  var sg_to_ca_i = ee.Image().byte().paint(ee.Feature(sg_to_ca, {zone: 1}), "zone")
  
  // SG -> CA for some offshore areas - darker coral (i suppose) comes up as seagrass
  man_benthic = man_benthic.where({
    test: sg_to_ca_i.eq(1)
                    .and(man_benthic.eq(14)),
    value: ee.Image(15)
  });
  
  
  
  // final smooth for missing data due to depth
  var ben_mask = man_benthic.gt(0)
  man_benthic = man_benthic.focal_mode(2)
                           .updateMask(ben_mask)
                           .selfMask()
  
  
  // Add the manual layer to the map

  var dove_image = ee.Image(region_params.image);
  Map.addLayer(dove_image, {bands: ['b3','b2','b1'], min:0, max:4000, gamma:1.5}, sensor_params.sname + ' low tide', true);
  
  var benthic_clean1 = ee.Image(region_params.benthic_map_clean1);
  var geo_clean1 = ee.Image(region_params.geo_map_clean1);
  var geo_clean2 = ee.Image(region_params.geo_map_clean2);
  Map.addLayer(geo_clean1, map_palettes.geo, 'Geo clean stage 1', false);
  Map.addLayer(geo_clean2.updateMask(geo_clean2.gt(2)), map_palettes.geo, 'Geo clean stage 2', false);
  Map.addLayer(geo_map.updateMask(geo_map.gt(2)), map_palettes.geo, 'Geo clean stage 3 - MANUAL', true);
  Map.addLayer(benthic_clean1, map_palettes.benthic, 'Benthic clean stage 1', false);
  Map.addLayer(man_benthic.reproject({crs:'EPSG:4326', scale: 5}), map_palettes.benthic, 'Benthic clean stage 2 - MANUAL', true);
  
  // Export
  var output_name = (vars.geomorphic) ? vars.geomorph_output_name : vars.benthic_output_name;
  Export.image.toAsset({
    image: man_benthic,
    description: output_name,
    assetId: vars.asset_output + 'in_out/' + output_name,
    region: region_extent,
    scale: vars.image_data_scale,
    crs: 'EPSG:4326',
    maxPixels: 1e13,
    pyramidingPolicy: {'.default': 'mode'}
  });
  
}

// #################################################################################################
// END OF MANUAL SECTION
// #################################################################################################


// 2. Data loads & vis

if (!vars.manual_clean) {

  // load input data
  
  // define raw geo/benthic outputs
  // Run check to see if the region has been split into multiple areas
  
  // geo
  if (ee.List(region_params.geo_map).length().getInfo() > 1) {
    var geo_map_raw = ee.Image(region_params.geo_map[0]).unmask(0, false)
                 .add(ee.Image(region_params.geo_map[1]).unmask(0,false))
                 .selfMask();
  } else {
    var geo_map_raw = ee.Image(region_params.geo_map);
  }
  
  // benthic
  if (ee.List(region_params.benthic_map).length().getInfo() > 1) {
      var benthic_map = ee.Image(region_params.benthic_map[0]).unmask(0, false)
               .add(ee.Image(region_params.benthic_map[1]).unmask(0,false))
               .selfMask();
  } else {
      var benthic_map = ee.Image(region_params.benthic_map);
  }
  
  // set the geo map for further processing
  if (vars.geomorphic && vars.obia_2nd_pass) {
    // if it's 2nd pass, you want to make sure you're loading the latest geo clean map
    var geo_map = ee.Image(region_params.geo_map_clean1);
  } else if (vars.geomorphic) {
    var geo_map = geo_map_raw;
  }
  
  var depth = ee.Image(region_params.pixels).select('depth');
  var low_tide_image = ee.Image(region_params.image);
  
  var display_pal = (vars.geomorphic) ? map_palettes.geo : map_palettes.benthic;
  Map.addLayer(depth, {min:0, max:2500}, 'Depth data', false);
  Map.addLayer(low_tide_image, {bands: ['b3','b2','b1'], min:0, max:3000}, sensor_params.sname + ' low tide', false);
  
  // load for display purposes
  if (vars.geomorphic) {
    Map.addLayer(geo_map_raw, display_pal, 'Geomorphic map RAW', false);
    if (vars.cleanup_stage == 2) Map.addLayer(ee.Image(region_params.geo_map_clean1), display_pal, 'Geo clean stage 1', false);
  }
  if (!vars.geomorphic) {
    // Use the manually cleaned geomorphic map as input for the benthic clean
    var geo_map = ee.Image(region_params.geo_map_clean3);
    Map.addLayer(geo_map.updateMask(geo_map.gt(2)), map_palettes.geo, 'Geo clean stage 3', false);
    Map.addLayer(benthic_map, display_pal, 'Benthic map RAW', false);
  }
  
  // 3. Object-based re-classificaiton and cleaning
  
  /* OUTPUT EXTENT
    - to the mapping extent just so it doesn't balloon out
    - to the 'reef boundary' extent for noise/deep removal
  */  
  var class_extent_mask = geo_map.gt(0);
  
  /*
  
  ########
  Initial small object clean
   - this was originally at the end, but we needed to massively reduce the number of objects to 
     iterate through in the OBIA cleaning, so this happens first now
   - future collabs with google might fix this, but need to change the parallel serialisation of vector procesing
   
   - includes a possible special case for:
        - geomorphic to clean up turbid areas over size threshold; fix shallow vs. deep lagoon
        - benthic to allow breaking waves (temporal class) to grow into surrounding class
  ########
  
  */
  
  // ##############################################################################################
  // START OF CLEAN 1
  // ##############################################################################################
  
  if (vars.geomorphic && !vars.obia_2nd_pass) {
    
    // shallow lagoon > 5m == deep lagoon
    geo_map = geo_map.where({
      test: geo_map.eq(11)
                    .and(depth.gt(vars.shallowlag_depth_cutoff)),
      value: ee.Image(12)
    });
    
    // deep water in depth data == deep (s2 + ls8 data should be good enough for this)
    geo_map = geo_map.where({
      test: depth.gt(vars.geo_depth_cutoff),
      value: ee.Image(2)
    });
    
    // make a smooth map with masked area as a value - *** Change to ee.kernal*** see reef mask in clean 3
    var smooth_map = geo_map
                        .focal_mode({
                          radius: vars.smooth_radius, // relates to smoothness required
                          kernelType: 'circle', units: 'pixels', iterations: 2
                        });
    
    // replace small objects with smooth underneath
    var clean_map = geo_map.where({
      test: geo_map.connectedPixelCount(vars.small_object_geo, false).lt(vars.small_object_geo), 
      value: smooth_map
    }).updateMask(class_extent_mask);
    
    // display distance to land mask for assessing cut-off distances
    var distToLand = ee.Image(region_params.distToLand);
    Map.addLayer(distToLand.lte(vars.dist_to_land_RC), {}, 'Dist to land (RC to TRF): ' + vars.dist_to_land_RC + 'm', false);
    Map.addLayer(distToLand.unmask(100000, false).gt(vars.dist_to_land_ORF), {}, 'Dist to land (TRF to ORF): ' + vars.dist_to_land_ORF + 'm', false);

    // reef crest close to land -> TRF
    clean_map = clean_map.where({
      test: distToLand.lte(vars.dist_to_land_RC)
                      .and(clean_map.eq(15)),
      value: ee.Image(16)
      });
    
    // TRF outside of specified distance from land -> ORF
    clean_map = clean_map.where({
      test: distToLand.unmask(100000, false).gt(vars.dist_to_land_ORF)
                       .and(clean_map.eq(16)),
      value: ee.Image(14)
    });
  }
  
  if (!vars.geomorphic && vars.cleanup_stage == 1) {
    
    // make a smooth map with masked area as a value, and without temporal class (basically breaking waves)
    var smooth_map = benthic_map
                        .focal_mode({
                          radius: vars.smooth_radius, // relates to smoothness required
                          kernelType: 'circle', units: 'pixels', iterations: 1
                        });
    
    //replace small objects with smooth underneath
    var clean_map = benthic_map.where({
      test: benthic_map.connectedPixelCount(vars.small_object_benthic, false).lt(vars.small_object_benthic),
      value: smooth_map
    }).updateMask(class_extent_mask);
    
  }
  
  // ##############################################################################################
  // START OF CLEAN 2
  // ##############################################################################################
  
  if (vars.geomorphic && vars.obia_2nd_pass) {
    var clean_map = geo_map;
  }
  
  if (vars.obia_clean) {
    
    if (vars.geomorphic && !vars.fast_clean) { 
      
      // FUNCTION that maps over feature colleciton and assigns neighbour percentages
      var set_neighbour_properties = function(f) {
        // make the 1px buffer
        var diff = f.buffer(vars.image_data_scale).difference(f, ee.ErrorMargin(0.5));
        // reduce the classes in the buffer zone
        var diff_classes = ee.Dictionary(
          clean_map.unmask(ee.Image(0)).reduceRegion({
            reducer: ee.Reducer.frequencyHistogram(),
            geometry: diff.geometry(),
            scale: vars.image_data_scale,
            maxPixels: 1e11
          }).get('classification')
        );
        // calculate the percentages
        var diff_sum = diff_classes.toArray().reduce(ee.Reducer.sum(), [0]).get([0]);
        var diff_percs = diff_classes.map(function(k,v){return(ee.Number(v).divide(diff_sum).multiply(100).toUint8())});
        
        /* NOW, we can try to do the class logic right here (see /users/mitchest/global_reefs/obia_dev),
           or we can return the neighbour % and do image logic via (painted) rasters */
        
        return(f.set(diff_percs));
      };
      
      // FUNCTION to reduce the map to vectors and map the neighbour properties function
      var reduce_neighbours = function() {
        // reduce map to vectors
        var map_fc = clean_map
              .updateMask(segment_id).updateMask(clean_map.eq(classn)) // only vectorise class/es of interest
              .reduceToVectors({
                scale: vars.image_data_scale, 
                eightConnected: false,
                bestEffort: true, 
                maxPixels: 1e13,
                tileScale: 1,
                geometry: region_extent
              });
        // map the function, calculate neighbour properties
        return(map_fc.map(set_neighbour_properties));
      };
      
      // first make a make size threshold, so we're not vecortising huge objects when we don't have to
      var segment_id = clean_map.connectedComponents(ee.Kernel.plus(1),vars.small_object_geo.sqrt()).select('labels');
      //Map.addLayer(segment_id.reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))))
      Map.addLayer(clean_map.updateMask(segment_id).reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))), display_pal, 'Map objects to be iterated through (OBIA)', false);
      
      // This is where we select the single or group of classes to vectorise for cleaning up
      //var classn = ee.Number(15) // one class
      var classn = clean_map.where({
        test: clean_map.neq(16) //TRF
                .and(clean_map.neq(15)) //RR
                .and(clean_map.neq(14)) //ORF
                .and(clean_map.neq(13)) //IRF
                //.and(clean_map.neq(12)) // deep L
                .and(clean_map.neq(11)), // shallow L 
        value: ee.Image(99) // 99 ensures it's ignored in logic
      });
      
      // Minimum size of object to reclass based on neighbourhood
      var max_size = ee.Number(1000).divide(vars.image_data_scale).pow(2); // the first number is the square dimension of the desired min size;
      // calculate neighbours
      var map_fc_neighbours = reduce_neighbours();
      
      // #########
      // REEF RIM
      // #########
      
      var focus_class = ee.Number(15); //RR
      
      // start the object-based neighbourhood rules
      // paint out to rasters (only paint the layers needed)
      var objsize = ee.Image(30000).paint(map_fc_neighbours, 'count').rename('count');
      //var nb24 = ee.Image().byte().paint(map_fc_neighbours, '24').unmask(0).rename('nb24') //OCL
      var nb22 = ee.Image().byte().paint(map_fc_neighbours, '22').unmask(0).rename('nb22'); //SL ex
      var nb21 = ee.Image().byte().paint(map_fc_neighbours, '21').unmask(0).rename('nb21'); //Sl sh
      var nb16 = ee.Image().byte().paint(map_fc_neighbours, '16').unmask(0).rename('nb16'); //TRF
      var nb15 = ee.Image().byte().paint(map_fc_neighbours, '15').unmask(0).rename('nb15'); //RR
      var nb14 = ee.Image().byte().paint(map_fc_neighbours, '14').unmask(0).rename('nb14'); //ORF
      var nb13 = ee.Image().byte().paint(map_fc_neighbours, '13').unmask(0).rename('nb13'); //IRF
      //var nb3 = ee.Image().byte().paint(map_fc_neighbours, '3').unmask(0).rename('nb3') //Turbid
      
      // RR surrounded by ORF --> ORF
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb14.gt(75)),
        value: ee.Image(14)
      });
      
      // RR surrounded by IRF --> IRF
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb13.gt(75)),
        value: ee.Image(13)
      });
      
      // RR surrounded by IRF + ORF --> IRF
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb13.add(nb14).gt(75)),
        value: ee.Image(13)
      });
      
      // RR with decent border to TRF --> TRF (often dark, probably seagrass)
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb16.gt(40)),
        value: ee.Image(16)
      });
      
      // RR surrounded by OCL --> OCL
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb24.gt(75)),
        value: ee.Image(24)
      })
      
      // small RR objects touching OCL + stuff --> ORF
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(objsize.lte(max_size))
                .and(nb13.lte(75).and(nb14.lte(75))) // to ensure we're no re-writing previous rules
                .and(nb24.gt(1)),
        value: ee.Image(14)
      })
      
      // ####
      // ORF
      // ####
      
      focus_class = ee.Number(14); // ORF
      
      // ORF surrounded by IRF --> IRF
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb13.gt(75)),
        value: ee.Image(13)
      });
      
      // ORF surrounded by TRF --> TRF
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb16.gt(75)),
        value: ee.Image(16)
      });
      
      // ORF surrounded by RR --> RR
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb15.gt(85)),
        value: ee.Image(15)
      });
      
      // ORF touching slope and RR --> RR
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb21.gt(0).or(nb22.gt(0)))
                .and(nb15.gt(0)),
        value: ee.Image(15)
      });
      
      // ####
      // IRF
      // ####
      
      focus_class = ee.Number(13); // IRF
      
      // IRF surrounded by ORF --> ORF
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb14.gt(75)),
        value: ee.Image(14)
      });
      
      // IRF surrounded by TRF --> TRF
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb16.gt(75)),
        value: ee.Image(16)
      });
      
      // IRF surrounded by RR --> RR
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb15.gt(85)),
        value: ee.Image(15)
      });
      
      // ####
      // TRF
      // ####
      
      focus_class = ee.Number(16); // TRF
      
      // TRF surrounded by ORF --> ORF
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb14.gt(75)),
        value: ee.Image(14)
      });
      
      // TRF surrounded by IRF --> IRF
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb13.gt(75)),
        value: ee.Image(13)
      });
      
      // TRF surrounded by IRF + ORF --> IRF
      clean_map = clean_map.where({
        test: clean_map.eq(focus_class)
                .and(nb13.add(nb14).gt(75)),
        value: ee.Image(13)
      });
      
      // ####
      // LAGOONS
      // ####
      
      var nb11 = ee.Image().byte().paint(map_fc_neighbours, '11').unmask(0).rename('nb11'); // shallow lag
      
      // SL sourrounded by DL --> DL
      clean_map = clean_map.where({
        test: clean_map.eq(11)
                .and(nb12.gt(75)),
        value: ee.Image(12)
      })
      
      // DL sourrounded by SL --> SL
      clean_map = clean_map.where({
        test: clean_map.eq(12)
                .and(nb11.gt(75)),
        value: ee.Image(11)
      })
      
      // DL/SL surrounded by IRF --> IRF
      clean_map = clean_map.where({
        test: clean_map.eq(11).or(clean_map.eq(12))
                .and(objsize.lte(max_size))
                .and(nb13.gt(80)),
        value: ee.Image(13)
      })
      
      // SL surrounded by IRF --> IRF
      clean_map = clean_map.where({
        test: clean_map.eq(11)
                .and(objsize.lte(max_size))
                .and(nb13.gt(80)),
        value: ee.Image(13)
      });
      
    
    } else if (vars.geomorphic && vars.fast_clean) {
      print("Executing the fast version OBIA");
      
      /* fast version of the geo clean up
        - blanket version assigns the underlying most common in neighbourhood
        - mode OBIA version iterates through objects+buffers but take the mode instead of doing the class percs, to see if that speeds things up
      */
      
      
      // ## Blanket version
      
      // make a very smooth map to capture the broader neighbourhood  - *** Change to ee.kernal*** see reef mask in clean 3
      var smooth_map = clean_map
                          .focal_mode({
                            radius: vars.smooth_radius.multiply(3), // relates to smoothness required
                            kernelType: 'circle', units: 'pixels', iterations: 2
                          });
      
      // first make a make size threshold, so we're not vectorising huge objects when we don't have t
      // - the unmask(99) captures small no data values/ data gaps
      var segment_id = clean_map.unmask(0).connectedComponents(ee.Kernel.plus(1),vars.small_object_geo.sqrt().multiply(2)).select('labels').pow(2).log().int();
      Map.addLayer(clean_map.unmask(0).updateMask(segment_id.gt(0)).reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))), display_pal, 'Map objects to be iterated through (OBIA)', false);
      
      // replace small objects with smooth underneath
      var clean_map = clean_map.unmask(0).where({
        test: segment_id.gt(0), 
        value: smooth_map
      }).selfMask();
      
      
      // ## mode OBIA version
      
      /* A possible faster plan
            - vectorise one/few class/es at a time, thus only spending resources on what is actually needed to clean up
            - BUT, just assign the mode of the neighbours, so save resouces even further??
      
      // FUNCTION that maps over feature colleciton and assigns neighbour percentages
      var set_neighbour_mode = function(f) {
        // make the 1px buffer
        var diff = f.buffer(vars.image_data_scale).difference(f, ee.ErrorMargin(0.5))
        // reduce the classes in the buffer zone
        var diff_mode = ee.Number(ee.Dictionary(
          clean_map.unmask(ee.Image(0)).reduceRegion({
            reducer: ee.Reducer.mode(),
            geometry: diff.geometry(),
            scale: vars.image_data_scale,
            maxPixels: 1e11
          })).get('classification'))
        
        return(f.set('mode',diff_mode))
      }
      
      // FUNCTION to reduce the map to vectors and map the neighbour properties function
      var reduce_neighbours_mode = function() {
        // reduce map to vectors
        var map_fc = clean_map.unmask(0)
              .updateMask(classn.gt(0)) // only vectorise class/es of interest
              .reduceToVectors({
                scale: vars.image_data_scale, 
                eightConnected: false,
                bestEffort: true, 
                maxPixels: 1e13,
                tileScale: 1,
                geometry: region_extent
              })
        // map the function, calculate neighbour properties
        return(map_fc.map(set_neighbour_mode))
      }
      
      // first make a make size threshold, so we're not vecortising huge objects when we don't have to
      var segment_id = clean_map.unmask(0).connectedComponents(ee.Kernel.plus(1),vars.small_object_geo.sqrt()).select('labels')
      Map.addLayer(clean_map.unmask(0).updateMask(segment_id.gt(0)).reproject(ee.Projection('EPSG:4326').atScale(ee.Number(vars.image_data_scale))), display_pal, 'Map objects to be iterated through (OBIA)', false)
      
      // This is where we select the single or group of classes to vectorise for cleaning up
      var classn = segment_id.where({
        test: clean_map.neq(16) //TRF
                .and(clean_map.neq(15)) //RR
                .and(clean_map.neq(14)) //ORF
                .and(clean_map.neq(13)) //IRF
                //.and(clean_map.neq(12)) // deep L
                .and(clean_map.neq(11)) // shallow L 
                .and(clean_map.unmask(0).neq(0)), // no data values (want to reclaim the small gaps 
        value: ee.Image(0) // 99 ensures it's ignored in logic
      })
      
      // calculate neighbours
      var map_fc_neighbours = reduce_neighbours_mode()
      
      //print(map_fc_neighbours.limit(10))
      
      var mode_map = ee.Image().byte().paint(map_fc_neighbours, 'mode').unmask(0).rename('mode') // paint out the mode values to an image
      //Map.addLayer(mode_map, display_pal, "mode map", false)
      
      // replace small objects with mode underneath
      var clean_map = clean_map.unmask(0).where({
        test: segment_id.gt(0), 
        value: mode_map
      }).selfMask()
      
      */
      
    } else {
      
      if (vars.cleanup_stage == 1) {
        // BENTHIC CLEAN-UP RULES
        
        /*// reclaim shallow no data to surrounding class
        var smooth_map = clean_map
                            .focal_mode({
                              radius: vars.smooth_radius.multiply(3), // relates to smoothness required
                              kernelType: 'circle', units: 'pixels', iterations: 2
                            });
        
        var clean_map = clean_map.unmask(0).where({
          test: geo_map.gt(2).and(clean_map.eq(0)), 
          value: smooth_map
        }).selfMask();*/
        
        // cut benthic off to < 10 - 15 m
        clean_map = clean_map.where({
          test: depth.gt(vars.benthic_depth_cutoff),
          value: ee.Image(0)
        });
        
        // Deep (or land or missing) in geo == masked from benthic
        clean_map = clean_map.where({
          test: geo_map.unmask(0).lte(2),
          value: ee.Image(0)
        });
        
      }
    }
  }
  
  // Final clip to the classified extent and move on
  if (vars.geomorphic) {
    clean_map = clean_map.updateMask(clean_map.gt(1)); // this ignores 0/land; make it .gt(2) if you want to mask deep too
  } else {
    clean_map = clean_map.updateMask(clean_map.gt(1)); // this ignores 0/land; make it .gt(2) if you want to mask deep too
  }

  
  
  // 4. Export data
  
  var output_name = (vars.geomorphic) ? vars.geomorph_output_name : vars.benthic_output_name;
  
  if (vars.do_export) {
    print("For export, the image data scale must be set to:", vars.image_data_scale);
    
    Map.addLayer(region_extent, {}, "Export footprint", false);
    
    Export.image.toAsset({
      image: clean_map.set(vars),
      description: output_name,
      assetId: vars.asset_output + 'in_out/' + output_name,
      region: region_extent,
      scale: vars.image_data_scale,
      crs: 'EPSG:4326',
      maxPixels: 1e13,
      pyramidingPolicy: {'.default': 'mode'}
    });
    
  } else {
    if (vars.reproject_display) {
      Map.addLayer(clean_map.reproject(ee.Projection('EPSG:4326').atScale(vars.image_data_scale)), display_pal, output_name, true);
    } else {
      Map.addLayer(clean_map, display_pal, output_name, false);
    }
  }

}

//Generate title
var title = ui.Label({
  value: 'Classes',
  style: {fontWeight: 'bold', fontSize: '12px'}
});

// generate the legend
var geo_legend = pkg_vis.discrete_legend(map_palettes.geo_atlas_names, map_palettes.geo_atlas_cols, 'Geomorphic Zone', false);
var benthic_legend = pkg_vis.discrete_legend(map_palettes.benthic_atlas_names, map_palettes.benthic_atlas_cols, 'Benthic Habitat', false);
//var mask_legend = pkg_vis.discrete_legend(["Low confidence depth","Water conditions"], ["#f7f7f7","#bababa"], 'Confidence Mask reason', false)
var legend = (vars.geomorphic) ? geo_legend : benthic_legend;
pkg_vis.add_lgds([title, legend]);//, mask_legend])
// generate the legend
