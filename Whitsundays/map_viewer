/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var wcmc = ee.FeatureCollection("projects/coral_atlas/global_datasets/wcmc_reefs_2018v4_filtered"),
    pixels = ee.Image("users/EvaK/Whit_eomap/in_out/whit_pixels"),
    segments = ee.Image("users/EvaK/Whit_eomap/in_out/whit_segmentation"),
    centre = /* color: #d63000 */ee.Geometry.Point([148.75488810629244, -20.15294144497883]),
    depth = ee.Image("projects/coral_atlas/gbr_eomap/mosaics/gbr_eomap_depth"),
    sfr = ee.Image("projects/coral_atlas/gbr_eomap/mosaics/gbr_eomap_sfr"),
    ssr = ee.Image("projects/coral_atlas/gbr_eomap/mosaics/gbr_eomap_ssr"),
    S2 = ee.Image("projects/coral_atlas/gbr_eomap/mosaics/gbr_eomap_pretty-rgb"),
    pixels2 = ee.Image("users/EvaK/Whit_eomap/in_out/whit_pixels2"),
    segments2 = ee.Image("users/EvaK/Whit_eomap/in_out/whit_segmentation2"),
    geo_raw = ee.Image("users/EvaK/Whit_eomap/in_out/whit_geoD"),
    geo_clean1 = ee.Image("users/EvaK/Whit_eomap/in_out/whit_geo-cleanD"),
    geo_clean2 = ee.Image("users/EvaK/Whit_eomap/in_out/whit_geo-cleanD2"),
    IRFtoBRS = /* color: #80d691 */ee.Geometry.Polygon(
        [[[148.5618513756873, -20.106554880701886],
          [148.54193865596073, -20.115581790227807],
          [148.56013476191777, -20.216776415739538],
          [148.64630877314823, -20.229340588372082],
          [148.67583452998417, -20.30470428633508],
          [148.78638445674198, -20.335934051848675],
          [148.8445886944462, -20.464258974968544],
          [148.9159998272587, -20.53982946556469],
          [148.987104802721, -20.51872851274575],
          [148.88449971634915, -20.384473609426024],
          [148.87385671097806, -20.40571244106652],
          [148.85772054154447, -20.374818627651067],
          [148.848450827189, -20.336192660018213],
          [148.85291402298978, -20.326534659159428],
          [148.86870686966947, -20.2821000908538],
          [148.81892507035306, -20.26631953341586],
          [148.78459279496244, -20.264065037021993],
          [148.70288197953275, -20.168702110233433],
          [148.64108388382962, -20.14807542106346],
          [148.61430470902494, -20.164190254930446],
          [148.5902721162515, -20.152587742235262],
          [148.5789424653726, -20.115256428360137]]]),
    ORFIRFandRCtoTRF = /* color: #4f8400 */ee.Geometry.MultiPolygon(
        [[[[148.9332369088553, -20.24898722837762],
           [148.94765646451935, -20.266057830226135],
           [148.96310598844514, -20.259938396354475],
           [148.97855551237092, -20.240290162513215],
           [148.95898611539826, -20.222894570552498],
           [148.93083364957795, -20.23900166690538]]],
         [[[149.0152910470389, -20.226116123316515],
           [148.99846823209748, -20.25059774269515],
           [148.9943483590506, -20.266057830226135],
           [149.01185781949982, -20.262192952694893],
           [149.01872427457795, -20.247376697360004],
           [149.02490408414826, -20.239645916044793],
           [149.022157502117, -20.227404725736005]]],
         [[[149.0314966603216, -20.25916393589493],
           [149.03286995133723, -20.25441313270986],
           [149.02849258622493, -20.247649026527064],
           [149.02574600419368, -20.245877426226333],
           [149.02248443803157, -20.24475003369695],
           [149.01862205705012, -20.247487972789212],
           [149.01673378190364, -20.252077938874407],
           [149.01561798295344, -20.256667769295927],
           [149.01158394059505, -20.265927540413927],
           [148.9963919087347, -20.280258966159703],
           [148.99716438493098, -20.296521114508764],
           [149.01184143266047, -20.295555093966527],
           [149.02136863908137, -20.28871227603008],
           [149.02267248624787, -20.275880627330867],
           [149.02559072965607, -20.27032518734378],
           [149.02601988309846, -20.25518761686941],
           [149.027736496868, -20.25518761686941],
           [149.02868063444123, -20.255831798878738],
           [149.02902395719514, -20.25792537194994]]],
         [[[148.94819950902468, -20.292141198425714],
           [148.9484570010901, -20.297212850825527],
           [148.95051693761354, -20.298903364730922],
           [148.9532635196448, -20.300110863367866],
           [148.96115994298464, -20.296649342090756],
           [148.9700863345862, -20.285539751426505],
           [148.9782896132684, -20.274929545296313],
           [148.9801778884149, -20.264382026322597],
           [148.96721745445493, -20.263254768145828],
           [148.94927884056332, -20.28169246252053]]]]),
    ORFtoIRF = /* color: #edfd46 */ee.Geometry.MultiPolygon(
        [[[[148.93521631087026, -20.274278489367173],
           [148.92577493513784, -20.276210789638217],
           [148.91616189802846, -20.285227872548898],
           [148.9221486200477, -20.28933377636866],
           [148.9243590651565, -20.294325094454788],
           [148.9282320740267, -20.29702187126694],
           [148.9323358404128, -20.301026739419495],
           [148.9336930935898, -20.300926082940858],
           [148.9377485986905, -20.296498307953435]]],
         [[[148.9523640681656, -20.306049388915334],
           [148.95790014757233, -20.306572615336805],
           [148.9631358195694, -20.310114409232785],
           [148.96622572435456, -20.30286974418315],
           [148.96017466081696, -20.300334031340533],
           [148.9536086131485, -20.30166226705483]]]]),
    DLSLandBRStoRC = /* color: #ff935a */ee.Geometry.Polygon(
        [[[148.88477379524355, -20.07251742893326],
          [148.89666134559755, -20.075056851595402],
          [148.90060955726747, -20.070542293984488],
          [148.88915116035585, -20.065826054819233],
          [148.88490254127626, -20.066954740348606]]]),
    RCtoORF = /* color: #ffd5a4 */ee.Geometry.MultiPolygon(
        [[[[148.94850302705314, -20.0931338961569],
           [148.95227963173036, -20.09605589695771],
           [148.9541249915326, -20.087148776113995],
           [148.94798809730653, -20.088116089769507]]],
         [[[148.9420228644574, -20.112538779637898],
           [148.9416795417035, -20.10367289708368],
           [148.93446976387148, -20.10721931037619]]]]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
// little viewing script for looking at reefs and classifications for each region. 
//From this region Andaman Sea onwards the map_viewer script is going to be used from the very beginning
//in the workflow 

// imports
var pkg_vis = require('users/mitchest/global_reefs:Modules/pkg_vis')
var map_palettes = require('users/mitchest/global_reefs:Modules/colour_pals')

// choogse where to centre (link this dynamically to map app?)
var centre_map = ee.Geometry.Point([148.75488810629244, -20.15294144497883])
Map.centerObject(centre_map, 7)



// add some background data
Map.addLayer(S2, {bands: ['b3','b2','b1'], min: 66, max: 1260}, "s2 pretty picture", false)
Map.addLayer(depth, {color: 'ffff00'}, 'Hs95', false)
//Map.addLayer(southasia_dove, {bands: ['b3','b2','b1'], min: 66, max: 1260}, "south asia - Dove low tide mosaic", false)
//Map.addLayer(Artifact_layer, {color: 'ffff00'}, 'Artifact Layer', false)

// Whitsundays
//Map.addLayer(pixels, {color:'#20639b'}, "pixels", false)
Map.addLayer(pixels2, {color:'#17e8e5'}, "pixels2", false)
//Map.addLayer(segments, {color:'#3caea3'}, "segments", false)
Map.addLayer(segments2, {color:'#135c55'}, "segments2", false)
//Map.addLayer(geo_rawA, map_palettes.geo, "Whit Geo - RAW OLD", false)
Map.addLayer(geo_raw, map_palettes.geo, "Whit Geo - RAW", false)
//Map.addLayer(geo_OLD, map_palettes.geo, "Whit Geo-clean OLD", false)
//Map.addLayer(geo_OLD2, map_palettes.geo, "Whit Geo-clean OLDb", false)

//Map.addLayer(benthic.updateMask(geo.gt(2)), map_palettes.benthic, "Andaman + Myanmar Benthic - RAW", false)
//Map.addLayer(benthic_clean, map_palettes.benthic, "Nth. Cari & Baha Benthic - FINAL", false)

Map.addLayer(geo_clean1, map_palettes.geo, "geo_clean_1", false)
Map.addLayer(geo_clean2, map_palettes.geo, "geo_clean_2", false)
//Map.addLayer(geo_clean3, map_palettes.geo, "geo_manual", false)
//Map.addLayer(ben_clean1, map_palettes.benthic, "ben_clean_1", false)
//Map.addLayer(ben_clean2, map_palettes.benthic, "ben_FINAL", false)
//Map.addLayer(ben_clean2b, map_palettes.benthic, "ben_FINAL-less rubble", false)

/*
// wave data
var kd1 = ee.Image('users/danleeharris/reefwave/fiji_v1_kd1')
var kd2 = ee.Image('users/danleeharris/reefwave/fiji_v1_kd2')

Map.addLayer(kd1, {}, "waves - kd1", false)
Map.addLayer(kd2, {}, "waves - kd2", false)*/

// add training data / sample point distributions

Map.addLayer(wcmc, {color:'#ffff00'}, "WCMC layer", false)

////////// UI SET UP //////////


//Generate title
var title = ui.Label({
  value: 'Coral Atlas map classes',
  style: {fontWeight: 'bold', fontSize: '18px'}
})

// generate the legend
var geo_legend = pkg_vis.discrete_legend(map_palettes.geo_atlas_names, map_palettes.geo_atlas_cols, 'Geomorphic Zone', false)
var benthic_legend = pkg_vis.discrete_legend(map_palettes.benthic_atlas_names, map_palettes.benthic_atlas_cols, 'Benthic Habitat', false)
//var mask_legend = pkg_vis.discrete_legend(["Low confidence depth","Water conditions"], ["#f7f7f7","#bababa"], 'Confidence Mask reason', false)
pkg_vis.add_lgds([title, geo_legend, benthic_legend])//, mask_legend])
// generate the legend